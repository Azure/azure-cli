interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-resource/16.1.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_app_gateway_waf_custom_rule_000001?api-version=2020-10-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001","name":"cli_test_app_gateway_waf_custom_rule_000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","date":"2021-05-14T05:57:09Z"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '428'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "properties": {"managedRules": {"managedRuleSets":
      [{"ruleSetType": "OWASP", "ruleSetVersion": "3.0"}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy create
      Connection:
      - keep-alive
      Content-Length:
      - '128'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"6b7442cb-9ab8-4049-95a9-e78821af30d9\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [],\r\n    \"policySettings\": {\r\n
        \     \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\": 128,\r\n
        \     \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/87d1ed6b-398f-46d1-a1b3-34ae010bb80b?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '924'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 666e95d4-f5a4-41fc-bfa1-322311e808a5
      x-ms-ratelimit-remaining-subscription-writes:
      - '1193'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"15f09a54-219a-4a96-90f9-602157221ed1\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [],\r\n    \"policySettings\": {\r\n
        \     \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\": 128,\r\n
        \     \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '925'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:16 GMT
      etag:
      - W/"15f09a54-219a-4a96-90f9-602157221ed1"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - b14c0a44-42cf-4e30-b71a-cb47ce1cb0d8
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"15f09a54-219a-4a96-90f9-602157221ed1\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [],\r\n    \"policySettings\": {\r\n
        \     \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\": 128,\r\n
        \     \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '925'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:16 GMT
      etag:
      - W/"15f09a54-219a-4a96-90f9-602157221ed1"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 2e14afa2-9e99-4ef8-837b-8b9049ed381c
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"policySettings": {"state": "Disabled",
      "mode": "Detection", "requestBodyCheck": true, "maxRequestBodySizeInKb": 128,
      "fileUploadLimitInMb": 100}, "customRules": [{"name": "rule1", "priority": 50,
      "ruleType": "MatchRule", "matchConditions": [], "action": "Log"}], "managedRules":
      {"exclusions": [], "managedRuleSets": [{"ruleSetType": "OWASP", "ruleSetVersion":
      "3.0", "ruleGroupOverrides": []}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      Content-Length:
      - '670'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"4c359392-2113-4a64-a55d-145bf5766961\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n    ],\r\n    \"policySettings\":
        {\r\n      \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\":
        128,\r\n      \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/7e840f95-857c-42a1-8c94-2b6334123896?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '1163'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 3c2f980a-2cc9-48d0-8306-63e1a098864a
      x-ms-ratelimit-remaining-subscription-writes:
      - '1189'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"989e208e-815c-4c29-bc96-865535cd96d8\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n    ],\r\n    \"policySettings\":
        {\r\n      \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\":
        128,\r\n      \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1164'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:17 GMT
      etag:
      - W/"989e208e-815c-4c29-bc96-865535cd96d8"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 0f7b8404-f48e-4938-bbf4-f6e41a7b5ca9
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"989e208e-815c-4c29-bc96-865535cd96d8\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n    ],\r\n    \"policySettings\":
        {\r\n      \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\":
        128,\r\n      \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1164'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:18 GMT
      etag:
      - W/"989e208e-815c-4c29-bc96-865535cd96d8"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 8b2ca1b8-acd1-4ae7-bf90-6e4500b7c0fe
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --transform
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"989e208e-815c-4c29-bc96-865535cd96d8\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n    ],\r\n    \"policySettings\":
        {\r\n      \"requestBodyCheck\": true,\r\n      \"maxRequestBodySizeInKb\":
        128,\r\n      \"fileUploadLimitInMb\": 100,\r\n      \"state\": \"Disabled\",\r\n
        \     \"mode\": \"Detection\"\r\n    },\r\n    \"managedRules\": {\r\n      \"managedRuleSets\":
        [\r\n        {\r\n          \"ruleSetType\": \"OWASP\",\r\n          \"ruleSetVersion\":
        \"3.0\",\r\n          \"ruleGroupOverrides\": []\r\n        }\r\n      ],\r\n
        \     \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1164'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:20 GMT
      etag:
      - W/"989e208e-815c-4c29-bc96-865535cd96d8"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 540a8349-bedf-4c54-81fe-3c331e81089b
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"policySettings": {"state": "Disabled",
      "mode": "Detection", "requestBodyCheck": true, "maxRequestBodySizeInKb": 128,
      "fileUploadLimitInMb": 100}, "customRules": [{"name": "rule1", "priority": 50,
      "ruleType": "MatchRule", "matchConditions": [{"matchVariables": [{"variableName":
      "RequestHeaders", "selector": "value"}], "operator": "Contains", "matchValues":
      ["foo", "boo"], "transforms": ["Lowercase"]}], "action": "Log"}], "managedRules":
      {"exclusions": [], "managedRuleSets": [{"ruleSetType": "OWASP", "ruleSetVersion":
      "3.0", "ruleGroupOverrides": []}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '831'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --transform
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"ff3d8bce-bc22-4a1b-adc0-5dbc04cfd3c2\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/c4c1f75c-825e-4b45-a24e-ae18399fd3f9?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '1607'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:20 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 99935e53-2dbb-4c3b-a74f-7412ee11bd96
      x-ms-ratelimit-remaining-subscription-writes:
      - '1190'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"4625802b-c5cd-416c-8ae8-11b32621937c\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1608'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:21 GMT
      etag:
      - W/"4625802b-c5cd-416c-8ae8-11b32621937c"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 30e30e3b-fe2a-4937-a38f-5c3c53d8c807
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --priority
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"4625802b-c5cd-416c-8ae8-11b32621937c\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 50,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1608'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:21 GMT
      etag:
      - W/"4625802b-c5cd-416c-8ae8-11b32621937c"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 62e00d5c-d922-4840-8257-9e3e9261933d
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"policySettings": {"state": "Disabled",
      "mode": "Detection", "requestBodyCheck": true, "maxRequestBodySizeInKb": 128,
      "fileUploadLimitInMb": 100}, "customRules": [{"name": "rule1", "priority": 75,
      "ruleType": "MatchRule", "matchConditions": [{"matchVariables": [{"variableName":
      "RequestHeaders", "selector": "value"}], "operator": "Contains", "negationConditon":
      false, "matchValues": ["foo", "boo"], "transforms": ["Lowercase"]}], "action":
      "Log"}], "managedRules": {"exclusions": [], "managedRuleSets": [{"ruleSetType":
      "OWASP", "ruleSetVersion": "3.0", "ruleGroupOverrides": []}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule update
      Connection:
      - keep-alive
      Content-Length:
      - '858'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --priority
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"9e6ea8fb-826e-44b0-baa9-bc5661f18aaf\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/c9f47d4d-e88b-4c9a-b7ab-8c56b42f3881?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '1607'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:22 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - f66c588c-4750-4b25-850b-83e14ea5c12f
      x-ms-ratelimit-remaining-subscription-writes:
      - '1191'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --transform
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"c86aafbd-99f9-41c3-b07f-5fe12b1f4103\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1608'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:23 GMT
      etag:
      - W/"c86aafbd-99f9-41c3-b07f-5fe12b1f4103"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - fb9617e6-cb7c-45a1-a7d3-1faeaf6b08b2
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"policySettings": {"state": "Disabled",
      "mode": "Detection", "requestBodyCheck": true, "maxRequestBodySizeInKb": 128,
      "fileUploadLimitInMb": 100}, "customRules": [{"name": "rule1", "priority": 75,
      "ruleType": "MatchRule", "matchConditions": [{"matchVariables": [{"variableName":
      "RequestHeaders", "selector": "value"}], "operator": "Contains", "negationConditon":
      false, "matchValues": ["foo", "boo"], "transforms": ["Lowercase"]}, {"matchVariables":
      [{"variableName": "RequestHeaders", "selector": "value"}], "operator": "Contains",
      "matchValues": ["remove", "this"], "transforms": ["Lowercase"]}], "action":
      "Log"}], "managedRules": {"exclusions": [], "managedRuleSets": [{"ruleSetType":
      "OWASP", "ruleSetVersion": "3.0", "ruleGroupOverrides": []}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '1025'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --transform
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"16ee3fcb-210b-4c99-a7b5-ea239dd7efcd\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         },\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"remove\",\r\n              \"this\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/8e274251-76c8-423d-9c29-c3fc74a5f905?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '2046'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - bddd90d4-9cd7-45a0-90fa-4092d854cbf5
      x-ms-ratelimit-remaining-subscription-writes:
      - '1195'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"113bfcbb-a5bf-4ce9-bde7-2eea7bb557d5\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         },\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"remove\",\r\n              \"this\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2047'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:23 GMT
      etag:
      - W/"113bfcbb-a5bf-4ce9-bde7-2eea7bb557d5"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - e0c3697b-8c1a-4fcc-9ce8-9f30280305bc
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --index
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"113bfcbb-a5bf-4ce9-bde7-2eea7bb557d5\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"foo\",\r\n              \"boo\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         },\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"remove\",\r\n              \"this\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2047'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:24 GMT
      etag:
      - W/"113bfcbb-a5bf-4ce9-bde7-2eea7bb557d5"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 9c78df69-8960-4a0f-bf59-b460d7d0a148
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"policySettings": {"state": "Disabled",
      "mode": "Detection", "requestBodyCheck": true, "maxRequestBodySizeInKb": 128,
      "fileUploadLimitInMb": 100}, "customRules": [{"name": "rule1", "priority": 75,
      "ruleType": "MatchRule", "matchConditions": [{"matchVariables": [{"variableName":
      "RequestHeaders", "selector": "value"}], "operator": "Contains", "negationConditon":
      false, "matchValues": ["remove", "this"], "transforms": ["Lowercase"]}], "action":
      "Log"}], "managedRules": {"exclusions": [], "managedRuleSets": [{"ruleSetType":
      "OWASP", "ruleSetVersion": "3.0", "ruleGroupOverrides": []}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition remove
      Connection:
      - keep-alive
      Content-Length:
      - '862'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --index
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"b3a41266-4220-49b7-a282-bb6b702c9942\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Updating\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"remove\",\r\n              \"this\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/f1234a8b-1a62-49ca-8673-b3fe02c72b77?api-version=2021-02-01
      cache-control:
      - no-cache
      content-length:
      - '1611'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:24 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 1ba06991-218b-4a38-9995-04ab57bc395c
      x-ms-ratelimit-remaining-subscription-writes:
      - '1195'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-network/18.0.0 Python/3.7.3 (Windows-10-10.0.19041-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2021-02-01
  response:
    body:
      string: "{\r\n  \"name\": \"agp1\",\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1\",\r\n
        \ \"etag\": \"W/\\\"a4da8e69-96ec-4a5e-aba9-d3e2bf6a2c15\\\"\",\r\n  \"type\":
        \"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies\",\r\n
        \ \"location\": \"westus\",\r\n  \"properties\": {\r\n    \"provisioningState\":
        \"Succeeded\",\r\n    \"customRules\": [\r\n      {\r\n        \"name\": \"rule1\",\r\n
        \       \"priority\": 75,\r\n        \"ruleType\": \"MatchRule\",\r\n        \"action\":
        \"Log\",\r\n        \"rateLimitThreshold\": 0,\r\n        \"matchConditions\":
        [\r\n          {\r\n            \"matchVariables\": [\r\n              {\r\n
        \               \"variableName\": \"RequestHeaders\",\r\n                \"selector\":
        \"value\"\r\n              }\r\n            ],\r\n            \"operator\":
        \"Contains\",\r\n            \"negationConditon\": false,\r\n            \"matchValues\":
        [\r\n              \"remove\",\r\n              \"this\"\r\n            ],\r\n
        \           \"transforms\": [\r\n              \"Lowercase\"\r\n            ]\r\n
        \         }\r\n        ],\r\n        \"skippedManagedRuleSets\": []\r\n      }\r\n
        \   ],\r\n    \"policySettings\": {\r\n      \"requestBodyCheck\": true,\r\n
        \     \"maxRequestBodySizeInKb\": 128,\r\n      \"fileUploadLimitInMb\": 100,\r\n
        \     \"state\": \"Disabled\",\r\n      \"mode\": \"Detection\"\r\n    },\r\n
        \   \"managedRules\": {\r\n      \"managedRuleSets\": [\r\n        {\r\n          \"ruleSetType\":
        \"OWASP\",\r\n          \"ruleSetVersion\": \"3.0\",\r\n          \"ruleGroupOverrides\":
        []\r\n        }\r\n      ],\r\n      \"exclusions\": []\r\n    }\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1612'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 14 May 2021 05:57:25 GMT
      etag:
      - W/"a4da8e69-96ec-4a5e-aba9-d3e2bf6a2c15"
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 3a1082ef-5ff2-4767-90bf-bfb0a9a260c7
    status:
      code: 200
      message: OK
version: 1
