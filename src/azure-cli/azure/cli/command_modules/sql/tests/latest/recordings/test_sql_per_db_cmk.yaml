interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector --user-assigned-identity-id --yes
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr?api-version=2022-08-01-preview
  response:
    body:
      string: '{"identity":{"principalId":"0fbbb9bc-df2a-4fd0-83e6-cd486061913f","type":"SystemAssigned","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47"},"kind":"v12.0","properties":{"administratorLogin":"cloudSA","version":"12.0","state":"Ready","fullyQualifiedDomainName":"pstestsvr.database.windows.net","privateEndpointConnections":[],"publicNetworkAccess":"Enabled","keyId":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","restrictOutboundNetworkAccess":"Disabled","externalGovernanceStatus":"Disabled"},"location":"eastus","tags":{},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr","name":"pstestsvr","type":"Microsoft.Sql/servers"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:41 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector --user-assigned-identity-id --yes
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr?api-version=2022-08-01-preview
  response:
    body:
      string: '{"identity":{"principalId":"0fbbb9bc-df2a-4fd0-83e6-cd486061913f","type":"SystemAssigned","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47"},"kind":"v12.0","properties":{"administratorLogin":"cloudSA","version":"12.0","state":"Ready","fullyQualifiedDomainName":"pstestsvr.database.windows.net","privateEndpointConnections":[],"publicNetworkAccess":"Enabled","keyId":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","restrictOutboundNetworkAccess":"Disabled","externalGovernanceStatus":"Disabled"},"location":"eastus","tags":{},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr","name":"pstestsvr","type":"Microsoft.Sql/servers"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:42 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "eastus", "identity": {"type": "UserAssigned", "userAssignedIdentities":
      {"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/pstestumi":
      {}}}, "properties": {"encryptionProtector": "https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db create
      Connection:
      - keep-alive
      Content-Length:
      - '359'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --server --name -a --encryption-protector --user-assigned-identity-id --yes
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01?api-version=2022-08-01-preview
  response:
    body:
      string: '{"operation":"UpdateLogicalDatabase","startTime":"2023-02-02T14:03:44.043Z"}'
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/locations/eastus/databaseAzureAsyncOperation/8f5819a0-dcbc-4298-88e3-c6a110750c93?api-version=2022-08-01-preview
      cache-control:
      - no-cache
      content-length:
      - '76'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:43 GMT
      expires:
      - '-1'
      location:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/locations/eastus/databaseOperationResults/8f5819a0-dcbc-4298-88e3-c6a110750c93?api-version=2022-08-01-preview
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 202
      message: Accepted
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector --user-assigned-identity-id --yes
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/locations/eastus/databaseAzureAsyncOperation/8f5819a0-dcbc-4298-88e3-c6a110750c93?api-version=2022-08-01-preview
  response:
    body:
      string: '{"name":"8f5819a0-dcbc-4298-88e3-c6a110750c93","status":"Succeeded","startTime":"2023-02-02T14:03:44.043Z"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '107'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:58 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector --user-assigned-identity-id --yes
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01?api-version=2022-08-01-preview
  response:
    body:
      string: '{"sku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"kind":"v12.0,user,vcore","identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/pstest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/pstestumi":{"principalId":"781be676-54b8-46e5-ba30-4d9a18b13bf6","clientId":"6c97fcb9-7792-4aa9-b1e3-69d6d3857e68"}}},"properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":34359738368,"status":"Online","databaseId":"62cf3022-c4e5-465f-b06f-93f4fe87bd33","creationDate":"2023-02-02T11:57:43.857Z","currentServiceObjectiveName":"GP_Gen5_2","requestedServiceObjectiveName":"GP_Gen5_2","defaultSecondaryLocation":"westus","catalogCollation":"SQL_Latin1_General_CP1_CI_AS","zoneRedundant":false,"licenseType":"LicenseIncluded","maxLogSizeBytes":193273528320,"earliestRestoreDate":"2023-02-02T12:00:27Z","readScale":"Disabled","currentSku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"currentBackupStorageRedundancy":"Geo","requestedBackupStorageRedundancy":"Geo","maintenanceConfigurationId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default","isLedgerOn":false,"isInfraEncryptionEnabled":false,"encryptionProtector":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","preferredEnclaveType":"Default","availabilityZone":"NoPreference"},"location":"eastus","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01","name":"cliautomationdb01","type":"Microsoft.Sql/servers/databases"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1724'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -s --name
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01?api-version=2022-08-01-preview
  response:
    body:
      string: '{"sku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"kind":"v12.0,user,vcore","identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/pstest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/pstestumi":{"principalId":"781be676-54b8-46e5-ba30-4d9a18b13bf6","clientId":"6c97fcb9-7792-4aa9-b1e3-69d6d3857e68"}}},"properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":34359738368,"status":"Online","databaseId":"62cf3022-c4e5-465f-b06f-93f4fe87bd33","creationDate":"2023-02-02T11:57:43.857Z","currentServiceObjectiveName":"GP_Gen5_2","requestedServiceObjectiveName":"GP_Gen5_2","defaultSecondaryLocation":"westus","catalogCollation":"SQL_Latin1_General_CP1_CI_AS","zoneRedundant":false,"licenseType":"LicenseIncluded","maxLogSizeBytes":193273528320,"earliestRestoreDate":"2023-02-02T12:00:27Z","readScale":"Disabled","currentSku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"currentBackupStorageRedundancy":"Geo","requestedBackupStorageRedundancy":"Geo","maintenanceConfigurationId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default","isLedgerOn":false,"isInfraEncryptionEnabled":false,"encryptionProtector":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","preferredEnclaveType":"Default","availabilityZone":"NoPreference"},"location":"eastus","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01","name":"cliautomationdb01","type":"Microsoft.Sql/servers/databases"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1724'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:03:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01?api-version=2022-08-01-preview
  response:
    body:
      string: '{"sku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"kind":"v12.0,user,vcore","identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/pstest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/pstestumi":{"principalId":"781be676-54b8-46e5-ba30-4d9a18b13bf6","clientId":"6c97fcb9-7792-4aa9-b1e3-69d6d3857e68"}}},"properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":34359738368,"status":"Online","databaseId":"62cf3022-c4e5-465f-b06f-93f4fe87bd33","creationDate":"2023-02-02T11:57:43.857Z","currentServiceObjectiveName":"GP_Gen5_2","requestedServiceObjectiveName":"GP_Gen5_2","defaultSecondaryLocation":"westus","catalogCollation":"SQL_Latin1_General_CP1_CI_AS","zoneRedundant":false,"licenseType":"LicenseIncluded","maxLogSizeBytes":193273528320,"earliestRestoreDate":"2023-02-02T12:00:27Z","readScale":"Disabled","currentSku":{"name":"GP_Gen5","tier":"GeneralPurpose","family":"Gen5","capacity":2},"currentBackupStorageRedundancy":"Geo","requestedBackupStorageRedundancy":"Geo","maintenanceConfigurationId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Maintenance/publicMaintenanceConfigurations/SQL_Default","isLedgerOn":false,"isInfraEncryptionEnabled":false,"encryptionProtector":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","preferredEnclaveType":"Default","availabilityZone":"NoPreference"},"location":"eastus","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01","name":"cliautomationdb01","type":"Microsoft.Sql/servers/databases"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1724'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:04:00 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --server --name -a --encryption-protector
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr?api-version=2022-08-01-preview
  response:
    body:
      string: '{"identity":{"principalId":"0fbbb9bc-df2a-4fd0-83e6-cd486061913f","type":"SystemAssigned","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47"},"kind":"v12.0","properties":{"administratorLogin":"cloudSA","version":"12.0","state":"Ready","fullyQualifiedDomainName":"pstestsvr.database.windows.net","privateEndpointConnections":[],"publicNetworkAccess":"Enabled","keyId":"https://pstestkv.vault.azure.net/keys/testkey/f62d937858464f329ab4a8c2dc7e0fa4","restrictOutboundNetworkAccess":"Disabled","externalGovernanceStatus":"Disabled"},"location":"eastus","tags":{},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr","name":"pstestsvr","type":"Microsoft.Sql/servers"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:04:01 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "eastus", "sku": {"name": "GP_Gen5", "tier": "GeneralPurpose",
      "family": "Gen5", "capacity": 2}, "identity": {"type": "UserAssigned", "userAssignedIdentities":
      {"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/pstest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/pstestumi":
      {}}}, "properties": {"collation": "SQL_Latin1_General_CP1_CI_AS", "maxSizeBytes":
      34359738368, "catalogCollation": "SQL_Latin1_General_CP1_CI_AS", "zoneRedundant":
      false, "licenseType": "LicenseIncluded", "readScale": "Disabled", "isLedgerOn":
      false, "encryptionProtector": "https://pstestkv.vault.azure.net/keys/testkey1/6218d117492a42eda0b6a9334c9a989d",
      "preferredEnclaveType": "Default", "availabilityZone": "NoPreference"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - sql db update
      Connection:
      - keep-alive
      Content-Length:
      - '748'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --server --name -a --encryption-protector
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-mgmt-sql/4.0.0b5 Python/3.9.5 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/pstest/providers/Microsoft.Sql/servers/pstestsvr/databases/cliautomationdb01?api-version=2022-08-01-preview
  response:
    body:
      string: '{"error":{"code":"AvailabilityZoneNotSupported","message":"Availability
        Zones for databases and elastic pools are not yet supported."}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '135'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 02 Feb 2023 14:04:03 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 400
      message: Bad Request
version: 1
