interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008?api-version=2021-06-01
  response:
    body:
      string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy definition
        ''5ffd78d9-436d-4b41-a421-5baa819e3008'' could not be found."}}'
    headers:
      cache-control:
      - no-store, no-cache
      content-length:
      - '138'
      content-type:
      - application/json
      date:
      - Thu, 20 Feb 2025 09:15:06 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/667ec4e3-e89f-4976-bd12-835bc81f1078
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3748'
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008?api-version=2021-06-01
  response:
    body:
      string: '{"properties":{"displayName":"Add or replace a tag on resources","policyType":"BuiltIn","mode":"Indexed","description":"Adds
        or replaces the specified tag and value when any resource is created or updated.
        Existing resources can be remediated by triggering a remediation task. Does
        not modify tags on resource groups.","metadata":{"version":"1.0.0","category":"Tags"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},"then":{"effect":"modify","details":{"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"operations":[{"operation":"addOrReplace","field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","type":"Microsoft.Authorization/policyDefinitions","name":"5ffd78d9-436d-4b41-a421-5baa819e3008"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1225'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 09:15:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - ''
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "identity": {"type": "SystemAssigned"}, "properties":
      {"policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008",
      "parameters": {"tagName": {"value": "cliTagKey"}, "tagValue": {"value": "cliTagValue"}},
      "enforcementMode": "Default"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '312'
      Content-Type:
      - application/json
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2021-06-01
  response:
    body:
      string: '{"identity":{"principalId":"2e902567-dd0f-4bd6-981c-caaa8e005234","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e","createdOn":"2025-02-20T09:15:08.9243503Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","location":"westus","systemData":{"createdBy":"zhiyihuang@microsoft.com","createdByType":"User","createdAt":"2025-02-20T09:15:08.0594637Z","lastModifiedBy":"zhiyihuang@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2025-02-20T09:15:08.0594637Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1173'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 09:15:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/77c0156f-6188-4877-ab9e-3c3c44dee90f
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2998'
      x-ms-ratelimit-remaining-subscription-writes:
      - '198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -a --resource-discovery-mode
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2021-06-01
  response:
    body:
      string: '{"value":[{"properties":{"displayName":"deny-nsg-rule-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-rule-internet-inbound","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. Assign the policy
        again.","metadata":{"assignedBy":"jiasli@microsoft.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:07:29.1757898Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:23:20.4306328Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/36e07b214d59455886a2b76b","type":"Microsoft.Authorization/policyAssignments","name":"36e07b214d59455886a2b76b","systemData":{"lastModifiedBy":"zhoxing@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:23:20.325117Z"}},{"properties":{"displayName":"deny-nsg-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-internet-inbound","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted it from my resource group
        and found that it applied to the the whole subscription.\nRe assign the policy.","metadata":{"assignedBy":"jiasli@microsoft.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:06:22.2583329Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:29:53.8929477Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5b5ec388a1b6480391640d13","type":"Microsoft.Authorization/policyAssignments","name":"5b5ec388a1b6480391640d13","systemData":{"lastModifiedBy":"zhoxing@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:29:53.8609992Z"}},{"properties":{"displayName":"deny_load_balancer_rules_and_inbound_nat_rules","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bfedda4d-ba65-4ba3-9df1-9eb8a13a0f09","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_azure-sample-node06b5c4550e194ae5ac_nodejs-sample06b5c4550e194ae5acdev_eastus","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/xichengroup"],"parameters":{},"description":"","metadata":{"assignedBy":"xiaojxu@microsoft.com
        ","parameterScopes":{},"createdBy":"b5ed59e8-f00d-4396-af62-8297e36d8b52","createdOn":"2020-04-16T10:28:45.5317863Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T07:43:58.5150353Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5d00856604b74b80927cca6e","type":"Microsoft.Authorization/policyAssignments","name":"5d00856604b74b80927cca6e","systemData":{"lastModifiedBy":"zhoxing@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T07:43:58.478803Z"}},{"properties":{"displayName":"deny-nic-no-nsg","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nic-no-nsg","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/wls-admin"],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. \nAssign the policy
        again.","metadata":{"assignedBy":"jiasli@microsoft.com ","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:04:31.0026973Z","updatedBy":"f0f844e0-d2fe-4aa3-8e2c-2e429618f305","updatedOn":"2020-09-11T07:46:03.3893374Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/8805e4466db647d1beda40e2","type":"Microsoft.Authorization/policyAssignments","name":"8805e4466db647d1beda40e2"},{"identity":{"principalId":"30601973-dcd6-4c4e-85e8-dc6e057238fa","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"displayName":"ASC
        DataProtection (subscription: 0b1f6471-1bf0-4dda-aec3-cb9272f09590)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center","createdBy":"2f8a138f-0955-44e1-9124-c386dfaecad4","createdOn":"2019-11-25T02:19:57.9086573Z","updatedBy":"062d5f19-c525-48c9-a809-3be8685b85d0","updatedOn":"2024-10-29T05:35:22.9920211Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter","type":"Microsoft.Authorization/policyAssignments","name":"DataProtectionSecurityCenter","location":"eastus","systemData":{"lastModifiedBy":"zhenteng@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2024-10-29T05:35:22.8883136Z"}},{"identity":{"principalId":"c44083df-c6be-4cfc-adab-afbe9e55fc6c","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2022-01-06T18:54:58.824404Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentb2i7mjcri","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentb2i7mjcri","location":"westus","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2022-01-06T18:54:57.7694834Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2022-01-06T18:54:57.7694834Z"}},{"properties":{"displayName":"test_assignment37erp","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policymnyzvdlzz","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-08-19T23:02:10.2750241Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj/providers/Microsoft.Authorization/policyAssignments/-bGpNMRxSf6Ecgpsw7K9ww","type":"Microsoft.Authorization/policyAssignments","name":"-bGpNMRxSf6Ecgpsw7K9ww","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2021-08-19T23:02:10.1625651Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-19T23:02:10.1625651Z"}},{"identity":{"principalId":"2e39dbd9-db71-4877-bd52-0b2736ff7370","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-06-24T23:13:58.5161882Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentmkw7g5ydg","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentmkw7g5ydg","location":"westus"},{"properties":{"displayName":"[AzCliTools][SFI-2.5.1]
        Disable all high risk inbound ports for Network Security Group","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/[AzCliTools][SFI-2.5.1]","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"parameterScopes":{},"createdBy":"7c7e34a2-6ea5-4d7f-a850-209630b9a209","createdOn":"2024-09-04T03:22:31.3292741Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/de132a2be8124ae2ad2819bd","type":"Microsoft.Authorization/policyAssignments","name":"de132a2be8124ae2ad2819bd","systemData":{"createdBy":"vidai@microsoft.com","createdByType":"User","createdAt":"2024-09-04T03:22:31.3009659Z","lastModifiedBy":"vidai@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2024-09-04T03:22:31.3009659Z"}},{"properties":{"displayName":"[AzCliTools][SFI-TI2.3.3]
        Deny Storage Account Creation with Anonymous Access","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/[AzCliTools][SFI-TI2.3.3]","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"parameterScopes":{},"createdBy":"7c7e34a2-6ea5-4d7f-a850-209630b9a209","createdOn":"2024-09-27T07:56:52.3529277Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5712913d870246df83e718b5","type":"Microsoft.Authorization/policyAssignments","name":"5712913d870246df83e718b5","systemData":{"createdBy":"vidai@microsoft.com","createdByType":"User","createdAt":"2024-09-27T07:56:52.3393958Z","lastModifiedBy":"vidai@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2024-09-27T07:56:52.3393958Z"}},{"properties":{"displayName":"[AzCliTools][SFI-TLS12+]
        Deny Web Site Creation/Update with TLS Less Than 1.2","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/[AzCliTools][SFI-TLS12+]","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"parameterScopes":{},"createdBy":"7c7e34a2-6ea5-4d7f-a850-209630b9a209","createdOn":"2024-11-22T09:17:54.9715748Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/2d4bce7a6222493ca5ef7bfb","type":"Microsoft.Authorization/policyAssignments","name":"2d4bce7a6222493ca5ef7bfb","systemData":{"createdBy":"vidai@microsoft.com","createdByType":"User","createdAt":"2024-11-22T09:17:54.9486486Z","lastModifiedBy":"vidai@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2024-11-22T09:17:54.9486486Z"}},{"identity":{"principalId":"2e902567-dd0f-4bd6-981c-caaa8e005234","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e","createdOn":"2025-02-20T09:15:08.9243503Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","location":"westus","systemData":{"createdBy":"zhiyihuang@microsoft.com","createdByType":"User","createdAt":"2025-02-20T09:15:08.0594637Z","lastModifiedBy":"zhiyihuang@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2025-02-20T09:15:08.0594637Z"}},{"properties":{"displayName":"ASC
        OpenSourceRelationalDatabasesProtection (subscription: 0b1f6471-1bf0-4dda-aec3-cb9272f09590)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center","createdBy":"062d5f19-c525-48c9-a809-3be8685b85d0","createdOn":"2024-10-29T05:35:25.1006249Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/OpenSourceRelationalDatabasesProtectionSecurityCenter","type":"Microsoft.Authorization/policyAssignments","name":"OpenSourceRelationalDatabasesProtectionSecurityCenter","systemData":{"createdBy":"zhenteng@microsoft.com","createdByType":"User","createdAt":"2024-10-29T05:35:25.065938Z","lastModifiedBy":"zhenteng@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2024-10-29T05:35:25.065938Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '14736'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 09:15:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/65657e7d-8741-4bab-8723-d25479b74884
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3748'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003",
      "resourceDiscoveryMode": "ReEvaluateCompliance"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '274'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g -a --resource-discovery-mode
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Accepted","createdOn":"2025-02-20T09:15:12.9366169Z","lastUpdatedOn":"2025-02-20T09:15:12.9367403Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance","correlationId":"208e0bbb-3c6f-49b2-8a9f-a585f8d1ab0b"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"zhiyihuang@microsoft.com","createdByType":"User","createdAt":"2025-02-20T09:15:12.4292511Z","lastModifiedBy":"zhiyihuang@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2025-02-20T09:15:12.4292511Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1045'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 09:15:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/288a3799-43c6-4b23-a536-06b5bf067472
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
    status:
      code: 201
      message: Created
version: 1
