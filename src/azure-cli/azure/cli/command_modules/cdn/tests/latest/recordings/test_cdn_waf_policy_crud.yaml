interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"error":{"code":"ResourceNotFound","message":"The Resource ''Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123''
        under resource group ''clitest.rg000001'' was not found. For more details
        please go to https://aka.ms/ARMResourceNotFoundFix"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '304'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-failure-cause:
      - gateway
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --name --redirect-url --tags
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"error":{"code":"ResourceNotFound","message":"The Resource ''Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123''
        under resource group ''clitest.rg000001'' was not found. For more details
        please go to https://aka.ms/ARMResourceNotFoundFix"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '304'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:18 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-failure-cause:
      - gateway
    status:
      code: 404
      message: Not Found
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"}},
      "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy set
      Connection:
      - keep-alive
      Content-Length:
      - '214'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --name --redirect-url --tags
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '747'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:25 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '747'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies?api-version=2020-09-01
  response:
    body:
      string: '{"value":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '759'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:27 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '747'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:28 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '747'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": []}, "customRules": {"rules": []}, "managedRules":
      {"managedRuleSets": [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0"}]}},
      "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set add
      Connection:
      - keep-alive
      Content-Length:
      - '376'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '843'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:31 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '843'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:31 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '843'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version -n -r -r -r
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '843'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:34 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": []}, "customRules": {"rules": []}, "managedRules":
      {"managedRuleSets": [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0",
      "anomalyScore": 0, "ruleGroupOverrides": [{"ruleGroupName": "SQLI", "rules":
      [{"ruleId": "942440", "enabledState": "Enabled", "action": "Redirect"}, {"ruleId":
      "942120"}, {"ruleId": "942100"}]}]}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override set
      Connection:
      - keep-alive
      Content-Length:
      - '572'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version -n -r -r -r
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:35 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:36 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:37 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:37 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --action --priority --match-condition
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:38 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": []}, "customRules": {"rules": [{"name": "customrule1",
      "enabledState": "Enabled", "priority": 100, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": true, "matchValue":
      ["GET", "HEAD"], "transforms": []}], "action": "Block"}]}, "managedRules": {"managedRuleSets":
      [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0", "anomalyScore":
      0, "ruleGroupOverrides": [{"ruleGroupName": "SQLI", "rules": [{"ruleId": "942440",
      "enabledState": "Enabled", "action": "Redirect"}, {"ruleId": "942120", "enabledState":
      "Disabled", "action": "Block"}, {"ruleId": "942100", "enabledState": "Disabled",
      "action": "Block"}]}]}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule set
      Connection:
      - keep-alive
      Content-Length:
      - '904'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name -n --action --priority --match-condition
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1303'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:40 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1303'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:40 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --action --priority -m -m
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1303'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:42 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": []}, "customRules": {"rules": [{"name": "customrule1",
      "enabledState": "Enabled", "priority": 100, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": true, "matchValue":
      ["GET", "HEAD"], "transforms": []}], "action": "Block"}, {"name": "customrule2",
      "enabledState": "Enabled", "priority": 200, "matchConditions": [{"matchVariable":
      "RequestUri", "operator": "Contains", "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "matchValue": [" "],
      "transforms": []}], "action": "Redirect"}]}, "managedRules": {"managedRuleSets":
      [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0", "anomalyScore":
      0, "ruleGroupOverrides": [{"ruleGroupName": "SQLI", "rules": [{"ruleId": "942440",
      "enabledState": "Enabled", "action": "Redirect"}, {"ruleId": "942120", "enabledState":
      "Disabled", "action": "Block"}, {"ruleId": "942100", "enabledState": "Disabled",
      "action": "Block"}]}]}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule set
      Connection:
      - keep-alive
      Content-Length:
      - '1210'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name -n --action --priority -m -m
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1664'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:43 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1194'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1664'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:44 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1664'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:45 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1664'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:46 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --action --priority --duration --request-threshold --match-condition
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1664'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:48 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": [{"name": "ratelimitrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      1}]}, "customRules": {"rules": [{"name": "customrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block"}, {"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0",
      "anomalyScore": 0, "ruleGroupOverrides": [{"ruleGroupName": "SQLI", "rules":
      [{"ruleId": "942440", "enabledState": "Enabled", "action": "Redirect"}, {"ruleId":
      "942120", "enabledState": "Disabled", "action": "Block"}, {"ruleId": "942100",
      "enabledState": "Disabled", "action": "Block"}]}]}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule set
      Connection:
      - keep-alive
      Content-Length:
      - '1563'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name -n --action --priority --duration --request-threshold --match-condition
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1958'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:49 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1196'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1958'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:50 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --action --priority --duration --request-threshold -m
        -m
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1958'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:51 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {"foo": "bar"}, "properties": {"policySettings":
      {"enabledState": "Enabled", "mode": "Detection", "defaultRedirectUrl": "https://example.com"},
      "rateLimitRules": {"rules": [{"name": "ratelimitrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      1}, {"name": "ratelimitrule2", "enabledState": "Enabled", "priority": 200, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "matchValue": ["PUT"],
      "transforms": []}, {"matchVariable": "RequestUri", "operator": "Contains", "matchValue":
      ["/expensive/resource/"], "transforms": []}], "action": "Redirect", "rateLimitThreshold":
      100, "rateLimitDurationInMinutes": 5}]}, "customRules": {"rules": [{"name":
      "customrule1", "enabledState": "Enabled", "priority": 100, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      true, "matchValue": ["GET", "HEAD"], "transforms": []}], "action": "Block"},
      {"name": "customrule2", "enabledState": "Enabled", "priority": 200, "matchConditions":
      [{"matchVariable": "RequestUri", "operator": "Contains", "negateCondition":
      false, "matchValue": [".."], "transforms": []}, {"matchVariable": "QueryString",
      "operator": "Contains", "negateCondition": false, "matchValue": [" "], "transforms":
      []}], "action": "Redirect"}]}, "managedRules": {"managedRuleSets": [{"ruleSetType":
      "DefaultRuleSet", "ruleSetVersion": "1.0", "anomalyScore": 0, "ruleGroupOverrides":
      [{"ruleGroupName": "SQLI", "rules": [{"ruleId": "942440", "enabledState": "Enabled",
      "action": "Redirect"}, {"ruleId": "942120", "enabledState": "Disabled", "action":
      "Block"}, {"ruleId": "942100", "enabledState": "Disabled", "action": "Block"}]}]}]}},
      "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule set
      Connection:
      - keep-alive
      Content-Length:
      - '1951'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --policy-name -n --action --priority --duration --request-threshold -m
        -m
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2397'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:53 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2397'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:53 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2397'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:54 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy set
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --name --sku --mode --block-response-body --block-response-status-code
        --redirect-url --tags --disabled
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{"foo":"bar"},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Enabled","mode":"Detection","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":null,"defaultCustomBlockResponseBody":null},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2397'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:54:55 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {}, "properties": {"policySettings": {"enabledState":
      "Disabled", "mode": "Prevention", "defaultRedirectUrl": "https://example.com",
      "defaultCustomBlockResponseStatusCode": 429, "defaultCustomBlockResponseBody":
      "PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="}, "rateLimitRules": {"rules":
      [{"name": "ratelimitrule1", "enabledState": "Enabled", "priority": 100, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      true, "matchValue": ["GET", "HEAD"], "transforms": []}], "action": "Block",
      "rateLimitThreshold": 100, "rateLimitDurationInMinutes": 1}, {"name": "ratelimitrule2",
      "enabledState": "Enabled", "priority": 200, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": false, "matchValue":
      ["PUT"], "transforms": []}, {"matchVariable": "RequestUri", "operator": "Contains",
      "negateCondition": false, "matchValue": ["/expensive/resource/"], "transforms":
      []}], "action": "Redirect", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      5}]}, "customRules": {"rules": [{"name": "customrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block"}, {"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0",
      "anomalyScore": 0, "ruleGroupOverrides": [{"ruleGroupName": "SQLI", "rules":
      [{"ruleId": "942440", "enabledState": "Enabled", "action": "Redirect"}, {"ruleId":
      "942120", "enabledState": "Disabled", "action": "Block"}, {"ruleId": "942100",
      "enabledState": "Disabled", "action": "Block"}]}]}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy set
      Connection:
      - keep-alive
      Content-Length:
      - '2128'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g --name --sku --mode --block-response-body --block-response-status-code
        --redirect-url --tags --disabled
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2437'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:00 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1195'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2437'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:01 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override delete
      Connection:
      - keep-alive
      ParameterSetName:
      - -y -g --policy-name --rule-set-type --rule-set-version -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[{"ruleGroupName":"SQLI","rules":[{"ruleId":"942440","enabledState":"Enabled","action":"Redirect"},{"ruleId":"942120","enabledState":"Disabled","action":"Block"},{"ruleId":"942100","enabledState":"Disabled","action":"Block"}]}]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2437'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:02 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {}, "properties": {"policySettings": {"enabledState":
      "Disabled", "mode": "Prevention", "defaultRedirectUrl": "https://example.com",
      "defaultCustomBlockResponseStatusCode": 429, "defaultCustomBlockResponseBody":
      "PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="}, "rateLimitRules": {"rules":
      [{"name": "ratelimitrule1", "enabledState": "Enabled", "priority": 100, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      true, "matchValue": ["GET", "HEAD"], "transforms": []}], "action": "Block",
      "rateLimitThreshold": 100, "rateLimitDurationInMinutes": 1}, {"name": "ratelimitrule2",
      "enabledState": "Enabled", "priority": 200, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": false, "matchValue":
      ["PUT"], "transforms": []}, {"matchVariable": "RequestUri", "operator": "Contains",
      "negateCondition": false, "matchValue": ["/expensive/resource/"], "transforms":
      []}], "action": "Redirect", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      5}]}, "customRules": {"rules": [{"name": "customrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block"}, {"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": [{"ruleSetType": "DefaultRuleSet", "ruleSetVersion": "1.0",
      "anomalyScore": 0, "ruleGroupOverrides": []}]}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override delete
      Connection:
      - keep-alive
      Content-Length:
      - '1883'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -y -g --policy-name --rule-set-type --rule-set-version -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2212'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:03 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set rule-group-override show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2212'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:05 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -y -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[{"ruleSetType":"DefaultRuleSet","ruleSetVersion":"1.0","anomalyScore":0,"ruleGroupOverrides":[]}]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2212'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:05 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {}, "properties": {"policySettings": {"enabledState":
      "Disabled", "mode": "Prevention", "defaultRedirectUrl": "https://example.com",
      "defaultCustomBlockResponseStatusCode": 429, "defaultCustomBlockResponseBody":
      "PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="}, "rateLimitRules": {"rules":
      [{"name": "ratelimitrule1", "enabledState": "Enabled", "priority": 100, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      true, "matchValue": ["GET", "HEAD"], "transforms": []}], "action": "Block",
      "rateLimitThreshold": 100, "rateLimitDurationInMinutes": 1}, {"name": "ratelimitrule2",
      "enabledState": "Enabled", "priority": 200, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": false, "matchValue":
      ["PUT"], "transforms": []}, {"matchVariable": "RequestUri", "operator": "Contains",
      "negateCondition": false, "matchValue": ["/expensive/resource/"], "transforms":
      []}], "action": "Redirect", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      5}]}, "customRules": {"rules": [{"name": "customrule1", "enabledState": "Enabled",
      "priority": 100, "matchConditions": [{"matchVariable": "RequestMethod", "operator":
      "Equal", "negateCondition": true, "matchValue": ["GET", "HEAD"], "transforms":
      []}], "action": "Block"}, {"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": []}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set remove
      Connection:
      - keep-alive
      Content-Length:
      - '1780'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -y -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2116'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1195'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy managed-rule-set show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --rule-set-type --rule-set-version
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2116'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule delete
      Connection:
      - keep-alive
      ParameterSetName:
      - -y -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2116'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {}, "properties": {"policySettings": {"enabledState":
      "Disabled", "mode": "Prevention", "defaultRedirectUrl": "https://example.com",
      "defaultCustomBlockResponseStatusCode": 429, "defaultCustomBlockResponseBody":
      "PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="}, "rateLimitRules": {"rules":
      [{"name": "ratelimitrule1", "enabledState": "Enabled", "priority": 100, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      true, "matchValue": ["GET", "HEAD"], "transforms": []}], "action": "Block",
      "rateLimitThreshold": 100, "rateLimitDurationInMinutes": 1}, {"name": "ratelimitrule2",
      "enabledState": "Enabled", "priority": 200, "matchConditions": [{"matchVariable":
      "RequestMethod", "operator": "Equal", "negateCondition": false, "matchValue":
      ["PUT"], "transforms": []}, {"matchVariable": "RequestUri", "operator": "Contains",
      "negateCondition": false, "matchValue": ["/expensive/resource/"], "transforms":
      []}], "action": "Redirect", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      5}]}, "customRules": {"rules": [{"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": []}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule delete
      Connection:
      - keep-alive
      Content-Length:
      - '1540'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -y -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1880'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1195'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy custom-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1880'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule delete
      Connection:
      - keep-alive
      ParameterSetName:
      - -y -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":1,"rateLimitThreshold":100,"name":"ratelimitrule1","enabledState":"Enabled","priority":100,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":true,"matchValue":["GET","HEAD"],"transforms":[]}],"action":"Block"},{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1880'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "Global", "tags": {}, "properties": {"policySettings": {"enabledState":
      "Disabled", "mode": "Prevention", "defaultRedirectUrl": "https://example.com",
      "defaultCustomBlockResponseStatusCode": 429, "defaultCustomBlockResponseBody":
      "PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="}, "rateLimitRules": {"rules":
      [{"name": "ratelimitrule2", "enabledState": "Enabled", "priority": 200, "matchConditions":
      [{"matchVariable": "RequestMethod", "operator": "Equal", "negateCondition":
      false, "matchValue": ["PUT"], "transforms": []}, {"matchVariable": "RequestUri",
      "operator": "Contains", "negateCondition": false, "matchValue": ["/expensive/resource/"],
      "transforms": []}], "action": "Redirect", "rateLimitThreshold": 100, "rateLimitDurationInMinutes":
      5}]}, "customRules": {"rules": [{"name": "customrule2", "enabledState": "Enabled",
      "priority": 200, "matchConditions": [{"matchVariable": "RequestUri", "operator":
      "Contains", "negateCondition": false, "matchValue": [".."], "transforms": []},
      {"matchVariable": "QueryString", "operator": "Contains", "negateCondition":
      false, "matchValue": [" "], "transforms": []}], "action": "Redirect"}]}, "managedRules":
      {"managedRuleSets": []}}, "sku": {"name": "Standard_Microsoft"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule delete
      Connection:
      - keep-alive
      Content-Length:
      - '1237'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -y -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1585'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy rate-limit-rule show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Cdn/cdnwebapplicationfirewallpolicies/policy123","type":"Microsoft.Cdn/cdnwebapplicationfirewallpolicies","name":"policy123","location":"Global","tags":{},"sku":{"name":"Standard_Microsoft"},"properties":{"policySettings":{"enabledState":"Disabled","mode":"Prevention","defaultRedirectUrl":"https://example.com","defaultCustomBlockResponseStatusCode":429,"defaultCustomBlockResponseBody":"PGh0bWw+PGJvZHk+ZXhhbXBsZSBib2R5PC9ib2R5PjwvaHRtbD4="},"customRules":{"rules":[{"name":"customrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":[".."],"transforms":[]},{"matchVariable":"QueryString","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["
        "],"transforms":[]}],"action":"Redirect"}]},"rateLimitRules":{"rules":[{"rateLimitDurationInMinutes":5,"rateLimitThreshold":100,"name":"ratelimitrule2","enabledState":"Enabled","priority":200,"matchConditions":[{"matchVariable":"RequestMethod","selector":null,"operator":"Equal","negateCondition":false,"matchValue":["PUT"],"transforms":[]},{"matchVariable":"RequestUri","selector":null,"operator":"Contains","negateCondition":false,"matchValue":["/expensive/resource/"],"transforms":[]}],"action":"Redirect"}]},"managedRules":{"managedRuleSets":[]},"endpointLinks":[],"resourceState":"Enabled","provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1585'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 19 Feb 2021 11:55:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - cdn waf policy delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -y -g -n
      User-Agent:
      - python/3.7.9 (Windows-10-10.0.19041-SP0) msrest/0.6.18 msrest_azure/0.6.3
        azure-mgmt-cdn/7.0.0 Azure-SDK-For-Python AZURECLI/2.19.1
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Cdn/CdnWebApplicationFirewallPolicies/policy123?api-version=2020-09-01
  response:
    body:
      string: ''
    headers:
      cache-control:
      - no-cache
      date:
      - Fri, 19 Feb 2021 11:55:19 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14998'
    status:
      code: 204
      message: No Content
version: 1
