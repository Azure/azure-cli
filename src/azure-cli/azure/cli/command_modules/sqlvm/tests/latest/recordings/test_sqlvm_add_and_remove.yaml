interactions:
- request:
    body: null
    headers:
      Connection:
      - close
      Host:
      - raw.githubusercontent.com
      User-Agent:
      - Python-urllib/3.8
    method: GET
    uri: https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json
  response:
    body:
      string: "{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\"\
        ,\n  \"contentVersion\": \"1.0.0.0\",\n  \"metadata\": {\n    \"_generator\"\
        : {\n      \"name\": \"bicep\",\n      \"version\": \"0.13.1.58284\",\n  \
        \    \"templateHash\": \"17567019607531788589\"\n    }\n  },\n  \"parameters\"\
        : {\n    \"adminUsername\": {\n      \"type\": \"string\",\n      \"metadata\"\
        : {\n        \"description\": \"The name of the administrator account of the\
        \ new VM and domain\"\n      }\n    },\n    \"adminPassword\": {\n      \"\
        type\": \"secureString\",\n      \"metadata\": {\n        \"description\"\
        : \"The password for the administrator account of the new VM and domain\"\n\
        \      }\n    },\n    \"domainName\": {\n      \"type\": \"string\",\n   \
        \   \"metadata\": {\n        \"description\": \"The FQDN of the Active Directory\
        \ Domain to be created\"\n      }\n    },\n    \"dnsPrefix\": {\n      \"\
        type\": \"string\",\n      \"metadata\": {\n        \"description\": \"The\
        \ DNS prefix for the public IP address used by the Load Balancer\"\n     \
        \ }\n    },\n    \"vmSize\": {\n      \"type\": \"string\",\n      \"defaultValue\"\
        : \"Standard_D2s_v3\",\n      \"metadata\": {\n        \"description\": \"\
        Size of the VM for the controller\"\n      }\n    },\n    \"_artifactsLocation\"\
        : {\n      \"type\": \"string\",\n      \"defaultValue\": \"[deployment().properties.templateLink.uri]\"\
        ,\n      \"metadata\": {\n        \"description\": \"The location of resources,\
        \ such as templates and DSC modules, that the template depends on\"\n    \
        \  }\n    },\n    \"_artifactsLocationSasToken\": {\n      \"type\": \"secureString\"\
        ,\n      \"defaultValue\": \"\",\n      \"metadata\": {\n        \"description\"\
        : \"Auto-generated token to access _artifactsLocation. Leave it blank unless\
        \ you need to provide your own value.\"\n      }\n    },\n    \"location\"\
        : {\n      \"type\": \"string\",\n      \"defaultValue\": \"[resourceGroup().location]\"\
        ,\n      \"metadata\": {\n        \"description\": \"Location for all resources.\"\
        \n      }\n    },\n    \"virtualMachineName\": {\n      \"type\": \"string\"\
        ,\n      \"defaultValue\": \"adVM\",\n      \"maxLength\": 15,\n      \"metadata\"\
        : {\n        \"description\": \"Virtual machine name.\"\n      }\n    },\n\
        \    \"virtualNetworkName\": {\n      \"type\": \"string\",\n      \"defaultValue\"\
        : \"adVNET\",\n      \"metadata\": {\n        \"description\": \"Virtual network\
        \ name.\"\n      }\n    },\n    \"virtualNetworkAddressRange\": {\n      \"\
        type\": \"string\",\n      \"defaultValue\": \"10.0.0.0/16\",\n      \"metadata\"\
        : {\n        \"description\": \"Virtual network address range.\"\n      }\n\
        \    },\n    \"loadBalancerFrontEndIPName\": {\n      \"type\": \"string\"\
        ,\n      \"defaultValue\": \"LBFE\",\n      \"metadata\": {\n        \"description\"\
        : \"Load balancer front end IP address name.\"\n      }\n    },\n    \"backendAddressPoolName\"\
        : {\n      \"type\": \"string\",\n      \"defaultValue\": \"LBBE\",\n    \
        \  \"metadata\": {\n        \"description\": \"Backend address pool name.\"\
        \n      }\n    },\n    \"inboundNatRulesName\": {\n      \"type\": \"string\"\
        ,\n      \"defaultValue\": \"adRDP\",\n      \"metadata\": {\n        \"description\"\
        : \"Inbound NAT rules name.\"\n      }\n    },\n    \"networkInterfaceName\"\
        : {\n      \"type\": \"string\",\n      \"defaultValue\": \"adNic\",\n   \
        \   \"metadata\": {\n        \"description\": \"Network interface name.\"\n\
        \      }\n    },\n    \"privateIPAddress\": {\n      \"type\": \"string\"\
        ,\n      \"defaultValue\": \"10.0.0.4\",\n      \"metadata\": {\n        \"\
        description\": \"Private IP address.\"\n      }\n    },\n    \"subnetName\"\
        : {\n      \"type\": \"string\",\n      \"defaultValue\": \"adSubnet\",\n\
        \      \"metadata\": {\n        \"description\": \"Subnet name.\"\n      }\n\
        \    },\n    \"subnetRange\": {\n      \"type\": \"string\",\n      \"defaultValue\"\
        : \"10.0.0.0/24\",\n      \"metadata\": {\n        \"description\": \"Subnet\
        \ IP range.\"\n      }\n    },\n    \"publicIPAddressName\": {\n      \"type\"\
        : \"string\",\n      \"defaultValue\": \"adPublicIP\",\n      \"metadata\"\
        : {\n        \"description\": \"Subnet IP range.\"\n      }\n    },\n    \"\
        availabilitySetName\": {\n      \"type\": \"string\",\n      \"defaultValue\"\
        : \"adAvailabiltySet\",\n      \"metadata\": {\n        \"description\": \"\
        Availability set name.\"\n      }\n    },\n    \"loadBalancerName\": {\n \
        \     \"type\": \"string\",\n      \"defaultValue\": \"adLoadBalancer\",\n\
        \      \"metadata\": {\n        \"description\": \"Load balancer name.\"\n\
        \      }\n    }\n  },\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Network/publicIPAddresses\"\
        ,\n      \"apiVersion\": \"2022-07-01\",\n      \"name\": \"[parameters('publicIPAddressName')]\"\
        ,\n      \"location\": \"[parameters('location')]\",\n      \"properties\"\
        : {\n        \"publicIPAllocationMethod\": \"Static\",\n        \"dnsSettings\"\
        : {\n          \"domainNameLabel\": \"[parameters('dnsPrefix')]\"\n      \
        \  }\n      }\n    },\n    {\n      \"type\": \"Microsoft.Compute/availabilitySets\"\
        ,\n      \"apiVersion\": \"2022-08-01\",\n      \"name\": \"[parameters('availabilitySetName')]\"\
        ,\n      \"location\": \"[parameters('location')]\",\n      \"properties\"\
        : {\n        \"platformUpdateDomainCount\": 20,\n        \"platformFaultDomainCount\"\
        : 2\n      },\n      \"sku\": {\n        \"name\": \"Aligned\"\n      }\n\
        \    },\n    {\n      \"type\": \"Microsoft.Network/loadBalancers\",\n   \
        \   \"apiVersion\": \"2022-07-01\",\n      \"name\": \"[parameters('loadBalancerName')]\"\
        ,\n      \"location\": \"[parameters('location')]\",\n      \"properties\"\
        : {\n        \"frontendIPConfigurations\": [\n          {\n            \"\
        name\": \"[parameters('loadBalancerFrontEndIPName')]\",\n            \"properties\"\
        : {\n              \"publicIPAddress\": {\n                \"id\": \"[resourceId('Microsoft.Network/publicIPAddresses',\
        \ parameters('publicIPAddressName'))]\"\n              }\n            }\n\
        \          }\n        ],\n        \"backendAddressPools\": [\n          {\n\
        \            \"name\": \"[parameters('backendAddressPoolName')]\"\n      \
        \    }\n        ],\n        \"inboundNatRules\": [\n          {\n        \
        \    \"name\": \"[parameters('inboundNatRulesName')]\",\n            \"properties\"\
        : {\n              \"frontendIPConfiguration\": {\n                \"id\"\
        : \"[resourceId('Microsoft.Network/loadBalancers/frontendIPConfigurations',\
        \ parameters('loadBalancerName'), parameters('loadBalancerFrontEndIPName'))]\"\
        \n              },\n              \"protocol\": \"Tcp\",\n              \"\
        frontendPort\": 3389,\n              \"backendPort\": 3389,\n            \
        \  \"enableFloatingIP\": false\n            }\n          }\n        ]\n  \
        \    },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Network/publicIPAddresses',\
        \ parameters('publicIPAddressName'))]\"\n      ]\n    },\n    {\n      \"\
        type\": \"Microsoft.Network/networkInterfaces\",\n      \"apiVersion\": \"\
        2022-07-01\",\n      \"name\": \"[parameters('networkInterfaceName')]\",\n\
        \      \"location\": \"[parameters('location')]\",\n      \"properties\":\
        \ {\n        \"ipConfigurations\": [\n          {\n            \"name\": \"\
        ipconfig1\",\n            \"properties\": {\n              \"privateIPAllocationMethod\"\
        : \"Static\",\n              \"privateIPAddress\": \"[parameters('privateIPAddress')]\"\
        ,\n              \"subnet\": {\n                \"id\": \"[resourceId('Microsoft.Network/virtualNetworks/subnets',\
        \ parameters('virtualNetworkName'), parameters('subnetName'))]\"\n       \
        \       },\n              \"loadBalancerBackendAddressPools\": [\n       \
        \         {\n                  \"id\": \"[resourceId('Microsoft.Network/loadBalancers/backendAddressPools',\
        \ parameters('loadBalancerName'), parameters('backendAddressPoolName'))]\"\
        \n                }\n              ],\n              \"loadBalancerInboundNatRules\"\
        : [\n                {\n                  \"id\": \"[resourceId('Microsoft.Network/loadBalancers/inboundNatRules',\
        \ parameters('loadBalancerName'), parameters('inboundNatRulesName'))]\"\n\
        \                }\n              ]\n            }\n          }\n        ]\n\
        \      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Network/loadBalancers',\
        \ parameters('loadBalancerName'))]\",\n        \"[resourceId('Microsoft.Resources/deployments',\
        \ 'VNet')]\"\n      ]\n    },\n    {\n      \"type\": \"Microsoft.Compute/virtualMachines\"\
        ,\n      \"apiVersion\": \"2022-08-01\",\n      \"name\": \"[parameters('virtualMachineName')]\"\
        ,\n      \"location\": \"[parameters('location')]\",\n      \"properties\"\
        : {\n        \"hardwareProfile\": {\n          \"vmSize\": \"[parameters('vmSize')]\"\
        \n        },\n        \"availabilitySet\": {\n          \"id\": \"[resourceId('Microsoft.Compute/availabilitySets',\
        \ parameters('availabilitySetName'))]\"\n        },\n        \"osProfile\"\
        : {\n          \"computerName\": \"[parameters('virtualMachineName')]\",\n\
        \          \"adminUsername\": \"[parameters('adminUsername')]\",\n       \
        \   \"adminPassword\": \"[parameters('adminPassword')]\"\n        },\n   \
        \     \"storageProfile\": {\n          \"imageReference\": {\n           \
        \ \"publisher\": \"MicrosoftWindowsServer\",\n            \"offer\": \"WindowsServer\"\
        ,\n            \"sku\": \"2019-Datacenter\",\n            \"version\": \"\
        latest\"\n          },\n          \"osDisk\": {\n            \"name\": \"\
        [format('{0}_OSDisk', parameters('virtualMachineName'))]\",\n            \"\
        caching\": \"ReadOnly\",\n            \"createOption\": \"FromImage\",\n \
        \           \"managedDisk\": {\n              \"storageAccountType\": \"StandardSSD_LRS\"\
        \n            }\n          },\n          \"dataDisks\": [\n            {\n\
        \              \"name\": \"[format('{0}_DataDisk', parameters('virtualMachineName'))]\"\
        ,\n              \"caching\": \"ReadWrite\",\n              \"createOption\"\
        : \"Empty\",\n              \"diskSizeGB\": 20,\n              \"managedDisk\"\
        : {\n                \"storageAccountType\": \"StandardSSD_LRS\"\n       \
        \       },\n              \"lun\": 0\n            }\n          ]\n       \
        \ },\n        \"networkProfile\": {\n          \"networkInterfaces\": [\n\
        \            {\n              \"id\": \"[resourceId('Microsoft.Network/networkInterfaces',\
        \ parameters('networkInterfaceName'))]\"\n            }\n          ]\n   \
        \     }\n      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Compute/availabilitySets',\
        \ parameters('availabilitySetName'))]\",\n        \"[resourceId('Microsoft.Network/loadBalancers',\
        \ parameters('loadBalancerName'))]\",\n        \"[resourceId('Microsoft.Network/networkInterfaces',\
        \ parameters('networkInterfaceName'))]\"\n      ]\n    },\n    {\n      \"\
        type\": \"Microsoft.Compute/virtualMachines/extensions\",\n      \"apiVersion\"\
        : \"2022-08-01\",\n      \"name\": \"[format('{0}/{1}', parameters('virtualMachineName'),\
        \ 'CreateADForest')]\",\n      \"location\": \"[parameters('location')]\"\
        ,\n      \"properties\": {\n        \"publisher\": \"Microsoft.Powershell\"\
        ,\n        \"type\": \"DSC\",\n        \"typeHandlerVersion\": \"2.19\",\n\
        \        \"autoUpgradeMinorVersion\": true,\n        \"settings\": {\n   \
        \       \"ModulesUrl\": \"[uri(parameters('_artifactsLocation'), format('DSC/CreateADPDC.zip{0}',\
        \ parameters('_artifactsLocationSasToken')))]\",\n          \"ConfigurationFunction\"\
        : \"CreateADPDC.ps1\\\\CreateADPDC\",\n          \"Properties\": {\n     \
        \       \"DomainName\": \"[parameters('domainName')]\",\n            \"AdminCreds\"\
        : {\n              \"UserName\": \"[parameters('adminUsername')]\",\n    \
        \          \"Password\": \"PrivateSettingsRef:AdminPassword\"\n          \
        \  }\n          }\n        },\n        \"protectedSettings\": {\n        \
        \  \"Items\": {\n            \"AdminPassword\": \"[parameters('adminPassword')]\"\
        \n          }\n        }\n      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Compute/virtualMachines',\
        \ parameters('virtualMachineName'))]\"\n      ]\n    },\n    {\n      \"type\"\
        : \"Microsoft.Resources/deployments\",\n      \"apiVersion\": \"2020-10-01\"\
        ,\n      \"name\": \"VNet\",\n      \"properties\": {\n        \"expressionEvaluationOptions\"\
        : {\n          \"scope\": \"inner\"\n        },\n        \"mode\": \"Incremental\"\
        ,\n        \"parameters\": {\n          \"virtualNetworkName\": {\n      \
        \      \"value\": \"[parameters('virtualNetworkName')]\"\n          },\n \
        \         \"virtualNetworkAddressRange\": {\n            \"value\": \"[parameters('virtualNetworkAddressRange')]\"\
        \n          },\n          \"subnetName\": {\n            \"value\": \"[parameters('subnetName')]\"\
        \n          },\n          \"subnetRange\": {\n            \"value\": \"[parameters('subnetRange')]\"\
        \n          },\n          \"location\": {\n            \"value\": \"[parameters('location')]\"\
        \n          }\n        },\n        \"template\": {\n          \"$schema\"\
        : \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\"\
        ,\n          \"contentVersion\": \"1.0.0.0\",\n          \"metadata\": {\n\
        \            \"_generator\": {\n              \"name\": \"bicep\",\n     \
        \         \"version\": \"0.13.1.58284\",\n              \"templateHash\":\
        \ \"7676624414886455368\"\n            }\n          },\n          \"parameters\"\
        : {\n            \"virtualNetworkName\": {\n              \"type\": \"string\"\
        ,\n              \"metadata\": {\n                \"description\": \"The name\
        \ of the Virtual Network to Create\"\n              }\n            },\n  \
        \          \"virtualNetworkAddressRange\": {\n              \"type\": \"string\"\
        ,\n              \"metadata\": {\n                \"description\": \"The address\
        \ range of the new VNET in CIDR format\"\n              }\n            },\n\
        \            \"subnetName\": {\n              \"type\": \"string\",\n    \
        \          \"metadata\": {\n                \"description\": \"The name of\
        \ the subnet created in the new VNET\"\n              }\n            },\n\
        \            \"subnetRange\": {\n              \"type\": \"string\",\n   \
        \           \"metadata\": {\n                \"description\": \"The address\
        \ range of the subnet created in the new VNET\"\n              }\n       \
        \     },\n            \"location\": {\n              \"type\": \"string\"\
        ,\n              \"metadata\": {\n                \"description\": \"Location\
        \ for all resources.\"\n              }\n            }\n          },\n   \
        \       \"resources\": [\n            {\n              \"type\": \"Microsoft.Network/virtualNetworks\"\
        ,\n              \"apiVersion\": \"2022-07-01\",\n              \"name\":\
        \ \"[parameters('virtualNetworkName')]\",\n              \"location\": \"\
        [parameters('location')]\",\n              \"properties\": {\n           \
        \     \"addressSpace\": {\n                  \"addressPrefixes\": [\n    \
        \                \"[parameters('virtualNetworkAddressRange')]\"\n        \
        \          ]\n                },\n                \"subnets\": [\n       \
        \           {\n                    \"name\": \"[parameters('subnetName')]\"\
        ,\n                    \"properties\": {\n                      \"addressPrefix\"\
        : \"[parameters('subnetRange')]\"\n                    }\n               \
        \   }\n                ]\n              }\n            }\n          ]\n  \
        \      }\n      }\n    },\n    {\n      \"type\": \"Microsoft.Resources/deployments\"\
        ,\n      \"apiVersion\": \"2020-10-01\",\n      \"name\": \"UpdateVNetDNS\"\
        ,\n      \"properties\": {\n        \"expressionEvaluationOptions\": {\n \
        \         \"scope\": \"inner\"\n        },\n        \"mode\": \"Incremental\"\
        ,\n        \"parameters\": {\n          \"virtualNetworkName\": {\n      \
        \      \"value\": \"[parameters('virtualNetworkName')]\"\n          },\n \
        \         \"virtualNetworkAddressRange\": {\n            \"value\": \"[parameters('virtualNetworkAddressRange')]\"\
        \n          },\n          \"subnetName\": {\n            \"value\": \"[parameters('subnetName')]\"\
        \n          },\n          \"subnetRange\": {\n            \"value\": \"[parameters('subnetRange')]\"\
        \n          },\n          \"DNSServerAddress\": {\n            \"value\":\
        \ [\n              \"[parameters('privateIPAddress')]\"\n            ]\n \
        \         },\n          \"location\": {\n            \"value\": \"[parameters('location')]\"\
        \n          }\n        },\n        \"template\": {\n          \"$schema\"\
        : \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\"\
        ,\n          \"contentVersion\": \"1.0.0.0\",\n          \"metadata\": {\n\
        \            \"_generator\": {\n              \"name\": \"bicep\",\n     \
        \         \"version\": \"0.13.1.58284\",\n              \"templateHash\":\
        \ \"12019049826642862479\"\n            }\n          },\n          \"parameters\"\
        : {\n            \"virtualNetworkName\": {\n              \"type\": \"string\"\
        ,\n              \"metadata\": {\n                \"description\": \"The name\
        \ of the Virtual Network to Create\"\n              }\n            },\n  \
        \          \"virtualNetworkAddressRange\": {\n              \"type\": \"string\"\
        ,\n              \"metadata\": {\n                \"description\": \"The address\
        \ range of the new VNET in CIDR format\"\n              }\n            },\n\
        \            \"subnetName\": {\n              \"type\": \"string\",\n    \
        \          \"metadata\": {\n                \"description\": \"The name of\
        \ the subnet created in the new VNET\"\n              }\n            },\n\
        \            \"subnetRange\": {\n              \"type\": \"string\",\n   \
        \           \"metadata\": {\n                \"description\": \"The address\
        \ range of the subnet created in the new VNET\"\n              }\n       \
        \     },\n            \"DNSServerAddress\": {\n              \"type\": \"\
        array\",\n              \"metadata\": {\n                \"description\":\
        \ \"The DNS address(es) of the DNS Server(s) used by the VNET\"\n        \
        \      }\n            },\n            \"location\": {\n              \"type\"\
        : \"string\",\n              \"metadata\": {\n                \"description\"\
        : \"Location for all resources.\"\n              }\n            }\n      \
        \    },\n          \"resources\": [\n            {\n              \"type\"\
        : \"Microsoft.Network/virtualNetworks\",\n              \"apiVersion\": \"\
        2022-07-01\",\n              \"name\": \"[parameters('virtualNetworkName')]\"\
        ,\n              \"location\": \"[parameters('location')]\",\n           \
        \   \"properties\": {\n                \"addressSpace\": {\n             \
        \     \"addressPrefixes\": [\n                    \"[parameters('virtualNetworkAddressRange')]\"\
        \n                  ]\n                },\n                \"dhcpOptions\"\
        : {\n                  \"dnsServers\": \"[parameters('DNSServerAddress')]\"\
        \n                },\n                \"subnets\": [\n                  {\n\
        \                    \"name\": \"[parameters('subnetName')]\",\n         \
        \           \"properties\": {\n                      \"addressPrefix\": \"\
        [parameters('subnetRange')]\"\n                    }\n                  }\n\
        \                ]\n              }\n            }\n          ]\n        }\n\
        \      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Compute/virtualMachines/extensions',\
        \ parameters('virtualMachineName'), 'CreateADForest')]\"\n      ]\n    }\n\
        \  ]\n}"
    headers:
      accept-ranges:
      - bytes
      access-control-allow-origin:
      - '*'
      cache-control:
      - max-age=300
      connection:
      - close
      content-length:
      - '17478'
      content-security-policy:
      - default-src 'none'; style-src 'unsafe-inline'; sandbox
      content-type:
      - text/plain; charset=utf-8
      cross-origin-resource-policy:
      - cross-origin
      date:
      - Sun, 25 Jun 2023 19:52:42 GMT
      etag:
      - '"a6a9f746524a858d27edd02ed463fe49223bcfe75d2d517caec85d69025e52cf"'
      expires:
      - Sun, 25 Jun 2023 19:57:42 GMT
      source-age:
      - '0'
      strict-transport-security:
      - max-age=31536000
      vary:
      - Authorization,Accept-Encoding,Origin
      via:
      - 1.1 varnish
      x-cache:
      - MISS
      x-cache-hits:
      - '0'
      x-content-type-options:
      - nosniff
      x-fastly-request-id:
      - 6aa7407a6e28859daaa028ced13e07b2a8f5e1bd
      x-frame-options:
      - deny
      x-github-request-id:
      - 6F16:9DCF:5454E7:673180:64989B0A
      x-served-by:
      - cache-pdx12323-PDX
      x-timer:
      - S1687722763.819134,VS0,VE150
      x-xss-protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"templateLink": {"uri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json"},
      "parameters": {"adminUsername": {"value": "admin123"}, "adminPassword": {"value":
      "SecretPassword123"}, "location": {"value": "westus"}, "domainName": {"value":
      "domain.com"}, "dnsPrefix": {"value": "fqgl5jx"}}, "mode": "Incremental"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      Content-Length:
      - '437'
      Content-Type:
      - application/json
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/validate?api-version=2021-04-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/domaintemplate","name":"domaintemplate","type":"Microsoft.Resources/deployments","properties":{"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json","contentVersion":"1.0.0.0"},"templateHash":"17567019607531788589","parameters":{"adminUsername":{"type":"String","value":"admin123"},"adminPassword":{"type":"SecureString"},"domainName":{"type":"String","value":"domain.com"},"dnsPrefix":{"type":"String","value":"fqgl5jx"},"vmSize":{"type":"String","value":"Standard_D2s_v3"},"_artifactsLocation":{"type":"String","value":"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json"},"_artifactsLocationSasToken":{"type":"SecureString"},"location":{"type":"String","value":"westus"},"virtualMachineName":{"type":"String","value":"adVM"},"virtualNetworkName":{"type":"String","value":"adVNET"},"virtualNetworkAddressRange":{"type":"String","value":"10.0.0.0/16"},"loadBalancerFrontEndIPName":{"type":"String","value":"LBFE"},"backendAddressPoolName":{"type":"String","value":"LBBE"},"inboundNatRulesName":{"type":"String","value":"adRDP"},"networkInterfaceName":{"type":"String","value":"adNic"},"privateIPAddress":{"type":"String","value":"10.0.0.4"},"subnetName":{"type":"String","value":"adSubnet"},"subnetRange":{"type":"String","value":"10.0.0.0/24"},"publicIPAddressName":{"type":"String","value":"adPublicIP"},"availabilitySetName":{"type":"String","value":"adAvailabiltySet"},"loadBalancerName":{"type":"String","value":"adLoadBalancer"}},"mode":"Incremental","provisioningState":"Succeeded","timestamp":"0001-01-01T00:00:00Z","duration":"PT0S","correlationId":"4e034299-d375-4631-892c-702aa712560a","providers":[{"namespace":"Microsoft.Network","resourceTypes":[{"resourceType":"publicIPAddresses","locations":["westus"]},{"resourceType":"loadBalancers","locations":["westus"]},{"resourceType":"networkInterfaces","locations":["westus"]}]},{"namespace":"Microsoft.Compute","resourceTypes":[{"resourceType":"availabilitySets","locations":["westus"]},{"resourceType":"virtualMachines","locations":["westus"]},{"resourceType":"virtualMachines/extensions","locations":["westus"]}]},{"namespace":"Microsoft.Resources","resourceTypes":[{"resourceType":"deployments","locations":[null]}]}],"dependencies":[{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/publicIPAddresses/adPublicIP","resourceType":"Microsoft.Network/publicIPAddresses","resourceName":"adPublicIP"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/VNet","resourceType":"Microsoft.Resources/deployments","resourceName":"VNet"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/networkInterfaces/adNic","resourceType":"Microsoft.Network/networkInterfaces","resourceName":"adNic"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/availabilitySets/adAvailabiltySet","resourceType":"Microsoft.Compute/availabilitySets","resourceName":"adAvailabiltySet"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/networkInterfaces/adNic","resourceType":"Microsoft.Network/networkInterfaces","resourceName":"adNic"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM","resourceType":"Microsoft.Compute/virtualMachines","resourceName":"adVM"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM","resourceType":"Microsoft.Compute/virtualMachines","resourceName":"adVM"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM/extensions/CreateADForest","resourceType":"Microsoft.Compute/virtualMachines/extensions","resourceName":"adVM/CreateADForest"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM/extensions/CreateADForest","resourceType":"Microsoft.Compute/virtualMachines/extensions","resourceName":"adVM/CreateADForest"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/UpdateVNetDNS","resourceType":"Microsoft.Resources/deployments","resourceName":"UpdateVNetDNS"}],"validatedResources":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/publicIPAddresses/adPublicIP"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/availabilitySets/adAvailabiltySet"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/networkInterfaces/adNic"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM/extensions/CreateADForest"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/VNet"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/UpdateVNetDNS"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualNetworks/adVNET"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/virtualNetworks/adVNET"}]}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '7159'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:52:44 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"templateLink": {"uri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json"},
      "parameters": {"adminUsername": {"value": "admin123"}, "adminPassword": {"value":
      "SecretPassword123"}, "location": {"value": "westus"}, "domainName": {"value":
      "domain.com"}, "dnsPrefix": {"value": "fqgl5jx"}}, "mode": "Incremental"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      Content-Length:
      - '437'
      Content-Type:
      - application/json
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment?api-version=2021-04-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/domaintemplate","name":"domaintemplate","type":"Microsoft.Resources/deployments","properties":{"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json","contentVersion":"1.0.0.0"},"templateHash":"17567019607531788589","parameters":{"adminUsername":{"type":"String","value":"admin123"},"adminPassword":{"type":"SecureString"},"domainName":{"type":"String","value":"domain.com"},"dnsPrefix":{"type":"String","value":"fqgl5jx"},"vmSize":{"type":"String","value":"Standard_D2s_v3"},"_artifactsLocation":{"type":"String","value":"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/application-workloads/active-directory/active-directory-new-domain/azuredeploy.json"},"_artifactsLocationSasToken":{"type":"SecureString"},"location":{"type":"String","value":"westus"},"virtualMachineName":{"type":"String","value":"adVM"},"virtualNetworkName":{"type":"String","value":"adVNET"},"virtualNetworkAddressRange":{"type":"String","value":"10.0.0.0/16"},"loadBalancerFrontEndIPName":{"type":"String","value":"LBFE"},"backendAddressPoolName":{"type":"String","value":"LBBE"},"inboundNatRulesName":{"type":"String","value":"adRDP"},"networkInterfaceName":{"type":"String","value":"adNic"},"privateIPAddress":{"type":"String","value":"10.0.0.4"},"subnetName":{"type":"String","value":"adSubnet"},"subnetRange":{"type":"String","value":"10.0.0.0/24"},"publicIPAddressName":{"type":"String","value":"adPublicIP"},"availabilitySetName":{"type":"String","value":"adAvailabiltySet"},"loadBalancerName":{"type":"String","value":"adLoadBalancer"}},"mode":"Incremental","provisioningState":"Accepted","timestamp":"2023-06-25T19:52:47.1611064Z","duration":"PT0.000132S","correlationId":"144f69e4-cd45-4de7-82de-16030c44169b","providers":[{"namespace":"Microsoft.Network","resourceTypes":[{"resourceType":"publicIPAddresses","locations":["westus"]},{"resourceType":"loadBalancers","locations":["westus"]},{"resourceType":"networkInterfaces","locations":["westus"]}]},{"namespace":"Microsoft.Compute","resourceTypes":[{"resourceType":"availabilitySets","locations":["westus"]},{"resourceType":"virtualMachines","locations":["westus"]},{"resourceType":"virtualMachines/extensions","locations":["westus"]}]},{"namespace":"Microsoft.Resources","resourceTypes":[{"resourceType":"deployments","locations":[null]}]}],"dependencies":[{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/publicIPAddresses/adPublicIP","resourceType":"Microsoft.Network/publicIPAddresses","resourceName":"adPublicIP"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/VNet","resourceType":"Microsoft.Resources/deployments","resourceName":"VNet"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/networkInterfaces/adNic","resourceType":"Microsoft.Network/networkInterfaces","resourceName":"adNic"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/availabilitySets/adAvailabiltySet","resourceType":"Microsoft.Compute/availabilitySets","resourceName":"adAvailabiltySet"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/loadBalancers/adLoadBalancer","resourceType":"Microsoft.Network/loadBalancers","resourceName":"adLoadBalancer"},{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Network/networkInterfaces/adNic","resourceType":"Microsoft.Network/networkInterfaces","resourceName":"adNic"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM","resourceType":"Microsoft.Compute/virtualMachines","resourceName":"adVM"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM","resourceType":"Microsoft.Compute/virtualMachines","resourceName":"adVM"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM/extensions/CreateADForest","resourceType":"Microsoft.Compute/virtualMachines/extensions","resourceName":"adVM/CreateADForest"},{"dependsOn":[{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Compute/virtualMachines/adVM/extensions/CreateADForest","resourceType":"Microsoft.Compute/virtualMachines/extensions","resourceName":"adVM/CreateADForest"}],"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Resources/deployments/UpdateVNetDNS","resourceType":"Microsoft.Resources/deployments","resourceName":"UpdateVNetDNS"}]}}'
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/domaintemplate/operationStatuses/08585138841192279109?api-version=2021-04-01
      cache-control:
      - no-cache
      content-length:
      - '5663'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:52:46 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/operationStatuses/08585138841192279109?api-version=2021-04-01
  response:
    body:
      string: '{"status":"Running"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '20'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:53:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/operationStatuses/08585138841192279109?api-version=2021-04-01
  response:
    body:
      string: '{"status":"Running"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '20'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:53:47 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/operationStatuses/08585138841192279109?api-version=2021-04-01
  response:
    body:
      string: '{"status":"Running"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '20'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:54:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/operationStatuses/08585138841192279109?api-version=2021-04-01
  response:
    body:
      string: '{"status":"Running"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '20'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:54:47 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - deployment group create
      Connection:
      - keep-alive
      ParameterSetName:
      - --name -g --template-uri --parameters
      User-Agent:
      - AZURECLI/2.43.0 azsdk-python-azure-mgmt-resource/21.1.0b1 Python/3.8.0 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001/providers/Microsoft.Resources/deployments/mock-deployment/operationStatuses/08585138841192279109?api-version=2021-04-01
  response:
    body:
      string: '{"status":"Running"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '20'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sun, 25 Jun 2023 19:55:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
version: 1
