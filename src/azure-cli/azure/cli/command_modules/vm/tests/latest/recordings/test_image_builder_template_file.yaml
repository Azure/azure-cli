interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-authorization/0.52.0 Azure-SDK-For-Python AZURECLI/2.1.0
      accept-language:
      - en-US
    method: GET
    uri: https://localhost:1080/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001/providers/Microsoft.Authorization/roleDefinitions?$filter=roleName%20eq%20%27Contributor%27&api-version=2018-01-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"roleName":"Contributor","type":"BuiltInRole","description":"Lets
        you manage everything except access to resources.","assignableScopes":["/"],"permissions":[{"actions":["*"],"notActions":["Microsoft.Authorization/*/Delete","Microsoft.Authorization/*/Write","Microsoft.Authorization/elevateAccess/Action","Microsoft.Blueprint/blueprintAssignments/write","Microsoft.Blueprint/blueprintAssignments/delete"],"dataActions":[],"notDataActions":[]}],"createdOn":"2015-02-02T21:55:09.8806423Z","updatedOn":"2019-02-05T21:24:38.4580610Z","createdBy":null,"updatedBy":null},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c","type":"Microsoft.Authorization/roleDefinitions","name":"b24988ac-6180-42a0-ab88-20f7382dd24c"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '832'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 04 Mar 2020 17:52:32 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      set-cookie:
      - x-ms-gateway-slice=Production; path=/; SameSite=None; secure; HttpOnly
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: grant_type=refresh_token&client_id=04b07795-8ddb-461a-bbee-02f9e1bf7b46&resource=https%3A%2F%2Fgraph.windows.net%2F&refresh_token=AQABAAAAAABeAFzDwllzTYGDLh_qYbH8vzwZdhGM1lJW7CMAgxLaOH0Oc8ql-B_SjZT3xq0jWjcz9ef-XxFHbS8to0sJsHEP1q8-W-sK81TvmgqALefecuaqZaqV-V_QTJjwscrBw8f7fwQwmYFGiDoTDb9V1KUtbP6X3gP5X2f-UVia0a7R_u0HJpEIFJBDHDM8RJnTuShpUfO0SdDCxABdLN0T1-Wuz8NWp-g7wymjZKRFcjHiQREaZH7ly20AY43iwhuscwL5WYHtchX5vqJNFg9H27Os8klgarYO2MSvPLCfSRlRlyxSFZcRyFnLP7ayQmRgIbGLAHmI-0XWEteKcCJfWsnl5NbDDoPo6CT8AnZItY-5W-Hq0JVghs4PXFjoSHNwp7k_6FosWsiWFyJyjALpmgXHTMKEiQoxN13TLgaWAyxRewEvOsepdkPUw8XEhziDLETt3RYFZof_q3Q2_wc6CnNhAd_iV416ntoRKyDH1R29OvIZeHc8UjDgL6JJyYl3xH6nd7J8p9ZeZ-fcmMrUWYuvrbQ2wXiUWaEMw1UPHgA6So7lAJ20PwyQubqS8AXHoEz0XPJ21J7ToMC0e4nir0Nrk8ycATCBaHUisGJ6slKpVH2Yx8nliPdylVRNEM-Q4YixoMVvLuxLfK0UUFzATuc7may9e8LPG9ereKE1H1xNm5QTBDqJQ_7HknsU5sijZ-_l2mSur_sKNf_0G9bWwhxJtGjfLl9VUqcPJZsLdXmIOZ0Tp-Rh-_8Jms3WCmw1W-jlzMocEhjsYLMHA0scXJCcBx1QE0ssvqRxhNdFtOg1aFg6Dhtz2o0llJxi-l2TCKLWqXgvHP3IdX1LwOwlM7XMYnMDqYFkB-WEGh9LM44tAmBS8svd7eG7f0dloIhSIytdJtmroRGMwm-Bmgyx0ricqdXZUFjfx6sn7Q55BYtiYqUymEXEkQIGdQ7AIebS5ckeQW633q1BBjE_rOKZHUpo8oaqTLXPCrmL-GMN5LmdgkXpeGGWyeQBsgc5sBN8F_e-L9y50VhHnuPgGH4TZ_DyYU9clLhXQ_PfNw1vwR94QXYf8a0DFBQ3i44jkDoaqKXsZ7nFXRel0RkSMpnH_zayU0qDXAK-yab4IW_tzj7dkPftGJD_A6jWYUtt2XCtF3ggAA
    headers:
      Accept:
      - '*/*'
      Accept-Charset:
      - utf-8
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '1296'
      User-Agent:
      - python-requests/2.22.0
      content-type:
      - application/x-www-form-urlencoded
      return-client-request-id:
      - 'true'
      x-client-CPU:
      - x64
      x-client-OS:
      - win32
      x-client-SKU:
      - Python
      x-client-Ver:
      - 1.2.2
    method: POST
    uri: https://localhost:1080/54826b22-38d6-4fb2-bad9-b7b93a3e9c5a/oauth2/token
  response:
    body:
      string: '{"token_type":"Bearer","scope":"62e90394-69f5-4237-9190-012177145e10","expires_in":"3599","ext_expires_in":"3599","expires_on":"1583347956","not_before":"1583344056","resource":"https://graph.windows.net/","access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkhsQzBSMTJza3hOWjFXUXdtak9GXzZ0X3RERSIsImtpZCI6IkhsQzBSMTJza3hOWjFXUXdtak9GXzZ0X3RERSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLndpbmRvd3MubmV0LyIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzU0ODI2YjIyLTM4ZDYtNGZiMi1iYWQ5LWI3YjkzYTNlOWM1YS8iLCJpYXQiOjE1ODMzNDQwNTYsIm5iZiI6MTU4MzM0NDA1NiwiZXhwIjoxNTgzMzQ3OTU2LCJhY3IiOiIxIiwiYWlvIjoiQVdRQW0vOE9BQUFBdjQzaDZnY3FoR2oyY1M3bEYwY1M2dktnYjcwVk5uK2Naa0N5MlJmLy9oemkrbSt6Ymd6YkVKSDFvb0F5V1orRWNFNTh1SE5SZkIzRmd0cGVQSEw0L0hFNnpZOXdNZkwvalZ4V3lzV3krRnJoYmJkbjg5VXdOUlZoeHRUNmFsOG0iLCJhbHRzZWNpZCI6IjU6OjEwMDMyMDAwNTcxQTVEMDQiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiMDRiMDc3OTUtOGRkYi00NjFhLWJiZWUtMDJmOWUxYmY3YjQ2IiwiYXBwaWRhY3IiOiIwIiwiZW1haWwiOiJmZXlAbWljcm9zb2Z0LmNvbSIsImZhbWlseV9uYW1lIjoiWXUiLCJnaXZlbl9uYW1lIjoiRmVpeXVlIiwiaWRwIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3LyIsImlwYWRkciI6IjUyLjE1NS4xMDUuMTYzIiwibmFtZSI6IkZlaXl1ZSBZdSIsIm9pZCI6IjBhNTkyYzQ1LTYxM2UtNGYxYi05MDIzLTdjNDQxNGZkNTNiZiIsInB1aWQiOiIxMDAzMjAwMDU3N0ZCNkJCIiwic2NwIjoiNjJlOTAzOTQtNjlmNS00MjM3LTkxOTAtMDEyMTc3MTQ1ZTEwIiwic3ViIjoiNldkMHhUSzQydlFGOGpiTHRKMnQzWG1DZEFxblVPTzhOQUlfZ0lpNDZRRSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJOQSIsInRpZCI6IjU0ODI2YjIyLTM4ZDYtNGZiMi1iYWQ5LWI3YjkzYTNlOWM1YSIsInVuaXF1ZV9uYW1lIjoiZmV5QG1pY3Jvc29mdC5jb20iLCJ1dGkiOiJJT1pnOFZha3BFU2VvQWJCYXZZY0FBIiwidmVyIjoiMS4wIn0.dzqdz_410xLflK7e_1XB29sGD8S6knJcTznzQ-F4RhHa8GOMIStA03LEtyB_BGwbIZjbUwJws2DLjj_jO_8RKxIp01W3PAXzWY_3SE1gvxAdWxS2nRa5bruFzMOnEJulY9k7sI_JqIWFdghrTYGnFbZhksqq_k_2ob9naobtTTizlCd79EkxpwEMvShDGxfdvVIHKoWqKsifrfedhyZG4RTbfystNS1XfJnef4BC5JhvH9H1SI0L5VPfYRq80WBJ6AbycMCUCHXLc9bEbA6iOQ1ApaMwA8yZkTugMFmqUtxiZ8FaZOwhykTaZ_GmVQThy5fPe6m-ZCxBnNzqvfyGag","refresh_token":"AQABAAAAAABeAFzDwllzTYGDLh_qYbH8lPPfEoSi0vfz5l9yhn2_b1fA9-IAlXwkjjm5bXafwGR1z54MzcsnDFVaYQMezbgq23X_GJBw65_snmFXvQ8OOHe3DxzO3PVYxAJodKlSN80BIUBBUMf2t4D1rWFukEfSIMJ4NaJnJfW8gPmr_jbSWZKTF_hpCdZGCMCx7Ff9UPEIR9YmEQR8TOpflxPZjnPjRpfV17AvNcszZtzDU5tYJSqz3XfOSmwC0gt8vwRZ2D9nMnRRj3fhQyFPmNGOIxSwDdgQyEkc_pZqdAq6TAVLnmTwsMMd7geVta3-Tp7-l8ICMjorXTmlum6jqRqQdVkCjKZuWvDptQsV_LEpXHb-KYKAYleZesePU9NoKGBWIEcKu2O5-ZCUao8SR-jd8mpp-oAFRdd9l9uQM7BYb1cdjbQG-bLkSNqZkmpXQL_aaxtMxx5UyF0JXvfHcb_cfluLCilrVOB3lPvoAmA-S9JvQoAnNMtZuOVA0yudAV8SMYkF_hpQjgHoVG4H-0yNa2L5-Hs3JcgLtExZscj7guxeghhoXtgG4_BHVOMmxi0GYZjsW4_cpk5ckxStYVNWgtwBpzCH27nWtAqWqPGtr5zQWTIdMsiPnW6p_xtUjZ4wk6y6O736m-ZiCeBztkRDojrjtD6xbp4vG_EfAHLglv1D1bKa7akzMSyKrv0w4N31M36t6EEAGywzxIR3AYLO44NU-GS4r1AK68dyP99jR43eStrDLGgijyEzi0NJa7SKvLlkc8huy6skcYJKgkSKZkdB5x52_miSeDmpXVR24fnme0vYaWOGUpiJY5VlnQzIHPlpl3_Z5nOpmQkIGcvl-Lhz7eerTtJklVKfExAHT6LjUwQtwi0L-9nBiLOVOS-sa6Kc_dtPPbSCuuFwlIQXBdojgV0TpfSypA66cQf9C5Q_JXQ2xeC3HDQpl6mV9HT3dREzP6yOg9b7zMApDLvtytz6P02eTe_RoYroWnESWbWCBqAod3oPCXJ3EpBBpuyA3Kz-B8pesNzapCr2pq5C2MpOv5v45MDKJoNDP-n94ooIvriL4B79RwUHJXwcFPB_iA1kfkGSnfYWpbEHV9oU0z7HwOUsBXB9IUJxn2jBw1m66iAA","foci":"1"}'
    headers:
      cache-control:
      - no-cache, no-store
      content-length:
      - '3109'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 04 Mar 2020 17:52:35 GMT
      expires:
      - '-1'
      p3p:
      - CP="DSP CUR OTPi IND OTRi ONL FIN"
      pragma:
      - no-cache
      set-cookie:
      - fpc=AiZ2tL4FZrBIs4CnqmaG4jkXKmpyAQAAAOPh8dUOAAAA; expires=Fri, 03-Apr-2020
        17:52:36 GMT; path=/; secure; HttpOnly; SameSite=None
      - x-ms-gateway-slice=prod; path=/; SameSite=None; secure; HttpOnly
      - stsservicecookie=ests; path=/; SameSite=None; secure; HttpOnly
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-clitelem:
      - 1,0,0,72145.203,
      x-ms-ests-server:
      - 2.1.10104.15 - SAN ProdSlices
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-graphrbac/0.60.0 Azure-SDK-For-Python AZURECLI/2.1.0
      accept-language:
      - en-US
    method: GET
    uri: https://localhost:1080/54826b22-38d6-4fb2-bad9-b7b93a3e9c5a/servicePrincipals?$filter=servicePrincipalNames%2Fany%28c%3Ac%20eq%20%27cf32a0cc-373c-47c9-9156-0db11f6a6dfc%27%29&api-version=1.6
  response:
    body:
      string: '{"odata.metadata":"https://graph.windows.net/00000000-0000-0000-0000-000000000000/$metadata#directoryObjects","value":[{"odata.type":"Microsoft.DirectoryServices.ServicePrincipal","objectType":"ServicePrincipal","objectId":"6d61a178-3216-4ba7-bdc3-0fbc62b65ac9","deletionTimestamp":null,"accountEnabled":true,"addIns":[],"alternativeNames":[],"appDisplayName":"Azure
        Virtual Machine Image Builder","appId":"cf32a0cc-373c-47c9-9156-0db11f6a6dfc","applicationTemplateId":null,"appOwnerTenantId":"f8cdef31-a31e-4b4a-93e4-5f571e91255a","appRoleAssignmentRequired":false,"appRoles":[],"displayName":"Azure
        Virtual Machine Image Builder","errorUrl":null,"homepage":null,"informationalUrls":{"termsOfService":null,"support":null,"privacy":null,"marketing":null},"keyCredentials":[],"logoutUrl":null,"notificationEmailAddresses":[],"oauth2Permissions":[],"passwordCredentials":[],"preferredSingleSignOnMode":null,"preferredTokenSigningKeyEndDateTime":null,"preferredTokenSigningKeyThumbprint":null,"publisherName":"Microsoft
        Services","replyUrls":[],"samlMetadataUrl":null,"samlSingleSignOnSettings":null,"servicePrincipalNames":["cf32a0cc-373c-47c9-9156-0db11f6a6dfc"],"servicePrincipalType":"Application","signInAudience":"AzureADMultipleOrgs","tags":[],"tokenEncryptionKeyId":null}]}'
    headers:
      access-control-allow-origin:
      - '*'
      cache-control:
      - no-cache
      content-length:
      - '1278'
      content-type:
      - application/json; odata=minimalmetadata; streaming=true; charset=utf-8
      dataserviceversion:
      - 3.0;
      date:
      - Wed, 04 Mar 2020 17:52:38 GMT
      duration:
      - '1864274'
      expires:
      - '-1'
      ocp-aad-diagnostics-server-name:
      - UasoFGN58uUDZzrA1RYY1/OBZjmM666H3oLwSIakuf0=
      ocp-aad-session-key:
      - 0gI8tiS123SmQZ6s4lsOXmURcYEmhdN8r_qYeq8s2qkRkGAQFYUDKTWQYvZpZsPpX1bgyvE-4xB68p1l3iPnqNu51zVJ3Scr1KbSpD-tK-GCcsSVnMyp-6c_guM00EGb.cKnukLY24AfCmcSHjG9-hc1hQ9PzXPaCJ5tRYjQqHM8
      pragma:
      - no-cache
      request-id:
      - 32789ab9-82c9-4423-9055-168b537d26d7
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-aspnet-version:
      - 4.0.30319
      x-ms-dirapi-data-contract-version:
      - '1.6'
      x-powered-by:
      - ASP.NET
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"roleDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
      "principalId": "6d61a178-3216-4ba7-bdc3-0fbc62b65ac9"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '233'
      Content-Type:
      - application/json; charset=utf-8
      Cookie:
      - x-ms-gateway-slice=Production
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-authorization/0.52.0 Azure-SDK-For-Python AZURECLI/2.1.0
      accept-language:
      - en-US
    method: PUT
    uri: https://localhost:1080/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001/providers/Microsoft.Authorization/roleAssignments/b58d79bd-eb31-4392-83cf-59596276ff76?api-version=2018-09-01-preview
  response:
    body:
      string: '{"properties":{"roleDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c","principalId":"6d61a178-3216-4ba7-bdc3-0fbc62b65ac9","principalType":"ServicePrincipal","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001","createdOn":"2020-03-04T17:52:40.5456392Z","updatedOn":"2020-03-04T17:52:40.5456392Z","createdBy":null,"updatedBy":"0a592c45-613e-4f1b-9023-7c4414fd53bf"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001/providers/Microsoft.Authorization/roleAssignments/b58d79bd-eb31-4392-83cf-59596276ff76","type":"Microsoft.Authorization/roleAssignments","name":"b58d79bd-eb31-4392-83cf-59596276ff76"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '903'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 04 Mar 2020 17:52:43 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      set-cookie:
      - x-ms-gateway-slice=Production; path=/; secure; HttpOnly; SameSite=None
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python-requests/2.22.0
    method: GET
    uri: https://localhost:1080/qwordy/azvmimagebuilder/master/quickquickstarts/0_Creating_a_Custom_Linux_Managed_Image/example.json
  response:
    body:
      string: "{\n    \"type\": \"Microsoft.VirtualMachineImages/imageTemplates\",\n
        \   \"apiVersion\": \"2019-05-01-preview\",\n    \"location\": \"westus\",\n
        \   \"dependsOn\": [],\n    \"tags\": {\n        \"imagebuilderTemplate\":
        \"ubuntu1804\"\n            },\n    \"properties\": {\n\n        \"buildTimeoutInMinutes\"
        : 80,\n        \n        \"vmProfile\": \n            {\n            \"vmSize\":
        \"Standard_D1_v2\",\n            \"osDiskSizeGB\": 30\n            },\n\n
        \       \"source\": {\n            \"type\": \"PlatformImage\",\n                \"publisher\":
        \"Canonical\",\n                \"offer\": \"UbuntuServer\",\n                \"sku\":
        \"18.04-LTS\",\n                \"version\": \"18.04.201903060\"\n            \n
        \       },\n        \"customize\": [\n            {\n                \"type\":
        \"Shell\",\n                \"name\": \"RunScriptFromSource\",\n                \"scriptUri\":
        \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript.sh\"\n
        \           },\n\n            {\n                \"type\": \"Shell\",\n                \"name\":
        \"CheckSumCompareShellScript\",\n                \"scriptUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript2.sh\",\n
        \               \"sha256Checksum\": \"ade4c5214c3c675e92c66e2d067a870c5b81b9844b3de3cc72c49ff36425fc93\"\n
        \           },\n            \n            {\n                \"type\": \"File\",\n
        \               \"name\": \"downloadBuildArtifacts\",\n                \"sourceUri\":
        \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/exampleArtifacts/buildArtifacts/index.html\",\n
        \               \"destination\":\"/tmp/index.html\"\n            },\n\n            {\n
        \               \"type\": \"Shell\",\n                \"name\": \"setupBuildPath\",\n
        \               \"inline\": [\n                    \"sudo mkdir /buildArtifacts\",\n
        \                   \"sudo cp /tmp/index.html /buildArtifacts/index.html\"\n
        \               ]\n            },\n\n            {\n                \"type\":
        \"Shell\",\n                \"name\": \"InstallUpgrades\",\n                \"inline\":
        [\n                    \"sudo apt install unattended-upgrades\"\n                ]\n
        \           }\n\n        ],\n        \"distribute\": \n            [\n                {
        \  \"type\":\"ManagedImage\",\n                    \"imageId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/fytest2/providers/Microsoft.Compute/images/image\",\n
        \                   \"location\": \"westus\",\n                    \"runOutputName\":
        \"runOutputName\",\n                    \"artifactTags\": {\n                        \"source\":
        \"azVmImageBuilder\",\n                        \"baseosimg\": \"ubuntu1804\"\n
        \                   }\n                }\n            ]\n        }\n    }\n"
    headers:
      accept-ranges:
      - bytes
      access-control-allow-origin:
      - '*'
      cache-control:
      - max-age=300
      connection:
      - keep-alive
      content-length:
      - '2666'
      content-security-policy:
      - default-src 'none'; style-src 'unsafe-inline'; sandbox
      content-type:
      - text/plain; charset=utf-8
      date:
      - Wed, 04 Mar 2020 17:52:47 GMT
      etag:
      - W/"308e89bcda38ef882050e78cdcfd78831d14d5d81ceba87b02fbf2215c092add"
      expires:
      - Wed, 04 Mar 2020 17:57:47 GMT
      source-age:
      - '131'
      strict-transport-security:
      - max-age=31536000
      vary:
      - Authorization,Accept-Encoding
      via:
      - 1.1 varnish (Varnish/6.0)
      - 1.1 varnish
      x-cache:
      - MISS, HIT
      x-cache-hits:
      - 0, 1
      x-content-type-options:
      - nosniff
      x-fastly-request-id:
      - 73494f2e5af94b47cae7ce5f698e544dbe60b8a9
      x-frame-options:
      - deny
      x-geo-block-list:
      - ''
      x-github-request-id:
      - B8B2:4279:29251:2C6BE:5E5FC6EE
      x-served-by:
      - cache-tyo19930-TYO
      x-timer:
      - S1583344367.157399,VS0,VE1
      x-xss-protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "tags": {"imagebuilderTemplate": "ubuntu1804"},
      "properties": {"source": {"type": "PlatformImage", "publisher": "Canonical",
      "offer": "UbuntuServer", "sku": "18.04-LTS", "version": "18.04.201903060"},
      "customize": [{"name": "RunScriptFromSource", "type": "Shell", "scriptUri":
      "https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript.sh"},
      {"name": "CheckSumCompareShellScript", "type": "Shell", "scriptUri": "https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript2.sh"},
      {"name": "downloadBuildArtifacts", "type": "File", "sourceUri": "https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/exampleArtifacts/buildArtifacts/index.html",
      "destination": "/tmp/index.html"}, {"name": "setupBuildPath", "type": "Shell",
      "inline": ["sudo mkdir /buildArtifacts", "sudo cp /tmp/index.html /buildArtifacts/index.html"]},
      {"name": "InstallUpgrades", "type": "Shell", "inline": ["sudo apt install unattended-upgrades"]}],
      "distribute": [{"runOutputName": "runOutputName", "artifactTags": {"source":
      "azVmImageBuilder", "baseosimg": "ubuntu1804"}, "type": "ManagedImage", "imageId":
      "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/fytest2/providers/Microsoft.Compute/images/image",
      "location": "westus"}], "buildTimeoutInMinutes": 80}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - image builder create
      Connection:
      - keep-alive
      Content-Length:
      - '1406'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -g -n --image-template
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-imagebuilder/0.2.1 Azure-SDK-For-Python AZURECLI/2.1.0
      accept-language:
      - en-US
    method: PUT
    uri: https://localhost:1080/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001/providers/Microsoft.VirtualMachineImages/imageTemplates/tmp1?api-version=2019-05-01-preview
  response:
    body:
      string: "{\n \"properties\": {\n  \"source\": {\n   \"offer\": \"UbuntuServer\",\n
        \  \"publisher\": \"Canonical\",\n   \"sku\": \"18.04-LTS\",\n   \"type\":
        \"PlatformImage\",\n   \"version\": \"18.04.201903060\"\n  },\n  \"customize\":
        [\n   {\n    \"name\": \"RunScriptFromSource\",\n    \"scriptUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript.sh\",\n
        \   \"type\": \"Shell\"\n   },\n   {\n    \"name\": \"CheckSumCompareShellScript\",\n
        \   \"scriptUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript2.sh\",\n
        \   \"type\": \"Shell\"\n   },\n   {\n    \"destination\": \"/tmp/index.html\",\n
        \   \"name\": \"downloadBuildArtifacts\",\n    \"sourceUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/exampleArtifacts/buildArtifacts/index.html\",\n
        \   \"type\": \"File\"\n   },\n   {\n    \"inline\": [\n     \"sudo mkdir
        /buildArtifacts\",\n     \"sudo cp /tmp/index.html /buildArtifacts/index.html\"\n
        \   ],\n    \"name\": \"setupBuildPath\",\n    \"type\": \"Shell\"\n   },\n
        \  {\n    \"inline\": [\n     \"sudo apt install unattended-upgrades\"\n    ],\n
        \   \"name\": \"InstallUpgrades\",\n    \"type\": \"Shell\"\n   }\n  ],\n
        \ \"distribute\": [\n   {\n    \"artifactTags\": {\n     \"baseosimg\": \"ubuntu1804\",\n
        \    \"source\": \"azVmImageBuilder\"\n    },\n    \"imageId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/fytest2/providers/Microsoft.Compute/images/image\",\n
        \   \"location\": \"westus\",\n    \"runOutputName\": \"runOutputName\",\n
        \   \"type\": \"ManagedImage\"\n   }\n  ],\n  \"provisioningState\": \"Creating\",\n
        \ \"buildTimeoutInMinutes\": 80\n },\n \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_image_builder_template_file_000001/providers/Microsoft.VirtualMachineImages/imageTemplates/tmp1\",\n
        \"name\": \"tmp1\",\n \"type\": \"Microsoft.VirtualMachineImages/imageTemplates\",\n
        \"location\": \"westus\",\n \"tags\": {\n  \"imagebuilderTemplate\": \"ubuntu1804\"\n
        }\n}"
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.VirtualMachineImages/locations/westus/operations/76fdde29-ba6b-4628-86c1-71e52f8de51e?api-version=2019-05-01-preview
      cache-control:
      - no-cache
      content-length:
      - '1953'
      content-type:
      - application/json
      date:
      - Wed, 04 Mar 2020 17:52:57 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - nginx
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - image builder create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --image-template
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-imagebuilder/0.2.1 Azure-SDK-For-Python AZURECLI/2.1.0
    method: GET
    uri: https://localhost:1080/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.VirtualMachineImages/locations/westus/operations/76fdde29-ba6b-4628-86c1-71e52f8de51e?api-version=2019-05-01-preview
  response:
    body:
      string: "{\n \"name\": \"76FDDE29-BA6B-4628-86C1-71E52F8DE51E\",\n \"status\":
        \"Succeeded\",\n \"startTime\": \"2020-03-04T17:52:55.755823Z\",\n \"endTime\":
        \"2020-03-04T17:53:28.0833551Z\"\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '164'
      content-type:
      - application/json
      date:
      - Wed, 04 Mar 2020 17:53:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - nginx
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - image builder create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --image-template
      User-Agent:
      - python/3.8.1 (Windows-10-10.0.17763-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-imagebuilder/0.2.1 Azure-SDK-For-Python AZURECLI/2.1.0
    method: GET
    uri: https://localhost:1080/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_image_builder_template_file_000001/providers/Microsoft.VirtualMachineImages/imageTemplates/tmp1?api-version=2019-05-01-preview
  response:
    body:
      string: "{\n \"properties\": {\n  \"source\": {\n   \"offer\": \"UbuntuServer\",\n
        \  \"publisher\": \"Canonical\",\n   \"sku\": \"18.04-LTS\",\n   \"type\":
        \"PlatformImage\",\n   \"version\": \"18.04.201903060\"\n  },\n  \"customize\":
        [\n   {\n    \"name\": \"RunScriptFromSource\",\n    \"scriptUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript.sh\",\n
        \   \"sha256Checksum\": \"2c6ff6902a4a52deee69e8db26d0036a53388651008aaf31795bb20dabd21fd8\",\n
        \   \"type\": \"Shell\"\n   },\n   {\n    \"name\": \"CheckSumCompareShellScript\",\n
        \   \"scriptUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/customizeScript2.sh\",\n
        \   \"sha256Checksum\": \"ade4c5214c3c675e92c66e2d067a870c5b81b9844b3de3cc72c49ff36425fc93\",\n
        \   \"type\": \"Shell\"\n   },\n   {\n    \"destination\": \"/tmp/index.html\",\n
        \   \"name\": \"downloadBuildArtifacts\",\n    \"sha256Checksum\": \"d9715d72889fb1a0463d06ce9e89d1d2bd33b2c5e5362a736db6f5a25e601a58\",\n
        \   \"sourceUri\": \"https://raw.githubusercontent.com/danielsollondon/azvmimagebuilder/master/quickquickstarts/exampleArtifacts/buildArtifacts/index.html\",\n
        \   \"type\": \"File\"\n   },\n   {\n    \"inline\": [\n     \"sudo mkdir
        /buildArtifacts\",\n     \"sudo cp /tmp/index.html /buildArtifacts/index.html\"\n
        \   ],\n    \"name\": \"setupBuildPath\",\n    \"type\": \"Shell\"\n   },\n
        \  {\n    \"inline\": [\n     \"sudo apt install unattended-upgrades\"\n    ],\n
        \   \"name\": \"InstallUpgrades\",\n    \"type\": \"Shell\"\n   }\n  ],\n
        \ \"distribute\": [\n   {\n    \"artifactTags\": {\n     \"baseosimg\": \"ubuntu1804\",\n
        \    \"source\": \"azVmImageBuilder\"\n    },\n    \"imageId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/fytest2/providers/Microsoft.Compute/images/image\",\n
        \   \"location\": \"westus\",\n    \"runOutputName\": \"runOutputName\",\n
        \   \"type\": \"ManagedImage\"\n   }\n  ],\n  \"provisioningState\": \"Succeeded\",\n
        \ \"buildTimeoutInMinutes\": 80\n },\n \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_image_builder_template_file_000001/providers/Microsoft.VirtualMachineImages/imageTemplates/tmp1\",\n
        \"name\": \"tmp1\",\n \"type\": \"Microsoft.VirtualMachineImages/imageTemplates\",\n
        \"location\": \"westus\",\n \"tags\": {\n  \"imagebuilderTemplate\": \"ubuntu1804\"\n
        }\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2224'
      content-type:
      - application/json
      date:
      - Wed, 04 Mar 2020 17:53:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - nginx
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
version: 1
