interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - ts create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n -v -l -f --description --version-description
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-resource/16.1.0 Python/3.8.10 (Windows-10-10.0.19043-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_template_specs000001/providers/Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002/versions/1.0?api-version=2021-05-01
  response:
    body:
      string: '{"error":{"code":"ResourceNotFound","message":"The Resource ''Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002/versions/1.0''
        under resource group ''cli_test_template_specs000001'' was not found. For
        more details please go to https://aka.ms/ARMResourceNotFoundFix"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '354'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 12 May 2021 20:08:44 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-failure-cause:
      - gateway
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - ts create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n -v -l -f --description --version-description
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-resource/16.1.0 Python/3.8.10 (Windows-10-10.0.19043-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_template_specs000001/providers/Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002?api-version=2021-05-01
  response:
    body:
      string: '{"error":{"code":"ResourceNotFound","message":"The Resource ''Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002''
        under resource group ''cli_test_template_specs000001'' was not found. For
        more details please go to https://aka.ms/ARMResourceNotFoundFix"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '341'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 12 May 2021 20:08:44 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-failure-cause:
      - gateway
    status:
      code: 404
      message: Not Found
- request:
    body: '{"location": "westus", "tags": {}, "properties": {"description": "AzCLI
      test root template spec"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - ts create
      Connection:
      - keep-alive
      Content-Length:
      - '98'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n -v -l -f --description --version-description
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-resource/16.1.0 Python/3.8.10 (Windows-10-10.0.19043-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_template_specs000001/providers/Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002?api-version=2021-05-01
  response:
    body:
      string: "{\r\n  \"location\": \"westus\",\r\n  \"tags\": {},\r\n  \"systemData\":
        {\r\n    \"createdBy\": \"daetienn@microsoft.com\",\r\n    \"createdByType\":
        \"User\",\r\n    \"createdAt\": \"2021-05-12T20:08:46.2994225Z\",\r\n    \"lastModifiedBy\":
        \"daetienn@microsoft.com\",\r\n    \"lastModifiedByType\": \"User\",\r\n    \"lastModifiedAt\":
        \"2021-05-12T20:08:46.2994225Z\"\r\n  },\r\n  \"properties\": {\r\n    \"description\":
        \"AzCLI test root template spec\"\r\n  },\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_template_specs000001/providers/Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002\",\r\n
        \ \"type\": \"Microsoft.Resources/templateSpecs\",\r\n  \"name\": \"cli-test-create-template-spec000002\"\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '790'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 12 May 2021 20:08:46 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: '{"location": "westus", "tags": {}, "properties": {"description": "AzCLI
      test version of root template spec", "linkedTemplates": [], "mainTemplate":
      "{''$schema'': ''https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#'',
      ''contentVersion'': ''1.0.0.0'', ''parameters'': {''customer'': {''type'': ''string'',
      ''minLength'': 2, ''maxLength'': 3, ''defaultValue'': \"[resourceGroup().tags[''customer-short'']]\",
      ''metadata'': {''description'': \"A short unique identifer for the customer
      owning the resource. E.g. ''mc''=''Marel Connect'', ''io''=''Innova''\"}}, ''environment'':
      {''type'': ''string'', ''allowedValues'': [''dev'', ''test'', ''int'', ''stage'',
      ''prod'', ''development'', ''testing'', ''integration'', ''staging'', ''production''],
      ''defaultValue'': \"[resourceGroup().tags[''environment'']]\", ''metadata'':
      {''description'': ''The environment being deployed to.''}}, ''location'': {''type'':
      ''string'', ''allowedValues'': [''eastasia'', ''southeastasia'', ''centralus'',
      ''eastus'', ''eastus2'', ''westus'', ''northcentralus'', ''southcentralus'',
      ''northeurope'', ''westeurope'', ''japanwest'', ''japaneast'', ''brazilsouth'',
      ''australiaeast'', ''australiasoutheast'', ''southindia'', ''centralindia'',
      ''westindia'', ''canadacentral'', ''canadaeast'', ''uksouth'', ''ukwest'', ''westcentralus'',
      ''westus2'', ''koreacentral'', ''koreasouth'', ''francecentral'', ''francesouth'',
      ''australiacentral'', ''australiacentral2'', ''southafricanorth'', ''southafricawest'',
      ''global''], ''defaultValue'': \"[if(contains(resourceGroup().tags, ''location''),
      resourceGroup().tags[''location''], resourceGroup().location)]\", ''metadata'':
      {''description'': ''The location of the data center the resorce will be deployed
      to.''}}, ''group'': {''type'': ''string'', ''minLength'': 3, ''maxLength'':
      12, ''defaultValue'': \"[resourceGroup().tags[''group'']]\", ''metadata'': {''description'':
      ''The group identifier''}}, ''resource'': {''type'': ''string'', ''metadata'':
      {''description'': \"The type of resource the name is being generated for. e.g.
      ''Microsoft.Storage/storageAccounts''\"}}, ''kind'': {''type'': ''string'',
      ''defaultValue'': '''', ''metadata'': {''description'': \"Sometimes a ''kind''
      needs to be specified. Then this parameter needs to be provided. E.g. resource=''Microsoft.Web/sites''
      kind=''functionapp''\"}}, ''instance'': {''type'': ''int'', ''defaultValue'':
      -1, ''metadata'': {''description'': ''If name is for a repeated resource then
      this should be an integer >= 0''}}, ''useHyphen'': {''type'': ''bool'', ''defaultValue'':
      True, ''metadata'': {''description'': \"Determines if the name should include
      hyphens or not. e.g. ''mc-d-euw-data-kv'' vs ''mcdeuwdatakv''\"}}}, ''functions'':
      [], ''variables'': {''environments'': {''dev'': ''d'', ''test'': ''t'', ''int'':
      ''i'', ''stage'': ''s'', ''prod'': ''p'', ''development'': ''d'', ''testing'':
      ''t'', ''integration'': ''i'', ''staging'': ''s'', ''production'': ''p''}, ''locations'':
      {''eastasia'': ''ase'', ''southeastasia'': ''asse'', ''centralus'': ''usc'',
      ''eastus'': ''use'', ''eastus2'': ''use2'', ''westus'': ''usw'', ''northcentralus'':
      ''usnc'', ''southcentralus'': ''ussc'', ''northeurope'': ''eun'', ''westeurope'':
      ''euw'', ''japanwest'': ''jpw'', ''japaneast'': ''jpe'', ''brazilsouth'': ''brs'',
      ''australiaeast'': ''aue'', ''australiasoutheast'': ''ause'', ''southindia'':
      ''ins'', ''centralindia'': ''inc'', ''westindia'': ''inw'', ''canadacentral'':
      ''cac'', ''canadaeast'': ''cae'', ''uksouth'': ''uks'', ''ukwest'': ''ukw'',
      ''westcentralus'': ''uswe'', ''westus2'': ''usw2'', ''koreacentral'': ''krc'',
      ''koreasouth'': ''krs'', ''francecentral'': ''frc'', ''francesouth'': ''frs'',
      ''australiacentral'': ''auc'', ''australiacentral2'': ''auc2'', ''southafricanorth'':
      ''zan'', ''southafricawest'': ''zaw'', ''global'': ''global''}, ''resources'':
      {''Microsoft.Web'': {''publishingUsers'': None, ''ishostnameavailable'': None,
      ''validate'': None, ''isusernameavailable'': None, ''sourceControls'': None,
      ''availableStacks'': None, ''staticSites'': None, ''listSitesAssignedToHostName'':
      None, ''locations/getNetworkPolicies'': None, ''locations/operations'': None,
      ''locations/operationResults'': None, ''sites/networkConfig'': None, ''sites/slots/networkConfig'':
      None, ''sites/hostNameBindings'': None, ''sites/slots/hostNameBindings'': None,
      ''operations'': None, ''certificates'': None, ''serverFarms'': ''asp'', ''sites'':
      {''api'': ''appsvc'', ''app'': ''appui'', ''functionapp'': ''fa''}, ''sites/slots'':
      None, ''runtimes'': None, ''recommendations'': None, ''resourceHealthMetadata'':
      None, ''georegions'': None, ''sites/premieraddons'': None, ''hostingEnvironments'':
      None, ''hostingEnvironments/multiRolePools'': None, ''hostingEnvironments/workerPools'':
      None, ''kubeEnvironments'': None, ''deploymentLocations'': None, ''deletedSites'':
      None, ''locations/deletedSites'': None, ''ishostingenvironmentnameavailable'':
      None, ''locations/deleteVirtualNetworkOrSubnets'': None, ''connections'': None,
      ''customApis'': None, ''locations'': None, ''locations/listWsdlInterfaces'':
      None, ''locations/extractApiDefinitionFromWsdl'': None, ''locations/managedApis'':
      None, ''locations/runtimes'': None, ''locations/apiOperations'': None, ''connectionGateways'':
      None, ''locations/connectionGatewayInstallations'': None, ''checkNameAvailability'':
      None, ''billingMeters'': None, ''verifyHostingEnvironmentVnet'': None, ''serverFarms/eventGridFilters'':
      None, ''sites/eventGridFilters'': None, ''sites/slots/eventGridFilters'': None,
      ''hostingEnvironments/eventGridFilters'': None, ''serverFarms/firstPartyApps'':
      None, ''serverFarms/firstPartyApps/keyVaultSettings'': None}}, ''provider'':
      \"[split(parameters(''resource''), ''/'')[0]]\", ''resourceType'': \"[replace(parameters(''resource''),
      concat(variables(''provider''), ''/''), '''')]\", ''hyphenedName'': \"[format(''[0]-[1]-[2]-[3]-[4]-[5]'',
      parameters(''customer''), variables(''environments'')[parameters(''environment'')],
      variables(''locations'')[parameters(''location'')], parameters(''group''), parameters(''service''),
      if(equals(parameters(''kind''), ''''), variables(''resources'')[variables(''provider'')][variables(''resourceType'')],
      variables(''resources'')[variables(''provider'')][variables(''resourceType'')][parameters(''kind'')]))]\",
      ''removeOptionalsFromHyphenedName'': \"[replace(variables(''hyphenedName''),
      ''--'', ''-'')]\", ''isInstanceCount'': \"[greater(parameters(''instance''),
      -1)]\", ''hyphenedNameAfterInstanceCount'': \"[if(variables(''isInstanceCount''),
      format(''[0]-[1]'', variables(''removeOptionalsFromHyphenedName''), string(parameters(''instance''))),
      variables(''removeOptionalsFromHyphenedName''))]\", ''name'': \"[if(parameters(''useHyphen''),
      variables(''hyphenedNameAfterInstanceCount''), replace(variables(''hyphenedNameAfterInstanceCount''),
      ''-'', ''''))]\"}, ''resources'': [], ''outputs'': {''name'': {''type'': ''string'',
      ''value'': \"[toLower(variables(''name''))]\"}}}"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - ts create
      Connection:
      - keep-alive
      Content-Length:
      - '6373'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n -v -l -f --description --version-description
      User-Agent:
      - AZURECLI/2.23.0 azsdk-python-azure-mgmt-resource/16.1.0 Python/3.8.10 (Windows-10-10.0.19043-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_template_specs000001/providers/Microsoft.Resources/templateSpecs/cli-test-create-template-spec000002/versions/1.0?api-version=2021-05-01
  response:
    body:
      string: "{\r\n  \"error\": {\r\n    \"code\": \"InvalidSchema\",\r\n    \"message\":
        \"Path:properties.mainTemplate, Schema:#/definitions/TemplateSpecVersionProperties/properties/mainTemplate,
        Error: Invalid type. Expected Object but got String.\"\r\n  }\r\n}"
    headers:
      cache-control:
      - no-cache
      content-length:
      - '230'
      content-type:
      - application/json; charset=utf-8
      date:
      - Wed, 12 May 2021 20:08:47 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 400
      message: Bad Request
version: 1
