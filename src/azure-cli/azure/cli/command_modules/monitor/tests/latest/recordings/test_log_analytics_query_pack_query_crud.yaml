interactions:
- request:
    body: '{"location": "eastus2", "properties": {}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - monitor log-analytics query-pack create
      Connection:
      - keep-alive
      Content-Length:
      - '41'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n -l
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_log_analytics_query_pack_query_crud000001/providers/Microsoft.OperationalInsights/queryPacks/clitest000002?api-version=2019-09-01
  response:
    body:
      string: "{\r\n  \"kind\": null,\r\n  \"etag\": \"\\\"5d0062b8-0000-0200-0000-67b705320000\\\"\",\r\n
        \ \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_log_analytics_query_pack_query_crud000001/providers/Microsoft.OperationalInsights/querypacks/clitest000002\",\r\n
        \ \"name\": \"clitest000002\",\r\n  \"type\": \"microsoft.operationalinsights/querypacks\",\r\n
        \ \"location\": \"eastus2\",\r\n  \"tags\": {},\r\n  \"properties\": {\r\n
        \   \"queryPackId\": \"fa544e62-f274-46b0-91f2-8d6466660a02\",\r\n    \"timeCreated\":
        \"2025-02-20T10:34:26.1206276Z\",\r\n    \"timeModified\": \"2025-02-20T10:34:26.1206276Z\",\r\n
        \   \"provisioningState\": \"Succeeded\"\r\n  }\r\n}"
    headers:
      access-control-expose-headers:
      - Request-Context
      cache-control:
      - no-cache
      content-length:
      - '618'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 10:34:25 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      request-context:
      - appId=cid-v1:0dd6a9c3-b728-41ca-aa78-7e1962e22331
      server:
      - Microsoft-IIS/10.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/2e147788-72d8-4089-995a-7d3837a0b82c
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-powered-by:
      - ASP.NET
    status:
      code: 201
      message: Created
- request:
    body: '{"properties": {"body": "let newExceptionsTimeRange = 1d;let timeRangeToCheckBefore
      = 7d;exceptions | where timestamp < ago(timeRangeToCheckBefore) | summarize
      count() by problemId | join kind= rightanti (exceptions | where timestamp >=
      ago(newExceptionsTimeRange) | extend stack = tostring(details[0].rawStack) |
      summarize count(), dcount(user_AuthenticatedId), min(timestamp), max(timestamp),
      any(stack) by problemId) on problemId | order by  count_ desc", "description":
      "this is for test", "displayName": "query-test", "related": {"categories": ["network",
      "monitor"], "resourceTypes": ["microsoft.network/loadbalancers", "microsoft.insights/autoscalesettings"],
      "solutions": ["networkmonitoring"]}, "tags": {"version": ["v2022-01-01", "v2021-12-01"]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - monitor log-analytics query-pack query create
      Connection:
      - keep-alive
      Content-Length:
      - '757'
      Content-Type:
      - application/json
      ParameterSetName:
      - --query-id -g --query-pack-name --display-name --body --description --categories
        --resource-types --solutions --tags
      User-Agent:
      - AZURECLI/2.69.0 azsdk-python-core/1.31.0 Python/3.12.9 (Windows-10-10.0.19045-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_log_analytics_query_pack_query_crud000001/providers/Microsoft.OperationalInsights/queryPacks/clitest000002/queries/5865fd70-3d2c-4c83-9423-7d204c3b3f90?api-version=2019-09-01
  response:
    body:
      string: "{\r\n  \"id\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_log_analytics_query_pack_query_crud000001/providers/Microsoft.OperationalInsights/querypacks/clitest000002/queries/5865fd70-3d2c-4c83-9423-7d204c3b3f90\",\r\n
        \ \"name\": \"5865fd70-3d2c-4c83-9423-7d204c3b3f90\",\r\n  \"type\": \"Microsoft.OperationalInsights/querypacks/queries\",\r\n
        \ \"etag\": \"\\\"5d00ecb8-0000-0200-0000-67b705370000\\\"\",\r\n  \"systemData\":
        {\r\n    \"createdBy\": \"zhiyihuang@microsoft.com\",\r\n    \"createdByType\":
        \"User\",\r\n    \"createdAt\": \"2025-02-20T10:34:28.3489213Z\",\r\n    \"lastModifiedBy\":
        \"zhiyihuang@microsoft.com\",\r\n    \"lastModifiedByType\": \"User\",\r\n
        \   \"lastModifiedAt\": \"2025-02-20T10:34:28.3489213Z\"\r\n  },\r\n  \"properties\":
        {\r\n    \"id\": \"5865fd70-3d2c-4c83-9423-7d204c3b3f90\",\r\n    \"displayName\":
        \"query-test\",\r\n    \"description\": \"this is for test\",\r\n    \"body\":
        \"let newExceptionsTimeRange = 1d;let timeRangeToCheckBefore = 7d;exceptions
        | where timestamp < ago(timeRangeToCheckBefore) | summarize count() by problemId
        | join kind= rightanti (exceptions | where timestamp >= ago(newExceptionsTimeRange)
        | extend stack = tostring(details[0].rawStack) | summarize count(), dcount(user_AuthenticatedId),
        min(timestamp), max(timestamp), any(stack) by problemId) on problemId | order
        by  count_ desc\",\r\n    \"related\": {\r\n      \"categories\": [\r\n        \"network\",\r\n
        \       \"monitor\"\r\n      ],\r\n      \"resourceTypes\": [\r\n        \"microsoft.network/loadbalancers\",\r\n
        \       \"microsoft.insights/autoscalesettings\"\r\n      ],\r\n      \"solutions\":
        [\r\n        \"networkmonitoring\"\r\n      ]\r\n    },\r\n    \"tags\": {\r\n
        \     \"version\": [\r\n        \"v2022-01-01\",\r\n        \"v2021-12-01\"\r\n
        \     ]\r\n    }\r\n  }\r\n}"
    headers:
      access-control-expose-headers:
      - Request-Context
      cache-control:
      - no-cache
      content-length:
      - '1681'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 20 Feb 2025 10:34:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      request-context:
      - appId=cid-v1:0dd6a9c3-b728-41ca-aa78-7e1962e22331
      server:
      - Microsoft-IIS/10.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=a7250e3a-0e5e-48e2-9a34-45f1f5e1a91e/eastus2euap/a22fcfcc-c793-40aa-861a-0eea74f21ac4
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-powered-by:
      - ASP.NET
    status:
      code: 200
      message: OK
version: 1
