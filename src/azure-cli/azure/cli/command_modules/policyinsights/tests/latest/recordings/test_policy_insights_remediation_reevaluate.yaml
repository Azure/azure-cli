interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-resource/12.1.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008?api-version=2020-09-01
  response:
    body:
      string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy definition
        ''5ffd78d9-436d-4b41-a421-5baa819e3008'' could not be found."}}'
    headers:
      cache-control:
      - no-store, no-cache
      content-length:
      - '138'
      content-type:
      - application/json
      date:
      - Mon, 05 Apr 2021 18:19:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-resource/12.1.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008?api-version=2020-09-01
  response:
    body:
      string: '{"properties":{"displayName":"Add or replace a tag on resources","policyType":"BuiltIn","mode":"Indexed","description":"Adds
        or replaces the specified tag and value when any resource is created or updated.
        Existing resources can be remediated by triggering a remediation task. Does
        not modify tags on resource groups.","metadata":{"version":"1.0.0","category":"Tags"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},"then":{"effect":"modify","details":{"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"operations":[{"operation":"addOrReplace","field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","type":"Microsoft.Authorization/policyDefinitions","name":"5ffd78d9-436d-4b41-a421-5baa819e3008"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1225'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:05 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008",
      "parameters": {"tagName": {"value": "cliTagKey"}, "tagValue": {"value": "cliTagValue"}},
      "enforcementMode": "Default"}, "location": "westus", "identity": {"type": "SystemAssigned"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '312'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - --policy -g -n --location --assign-identity -p
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-resource/12.1.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2020-09-01
  response:
    body:
      string: '{"identity":{"principalId":"9a9ec698-8ba6-4fa9-8952-b92fc14dd723","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"9d6d6799-f94d-4ccf-a96d-67761f19626b","createdOn":"2021-04-05T18:19:09.2670865Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","location":"westus"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1037'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -a --resource-discovery-mode
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-resource/12.1.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2020-09-01
  response:
    body:
      string: '{"value":[{"identity":{"principalId":"93a1325f-d061-40d9-a5dc-ac1c1964b8c5","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"PUX
        Testing","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/b755afb5-655c-4ebd-b231-ed2ea62788da","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/chegg1","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggrg"],"parameters":{},"description":"asdf","metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2020-08-24T19:55:15.037589Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2020-12-08T23:32:56.5545843Z"},"enforcementMode":"Default","nonComplianceMessages":[{"message":"general
        msg"},{"policyDefinitionReferenceId":"13123074483967204561","message":"asdf"},{"policyDefinitionReferenceId":"3854513742587939697","message":"asdf"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d0340753bef49b2a49e3b24","type":"Microsoft.Authorization/policyAssignments","name":"4d0340753bef49b2a49e3b24","location":"eastus"},{"identity":{"principalId":"cc514f81-616b-428d-ad5d-5edf6eda6123","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"delegated
        test","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"tagName":{"value":"inheritThis"}},"description":"","metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2020-10-27T20:42:49.4800137Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2020-12-08T23:51:32.0323505Z"},"enforcementMode":"Default","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/6cdf02569df44e97ac1207d8","type":"Microsoft.Authorization/policyAssignments","name":"6cdf02569df44e97ac1207d8","location":"eastus"},{"identity":{"principalId":"dee5ebd7-7c42-488f-9337-1e13990a5f0f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Deploy
        Auditing on SQL servers","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"retentionDays":{"value":"365"},"storageAccountsResourceGroup":{"value":"fasdf"}},"description":"","metadata":{"createdBy":"62cf80f1-18ad-45ab-9f4a-31351e915e7a","createdOn":"2020-07-07T18:07:30.491332Z","updatedBy":"44b5ad13-adfa-4496-9ddf-e12eaf49394c","updatedOn":"2020-07-07T18:10:47.7361423Z"},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3","type":"Microsoft.Authorization/policyAssignments","name":"9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3","location":"westus2"},{"identity":{"principalId":"c6cc2129-0f3b-4411-bf01-204c836e4254","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Deploy
        SQL DB transparent data encryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"","metadata":{"createdBy":"62cf80f1-18ad-45ab-9f4a-31351e915e7a","createdOn":"2020-07-07T18:07:24.6983719Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2020-09-04T17:44:25.5203202Z","parameterScopes":{}},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09","type":"Microsoft.Authorization/policyAssignments","name":"a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09","location":"westus2"},{"identity":{"principalId":"f357a207-efa0-4712-bd1b-408ba7f7cf0b","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"RegComp
        with Manual Policies","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/44596757892f4cb8946d34c0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"logAnalyticsWorkspaceIdforVMReporting":{"value":"/doesntexist"},"listOfMembersToExcludeFromWindowsVMAdministratorsGroup":{"value":"none"},"listOfMembersToIncludeInWindowsVMAdministratorsGroup":{"value":"none"}},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-02-01T21:29:09.2965279Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default","nonComplianceMessages":[{"message":"You
        are not compliant"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/afe2a902a37a4a5fb474162f","type":"Microsoft.Authorization/policyAssignments","name":"afe2a902a37a4a5fb474162f","location":"eastus"},{"properties":{"displayName":"Enable
        Monitoring in Azure Security Center","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2020-03-31T22:09:50.4969437Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/c0921b86d1db4b8c9ac90f9f","type":"Microsoft.Authorization/policyAssignments","name":"c0921b86d1db4b8c9ac90f9f"},{"identity":{"principalId":"c93898bd-f9d0-4659-a5d1-c0031872b936","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Not
        enforced subscription tag policy (cheggert)","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/61a4d60b-7326-440e-8051-9f94394d4dd1","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"tagName":{"value":"notEnforced"},"tagValue":{"value":"notEnforcedVal"}},"description":"","metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-02-08T19:39:08.440631Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2021-02-08T19:39:27.8198427Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[{"message":"This
        subscription is not compliant (cheggert)"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/ea30901b981543ae98a3d2bf","type":"Microsoft.Authorization/policyAssignments","name":"ea30901b981543ae98a3d2bf","location":"eastus"},{"identity":{"principalId":"8b9d526a-9e43-4d1b-8bfe-cfe4d90f3b58","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"chegg:
        Replace tag without becoming compliant","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/270f0d11-af30-4c15-95f7-28ba884518f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2019-11-21T00:28:49.7568462Z","updatedBy":null,"updatedOn":null},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/ee5909f9ee3f4c12bbed6efc","type":"Microsoft.Authorization/policyAssignments","name":"ee5909f9ee3f4c12bbed6efc","location":"eastus"},{"identity":{"principalId":"dfd2385a-7700-420f-b164-bd9ffb52285b","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Empty
        deployment on each KeyVault resource (SUB)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"Deploys
        an empty deployment (with one output) on each KeyVault vault.  Used for some
        PolicyInsights SDK tests.","metadata":{"assignedBy":"Chris Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2019-11-21T17:43:53.4694168Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2021-02-24T18:26:48.4990411Z"},"enforcementMode":"Default","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/fcddeb6113ec43798567dce2","type":"Microsoft.Authorization/policyAssignments","name":"fcddeb6113ec43798567dce2","location":"eastus"},{"identity":{"principalId":"9a9ec698-8ba6-4fa9-8952-b92fc14dd723","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"9d6d6799-f94d-4ccf-a96d-67761f19626b","createdOn":"2021-04-05T18:19:09.2670865Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","location":"westus"},{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_triggerscanx7x4fwt4yyp3z5k4ynhlzklshsaxk64jlbzvvmj4rs43o46wxyndjp6","parameters":{"tagName":{"value":"notThere"}},"metadata":{"createdBy":"9d6d6799-f94d-4ccf-a96d-67761f19626b","createdOn":"2021-04-05T18:18:09.0586403Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_triggerscanx7x4fwt4yyp3z5k4ynhlzklshsaxk64jlbzvvmj4rs43o46wxyndjp6/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentxan5ddwvf","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentxan5ddwvf"},{"properties":{"displayName":"CSEO
        Block WVD resource creation","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyDefinitions/Deny
        WVD creation","scope":"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47","notScopes":["/providers/Microsoft.Management/managementGroups/MSFT-DSRE-ISO-IAM","/providers/Microsoft.Management/managementGroups/9ce3369a-545b-cfba-c329-3631400b552f","/providers/Microsoft.Management/managementGroups/WVDSelfhost","/subscriptions/00000000-0000-0000-0000-000000000000","/providers/Microsoft.Management/managementGroups/595d008b-0e4c-41f8-af09-254420fd7571","/providers/Microsoft.Management/managementGroups/CloudPCMSFTSubscriptions","/providers/Microsoft.Management/managementGroups/64cd7b97-58e0-44d3-832b-55657739bde3"],"description":"IAMAADENG@microsoft.com","metadata":{"createdBy":"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e","createdOn":"2020-11-17T19:41:36.3082667Z","updatedBy":"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e","updatedOn":"2021-03-03T20:26:00.9826574Z"},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyAssignments/Block
        WVD creation","type":"Microsoft.Authorization/policyAssignments","name":"Block
        WVD creation"},{"properties":{"displayName":"Manual Policy Initiative","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policySetDefinitions/648898cb915947e68e67f582","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{},"description":"","metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-01-20T20:53:12.4535246Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2021-01-21T19:02:48.9589454Z"},"enforcementMode":"Default","nonComplianceMessages":[{"policyDefinitionReferenceId":"Subscription
        Manual Policy (parameterized effect)_1","message":"These subscriptions have
        been manually set to non-compliant"},{"policyDefinitionReferenceId":"Subscription
        Manual Policy (parameterized default)_1","message":"These subscriptions have
        been manually set to non-compliant"}]},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/4347209461a74f558795177c","type":"Microsoft.Authorization/policyAssignments","name":"4347209461a74f558795177c"},{"properties":{"displayName":"Subscription
        Manual Policy (parameterized effect)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf94","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{"effect":{"value":"manual"}},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-01-20T20:53:47.6246297Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/6b90de548ea0486e925fcbad","type":"Microsoft.Authorization/policyAssignments","name":"6b90de548ea0486e925fcbad"},{"properties":{"displayName":"Subscription
        Manual Policy (parameterized default)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf8a","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{"defaultState":{"value":"NonCompliant"}},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-01-20T20:53:36.5851095Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/75aacc60963a4146a2e87f3e","type":"Microsoft.Authorization/policyAssignments","name":"75aacc60963a4146a2e87f3e"},{"properties":{"displayName":"Multi-type
        Manual Policy (parameterized effect)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/d4094db5-f5c0-45d4-8540-67f60ba1b923","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{"effect":{"value":"manual"}},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-01-20T20:53:58.1343344Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/92216833e0dd4e1793da2eb7","type":"Microsoft.Authorization/policyAssignments","name":"92216833e0dd4e1793da2eb7"},{"identity":{"principalId":"ce1d9a10-d84d-472f-8535-7db0fee761a0","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Add
        time tag to subscriptions","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7637bcff-f8f5-4077-924a-287ae88f7299","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{},"description":"","metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-02-08T19:35:58.108131Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2021-02-16T20:32:03.7379054Z"},"enforcementMode":"Default","nonComplianceMessages":[{"message":"The
        subscription did not have a time tag"}]},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/abd7b3be02774ce0b2e15d76","type":"Microsoft.Authorization/policyAssignments","name":"abd7b3be02774ce0b2e15d76","location":"eastus"},{"properties":{"displayName":"Subscription
        Manual Policy (unknown default)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14fa603","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-01-20T20:53:26.2531867Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/c210fc4598ea42358daa72d0","type":"Microsoft.Authorization/policyAssignments","name":"c210fc4598ea42358daa72d0"},{"identity":{"principalId":"4977cd5b-1262-46b5-a5f2-0b4ebba35242","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Create
        subscription greenfield resource group (cheggert)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/64f8fdd9-7ea8-48ba-938d-fec37063b311","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2021-02-08T19:47:59.5901431Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default","nonComplianceMessages":[{"message":"The
        resource group did not exist"}]},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/d1d1cbed1ed14901b4c6b81c","type":"Microsoft.Authorization/policyAssignments","name":"d1d1cbed1ed14901b4c6b81c","location":"eastus2"},{"identity":{"principalId":"067c1aa0-c425-4ad5-80fe-41d4639b1d42","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"displayName":"Empty
        deployment on each KeyVault resource (MG)","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":[],"parameters":{},"description":"Deploys
        an empty deployment (with one output) on each KeyVault vault.  Used for some
        PolicyInsights SDK tests.","metadata":{"assignedBy":"Chris Eggert","parameterScopes":{},"createdBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","createdOn":"2019-11-21T17:44:17.3643721Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2020-09-04T17:44:00.7898442Z"},"enforcementMode":"DoNotEnforce"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/d80d743b97874fd3bfd1d539","type":"Microsoft.Authorization/policyAssignments","name":"d80d743b97874fd3bfd1d539","location":"eastus"},{"properties":{"displayName":"Audit
        tag at MG","policyDefinitionId":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/03ae6c12-b46a-43f1-9f3d-c20620473106","scope":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000"],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{},"createdBy":"327c26bf-bf3e-4128-9b75-fbbd99e98739","createdOn":"2019-09-19T21:02:48.2629834Z","updatedBy":"36e2f355-d2e2-4fbc-88ab-4281639dff94","updatedOn":"2019-10-01T17:50:28.4254014Z"},"enforcementMode":"Default"},"id":"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/ef26e8bbc3da423ebf7fcb80","type":"Microsoft.Authorization/policyAssignments","name":"ef26e8bbc3da423ebf7fcb80"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '21552'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003",
      "resourceDiscoveryMode": "ReEvaluateCompliance"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '326'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -g -a --resource-discovery-mode
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-policyinsights/0.5.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2019-07-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Accepted","createdOn":"2021-04-05T18:19:10.7033704Z","lastUpdatedOn":"2021-04-05T18:19:10.7033704Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '869'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '146'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-policyinsights/0.5.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2019-07-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Accepted","createdOn":"2021-04-05T18:19:10.7033704Z","lastUpdatedOn":"2021-04-05T18:19:10.7033704Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '869'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '144'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-policyinsights/0.5.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations?api-version=2019-07-01
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Accepted","createdOn":"2021-04-05T18:19:10.7033704Z","lastUpdatedOn":"2021-04-05T18:19:10.7033704Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '881'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '144'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-policyinsights/0.5.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2019-07-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '145'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation cancel
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.8.8 (Windows-10-10.0.19041-SP0) msrest/0.6.21 msrest_azure/0.6.3
        azure-mgmt-policyinsights/0.5.0 Azure-SDK-For-Python AZURECLI/2.21.0
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/cancel?api-version=2019-07-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Cancelling","createdOn":"2021-04-05T18:19:10.7033704Z","lastUpdatedOn":"2021-04-05T18:19:13.9377805Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '871'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Apr 2021 18:19:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '143'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
version: 1
