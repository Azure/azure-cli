interactions:
- request:
    body: '{"userPrincipalName": "testuser000002@azuresdkteam.onmicrosoft.com", "displayName":
      "tester123", "passwordProfile": {"password": "Test123456789", "forceChangePasswordNextSignIn":
      false}, "mailNickname": "testuser000002", "accountEnabled": true}'
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - ad user create
      Connection:
      - keep-alive
      Content-Length:
      - '244'
      Content-Type:
      - application/json
      ParameterSetName:
      - --display-name --password --user-principal-name
      User-Agent:
      - python/3.10.9 (Windows-10-10.0.22621-SP0) AZURECLI/2.49.0
    method: POST
    uri: https://graph.microsoft.com/v1.0/users
  response:
    body:
      string: '{"@odata.context":"https://graph.microsoft.com/v1.0/$metadata#users/$entity","id":"a2102d4c-0da3-49d6-a67e-f73263b3b311","businessPhones":[],"displayName":"tester123","givenName":null,"jobTitle":null,"mail":null,"mobilePhone":null,"officeLocation":null,"preferredLanguage":null,"surname":null,"userPrincipalName":"testuser000002@azuresdkteam.onmicrosoft.com"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '359'
      content-type:
      - application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:17 GMT
      location:
      - https://graph.microsoft.com/v2/54826b22-38d6-4fb2-bad9-b7b93a3e9c5a/directoryObjects/a2102d4c-0da3-49d6-a67e-f73263b3b311/Microsoft.DirectoryServices.User
      odata-version:
      - '4.0'
      request-id:
      - 59b8890d-4770-4e7f-a3c9-99fad679a14c
      strict-transport-security:
      - max-age=31536000
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-ms-ags-diagnostic:
      - '{"ServerInfo":{"DataCenter":"Japan East","Slice":"E","Ring":"5","ScaleUnit":"003","RoleInstance":"TYO1EPF00002265"}}'
      x-ms-resource-unit:
      - '1'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - python/3.10.9 (Windows-10-10.0.22621-SP0) AZURECLI/2.49.0
    method: GET
    uri: https://graph.microsoft.com/v1.0/users?$filter=userPrincipalName%20eq%20%27testuser000002%40azuresdkteam.onmicrosoft.com%27
  response:
    body:
      string: '{"@odata.context":"https://graph.microsoft.com/v1.0/$metadata#users","value":[{"businessPhones":[],"displayName":"tester123","givenName":null,"jobTitle":null,"mail":null,"mobilePhone":null,"officeLocation":null,"preferredLanguage":null,"surname":null,"userPrincipalName":"testuser000002@azuresdkteam.onmicrosoft.com","id":"a2102d4c-0da3-49d6-a67e-f73263b3b311"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '363'
      content-type:
      - application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:32 GMT
      odata-version:
      - '4.0'
      request-id:
      - b174c266-7f47-4794-a78e-5e31aa8de11a
      strict-transport-security:
      - max-age=31536000
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-ms-ags-diagnostic:
      - '{"ServerInfo":{"DataCenter":"Japan East","Slice":"E","Ring":"5","ScaleUnit":"003","RoleInstance":"TYO1EPF00002261"}}'
      x-ms-resource-unit:
      - '2'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-authorization/3.0.0 Python/3.10.9
        (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions?$filter=roleName%20eq%20%27contributor%27&api-version=2022-04-01
  response:
    body:
      string: '{"value":[{"properties":{"roleName":"Contributor","type":"BuiltInRole","description":"Grants
        full access to manage all resources, but does not allow you to assign roles
        in Azure RBAC, manage assignments in Azure Blueprints, or share image galleries.","assignableScopes":["/"],"permissions":[{"actions":["*"],"notActions":["Microsoft.Authorization/*/Delete","Microsoft.Authorization/*/Write","Microsoft.Authorization/elevateAccess/Action","Microsoft.Blueprint/blueprintAssignments/write","Microsoft.Blueprint/blueprintAssignments/delete","Microsoft.Compute/galleries/share/action"],"dataActions":[],"notDataActions":[]}],"createdOn":"2015-02-02T21:55:09.8806423Z","updatedOn":"2021-11-11T20:13:28.6061853Z","createdBy":null,"updatedBy":null},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c","type":"Microsoft.Authorization/roleDefinitions","name":"b24988ac-6180-42a0-ab88-20f7382dd24c"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '984'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      set-cookie:
      - x-ms-gateway-slice=Production; path=/; secure; samesite=none; httponly
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"roleDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
      "principalId": "a2102d4c-0da3-49d6-a67e-f73263b3b311", "principalType": "User"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - role assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '258'
      Content-Type:
      - application/json
      Cookie:
      - x-ms-gateway-slice=Production
      ParameterSetName:
      - --assignee --role --scope
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-authorization/3.0.0 Python/3.10.9
        (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleAssignments/88888888-0000-0000-0000-000000000001?api-version=2022-04-01
  response:
    body:
      string: '{"properties":{"roleDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c","principalId":"a2102d4c-0da3-49d6-a67e-f73263b3b311","principalType":"User","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","condition":null,"conditionVersion":null,"createdOn":"2023-06-05T03:47:34.5651903Z","updatedOn":"2023-06-05T03:47:35.8437959Z","createdBy":null,"updatedBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","delegatedManagedIdentityResourceId":null,"description":null},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleAssignments/88888888-0000-0000-0000-000000000001","type":"Microsoft.Authorization/roleAssignments","name":"88888888-0000-0000-0000-000000000001"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '811'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:37 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --display-name --description -a --package-file-uri --lock-level --deployment-mode
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-resource/23.0.1 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001?api-version=2022-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001","name":"clitest.rg000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","test":"test_managed_app_def_deployment_mode","date":"2023-06-05T03:47:13Z","module":"resource"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '376'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:38 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "properties": {"lockLevel": "None", "displayName":
      "test_appdef000004", "authorizations": [{"principalId": "a2102d4c-0da3-49d6-a67e-f73263b3b311",
      "roleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c"}], "description":
      "test", "packageFileUri": "https://raw.githubusercontent.com/Azure/azure-managedapp-samples/master/Managed%20Application%20Sample%20Packages/201-managed-storage-account/managedstorage.zip",
      "deploymentPolicy": {"deploymentMode": "Incremental"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition create
      Connection:
      - keep-alive
      Content-Length:
      - '492'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g --display-name --description -a --package-file-uri --lock-level --deployment-mode
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-resource/23.0.1 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003?api-version=2019-07-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003","name":"def000003","type":"microsoft.solutions/applicationdefinitions","location":"westus","systemData":{"createdBy":"v-jingszhang@microsoft.com","createdByType":"User","createdAt":"2023-06-05T03:47:41.4929579Z","lastModifiedBy":"v-jingszhang@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2023-06-05T03:47:41.4929579Z"},"properties":{"deploymentPolicy":{"deploymentMode":"Incremental"},"authorizations":[{"principalId":"a2102d4c-0da3-49d6-a67e-f73263b3b311","roleDefinitionId":"b24988ac-6180-42a0-ab88-20f7382dd24c"}],"isEnabled":true,"lockLevel":"None","displayName":"test_appdef000004","description":"test","artifacts":[{"name":"ApplicationResourceTemplate","type":"Template","uri":"https://amastorageprodus.blob.core.windows.net/applicationdefinitions/8C96E_0B1F64711BF04DDAAEC3CB9272F09590_899F9C6394E71F7A91E6AC4961C8DC1477E5CDDE7B90DEA577E19D94C7A69C94/76b8ccc0651d4e12aee836390187d9cc/applicationResourceTemplate.json"},{"name":"CreateUiDefinition","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003/applicationArtifacts/CreateUiDefinition?api-version=2017-09-01"},{"name":"MainTemplateParameters","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003/applicationArtifacts/MainTemplateParameters?api-version=2017-09-01"}],"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1723'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:44 GMT
      etag:
      - '"7e089c28-0000-0700-0000-647d5adf0000"'
      expires:
      - '-1'
      mise-correlation-id:
      - 0002f49c-2093-42dc-82fc-facfe458b2c6
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-providerhub-traffic:
      - 'True'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition update
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --display-name --description -a --package-file-uri --lock-level --deployment-mode
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-resource/23.0.1 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/clitest.rg000001?api-version=2022-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001","name":"clitest.rg000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","test":"test_managed_app_def_deployment_mode","date":"2023-06-05T03:47:13Z","module":"resource"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      connection:
      - close
      content-length:
      - '376'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:44 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "properties": {"lockLevel": "None", "displayName":
      "test_appdef000004", "authorizations": [{"principalId": "a2102d4c-0da3-49d6-a67e-f73263b3b311",
      "roleDefinitionId": "b24988ac-6180-42a0-ab88-20f7382dd24c"}], "description":
      "test", "packageFileUri": "https://raw.githubusercontent.com/Azure/azure-managedapp-samples/master/Managed%20Application%20Sample%20Packages/201-managed-storage-account/managedstorage.zip",
      "deploymentPolicy": {"deploymentMode": "Complete"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition update
      Connection:
      - keep-alive
      Content-Length:
      - '489'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g --display-name --description -a --package-file-uri --lock-level --deployment-mode
      User-Agent:
      - AZURECLI/2.49.0 azsdk-python-azure-mgmt-resource/23.0.1 Python/3.10.9 (Windows-10-10.0.22621-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003?api-version=2019-07-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003","name":"def000003","type":"microsoft.solutions/applicationdefinitions","location":"westus","etag":"\"7e089c28-0000-0700-0000-647d5adf0000\"","systemData":{"createdBy":"v-jingszhang@microsoft.com","createdByType":"User","createdAt":"2023-06-05T03:47:41.4929579Z","lastModifiedBy":"v-jingszhang@microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2023-06-05T03:47:46.082846Z"},"properties":{"deploymentPolicy":{"deploymentMode":"Complete"},"authorizations":[{"principalId":"a2102d4c-0da3-49d6-a67e-f73263b3b311","roleDefinitionId":"b24988ac-6180-42a0-ab88-20f7382dd24c"}],"isEnabled":true,"lockLevel":"None","displayName":"test_appdef000004","description":"test","artifacts":[{"name":"ApplicationResourceTemplate","type":"Template","uri":"https://amastorageprodus.blob.core.windows.net/applicationdefinitions/8C96E_0B1F64711BF04DDAAEC3CB9272F09590_899F9C6394E71F7A91E6AC4961C8DC1477E5CDDE7B90DEA577E19D94C7A69C94/76b8ccc0651d4e12aee836390187d9cc/applicationResourceTemplate.json"},{"name":"CreateUiDefinition","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003/applicationArtifacts/CreateUiDefinition?api-version=2017-09-01"},{"name":"MainTemplateParameters","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/def000003/applicationArtifacts/MainTemplateParameters?api-version=2017-09-01"}],"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1769'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 05 Jun 2023 03:47:46 GMT
      etag:
      - '"7e08bb29-0000-0700-0000-647d5ae20000"'
      expires:
      - '-1'
      mise-correlation-id:
      - 971978db-bf14-403d-a665-188078a8171e
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-providerhub-traffic:
      - 'True'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 200
      message: OK
version: 1
