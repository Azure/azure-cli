interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -m --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '202'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-tenant-policy-insights-requests:
      - '199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -m --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/mgtestrg-centralus/providers/microsoft.storage/storageaccounts/multilevelmgtestsa","numRecords":2},{"@odata.id":null,"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cloud-shell-storage-westus/providers/microsoft.storage/storageaccounts/cs4e78961ba36fex4739x921","numRecords":2}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1290'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-tenant-policy-insights-requests:
      - '199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -m --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":21,"nonCompliantPolicies":8,"resourceDetails":[{"complianceState":"noncompliant","count":21}],"policyDetails":[{"complianceState":"noncompliant","count":8}],"policyGroupDetails":[{"complianceState":"noncompliant","count":11}]},"policyAssignments":[{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''","nonCompliantResources":17,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":17}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditusageofcustomrbacrules","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''auditusageofcustomrbacrules''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"previewauditaccountswithownerpermissionswhoarenotmfaenabledonasubscription","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''previewauditaccountswithownerpermissionswhoarenotmfaenabledonasubscription''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditunrestrictednetworkaccesstostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''
        and PolicyDefinitionReferenceId eq ''auditunrestrictednetworkaccesstostorageaccounts''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"previewauditmaximumnumberofownersforasubscription","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''previewauditmaximumnumberofownersforasubscription''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditsecuretransfertostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''auditsecuretransfertostorageaccounts''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":17,"resourceDetails":[{"complianceState":"noncompliant","count":17}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicyDefinitionId eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''","nonCompliantResources":3,"nonCompliantPolicies":2,"resourceDetails":[{"complianceState":"noncompliant","count":3}],"policyDetails":[{"complianceState":"noncompliant","count":2}],"policyGroupDetails":[{"complianceState":"noncompliant","count":4}]},"policyDefinitions":[{"policyDefinitionGroupNames":["nist_sp_800-53_r4_ac-17(1)","nist_sp_800-53_r4_sc-7"],"policyDefinitionReferenceId":"auditunrestrictednetworkaccesstostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''
        and PolicyDefinitionReferenceId eq ''auditunrestrictednetworkaccesstostorageaccounts''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":2}]}},{"policyDefinitionGroupNames":["nist_sp_800-53_r4_au-5","nist_sp_800-53_r4_au-12"],"policyDefinitionReferenceId":"auditdiagnosticsetting","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9''
        and PolicyDefinitionReferenceId eq ''auditdiagnosticsetting''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":2}]}}],"policyGroups":[{"policyGroupName":"nist_sp_800-53_r4_ac-17(1)","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_ac-17(1)'' in PolicyDefinitionGroupNames","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_sc-7","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_sc-7'' in PolicyDefinitionGroupNames","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_au-5","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_au-5'' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_au-12","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_au-12'' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/providers/Microsoft.Management/managementGroups/azgovtest5/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]}]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '46485'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-tenant-policy-insights-requests:
      - '199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '194'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/mgtestrg-centralus/providers/microsoft.storage/storageaccounts/multilevelmgtestsa","numRecords":2},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cloud-shell-storage-westus/providers/microsoft.storage/storageaccounts/cs4e78961ba36fex4739x921","numRecords":2}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1266'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":21,"nonCompliantPolicies":8,"resourceDetails":[{"complianceState":"noncompliant","count":21}],"policyDetails":[{"complianceState":"noncompliant","count":8}],"policyGroupDetails":[{"complianceState":"noncompliant","count":11}]},"policyAssignments":[{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''","nonCompliantResources":19,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identityenablemfaforownerpermissionsmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''identityenablemfaforownerpermissionsmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"securetransfertostorageaccountmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''securetransfertostorageaccountmonitoring''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"userbacrulesmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''userbacrulesmonitoring''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"identitydesignatelessthanownersmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''identitydesignatelessthanownersmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":19,"resourceDetails":[{"complianceState":"noncompliant","count":19}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''","nonCompliantResources":17,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":17}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"previewauditaccountswithownerpermissionswhoarenotmfaenabledonasubscription","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed''
        and PolicyDefinitionReferenceId eq ''previewauditaccountswithownerpermissionswhoarenotmfaenabledonasubscription''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"previewauditmaximumnumberofownersforasubscription","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c''
        and PolicyDefinitionReferenceId eq ''previewauditmaximumnumberofownersforasubscription''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditusageofcustomrbacrules","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5''
        and PolicyDefinitionReferenceId eq ''auditusageofcustomrbacrules''","nonCompliantResources":12,"resourceDetails":[{"complianceState":"noncompliant","count":12}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditsecuretransfertostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9''
        and PolicyDefinitionReferenceId eq ''auditsecuretransfertostorageaccounts''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"auditunrestrictednetworkaccesstostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''
        and PolicyDefinitionReferenceId eq ''auditunrestrictednetworkaccesstostorageaccounts''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/83a3c1f3cf33463886201bc2''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":17,"resourceDetails":[{"complianceState":"noncompliant","count":17}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicyDefinitionId eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''","nonCompliantResources":3,"nonCompliantPolicies":2,"resourceDetails":[{"complianceState":"noncompliant","count":3}],"policyDetails":[{"complianceState":"noncompliant","count":2}],"policyGroupDetails":[{"complianceState":"noncompliant","count":4}]},"policyDefinitions":[{"policyDefinitionGroupNames":["nist_sp_800-53_r4_au-5","nist_sp_800-53_r4_au-12"],"policyDefinitionReferenceId":"auditdiagnosticsetting","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9''
        and PolicyDefinitionReferenceId eq ''auditdiagnosticsetting''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":2}]}},{"policyDefinitionGroupNames":["nist_sp_800-53_r4_ac-17(1)","nist_sp_800-53_r4_sc-7"],"policyDefinitionReferenceId":"auditunrestrictednetworkaccesstostorageaccounts","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''
        and PolicyDefinitionReferenceId eq ''auditunrestrictednetworkaccesstostorageaccounts''","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":2}]}}],"policyGroups":[{"policyGroupName":"nist_sp_800-53_r4_au-5","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_au-5'' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_au-12","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_au-12'' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_ac-17(1)","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_ac-17(1)'' in PolicyDefinitionGroupNames","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}},{"policyGroupName":"nist_sp_800-53_r4_sc-7","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/sandipsh/providers/microsoft.authorization/policyassignments/8e6d811f59d145db97ca9f16''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f''
        and ''nist_sp_800-53_r4_sc-7'' in PolicyDefinitionGroupNames","nonCompliantResources":2,"resourceDetails":[{"complianceState":"noncompliant","count":2}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]}]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '46109'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -g --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '234'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -g --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '233'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -g --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/defaultresourcegroup-eus/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '929'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '268'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:14 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv","numRecords":1},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv","numRecords":1}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1420'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:15 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":1,"nonCompliantPolicies":5,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":5}],"policyGroupDetails":[{"complianceState":"noncompliant","count":5}]},"policyAssignments":[{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4e4179ff39194a62bad4ef3e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.authorization/policyassignments/8a4555d353ed46bb856e9890''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/1e4e70f9cd4846268b6998ee''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicyDefinitionId eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''","nonCompliantResources":1,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effect":"auditifnotexists","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21''
        and PolicyDefinitionReferenceId eq ''diagnosticslogsinkeyvaultmonitoring''","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e''
        and PolicySetDefinitionId eq ''/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8''
        and '''' in PolicyDefinitionGroupNames","nonCompliantResources":1,"resourceDetails":[{"complianceState":"noncompliant","count":1}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]}]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '16998'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type -g --from --to --filter --apply --select
        --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '265'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type -g --from --to --filter --apply --select
        --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '264'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:17 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type -g --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1022'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:18 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type --parent -g --from --to --filter --apply
        --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '291'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:19 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type --parent -g --from --to --filter --apply
        --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '290'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:20 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --namespace --resource-type --parent -g --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/microsoft.network/virtualnetworks/cheggvnet/subnets/subnet2/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1100'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:21 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -s --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '286'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:21 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -s --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '285'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:21 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -s --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1085'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -d --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '283'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -d --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '282'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:24 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -d --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1076'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:25 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '271'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cloud-shell-storage-westus/providers/microsoft.storage/storageaccounts/cs4e78961ba36fex4739x921","numRecords":1},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/mgtestrg-centralus/providers/microsoft.storage/storageaccounts/multilevelmgtestsa","numRecords":1}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1481'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyAssignments":[{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e","policySetDefinitionId":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''","nonCompliantResources":4,"nonCompliantPolicies":1,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]},"policyDefinitions":[{"policyDefinitionGroupNames":[""],"policyDefinitionReferenceId":"","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicyDefinitionId eq ''/providers/microsoft.authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c''","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}],"policyGroups":[{"policyGroupName":"","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4d31128e32d04a0098fd536e/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false) and PolicyAssignmentId
        eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/4d31128e32d04a0098fd536e''
        and PolicySetDefinitionId eq '''' and '''' in PolicyDefinitionGroupNames","nonCompliantResources":4,"resourceDetails":[{"complianceState":"noncompliant","count":4}],"policyDetails":[{"complianceState":"noncompliant","count":1}],"policyGroupDetails":[{"complianceState":"noncompliant","count":1}]}}]}]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '4051'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:27 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '594'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy event list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a -g --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '298'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:28 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '594'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a -g --from --to --filter --apply --select --order-by --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":0,"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '297'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '593'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state summarize
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -a -g --from --to --filter --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2019-10-01&$top=2&$from=2020-01-01T00%3A00%3A00.000Z&$to=2020-01-10T22%3A30%3A00.000Z&$filter=isCompliant%20eq%20false
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/f32eeddfc32345b585f9a70b/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$from=2020-01-01
        00:00:00Z&$to=2020-01-10 22:30:00Z&$filter=(isCompliant eq false)","nonCompliantResources":0,"nonCompliantPolicies":0,"resourceDetails":[],"policyDetails":[],"policyGroupDetails":[]},"policyAssignments":[]}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1121'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '592'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy state list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --resource --expand --top
      User-Agent:
      - python/3.8.0 (Windows-10-10.0.18362-SP0) msrest/0.6.10 msrest_azure/0.6.2
        azure-mgmt-policyinsights/0.4.0 Azure-SDK-For-Python AZURECLI/2.0.79
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2019-10-01&$top=2&$expand=PolicyEvaluationDetails
  response:
    body:
      string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","timestamp":"2020-01-10T19:05:27.8428283Z","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/d58dea05c8704a33b6c8e43e","policyDefinitionId":"/providers/microsoft.authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","effectiveParameters":"","isCompliant":false,"subscriptionId":"e78961ba-36fe-4739-9212-e3031b4c8db7","resourceType":"/Microsoft.KeyVault/vaults","resourceLocation":"westus","resourceGroup":"cheggpolicy","resourceTags":"tbd","policyAssignmentName":"d58dea05c8704a33b6c8e43e","policyAssignmentOwner":"tbd","policyAssignmentParameters":"","policyAssignmentScope":"/subscriptions/00000000-0000-0000-0000-000000000000","policyDefinitionName":"cf820ca0-f99e-4f3e-84fb-66e913812d21","policyDefinitionAction":"auditifnotexists","policyDefinitionCategory":"tbd","policySetDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","policySetDefinitionName":"1f3afdf9-d0c9-4c3d-847f-89da613e70a8","policySetDefinitionOwner":"","policySetDefinitionCategory":"security
        center","policySetDefinitionParameters":"","managementGroupIds":"PolicyUIMG,AzGovTest5,72f988bf-86f1-41af-91ab-2d7cd011db47","policyDefinitionReferenceId":"diagnosticslogsinkeyvaultmonitoring","complianceState":"NonCompliant","policyDefinitionGroupNames":[""],"policyEvaluationDetails":{"ifNotExistsDetails":{"totalResources":0,"requestUri":"https://management.azure.com:443/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.KeyVault/vaults/cheggtmpkv/providers/microsoft.insights/diagnosticSettings?api-version=2017-05-01-preview"}}},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","timestamp":"2020-01-10T19:05:27.8427723Z","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.keyvault/vaults/cheggtmpkv","policyAssignmentId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policyassignments/f32eeddfc32345b585f9a70b","policyDefinitionId":"/providers/microsoft.management/managementgroups/azgovtest5/providers/microsoft.authorization/policydefinitions/f7ca2f01-f4fe-4647-9e39-13dd20167c38","effectiveParameters":"","isCompliant":false,"subscriptionId":"e78961ba-36fe-4739-9212-e3031b4c8db7","resourceType":"/Microsoft.KeyVault/vaults","resourceLocation":"westus","resourceGroup":"cheggpolicy","resourceTags":"tbd","policyAssignmentName":"f32eeddfc32345b585f9a70b","policyAssignmentOwner":"tbd","policyAssignmentParameters":"","policyAssignmentScope":"/providers/Microsoft.Management/managementGroups/AzGovTest5","policyDefinitionName":"f7ca2f01-f4fe-4647-9e39-13dd20167c38","policyDefinitionAction":"auditifnotexists","policyDefinitionCategory":"tbd","policySetDefinitionId":"","policySetDefinitionName":"","policySetDefinitionOwner":"","policySetDefinitionCategory":"","policySetDefinitionParameters":"","managementGroupIds":"PolicyUIMG,AzGovTest5,72f988bf-86f1-41af-91ab-2d7cd011db47","policyDefinitionReferenceId":"","complianceState":"NonCompliant","policyDefinitionGroupNames":[""],"policyEvaluationDetails":{"ifNotExistsDetails":{"totalResources":0,"requestUri":"https://management.azure.com:443/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/Microsoft.KeyVault/vaults/cheggtmpkv/providers/microsoft.insights/diagnosticSettings?api-version=2017-05-01-preview"}}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '4369'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 10 Jan 2020 22:34:31 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
version: 1
