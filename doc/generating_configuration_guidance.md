# Generating Configuration Guidance

[Azdev](https://github.com/Azure/azure-cli-dev-tools) supports to generate a snapshot of command interfaces for a specified module since version 0.2.0.

## Output

### Folder structure
After generation, there will be a folder named `configuration` under the module dir. The subdirectories of `configuration` are named by profiles, such as `latest`, `2020-09-01-hybrid` and `2019-03-01-hybrid`.
Each profile named folder contains two json files named `commands.json` and `examples.json` respectively.

```
- <module dir>
    - ...
    - configuration
        - latest
            - commands.json
            - examples.json
        - 2020-09-01-hybrid
            - commands.json
            - examples.json
        - <other profile name>
            - commands.json
            - examples.json
```

### Simple Schema of `commands.json`

The schema of commands is a tree composed of `command group` nodes, `command` nodes and `argument` nodes.
Its root is a command group node names `az`. In our example, it's the father of sub command group names `network`,
and `network` is the father of command nodes (`list-service-aliases` and `list-service-tags`) and
command group nodes (`application-gateway`, `dns` and `lb`), and a command node, such as `create`, is the father of argument nodes.

```
{
  "az": {
    "full-name": "",
    "command-groups": {
      "network": {
        "full-name": "network",
        "help": "Manage Azure Network resources.",
        "commands": {
          "list-service-aliases": {
            "full-name": "network list-service-aliases",
            ...
          },
          "list-service-tags": {
            "full-name": "network list-service-tags",
            ...
          }
        },
        "command-groups": {
          "application-gateway": {
            "full-name": "network application-gateway",
            "help": {
              "short-summary": "Manage application-level routing and load balancing services.",
              "long-summary": "To learn more about Application Gateway, visit https://docs.microsoft.com/azure/application-gateway/application-gateway-create-gateway-cli"
            },
            "commands": {
              "create": {
                "full-name": "network application-gateway create",
                "help": "Create an application gateway.",
                "operation": "@.custom#create_application_gateway",
                "arguments": {
                  "application_gateway_name": {
                    ...
                  },
                  "connection_draining_timeout": {
                    "min-api": "2016-12-01",
                    "options": [
                      "--connection-draining-timeout"
                    ],
                    "help": "The time in seconds after a backend server is removed during which on open connection remains active. Range: 0 (disabled) to 3600",
                    "arg-group": "Gateway"
                  }
                }
              },
              "delete": {
                "full-name": "network application-gateway delete",
                ...
              }
            },
            "command-groups": {
              "address-pool": {
                "full-name": "network application-gateway address-pool",
                ...
              },
              "auth-cert": {
                "full-name": "network application-gateway auth-cert",
                ...
              }
            }
          },
          "dns": {
            "full-name": "network dns",
            ...
          },
          "lb": {
            "full-name": "network lb",
            ...
          }
        }
      }
    }
  }
}
```

### Simple Schema of `examples.json`

The schema is also a tree composed of `command group` nodes and `command` nodes. The examples will be in the corresponding command node.

```
{
  "az": {
    "command-groups": {
      "network": {
        "commands": {
          "list-service-aliases": [
            {
              "autogenerated": true,
              "name": "List available service aliases in the region which can be used for Service Endpoint Policies. (autogenerated)",
              "text": "az network list-service-aliases --location westus2"
            }
          ],
          "list-service-tags": [
            {
              "autogenerated": true,
              "name": "Gets a list of service tag information resources. (autogenerated)",
              "text": "az network list-service-tags --location westus2"
            }
          ],
          "list-usages": [
            ...
          ]
        },
        "command-groups": {
          "application-gateway": {
            "commands": {
              "create": [
                {
                  "name": "Create an application gateway with VMs as backend servers.",
                  "text": "az network application-gateway create -g MyResourceGroup -n MyAppGateway --capacity 2 --sku Standard_Medium --vnet-name MyVNet --subnet MySubnet --http-settings-cookie-based-affinity Enabled --public-ip-address MyAppGatewayPublicIp --servers 10.0.0.4 10.0.0.5"
                },
                {
                  "autogenerated": true,
                  "name": "Create an application gateway. (autogenerated)",
                  "text": "az network application-gateway create --capacity 2 --frontend-port MyFrontendPort --http-settings-cookie-based-affinity Enabled --http-settings-port 80 --http-settings-protocol Http --location westus2 --name MyAppGateway --public-ip-address MyAppGatewayPublicIp --resource-group MyResourceGroup --sku Standard_Small --subnet MySubnet --vnet-name MyVNet"
                }
              ],
              "delete": [
                ...
              ]
            },
            "command-groups": {
              "address-pool": {
                ...
              },
              "auth-cert": {
                ...
              }
            }
          },
          "dns": {
            ...
          },
          "lb": {
            ...
          }
        }
      }
    }
  }
}
```

