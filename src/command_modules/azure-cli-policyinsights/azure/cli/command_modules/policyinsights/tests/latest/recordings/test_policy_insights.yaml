interactions:
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy event list]
      Connection: [keep-alive]
      Content-Length: ['0']
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.5 (Windows-10-10.0.16299-SP0) requests/2.18.4 msrest/0.4.29
          msrest_azure/0.4.29 azure-mgmt-policyinsights/0.1.0 Azure-SDK-For-Python
          AZURECLI/2.0.33]
      accept-language: [en-US]
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/default/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$filter=policyDefinitionAction%20eq%20%27audit%27&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body: {string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/ddd8ef92e3714a5ea3d208c1","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/databricks-rg-topology-private-gk-5ipya7gfhnzaw/providers/microsoft.network/virtualnetworks/workers-vnet/subnets/public-subnet","numRecords":15798},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyEvents/$metadata#default/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/databricks-rg-topology-private-gk-5ipya7gfhnzaw/providers/microsoft.network/virtualnetworks/workers-vnet/subnets/public-subnet","numRecords":15798}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1337']
      content-type: [application/json; charset=utf-8]
      date: ['Thu, 17 May 2018 18:58:42 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy state list]
      Connection: [keep-alive]
      Content-Length: ['0']
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.5 (Windows-10-10.0.16299-SP0) requests/2.18.4 msrest/0.4.29
          msrest_azure/0.4.29 azure-mgmt-policyinsights/0.1.0 Azure-SDK-For-Python
          AZURECLI/2.0.33]
      accept-language: [en-US]
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$top=2&$orderby=numRecords%20desc&$select=policyAssignmentId%2C%20resourceId%2C%20numRecords&$filter=policyDefinitionAction%20eq%20%27audit%27&$apply=groupby%28%28policyAssignmentId%2C%20resourceId%29%2C%20aggregate%28%24count%20as%20numRecords%29%29
  response:
    body: {string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest","@odata.count":2,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/carolyntestpolicyrg/providers/microsoft.authorization/policyassignments/93d652e091fa446e87eaec54","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/carolyntestpolicyrg/providers/microsoft.storage/storageaccounts/carolynbasicsatest","numRecords":5},{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#latest/$entity","policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/ddd8ef92e3714a5ea3d208c1","resourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cheggpolicy/providers/microsoft.storage/storageaccounts/cheggsqlauditing","numRecords":5}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1263']
      content-type: [application/json; charset=utf-8]
      date: ['Thu, 17 May 2018 18:58:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy state summarize]
      Connection: [keep-alive]
      Content-Length: ['0']
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.5 (Windows-10-10.0.16299-SP0) requests/2.18.4 msrest/0.4.29
          msrest_azure/0.4.29 azure-mgmt-policyinsights/0.1.0 Azure-SDK-For-Python
          AZURECLI/2.0.33]
      accept-language: [en-US]
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/summarize?api-version=2018-04-04&$top=2&$filter=policyDefinitionAction%20eq%20%27audit%27
  response:
    body: {string: '{"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary","@odata.count":1,"value":[{"@odata.id":null,"@odata.context":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/$metadata#summary/$entity","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false","nonCompliantResources":4856,"nonCompliantPolicies":22},"policyAssignments":[{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/3c53617ee139444db82514a5","policySetDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policysetdefinitions/5c7950f6-99c0-4ead-a646-b0b9b7832559","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/3c53617ee139444db82514a5''","nonCompliantResources":4856,"nonCompliantPolicies":1},"policyDefinitions":[{"policyDefinitionReferenceId":"1748719353954991994","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/textboxdefaultvalue","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/3c53617ee139444db82514a5''
        and PolicyDefinitionId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/textboxdefaultvalue''
        and PolicyDefinitionReferenceId eq ''1748719353954991994''","nonCompliantResources":4856}}]},{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01","policySetDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policysetdefinitions/a03db67e-a286-43c3-9098-b2da83d361ad","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01''","nonCompliantResources":4473,"nonCompliantPolicies":3},"policyDefinitions":[{"policyDefinitionReferenceId":"8935913113203900114","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01''
        and PolicyDefinitionId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474''
        and PolicyDefinitionReferenceId eq ''8935913113203900114''","nonCompliantResources":4455}},{"policyDefinitionReferenceId":"4859121137597195236","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01''
        and PolicyDefinitionId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474''
        and PolicyDefinitionReferenceId eq ''4859121137597195236''","nonCompliantResources":4170}},{"policyDefinitionReferenceId":"4047897157028507992","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","effect":"audit","results":{"queryResultsUri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/policyStates/latest/queryResults?api-version=2018-04-04&$from=2018-05-16
        18:58:45Z&$to=2018-05-17 18:58:45Z&$filter=(policyDefinitionAction eq ''audit'')
        and IsCompliant eq false and PolicyAssignmentId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/e46af646ebdb461dba708e01''
        and PolicyDefinitionId eq ''/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policydefinitions/c8b79b49-a579-4045-984e-1b249ab8b474''
        and PolicyDefinitionReferenceId eq ''4047897157028507992''","nonCompliantResources":1449}}]}]}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['6398']
      content-type: [application/json; charset=utf-8]
      date: ['Thu, 17 May 2018 18:58:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
version: 1
