interactions:
- request:
    body: '{"location": "westcentralus", "properties": {"lockLevel": "None", "displayName":
      "test_appdef_123", "authorizations": [{"principalId": "872b463c-9606-4c8c-92a2-571a4d018650",
      "roleDefinitionId": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635"}], "description":
      "test_appdef_123", "packageFileUri": "https://github.com/Azure/azure-managedapp-samples/raw/master/Managed%20Application%20Sample%20Packages/201-managed-storage-account/managedstorage.zip"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition create
      Connection:
      - keep-alive
      Content-Length:
      - '442'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n --package-file-uri --display-name --description -l -a --lock-level -g
      User-Agent:
      - python/3.8.2 (Windows-10-10.0.18362-SP0) msrest/0.6.11 msrest_azure/0.6.3
        azure-mgmt-resource/2017-09-01 Azure-SDK-For-Python AZURECLI/2.7.0
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname?api-version=2018-06-01
  response:
    body:
      string: '{"properties":{"authorizations":[{"principalId":"872b463c-9606-4c8c-92a2-571a4d018650","roleDefinitionId":"8e3af657-a8ff-443c-a75c-2fe8c4bcb635"}],"isEnabled":true,"lockLevel":"None","displayName":"test_appdef_123","description":"test_appdef_123","artifacts":[{"name":"ApplicationResourceTemplate","type":"Template","uri":"https://prdsapplianceprodcy01.blob.core.windows.net/applicationdefinitions/E79C9_B9F138A11D64410884139EA3BE1C1B2D_D3FFCA55D015F58F2E81E978E8D86D146C9BF4C8/fc0c53a6c7244b67a4630679c1ec7c45/applicationResourceTemplate.json"},{"name":"CreateUiDefinition","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname/applicationArtifacts/CreateUiDefinition?api-version=2017-09-01"},{"name":"MainTemplateParameters","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname/applicationArtifacts/MainTemplateParameters?api-version=2017-09-01"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname","name":"testappdefname","type":"Microsoft.Solutions/applicationDefinitions","location":"westcentralus"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1589'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 12 Jun 2020 03:45:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp definition create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n --package-file-uri --display-name --description -l -a --lock-level -g
      User-Agent:
      - python/3.8.2 (Windows-10-10.0.18362-SP0) msrest/0.6.11 msrest_azure/0.6.3
        azure-mgmt-resource/2017-09-01 Azure-SDK-For-Python AZURECLI/2.7.0
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname?api-version=2018-06-01
  response:
    body:
      string: '{"properties":{"authorizations":[{"principalId":"872b463c-9606-4c8c-92a2-571a4d018650","roleDefinitionId":"8e3af657-a8ff-443c-a75c-2fe8c4bcb635"}],"isEnabled":true,"lockLevel":"None","displayName":"test_appdef_123","description":"test_appdef_123","artifacts":[{"name":"ApplicationResourceTemplate","type":"Template","uri":"https://prdsapplianceprodcy01.blob.core.windows.net/applicationdefinitions/E79C9_B9F138A11D64410884139EA3BE1C1B2D_D3FFCA55D015F58F2E81E978E8D86D146C9BF4C8/fc0c53a6c7244b67a4630679c1ec7c45/applicationResourceTemplate.json"},{"name":"CreateUiDefinition","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname/applicationArtifacts/CreateUiDefinition?api-version=2017-09-01"},{"name":"MainTemplateParameters","type":"Custom","uri":"https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname/applicationArtifacts/MainTemplateParameters?api-version=2017-09-01"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname","name":"testappdefname","type":"Microsoft.Solutions/applicationDefinitions","location":"westcentralus"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1589'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 12 Jun 2020 03:45:46 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: 'b''{"location": "westcentralus", "properties": {"managedResourceGroupId":
      "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/climanagedapp000002",
      "applicationDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname",
      "parameters": {"storageAccountNamePrefix": {"value": "mytest"}, "storageAccountType":
      {"value": "Standard_LRS"}}}, "kind": "servicecatalog"}'''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp create
      Connection:
      - keep-alive
      Content-Length:
      - '548'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -g -l --kind -m -d --parameters
      User-Agent:
      - python/3.8.2 (Windows-10-10.0.18362-SP0) msrest/0.6.11 msrest_azure/0.6.3
        azure-mgmt-resource/2017-09-01 Azure-SDK-For-Python AZURECLI/2.7.0
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applications/mymanagedapp?api-version=2018-06-01
  response:
    body:
      string: '{"properties":{"managedResourceGroupId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/climanagedapp000002","applicationDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname","publisherPackageId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applicationDefinitions/testappdefname","provisioningState":"Accepted","authorizations":[{"principalId":"872b463c-9606-4c8c-92a2-571a4d018650","roleDefinitionId":"8e3af657-a8ff-443c-a75c-2fe8c4bcb635"}],"createdBy":{"oid":"b8aeaa91-5c34-4947-9a7c-3c9bc2ca8271","puid":"100320007298804A","applicationId":"04b07795-8ddb-461a-bbee-02f9e1bf7b46"},"updatedBy":{"oid":"b8aeaa91-5c34-4947-9a7c-3c9bc2ca8271","puid":"100320007298804A","applicationId":"04b07795-8ddb-461a-bbee-02f9e1bf7b46"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/applications/mymanagedapp","name":"mymanagedapp","type":"Microsoft.Solutions/applications","kind":"servicecatalog","location":"westcentralus"}'
    headers:
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/locations/westcentralus/operationStatuses/eyJmdWxseVF1YWxpZmllZEFwcGxpYW5jZUlkIjoiL3N1YnNjcmlwdGlvbnMvYjlmMTM4YTEtMWQ2NC00MTA4LTg0MTMtOWVhM2JlMWMxYjJkL3Jlc291cmNlR3JvdXBzL2NsaXRlc3Qucmd0bmJnZW9naXdrM2gya3YzYmoyNWVudGlsaXFsbW5wZDd6d2xxaTZ4ZjdrbjZvb3h2NzNqbm83dTN3ZGozdnczbC9wcm92aWRlcnMvTWljcm9zb2Z0LlNvbHV0aW9ucy9hcHBsaWNhdGlvbnMvbXltYW5hZ2VkYXBwIiwiam9iSWQiOiJBcHBsaWFuY2VQcm92aXNpb25pbmdKb2I6MkRSR0E6MkRDTElURVNUOjNBMkVSR1ROQkdFT0dJV0szSDJLVjNCSjI1RU5USUxJUUxNTlBEN1pXOjdDNjcyOTIxQjc4NDExNkM2RDoyRE1ZTUFOQUdFREFQUCJ9?api-version=2018-06-01
      cache-control:
      - no-cache
      content-length:
      - '1373'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 12 Jun 2020 03:45:50 GMT
      expires:
      - '-1'
      location:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/locations/westcentralus/operationStatuses/eyJmdWxseVF1YWxpZmllZEFwcGxpYW5jZUlkIjoiL3N1YnNjcmlwdGlvbnMvYjlmMTM4YTEtMWQ2NC00MTA4LTg0MTMtOWVhM2JlMWMxYjJkL3Jlc291cmNlR3JvdXBzL2NsaXRlc3Qucmd0bmJnZW9naXdrM2gya3YzYmoyNWVudGlsaXFsbW5wZDd6d2xxaTZ4ZjdrbjZvb3h2NzNqbm83dTN3ZGozdnczbC9wcm92aWRlcnMvTWljcm9zb2Z0LlNvbHV0aW9ucy9hcHBsaWNhdGlvbnMvbXltYW5hZ2VkYXBwIiwiam9iSWQiOiJBcHBsaWFuY2VQcm92aXNpb25pbmdKb2I6MkRSR0E6MkRDTElURVNUOjNBMkVSR1ROQkdFT0dJV0szSDJLVjNCSjI1RU5USUxJUUxNTlBEN1pXOjdDNjcyOTIxQjc4NDExNkM2RDoyRE1ZTUFOQUdFREFQUCJ9?api-version=2018-06-01
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - managedapp create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -l --kind -m -d --parameters
      User-Agent:
      - python/3.8.2 (Windows-10-10.0.18362-SP0) msrest/0.6.11 msrest_azure/0.6.3
        azure-mgmt-resource/2017-09-01 Azure-SDK-For-Python AZURECLI/2.7.0
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/clitest.rg000001/providers/Microsoft.Solutions/locations/westcentralus/operationStatuses/eyJmdWxseVF1YWxpZmllZEFwcGxpYW5jZUlkIjoiL3N1YnNjcmlwdGlvbnMvYjlmMTM4YTEtMWQ2NC00MTA4LTg0MTMtOWVhM2JlMWMxYjJkL3Jlc291cmNlR3JvdXBzL2NsaXRlc3Qucmd0bmJnZW9naXdrM2gya3YzYmoyNWVudGlsaXFsbW5wZDd6d2xxaTZ4ZjdrbjZvb3h2NzNqbm83dTN3ZGozdnczbC9wcm92aWRlcnMvTWljcm9zb2Z0LlNvbHV0aW9ucy9hcHBsaWNhdGlvbnMvbXltYW5hZ2VkYXBwIiwiam9iSWQiOiJBcHBsaWFuY2VQcm92aXNpb25pbmdKb2I6MkRSR0E6MkRDTElURVNUOjNBMkVSR1ROQkdFT0dJV0szSDJLVjNCSjI1RU5USUxJUUxNTlBEN1pXOjdDNjcyOTIxQjc4NDExNkM2RDoyRE1ZTUFOQUdFREFQUCJ9?api-version=2018-06-01
  response:
    body:
      string: '{"status":"Failed","error":{"code":"ApplianceProvisioningFailed","message":"Principal
        872b463c96064c8c92a2571a4d018650 does not exist in the directory 72f988bf-86f1-41af-91ab-2d7cd011db47.:Principal
        872b463c96064c8c92a2571a4d018650 does not exist in the directory 72f988bf-86f1-41af-91ab-2d7cd011db47."}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '304'
      content-type:
      - application/json; charset=utf-8
      date:
      - Fri, 12 Jun 2020 03:46:05 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
version: 1
