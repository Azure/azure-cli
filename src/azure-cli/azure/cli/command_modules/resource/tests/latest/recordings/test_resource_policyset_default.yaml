interactions:
- request:
    body: '{"location": "westus", "tags": {"product": "azurecli", "cause": "automation",
      "date": "2019-02-08T19:19:59Z"}}'
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [group create]
      Connection: [keep-alive]
      Content-Length: ['110']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [--location --name --tag]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          resourcemanagementclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policyset000001?api-version=2018-05-01
  response:
    body: {string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001","name":"cli_test_policyset000001","location":"westus","tags":{"product":"azurecli","cause":"automation","date":"2019-02-08T19:19:59Z"},"properties":{"provisioningState":"Succeeded"}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['384']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1199']
    status: {code: 201, message: Created}
- request:
    body: 'b''{"properties": {"displayName": "test_policy000003", "description": "desc_for_test_policy_123",
      "policyRule": {"if": {"not": {"field": "location", "in": "[parameters(\''allowedLocations\'')]"}},
      "then": {"effect": "deny"}}, "parameters": {"allowedLocations": {"type": "array",
      "metadata": {"description": "The list of locations that can be specified when
      deploying resources", "strongType": "location", "displayName": "Allowed locations"}}}}}'''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition create]
      Connection: [keep-alive]
      Content-Length: ['440']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-n --rules --params --display-name --description]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policy000003","policyType":"Custom","description":"desc_for_test_policy_123","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","type":"Microsoft.Authorization/policyDefinitions","name":"azure-cli-test-policy000002"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['670']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1198']
    status: {code: 201, message: Created}
- request:
    body: 'b''b\''{"properties": {"displayName": "test_policyset000005", "description":
      "desc_for_test_policyset_123", "policyDefinitions": [{"policyDefinitionId":
      "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002",
      "parameters": {"allowedLocations": {"value": ["australiaeast", "eastus", "japaneast",
      "westus"]}}}]}}\'''''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition create]
      Connection: [keep-alive]
      Content-Length: ['385']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-n --definitions --display-name --description]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005","policyType":"Custom","description":"desc_for_test_policyset_123","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['685']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1198']
    status: {code: 201, message: Created}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition update]
      Connection: [keep-alive]
      ParameterSetName: [-n --display-name --description]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005","policyType":"Custom","description":"desc_for_test_policyset_123","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['685']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: 'b''b\''{"properties": {"displayName": "test_policyset000005_new", "description":
      "desc_for_test_policyset_123_new", "policyDefinitions": [{"policyDefinitionId":
      "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002",
      "parameters": {"allowedLocations": {"value": ["australiaeast", "eastus", "japaneast",
      "westus"]}}}]}}\'''''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition update]
      Connection: [keep-alive]
      Content-Length: ['393']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-n --display-name --description]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['693']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:05 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1199']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition list]
      Connection: [keep-alive]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-05-01
  response:
    body: {string: '{"value":[{"properties":{"displayName":"[Preview]: Enable Monitoring
        in Azure Security Center","policyType":"BuiltIn","description":"Monitor all
        the available security recommendations in Azure Security Center. This is the
        default policy for Azure Security Center.","metadata":{"category":"Security
        Center"},"parameters":{"systemUpdatesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        system updates","description":"Enable or disable reporting of system updates"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        OS vulnerabilities","description":"Enable or disable OS vulnerabilities monitoring
        (based on a configured baseline)"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        endpoint protection","description":"Enable or disable endpoint protection
        monitoring"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disk encryption","description":"Enable or disable the monitoring for VM disk
        encryption"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        network security groups","description":"Enable or disable monitoring of network
        security groups with permissive rules"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        web application firewall","description":"Enable or disable the monitoring
        of unprotected web applications"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Enable
        Next Generation Firewall (NGFW) monitoring","description":"Enable or disable
        monitoring network endpoints without a Next Generation Firewall"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        vulnerability assesment","description":"Enable or disable the detection of
        VM vulnerabilities by a vulnerability assessment solution"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        storage blob encryption","description":"Enable or disable the monitoring of
        blob encryption for storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"jitNetworkAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        JIT network access","description":"Enable or disable the monitoring of network
        just In time access"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        application whitelisting","description":"Enable or disable the monitoring
        of application whitelisting in Azure Security Center"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL auditing","description":"Enable or disable the monitoring of unaudited
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlServerAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL Servers auditing","description":"Enable or disable the monitoring of unaudited
        SQL Servers"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInAppServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure App Services","description":"Enable or disable the
        monitoring of diagnostics logs in Azure App Services"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"encryptionOfAutomationAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        encryption of automation accounts","description":"Enable or disable the monitoring
        of automation account encryption"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Batch accounts","description":"Enable or disable the monitoring
        of diagnostic logs in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInBatchAccountRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) for logs in Batch accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"metricAlertsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        metric alerts in Batch accounts","description":"Enable or disable the monitoring
        of metric alerts in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"classicComputeVMsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic compute VMs","description":"Enable or disable the monitoring of classic
        compute VMs"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"classicStorageAccountsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic storage accounts","description":"Enable or disable the monitoring
        of classic storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Analytics accounts","description":"Enable or
        disable the monitoring of diagnostic logs in Data Lake Analytics accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Analytics accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Store accounts","description":"Enable or disable
        the monitoring of diagnostic logs in Data Lake Store accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Store accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Event Hub accounts","description":"Enable or disable the
        monitoring of diagnostic logs in Event Hub accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInEventHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Event Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Key Vault vaults","description":"Enable or disable the
        monitoring of diagnostic logs in Key Vault vaults"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Key Vault vaults","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Logic Apps workflows","description":"Enable or disable
        the monitoring of diagnostic logs in Logic Apps workflows"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Logic Apps workflows","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Redis Cache","description":"Enable or disable the
        monitoring of diagnostic logs in Azure Redis Cache"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Search service","description":"Enable or disable
        the monitoring of diagnostic logs in Azure Search service"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInSearchServiceRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Azure Search service","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"aadAuthenticationInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Azure Active Directory authentication in Service Fabric","description":"Enable
        or disable the monitoring of Azure Active Directory for client authentication
        in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        cluster protection level in Service Fabric","description":"Enable or disable
        the monitoring of cluster protection level in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Bus","description":"Enable or disable the monitoring
        of diagnostic logs in Service Bus"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInServiceBusRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Service Bus","description":"The required diagnostic
        logs retention period in days"},"defaultValue":"365"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Service Bus namespace authorization rules","description":"Enable or disable
        the monitoring of Service Bus namespace authorization rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the provisioning of an Azure AD admininistrator for SQL server","description":"Enable
        or disable the monitoring of an Azure AD admininistrator for SQL server"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the secure transfer to storage account","description":"Enable or disable the
        monitoring of secure transfer to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Stream Analytics","description":"Enable or disable the
        monitoring of diagnostic logs in Stream Analytics"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInStreamAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Stream Analytics","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"useRbacRulesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        of using built-in RBAC rules","description":"Enable or disable the monitoring
        of using built-in RBAC rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disabling of unrestricted network access to storage account","description":"Enable
        or disable the monitoring of network access to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Fabric","description":"Enable or disable the monitoring
        of diagnostic logs in Service Fabric"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"accessRulesInEventHubNamespaceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hub namespaces","description":"Enable or disable the
        monitoring of access rules in Event Hub namespaces"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"accessRulesInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hubs","description":"Enable or disable the monitoring
        of access rules in Event Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbVulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL vulnerability assessment results","description":"Enable or disable the
        monitoring of Vulnerability Assessment scan results and recommendations for
        how to remediate database vulnerabilities."},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateLessThanOwnersMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        maximum number of owners","description":"Enable or disable the monitoring
        of maximum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateMoreThanOneOwnerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        minimus number of owners","description":"Enable or disable the monitoring
        of minimum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with owner permissions","description":"Enable or disable
        the monitoring of MFA for accounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with write permissions","description":"Enable or disable
        the monitoring of MFA for accounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with read permissions","description":"Enable or disable the
        monitoring of MFA for accounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts with owner permissions","description":"Enable or
        disable the monitoring of deprecated acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts","description":"Enable or disable the monitoring
        of deprecated acounts in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with owner permissions","description":"Enable or
        disable the monitoring of external acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with write permissions","description":"Enable or
        disable the monitoring of external acounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with read permissions","description":"Enable or disable
        the monitoring of external acounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for API App","description":"Enable or disable the
        monitoring of IP restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Function App","description":"Enable or disable
        the monitoring of IP restrictions for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Web App","description":"Enable or disable the
        monitoring of IP restrictions for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for API App","description":"Enable or disable the
        monitoring of remote debugging for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Function App","description":"Enable or disable
        the monitoring of remote debugging for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Web App","description":"Enable or disable the
        monitoring of remote debugging for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for API App","description":"Enable or disable the monitoring
        of web sockets for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Function App","description":"Enable or disable the
        monitoring of web sockets for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Web App","description":"Enable or disable the monitoring
        of web sockets for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in API App","description":"Enable or disable the monitoring
        of the use of HTTPS in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in function App","description":"Enable or disable the monitoring
        of the use of HTTPS in function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in Web App","description":"Enable or disable the monitoring
        of the use of HTTPS in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API App","description":"Enable or disable the monitoring
        of CORS restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Function","description":"Enable or disable the
        monitoring of CORS restrictions for API Function"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Web","description":"Enable or disable the monitoring
        of CORS restrictions for API Web"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in API App","description":"Enable or disable the monitoring
        of custom domain use in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Function App","description":"Enable or disable the
        monitoring of custom domain use in Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Web App","description":"Enable or disable the monitoring
        of custom domain use in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in API App","description":"Enable or disable the monitoring
        of .Net version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in Web App","description":"Enable or disable the monitoring
        of .Net version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in API App","description":"Enable or disable the monitoring
        of Java version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in Web App","description":"Enable or disable the monitoring
        of Java version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestNodeJsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Node.js in Web App","description":"Enable or disable the monitoring
        of Node.js version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in API App","description":"Enable or disable the monitoring
        of PHP version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in Web App","description":"Enable or disable the monitoring
        of PHP version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in API App","description":"Enable or disable the monitoring
        of Python version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in Web App","description":"Enable or disable the monitoring
        of Python version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vnetEnableDDoSProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use of DDoS protection for virtual network","description":"Enable or disable
        the monitoring of DDoS protection for virtual network"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in IoT Hubs","description":"Enable or disable the monitoring
        of diagnostic logs in IoT Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in IoT Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"sqlServerAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL servers without Advanced Data Security","description":"Enable or disable
        the monitoring of SQL servers without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL managed instances without Advanced Data Security","description":"Enable
        or disable the monitoring of SQL managed instances without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyDefinitions":[{"policyDefinitionReferenceId":"diagnosticsLogsInIoTHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInIoTHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInIoTHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceFabricMonitoringEffect","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubNamespaceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubNamespaceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"disableUnrestrictedNetworkToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","parameters":{"effect":{"value":"[parameters(''disableUnrestrictedNetworkToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"useRbacRulesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","parameters":{"effect":{"value":"[parameters(''useRbacRulesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInStreamAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"secureTransferToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","parameters":{"effect":{"value":"[parameters(''secureTransferToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInSqlServerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInSqlServerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"namespaceAuthorizationRulesInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","parameters":{"effect":{"value":"[parameters(''namespaceAuthorizationRulesInServiceBusMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceBusMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInServiceBusRetentionDays'')]"}}},{"policyDefinitionReferenceId":"clusterProtectionLevelInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","parameters":{"effect":{"value":"[parameters(''clusterProtectionLevelInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInSearchServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInSearchServiceMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInSearchServiceRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInRedisCacheMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInRedisCacheMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInLogicAppsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInLogicAppsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInLogicAppsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInKeyVaultMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInKeyVaultMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInKeyVaultRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInEventHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInEventHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeStoreMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"classicStorageAccountsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","parameters":{"effect":{"value":"[parameters(''classicStorageAccountsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"classicComputeVMsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","parameters":{"effect":{"value":"[parameters(''classicComputeVMsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"metricAlertsInBatchAccountPoolDeleteStart","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","parameters":{"effect":{"value":"[parameters(''metricAlertsInBatchAccountMonitoringEffect'')]"},"metricName":{"value":"PoolDeleteStartEvent"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInBatchAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInBatchAccountMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInBatchAccountRetentionDays'')]"}}},{"policyDefinitionReferenceId":"encryptionOfAutomationAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","parameters":{"effect":{"value":"[parameters(''encryptionOfAutomationAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInAppServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInAppServiceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","parameters":{"effect":{"value":"[parameters(''sqlDbEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","parameters":{"effect":{"value":"[parameters(''sqlServerAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","parameters":{"effect":{"value":"[parameters(''sqlEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","parameters":{"effect":{"value":"[parameters(''sqlAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemUpdatesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","parameters":{"effect":{"value":"[parameters(''systemUpdatesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"storageEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{"effect":{"value":"[parameters(''storageEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"jitNetworkAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","parameters":{"effect":{"value":"[parameters(''jitNetworkAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"adaptiveApplicationControlsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","parameters":{"effect":{"value":"[parameters(''adaptiveApplicationControlsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"networkSecurityGroupsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","parameters":{"effect":{"value":"[parameters(''networkSecurityGroupsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemConfigurationsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","parameters":{"effect":{"value":"[parameters(''systemConfigurationsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"endpointProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","parameters":{"effect":{"value":"[parameters(''endpointProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diskEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","parameters":{"effect":{"value":"[parameters(''diskEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","parameters":{"effect":{"value":"[parameters(''vulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webApplicationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","parameters":{"effect":{"value":"[parameters(''webApplicationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"nextGenerationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","parameters":{"effect":{"value":"[parameters(''nextGenerationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbVulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","parameters":{"effect":{"value":"[parameters(''sqlDbVulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateLessThanOwnersMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","parameters":{"effect":{"value":"[parameters(''identityDesignateLessThanOwnersMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateMoreThanOneOwnerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","parameters":{"effect":{"value":"[parameters(''identityDesignateMoreThanOneOwnerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53","parameters":{"effect":{"value":"[parameters(''apiAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90","parameters":{"effect":{"value":"[parameters(''functionAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe","parameters":{"effect":{"value":"[parameters(''webAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e","parameters":{"effect":{"value":"[parameters(''apiAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9","parameters":{"effect":{"value":"[parameters(''functionAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71","parameters":{"effect":{"value":"[parameters(''webAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951","parameters":{"effect":{"value":"[parameters(''apiAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{"effect":{"value":"[parameters(''functionAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e","parameters":{"effect":{"value":"[parameters(''webAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d","parameters":{"effect":{"value":"[parameters(''apiAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55","parameters":{"effect":{"value":"[parameters(''functionAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0","parameters":{"effect":{"value":"[parameters(''webAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac","parameters":{"effect":{"value":"[parameters(''apiAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5","parameters":{"effect":{"value":"[parameters(''functionAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9","parameters":{"effect":{"value":"[parameters(''webAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac","parameters":{"effect":{"value":"[parameters(''apiAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c","parameters":{"effect":{"value":"[parameters(''functionAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a","parameters":{"effect":{"value":"[parameters(''webAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestNodeJsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestNodeJsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vnetEnableDDoSProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd","parameters":{"effect":{"value":"[parameters(''vnetEnableDDoSProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9","parameters":{"effect":{"value":"[parameters(''sqlServerAdvancedDataSecurityMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlManagedInstanceAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9","parameters":{"effect":{"value":"[parameters(''sqlManagedInstanceAdvancedDataSecurityMonitoringEffect'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","type":"Microsoft.Authorization/policySetDefinitions","name":"1f3afdf9-d0c9-4c3d-847f-89da613e70a8"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"installedApplication":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6","parameters":{"installedApplication":{"value":"[parameters(''installedApplication'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1","type":"Microsoft.Authorization/policySetDefinitions","name":"25ef9b72-4af2-4501-acd1-fc814e73dde1"},{"properties":{"displayName":"[Preview]:
        Audit that password security settings are set correctly inside Linux and Windows
        machines","policyType":"BuiltIn","description":"This initiative will both
        deploy the policy requirements and audit that password security settings are
        set correctly inside Linux and Windows machines. For more information on guest
        configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df"},{"policyDefinitionReferenceId":"Deploy_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"policyDefinitionReferenceId":"Deploy_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"policyDefinitionReferenceId":"Deploy_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe"},{"policyDefinitionReferenceId":"Audit_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"policyDefinitionReferenceId":"Audit_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"policyDefinitionReferenceId":"Audit_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"policyDefinitionReferenceId":"Audit_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6","type":"Microsoft.Authorization/policySetDefinitions","name":"3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VMs","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the Virtual Machines (VMs) in the specified scope (Management
        group, Subscription or resource group). Takes Log Analytics workspace as parameter.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a","type":"Microsoft.Authorization/policySetDefinitions","name":"55f3eceb-5573-4f18-9695-226972c6d74a"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VM Scale Sets (VMSS)","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the VM Scale Sets in the specified scope (Management group,
        Subscription or resource group). Takes Log Analytics workspace as parameter.
        Note: if your scale set upgradePolicy is set to Manual, you need to apply
        the extension to the all VMs in the set by calling upgrade on them. In CLI
        this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad","type":"Microsoft.Authorization/policySetDefinitions","name":"75714362-cae7-409e-9b99-a8e5075b7fad"},{"properties":{"displayName":"[Preview]
        Audit that Windows web servers are using secure communication protocols","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that Windows
        web servers are using secure communication protocols (TLS 1.1 or TLS 1.2).
        For more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"policyDefinitionReferenceId":"Audit_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c","type":"Microsoft.Authorization/policySetDefinitions","name":"8bc55e6b-e9d5-4266-8dac-f688d151ec9c"},{"properties":{"displayName":"[Preview]:
        Enable Data Protection Suite","policyType":"BuiltIn","description":"Enable
        data protection for SQL servers. This initiative is assigned automatically
        by Azure Security Center Standard Tier.","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"deployThreatDetectionOnSqlServers","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","type":"Microsoft.Authorization/policySetDefinitions","name":"9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e","type":"Microsoft.Authorization/policySetDefinitions","name":"c937dcb4-4398-4b39-8d63-4a6be432252e"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2","type":"Microsoft.Authorization/policySetDefinitions","name":"d7fff7ea-9d47-4952-b854-b7da261e48f2"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20","type":"Microsoft.Authorization/policySetDefinitions","name":"f48bcc78-5400-4fb0-b913-5140a2e5fa20"},{"properties":{"displayName":"rohitbh
        : Azure Monitor","policyType":"Custom","description":"Contains many policies
        with DeployIfNotExists effect with assignPermissions set at the parameter
        at the individual policy definition level.","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2476fb6f-011e-4bc4-9d07-ba137949735d","type":"Microsoft.Authorization/policySetDefinitions","name":"2476fb6f-011e-4bc4-9d07-ba137949735d"},{"properties":{"displayName":"robga
        test category","policyType":"Custom","metadata":{"category":"test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"12670347827388363681","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2616b647-f45e-4c9b-96fe-4928dfde615a","type":"Microsoft.Authorization/policySetDefinitions","name":"2616b647-f45e-4c9b-96fe-4928dfde615a"},{"properties":{"displayName":"rohitbh
        : No DINE","policyType":"Custom","description":"Contains no policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring"},"parameters":{"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/351907c4-cd47-4e63-8246-c591645a58d6","type":"Microsoft.Authorization/policySetDefinitions","name":"351907c4-cd47-4e63-8246-c591645a58d6"},{"properties":{"displayName":"cosmosdb
        new aliases test","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"5701618597132748228","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0","parameters":{}},{"policyDefinitionReferenceId":"9148562625737659571","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7","parameters":{}},{"policyDefinitionReferenceId":"1317257300482699336","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd","parameters":{}},{"policyDefinitionReferenceId":"636235743263978372","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce","parameters":{}},{"policyDefinitionReferenceId":"6540762518326135304","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160","parameters":{}},{"policyDefinitionReferenceId":"16237668974108817340","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164","type":"Microsoft.Authorization/policySetDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd164"},{"properties":{"displayName":"rohitbh:
        Initiative containing some definitions with deployIfNotExists effect","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"3301615874834833614","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}},{"policyDefinitionReferenceId":"8044870099827093134","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/471eddb2-9421-4b81-8a25-3a0b849544dd","type":"Microsoft.Authorization/policySetDefinitions","name":"471eddb2-9421-4b81-8a25-3a0b849544dd"},{"properties":{"displayName":"rohitbh
        : oms vm linux parameterized effect","policyType":"Custom","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Effect","strongType":"omsWorkspace"},"allowedValues":["deployIfNotExists","disabled"]},"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7548235847093577126","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/539147f6-940a-49c1-a0f3-db04b8a7d9db","type":"Microsoft.Authorization/policySetDefinitions","name":"539147f6-940a-49c1-a0f3-db04b8a7d9db"},{"properties":{"displayName":"Diagnostic
        logs test","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypes":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"16751317232073684559","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","parameters":{"listOfResourceTypes":{"value":["Microsoft.HDInsight/clusters","Microsoft.HDInsight/clusters/applications","Microsoft.HDInsight/clusters/operationresults","Microsoft.HDInsight/locations","Microsoft.HDInsight/locations/azureasyncoperations","Microsoft.HDInsight/locations/operationresults","Microsoft.HDInsight/locations/capabilities","Microsoft.HDInsight/operations","Microsoft.HDInsight/locations/validateCreateRequest","Microsoft.HDInsight/locations/usages"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/68bcb2cc-b088-472f-a877-ac858014f0bb","type":"Microsoft.Authorization/policySetDefinitions","name":"68bcb2cc-b088-472f-a877-ac858014f0bb"},{"properties":{"displayName":"Policy
        tracked resources SDK tests","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"6346022531429970426","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/71289c53-22e7-4f31-a6dd-780b532380c2","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/71289c53-22e7-4f31-a6dd-780b532380c6","type":"Microsoft.Authorization/policySetDefinitions","name":"71289c53-22e7-4f31-a6dd-780b532380c6"},{"properties":{"displayName":"robgatestinitmultiparam","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name1"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value1"}},"TAGNAME_2":{"type":"String","metadata":{"displayName":"Tag
        Name2"}},"TAGVALUE_2":{"type":"String","metadata":{"displayName":"Tag Value2"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}},{"policyDefinitionReferenceId":"14987881155449304382","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_2'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/73933cd4-bc06-4e14-8166-3a7109eca21b","type":"Microsoft.Authorization/policySetDefinitions","name":"73933cd4-bc06-4e14-8166-3a7109eca21b"},{"properties":{"displayName":"rohitbh
        : One DINE","policyType":"Custom","description":"Contains one policy with
        DeployIfNotExists effect","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"},"category":"Monitoring"},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"12822089530504669560","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"}}},{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/74016c36-0a9a-436a-8436-291d54eab1a2","type":"Microsoft.Authorization/policySetDefinitions","name":"74016c36-0a9a-436a-8436-291d54eab1a2"},{"properties":{"displayName":"jilim
        allowed set","policyType":"Custom","metadata":{"category":"Test"},"parameters":{"LISTOFALLOWEDSKUS_1":{"type":"Array","metadata":{"displayName":"Allowed
        SKUs","strongType":"VMSKUs"}},"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"8962248944013962433","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","parameters":{"listOfAllowedSKUs":{"value":"[parameters(''LISTOFALLOWEDSKUS_1'')]"}}},{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/762007ec-c5ba-41ae-a52d-db0834bea096","type":"Microsoft.Authorization/policySetDefinitions","name":"762007ec-c5ba-41ae-a52d-db0834bea096"},{"properties":{"displayName":"TestAdditionalResourceType","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4146325350290724164","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Sql/servers/firewallRules","TrendMicro.DeepSecurity/listCommunicationPreference"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/80894954-5ae1-4391-975d-630e5586d07a","type":"Microsoft.Authorization/policySetDefinitions","name":"80894954-5ae1-4391-975d-630e5586d07a"},{"properties":{"displayName":"jilim
        rt group set","policyType":"Custom","description":"1","metadata":{"category":"Test","parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"ALLOWEDTYPES_1":{"type":"Array","metadata":{"displayName":"Allowed
        resource types","description":null,"strongType":"resourceTypes"},"allowedValues":["Microsoft.EventGrid/domains","Microsoft.EventGrid/domains/topics","Microsoft.EventGrid/locations"]}},"policyDefinitions":[{"policyDefinitionReferenceId":"18341726042324576950","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Cdn/checkNameAvailability","Microsoft.Cdn/checkResourceUsage","Microsoft.Cdn/profiles"]}}},{"policyDefinitionReferenceId":"1359233886895761531","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c872f951-1c5d-4c61-89dd-aee2350a11ba","parameters":{"allowedTypes":{"value":"[parameters(''ALLOWEDTYPES_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/82d42e20-f682-48dc-95b1-144f0963f0c1","type":"Microsoft.Authorization/policySetDefinitions","name":"82d42e20-f682-48dc-95b1-144f0963f0c1"},{"properties":{"displayName":"tags","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9736595915162791837","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t1"},"tagValue":{"value":"t1v"}}},{"policyDefinitionReferenceId":"5376449293497609056","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t2"},"tagValue":{"value":"t2v"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/875cf75e-49c3-47f8-ab8d-89ba3d2311a0","type":"Microsoft.Authorization/policySetDefinitions","name":"875cf75e-49c3-47f8-ab8d-89ba3d2311a0"},{"properties":{"displayName":"ComplianceTestInitiative","policyType":"Custom","description":"Compliance
        test initiative ","metadata":{"category":"Compliance test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4047897157028507992","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus"]}}},{"policyDefinitionReferenceId":"4859121137597195236","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["centralus"]}}},{"policyDefinitionReferenceId":"8935913113203900114","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus2"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad","type":"Microsoft.Authorization/policySetDefinitions","name":"a03db67e-a286-43c3-9098-b2da83d361ad"},{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"},{"properties":{"displayName":"test_policysetgqko4b_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"6058980588454309585","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policygehbsyfdw","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policysetjf4n3w","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policysetjf4n3w"},{"properties":{"displayName":"rohitbh
        : DINE mulitple policies with no role definitions","policyType":"Custom","metadata":{"parameterScopes":{"storageAccountsResourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"661064339838764944","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","parameters":{"storageAccountsResourceGroup":{"value":"rohitbhtest"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/b03bf722-f2a8-4a84-8af6-f43b28b5a917","type":"Microsoft.Authorization/policySetDefinitions","name":"b03bf722-f2a8-4a84-8af6-f43b28b5a917"},{"properties":{"displayName":"robgaparamtest","policyType":"Custom","metadata":{},"parameters":{"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/c020e9eb-47d4-434a-8627-e202808ed117","type":"Microsoft.Authorization/policySetDefinitions","name":"c020e9eb-47d4-434a-8627-e202808ed117"},{"properties":{"displayName":"rohitbh
        : Many DINE","policyType":"Custom","description":"Contains many policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/da84593c-b133-40c2-8524-c79fd38e7450","type":"Microsoft.Authorization/policySetDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7450"},{"properties":{"displayName":"test_sandipsh123","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002","type":"Microsoft.Authorization/policySetDefinitions","name":"db6c5074-a529-4cc8-8882-43f10ef42002"},{"properties":{"displayName":"MuratTest","policyType":"Custom","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and it''s value","parameters":{"tagName":{"value":"murat"},"tagValue":{"value":"ersan"}}},{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}},{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and its value","parameters":{"tagName":{"value":"testupdate"},"tagValue":{"value":"ignite"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f","type":"Microsoft.Authorization/policySetDefinitions","name":"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f"},{"properties":{"displayName":"Initiative
        with my parameterized effect policy","policyType":"Custom","metadata":{"category":"camarvin","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Initiative
        effect","description":null},"defaultValue":"audit"}},"policyDefinitions":[{"policyDefinitionReferenceId":"16025301204423402856","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"audit"}}},{"policyDefinitionReferenceId":"15232055014610564026","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078","type":"Microsoft.Authorization/policySetDefinitions","name":"e6884163-54c6-4f5e-9570-9e4cbd95b078"},{"properties":{"displayName":"robga:
        initiative parameters","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/f872dbd0-c410-4182-b982-bd24169b4222","type":"Microsoft.Authorization/policySetDefinitions","name":"f872dbd0-c410-4182-b982-bd24169b4222"},{"properties":{"displayName":"testDisplay","policyType":"Custom","description":"Updated
        Unit test junk: sorry for littering. Please delete me!","policyDefinitions":[{"policyDefinitionReferenceId":"6782502132987446742","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps9867"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/ps3866","type":"Microsoft.Authorization/policySetDefinitions","name":"ps3866"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['100496']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition show]
      Connection: [keep-alive]
      ParameterSetName: [-n]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['693']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:05 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy assignment create]
      Connection: [keep-alive]
      ParameterSetName: [-d -n --display-name -g]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['693']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:05 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: 'b''b\''b\\\''{"properties": {"displayName": "test_assignment000007", "policyDefinitionId":
      "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004",
      "scope": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001"},
      "sku": {"name": "A0", "tier": "Free"}}\\\''\'''''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy assignment create]
      Connection: [keep-alive]
      Content-Length: ['412']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-d -n --display-name -g]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000006?api-version=2018-05-01
  response:
    body: {string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"test_assignment000007","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000006","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000006"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['745']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1196']
    status: {code: 201, message: Created}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy assignment delete]
      Connection: [keep-alive]
      Content-Length: ['0']
      ParameterSetName: [-n -g]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000006?api-version=2018-05-01
  response:
    body: {string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"test_assignment000007","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policyset000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000006","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000006"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['745']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-deletes: ['14998']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy assignment list]
      Connection: [keep-alive]
      ParameterSetName: [--disable-scope-strict-match]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2018-05-01
  response:
    body: {string: '{"value":[{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-Audit
        SQL Server firewall rule","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/20e2cbc3-cc16-4fa9-ab9a-5cfd8a137127","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"startIpAddress":{"value":"171.0.2.1"},"endIpAddress":{"value":"171.0.2.16"}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/11e0b6fcf39b47ed813b41bd","type":"Microsoft.Authorization/policyAssignments","name":"11e0b6fcf39b47ed813b41bd","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : AuditIfNotExists","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ddd96d8-fccd-40cb-81d2-5072a4ed061c","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{}}},"identity":{"principalId":"a944d9ea-db14-4dad-9a79-dc2a688c848d","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/20dd518e837b4304b23f60e6","type":"Microsoft.Authorization/policyAssignments","name":"20dd518e837b4304b23f60e6","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-Audit
        resource location matches resource group location","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/3c3059c96b0940f0995f9464","type":"Microsoft.Authorization/policyAssignments","name":"3c3059c96b0940f0995f9464","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : oms vm linux parameterized effect","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/robgatestworkspace/providers/microsoft.operationalinsights/workspaces/robgatestworkspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000","effect":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"0e0cfe34-5101-4bdc-b611-12ea2b8cb4fc","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/450b1ff157cf4282b2a8f4d4","type":"Microsoft.Authorization/policyAssignments","name":"450b1ff157cf4282b2a8f4d4","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"test
        guest assignment","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/28e54a72-2fd7-40d3-afe2-b05423e0147a","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Liz
        Kim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4eab70dec54d4ddfbb915567","type":"Microsoft.Authorization/policyAssignments","name":"4eab70dec54d4ddfbb915567","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Case
        118113021002127","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/86cd412c-c557-473b-984c-a5f15cdcb116","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"effect":{"value":"auditifnotexists"}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/4ee83e1d5f4f4d99a28b185f","type":"Microsoft.Authorization/policyAssignments","name":"4ee83e1d5f4f4d99a28b185f","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"SQL
        firewall applicability test","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/78c26c94-429b-48f5-8a89-3a56ea2151ae","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5322bcb3afd7423bafb0939a","type":"Microsoft.Authorization/policyAssignments","name":"5322bcb3afd7423bafb0939a","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim
        Audit existence of a tag","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"tagName":{"value":"CostCenter"}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/62685ff6f6cc4754a39b17a5","type":"Microsoft.Authorization/policyAssignments","name":"62685ff6f6cc4754a39b17a5","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        web sites with tags on their authsettings","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e7c6ee79-2fdb-4c28-9a1f-9dcad3100120","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/69913a3fbc664e5385fff942","type":"Microsoft.Authorization/policyAssignments","name":"69913a3fbc664e5385fff942","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        all Microsoft.Web/sites/config/authsettings","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/211a466d-b2be-46e8-b029-8c28f566f118","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/98c12b3d2cb54caa9c3398b9","type":"Microsoft.Authorization/policyAssignments","name":"98c12b3d2cb54caa9c3398b9","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robga
        test for VM exclude RG","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh"],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/9a7093dcc21e4506a04e3c47","type":"Microsoft.Authorization/policyAssignments","name":"9a7093dcc21e4506a04e3c47","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : oms vm linux disabled effect","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/robgatestworkspace/providers/microsoft.operationalinsights/workspaces/robgatestworkspace"},"effect":{"value":"disabled"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000","effect":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"a6c6330d-ce01-40f7-8534-ca9689396d77","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/acc67c23039d428a9a4eb348","type":"Microsoft.Authorization/policyAssignments","name":"acc67c23039d428a9a4eb348","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : oms vm linux parameterized effect init","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/539147f6-940a-49c1-a0f3-db04b8a7d9db","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"EFFECT_1":{"value":"deployIfNotExists"},"LOGANALYTICS_1":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/robgatestworkspace/providers/microsoft.operationalinsights/workspaces/robgatestworkspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"EFFECT_1":"/subscriptions/00000000-0000-0000-0000-000000000000","LOGANALYTICS_1":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"3765443c-6347-4822-b7fe-022f2a7282ea","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/caeb6d68194d4042ab510658","type":"Microsoft.Authorization/policyAssignments","name":"caeb6d68194d4042ab510658","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-Audit
        allowed virtual machine SKUs","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a54cf76d-5680-4cd2-9fe9-b1bc82b8c1a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"listOfAllowedSKUs":{"value":["Standard_A3","Standard_A4_v2","Standard_A6"]}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{"listOfAllowedSKUs":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/ce2c7c3006204ef486692829","type":"Microsoft.Authorization/policyAssignments","name":"ce2c7c3006204ef486692829","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Kubernetes
        ingress policy","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8dc89b7c-4ffa-4051-b93e-4e8f1bd5631a","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"Only
        specified ingress is allowed based on names","metadata":{"assignedBy":"Liz
        Kim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/ced209fa90cd4809bc2498a4","type":"Microsoft.Authorization/policyAssignments","name":"ced209fa90cd4809bc2498a4","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-[Preview]:
        Audit Dependency Agent Deployment - VM Image (OS) unlisted","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/cf3396c38714442ca6afc500","type":"Microsoft.Authorization/policyAssignments","name":"cf3396c38714442ca6afc500","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"github209","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9a060c03-fda7-4b0a-b4da-15e2b7e4d117","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/d95f9c799ecc4cb09d371780","type":"Microsoft.Authorization/policyAssignments","name":"d95f9c799ecc4cb09d371780","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Attempt
        service bus","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/163c640e-681c-445f-92ba-cd434bd8c11c","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/e5c4e1c88be34db1bc8b2046","type":"Microsoft.Authorization/policyAssignments","name":"e5c4e1c88be34db1bc8b2046","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        web sites with tags on their logs config","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e7c6ee79-2fdb-4c28-9a1f-9dcad3100125","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/f54e881207924ca8b2e39f6a","type":"Microsoft.Authorization/policyAssignments","name":"f54e881207924ca8b2e39f6a","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"ASC
        Default (subscription: d0610b27-9663-4c05-89f8-5b4be01e86a5)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"Disabled"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"storage_httpsTrafficOnly","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/023217dd-81bb-461f-93ea-8799caac50c7","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/SANDIPSH-RG1/providers/Microsoft.Compute/disks/testrepro1rg1_disk1_76c690d81d3648f49024a7835c2d1077","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Compute/virtualMachines/testrepro1rg1"],"parameters":{},"description":"storage_httpsTrafficOnly
        desc","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/896b553d68384e2a9d8a2f67","type":"Microsoft.Authorization/policyAssignments","name":"896b553d68384e2a9d8a2f67","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"testImageId","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/70dc1e8d-61c9-4089-8bf5-895b227c1298","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/a12728ff6d5f4f1f8555f05a","type":"Microsoft.Authorization/policyAssignments","name":"a12728ff6d5f4f1f8555f05a"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Allowed
        Location Indexed - eastasia","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Allowed-Locations-Indexed","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":[],"parameters":{"allowedLocations":{"value":["centralus"]}},"description":"test
        1","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/a63772a0504c4466a7558f76","type":"Microsoft.Authorization/policyAssignments","name":"a63772a0504c4466a7558f76","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"Do_not_Delete_Assignment","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":[],"parameters":{"allowedLocations":{"value":["EUS,
        WEU"]}},"description":"this is used for testing purpose, do not delete it.","metadata":{"assignedBy":"Sandip
        Shahane"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/b7a1ca2596524e3ab19597f2","type":"Microsoft.Authorization/policyAssignments","name":"b7a1ca2596524e3ab19597f2"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Not
        allowed resource types","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":[],"parameters":{"listOfResourceTypesNotAllowed":{"value":["Microsoft.Storage/storageAccounts"]}},"description":"test
        ","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{"listOfResourceTypesNotAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/c0e2b84ed8224fe684fb0487","type":"Microsoft.Authorization/policyAssignments","name":"c0e2b84ed8224fe684fb0487","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"test_sandipsh123","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/fafa9611e2ad4da19e8af8b9","type":"Microsoft.Authorization/policyAssignments","name":"fafa9611e2ad4da19e8af8b9","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"testblah3","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipsh-rg1/providers/Microsoft.Authorization/policyAssignments/testblah3","type":"Microsoft.Authorization/policyAssignments","name":"testblah3"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe
        - incident - gardner","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d54722e7-4665-47ce-9a82-2f96cebfe353","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-empty","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Akif
        Heren","parameterScopes":{}}},"identity":{"principalId":"4fab5525-4458-43d1-9399-0e1abf90ac0d","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-empty/providers/Microsoft.Authorization/policyAssignments/9d12268c532648e3ad807e02","type":"Microsoft.Authorization/policyAssignments","name":"9d12268c532648e3ad807e02","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Enforce
        tag and its value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-empty","notScopes":[],"parameters":{"tagName":{"value":"test"},"tagValue":{"value":"test"}},"description":"Basic
        built in policy","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-empty/providers/Microsoft.Authorization/policyAssignments/a75130bb2fc44c649cd5816d","type":"Microsoft.Authorization/policyAssignments","name":"a75130bb2fc44c649cd5816d","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"github264","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ef00ee9d-fe45-4d14-8bee-789eea392116","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/0982a2c4492042a89d96041c","type":"Microsoft.Authorization/policyAssignments","name":"0982a2c4492042a89d96041c","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Case
        118113021002127 - better","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a514cb15-f9d8-49c9-a1e1-8b6d1fe19121","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"effect":{"value":"Deny"}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/1438b1322b514662ad1f5541","type":"Microsoft.Authorization/policyAssignments","name":"1438b1322b514662ad1f5541","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rs
        defaultvalue backslash","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50877efd-8dd9-43d5-b4e6-3b70e64311b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"ExclusionsPaths":{"value":"C:\\rs-pkgs;C:\\System
        Volume Information\\DFSR;C:\\Sysvol;C:\\ProgramData\\Microsoft\\SharePint;C:\\Program
        Files\\Common Files\\Microsoft Shared\\Web Server Extensions;C:\\Program Files\\Operations
        Manager;C:\\Program Files\\Microsoft Monitoring Agent;C:\\Program Files\\Microsoft
        Office Servers;C:\\Program Files\\Microsoft System Center 2012 R2\\Server;C:\\Program
        Files\\System Center Operations Manager;C:\\Program Files\\System Center Operations
        Manager 2007;C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\Temporary
        ASP.NET Files;C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary
        ASP.NET Files;C:\\Windows\\NTDS;C:\\Windows\\System32\\LogFiles;C:\\Windows\\Sysvol;C:\\Program
        Files\\Double-Take Software;C:\\Program Files\\DoubleTake;C:\\Program Files\\Exchsrvr;C:\\Program
        Files\\Ipswitch;C:\\Program Files\\LogMeIn;C:\\Windows\\SoftwareDistribution\\Datastore;C:\\Windows\\Temp\\Gthrsvc"}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"identity":{"principalId":"e0d4912c-1037-467d-95d0-7f0c74773591","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/18d1660ea4bc4ed5931f5321","type":"Microsoft.Authorization/policyAssignments","name":"18d1660ea4bc4ed5931f5321","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"[Preview]:
        Enable Monitoring in Azure Security Center","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/1b699e226afb49fa89e9c7a2","type":"Microsoft.Authorization/policyAssignments","name":"1b699e226afb49fa89e9c7a2","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"default
        value backslash","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b9203c56-0565-434a-a315-87f4da9f21b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/21247eec71364c5eaffee5ae","type":"Microsoft.Authorization/policyAssignments","name":"21247eec71364c5eaffee5ae","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Append
        HTTPS For Web Apps","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3b788cf8-ff6f-4075-86a1-ab76270790e0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/3a2143200749436dbe573f43","type":"Microsoft.Authorization/policyAssignments","name":"3a2143200749436dbe573f43","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Allowed
        virtual machine SKUs","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"listOfAllowedSKUs":{"value":["Basic_A0","Standard_A8","Standard_A10","Standard_A1","Standard_D2s_v3","Standard_D2_v3","Standard_D2_v2_Promo","Standard_D2","Standard_A0","Standard_DS5_v2_Promo","Standard_DS4_v2","Standard_DS3","Standard_DS3_v2_Promo","Standard_DS5_v2","Standard_DS4_v2_Promo","Standard_DS14","Standard_DS13_v2","Standard_DS12","Standard_DS2_v2","Standard_DS2","Standard_DS2_v2_Promo","Standard_DS3_v2","Standard_DS4","Standard_DS1_v2","Standard_DS1","Standard_DS11","Standard_DS11_v2","Standard_DS11_v2_Promo","Standard_DS11-1_v2"]}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{"listOfAllowedSKUs":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/60554181611f46c7adfe0ed2","type":"Microsoft.Authorization/policyAssignments","name":"60554181611f46c7adfe0ed2","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        SQL TDE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8cedfaa-4aa0-465a-8b90-49caf8177158","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/64624b8007574246b83f09e4","type":"Microsoft.Authorization/policyAssignments","name":"64624b8007574246b83f09e4","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Deny
        ActiveDirectory administrators","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7e520b19-dac2-4bbf-b27b-dcd67a3f60e0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/6577f1369c314443b8e561d1","type":"Microsoft.Authorization/policyAssignments","name":"6577f1369c314443b8e561d1","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"inherit
        all tags","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1e3c9312-c011-40a3-ac40-3bf3ddc24120","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/6fb4cdaa7959425791446915","type":"Microsoft.Authorization/policyAssignments","name":"6fb4cdaa7959425791446915","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Deny
        storage container creation","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4d2f8837-7acb-4488-b580-95960ee3f116","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/7632ded24e5f4a248f93904c","type":"Microsoft.Authorization/policyAssignments","name":"7632ded24e5f4a248f93904c","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"camarvin
        oms vm linux parameterized effect (with manually modified MI)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/jilimpolicytest/providers/microsoft.operationalinsights/workspaces/jilimpolicyws"},"effect":{"value":"deployIfNotExists"}},"description":"Has
        a manually modified Managed Identity with correct permissions\n\nSteps to
        add permissions:\n1. Powershell: Get-AzureRmADServicePrincipal -ObjectId 055b8b93-56ec-43d6-8ba0-ede402de7fa0\n2:
        Copy the \"DisplayName\" \n\n3. In azure portal: subscriptions => IAM => Add
        => Search  for \"DisplayName\" \n4. Add \"Log Analytics Contributor\"","metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000","effect":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"055b8b93-56ec-43d6-8ba0-ede402de7fa0","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/7a29f3e24c224adaa05ace42","type":"Microsoft.Authorization/policyAssignments","name":"7a29f3e24c224adaa05ace42","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        enabling of diagnostic logs in App Services","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/7a9e8638a93749f2b0484aea","type":"Microsoft.Authorization/policyAssignments","name":"7a9e8638a93749f2b0484aea","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"89322663
        audit diag setting","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b350b9b0-8ba5-4867-bc9c-63b4544671b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"listOfResourceTypes":{"value":["Microsoft.ApiManagement","Microsoft.Network/applicationGateways","Microsoft.DocumentDB","Microsoft.Network/expressRouteCircuits","Microsoft.EventHub","Microsoft.Network/loadBalancers","Microsoft.Logic","Microsoft.KeyVault/vaults","Microsoft.Network/virtualNetworkGateways","Microsoft.Sql","Microsoft.ServiceBus","Microsoft.Storage","Microsoft.Network/networkSecurityGroups"]}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/7bbbbe1a43654c448459d2af","type":"Microsoft.Authorization/policyAssignments","name":"7bbbbe1a43654c448459d2af","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"9_11_18
        security center","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInAppServiceMonitoringEffect":{"value":"Audit"},"encryptionOfAutomationAccountMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"metricAlertsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"classicComputeVMsMonitoringEffect":{"value":"Audit"},"classicStorageAccountsMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInEventHubMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"value":"AuditIfNotExists"},"aadAuthenticationInServiceFabricMonitoringEffect":{"value":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"value":"AuditIfNotExists"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"value":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"value":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"useRbacRulesMonitoringEffect":{"value":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"value":"Audit"},"accessRulesInEventHubNamespaceMonitoringEffect":{"value":"Audit"},"accessRulesInEventHubMonitoringEffect":{"value":"AuditIfNotExists"}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/7fc35fcaccba4ce6a1dab6b3","type":"Microsoft.Authorization/policyAssignments","name":"7fc35fcaccba4ce6a1dab6b3","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        SQL server level Auditing settings","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/918c9736830b43e1870a06d7","type":"Microsoft.Authorization/policyAssignments","name":"918c9736830b43e1870a06d7","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        single location","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/25e0ce73-3c96-46fd-9f4d-b83b99ec11bf","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"allowedLocation":{"value":"[resourcegroup().totallyInvliadthign.yo]"}},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/9cae02e590dc43da9e1e9357","type":"Microsoft.Authorization/policyAssignments","name":"9cae02e590dc43da9e1e9357","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"default
        value backslash really long string","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b9203c56-0565-434a-a315-87f4da9f21b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"description":"Add
        description to trigger a scan.","metadata":{"assignedBy":"Murat Ersan","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/b71b06cfff6c41c4a08530a2","type":"Microsoft.Authorization/policyAssignments","name":"b71b06cfff6c41c4a08530a2","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"new
        value backslash (string)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b9203c56-0565-434a-a315-87f4da9f21b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{"allowedLocations":{"value":"C:\\rs-pkgs;C:\\System
        Volume Information\\changeipt"}},"metadata":{"assignedBy":"Camille Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/bc8a041d7dea4c5eb5484107","type":"Microsoft.Authorization/policyAssignments","name":"bc8a041d7dea4c5eb5484107","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"default
        value backslash","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b9203c56-0565-434a-a315-87f4da9f21b9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/bfacfd1b0c07473d92ef01a3","type":"Microsoft.Authorization/policyAssignments","name":"bfacfd1b0c07473d92ef01a3","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Deploy
        Threat Detection on ManagedInstances","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/388f3717-f877-4c56-9083-d448c837c0df","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"identity":{"principalId":"26f3b60f-e29b-4549-81c4-3cb80f1326b9","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/ca67c2f9aa304c37b15dc50d","type":"Microsoft.Authorization/policyAssignments","name":"ca67c2f9aa304c37b15dc50d","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/camarvin-test-empty-assign","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","parameters":{"namePattern":{"value":""}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/camarvin-empty","type":"Microsoft.Authorization/policyAssignments","name":"camarvin-empty"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"default
        value backslash weird chars","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7f4d769f-78db-46eb-ac3c-0b8214f8c245","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/d3d75de48ccf409d8f876342","type":"Microsoft.Authorization/policyAssignments","name":"d3d75de48ccf409d8f876342","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        SQL  and Managed Instance TDE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/388f3717-f877-4c56-9083-d448c837c144","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/d7e5be26fe044e82a824d749","type":"Microsoft.Authorization/policyAssignments","name":"d7e5be26fe044e82a824d749","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Block
        TLS < 1.2 on web apps and slots","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/78c5df31-2f05-4f4d-acfe-3e536d88c1bc","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/eb261cd5e7f040f9bbf46200","type":"Microsoft.Authorization/policyAssignments","name":"eb261cd5e7f040f9bbf46200","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        transparent data encryption status","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/ee4a6c00c19e413da8ad30ab","type":"Microsoft.Authorization/policyAssignments","name":"ee4a6c00c19e413da8ad30ab","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"inherit
        costcenter tag","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6ced0d17-98f3-41e2-8038-08c8f4fb90e3","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin/providers/Microsoft.Authorization/policyAssignments/fe3d2a9d1b2b431d9cf32ded","type":"Microsoft.Authorization/policyAssignments","name":"fe3d2a9d1b2b431d9cf32ded","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"Allowed
        resource types","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Test","notScopes":[],"parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.AzureActiveDirectory/operations","Microsoft.AzureStack/registrations/customerSubscriptions","Microsoft.Batch/locations/quotas","Microsoft.BatchAI/fileservers","Microsoft.BatchAI/locations/operationstatuses","Microsoft.BatchAI/locations/usages","Microsoft.BatchAI/operations","Microsoft.Billing/BillingPeriods","Microsoft.Cdn/operationresults/profileresults/endpointresults/customdomainresults","Microsoft.Cdn/operations","Microsoft.Cdn/profiles/endpoints","Microsoft.ClassicNetwork/reservedIps","Microsoft.ClassicNetwork/virtualNetworks/remoteVirtualNetworkPeeringProxies","Microsoft.ClassicNetwork/virtualNetworks/virtualNetworkPeerings","Microsoft.Compute/locations/publishers","Microsoft.Compute/operations","Microsoft.ContainerRegistry/registries/regenerateCredentials","Microsoft.ContainerRegistry/registries/webhooks","Microsoft.ContainerRegistry/registries/webhooks/getCallbackConfig","Microsoft.DBforPostgreSQL/checkNameAvailability","Microsoft.DBforPostgreSQL/locations","Microsoft.DBforPostgreSQL/locations/azureAsyncOperation","Microsoft.DataMigration/locations/checkNameAvailability","Microsoft.DataMigration/locations/operationStatuses","Microsoft.DataMigration/services","Microsoft.DynamicsLcs/operations","Microsoft.EventGrid/extensionTopics","Microsoft.Network/dnszones"]}},"description":"This
        policy ensures that only approves resource types can be deployed.","metadata":{"assignedBy":"Liz
        Kim","parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Test"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Test/providers/Microsoft.Authorization/policyAssignments/5d78e6eb576241ee898e7450","type":"Microsoft.Authorization/policyAssignments","name":"5d78e6eb576241ee898e7450"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Policy
        tracked resources SDK tests","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/71289c53-22e7-4f31-a6dd-780b532380c6","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere-sdk-tests","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"identity":{"principalId":"f7ce5c8a-5d30-4606-95ed-43de400b2e2e","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere-sdk-tests/providers/Microsoft.Authorization/policyAssignments/18c66454099644de94931534","type":"Microsoft.Authorization/policyAssignments","name":"18c66454099644de94931534","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robgatest","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgasatest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"identity":{"principalId":"66c636c9-627f-4d86-883b-0d559ba15a7a","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgasatest/providers/Microsoft.Authorization/policyAssignments/c7509a25e71345a69af498de","type":"Microsoft.Authorization/policyAssignments","name":"c7509a25e71345a69af498de","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-Require
        SQL Server version 12.0","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/1c95b94c9c394a8eb4f1d8a6","type":"Microsoft.Authorization/policyAssignments","name":"1c95b94c9c394a8eb4f1d8a6","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"Audit
        allowed locations","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{"allowedLocations":{"value":["koreacentral","koreasouth"]}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{"allowedLocations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/39ecf6a6f4c84656a087acb9","type":"Microsoft.Authorization/policyAssignments","name":"39ecf6a6f4c84656a087acb9"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-Audit
        SQL server level Auditing settings","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/8949da153a554778a1fb04bd","type":"Microsoft.Authorization/policyAssignments","name":"8949da153a554778a1fb04bd","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim
        repro Enforce tag and its value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{"tagName":{"value":"aaa"},"tagValue":{"value":"bbb"}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/a0c1423f9d624ee992a76646","type":"Microsoft.Authorization/policyAssignments","name":"a0c1423f9d624ee992a76646","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-incident-86226837-fix","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/15358dd8-671e-4c96-be33-2b668791418f","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/a130362e761140cfb54de097","type":"Microsoft.Authorization/policyAssignments","name":"a130362e761140cfb54de097","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim
        nsg repro","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/14ac45e9-df97-455d-b6ee-dd216f15f694","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest/providers/Microsoft.Authorization/policyAssignments/adc0df50830140759ba2b0d7","type":"Microsoft.Authorization/policyAssignments","name":"adc0df50830140759ba2b0d7","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : Many DINE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/da84593c-b133-40c2-8524-c79fd38e7450","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"LOGANALYTICS_1":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/test0/providers/microsoft.operationalinsights/workspaces/rb-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"LOGANALYTICS_1":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"e7f8f300-816b-4e5d-bddd-a6ebf28ae4ac","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/12930897b7964a8b8863342e","type":"Microsoft.Authorization/policyAssignments","name":"12930897b7964a8b8863342e","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : Many DINE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/da84593c-b133-40c2-8524-c79fd38e7450","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"LOGANALYTICS_1":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/test0/providers/microsoft.operationalinsights/workspaces/rb-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"LOGANALYTICS_1":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"f1f7a5aa-6a01-47d6-85b8-93276f8029bc","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/13a94a5d73cf4458920861a6","type":"Microsoft.Authorization/policyAssignments","name":"13a94a5d73cf4458920861a6","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : One DINE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/74016c36-0a9a-436a-8436-291d54eab1a2","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"LOGANALYTICS_1":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/robgatestworkspace/providers/microsoft.operationalinsights/workspaces/robgatestworkspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"LOGANALYTICS_1":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"b89fc8be-b6ba-4f72-92ac-20286f16bff3","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/18c7601eba2f47e78fcc611b","type":"Microsoft.Authorization/policyAssignments","name":"18c7601eba2f47e78fcc611b","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : definition param with assignPermissions (next stamp)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/57ef268f-b414-436a-9894-125a81d80b30","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rohitbh-rg/providers/microsoft.operationalinsights/workspaces/rohitbh-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"b3f86e28-f5b5-4e28-bdd4-c20ab0a08fe1","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/2456022894aa44a3acfe3cd5","type":"Microsoft.Authorization/policyAssignments","name":"2456022894aa44a3acfe3cd5","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : definition param with assignPermissions","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/57ef268f-b414-436a-9894-125a81d80b30","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rohitbh-rg/providers/microsoft.operationalinsights/workspaces/rohitbh-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"5d011224-1924-462f-8916-307b63b74496","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/bdb5118274eb4e39ba731ffc","type":"Microsoft.Authorization/policyAssignments","name":"bdb5118274eb4e39ba731ffc","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : Azure Monitor init param","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2476fb6f-011e-4bc4-9d07-ba137949735d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"LOGANALYTICS_1":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rohitbh-rg/providers/microsoft.operationalinsights/workspaces/rohitbh-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"LOGANALYTICS_1":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"d23c9087-e936-4126-9d85-3b289455b91f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/c737cb84fce94775b1c898ba","type":"Microsoft.Authorization/policyAssignments","name":"c737cb84fce94775b1c898ba","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : DINE mulitple policies with no role definitions","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/b03bf722-f2a8-4a84-8af6-f43b28b5a917","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{}}},"identity":{"principalId":"c5408926-eb0e-4fd0-8725-b6de7ae6fea8","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/da988e822a6f45c4a07f0b63","type":"Microsoft.Authorization/policyAssignments","name":"da988e822a6f45c4a07f0b63","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : No DINE","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/351907c4-cd47-4e63-8246-c591645a58d6","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/dc7b37a6659c4d2788060957","type":"Microsoft.Authorization/policyAssignments","name":"dc7b37a6659c4d2788060957","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : deny on ''test'' tag","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ced59ff0-9061-49dd-94de-093b33a640d7","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/e6de82143de74d408041025a","type":"Microsoft.Authorization/policyAssignments","name":"e6de82143de74d408041025a","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh
        : definition param with assignPermissions","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/57ef268f-b414-436a-9894-125a81d80b30","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"logAnalytics":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rohitbh-rg/providers/microsoft.operationalinsights/workspaces/rohitbh-la-workspace"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"4b3b7014-dffe-446c-9d4a-ed5137e366ab","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/e72c5d12bc1446739fda94d2","type":"Microsoft.Authorization/policyAssignments","name":"e72c5d12bc1446739fda94d2","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh:
        Deploy Auditing on SQL servers without role definitions","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest","notScopes":[],"parameters":{"storageAccountsResourceGroup":{"value":"rohitbhtest"}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"storageAccountsResourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000"}}},"identity":{"principalId":"7681b38e-7e70-46d7-ba45-8fbb246a5ab2","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rohitbhtest/providers/Microsoft.Authorization/policyAssignments/eeae4b7783a14decb95eec61","type":"Microsoft.Authorization/policyAssignments","name":"eeae4b7783a14decb95eec61","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"RobgaDataFactoryTest","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3ffb9f8c-fdaa-41b0-ad4b-b0f55e2860c9","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgaTestEUS","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgaTestEUS/providers/Microsoft.Authorization/policyAssignments/14c147c3c5e64680ba18065f","type":"Microsoft.Authorization/policyAssignments","name":"14c147c3c5e64680ba18065f","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Not
        allowed resource types","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgaTestEUS","notScopes":[],"parameters":{"listOfResourceTypesNotAllowed":{"value":["Microsoft.Network/virtualNetworks/taggedTrafficConsumers","Microsoft.Network/routeTables"]}},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{"listOfResourceTypesNotAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgaTestEUS"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgaTestEUS/providers/Microsoft.Authorization/policyAssignments/b1a97d6af29947acaeb29d6d","type":"Microsoft.Authorization/policyAssignments","name":"b1a97d6af29947acaeb29d6d","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/ea7ac87c-b242-4ed1-b49f-ca12d59175e7","parameters":{"listOfAllowedSKUs":{"value":["Standard_LRS"]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/ea7ac87c-b242-4ed1-b49f-ca12d59175e7/providers/Microsoft.Authorization/policyAssignments/storageAccountSku","type":"Microsoft.Authorization/policyAssignments","name":"storageAccountSku"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Enforce
        KeyVault diagnostic log storage (elpere)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d0d9349d-843c-443a-9f27-5ce84f08c37e","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","description":"aaza"},"identity":{"principalId":"ae5233ae-20c7-4241-8af9-4681e5485af8","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/147a06ff85c644e1a06bb389","type":"Microsoft.Authorization/policyAssignments","name":"147a06ff85c644e1a06bb389","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        virtual machines without disaster recovery configured","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/2244e0c96aca4f43b51a7e85","type":"Microsoft.Authorization/policyAssignments","name":"2244e0c96aca4f43b51a7e85","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"docdb_aliases_test","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/2eae45fa1fcd4da1ab3a076a","type":"Microsoft.Authorization/policyAssignments","name":"2eae45fa1fcd4da1ab3a076a"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"storage
        ip rules append 2","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/3614109c79cb40b5b6aee5be","type":"Microsoft.Authorization/policyAssignments","name":"3614109c79cb40b5b6aee5be"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"ICM
        83577342 deny proxy resource location","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/77429b44-aac1-4417-a53e-6900c07e11ac","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/5fc81fe96c7148a2a6677065","type":"Microsoft.Authorization/policyAssignments","name":"5fc81fe96c7148a2a6677065","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Policy
        tracked resources SDK tests","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/71289c53-22e7-4f31-a6dd-780b532380c6","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"description":"asdasd","metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"identity":{"principalId":"6030ce17-cea2-45c3-ad80-d6029082b098","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/abb5adbb7b394308957c1a77","type":"Microsoft.Authorization/policyAssignments","name":"abb5adbb7b394308957c1a77","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"cosmosdb
        new aliases test","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/d6e82e15ff484a3bad53adbf","type":"Microsoft.Authorization/policyAssignments","name":"d6e82e15ff484a3bad53adbf","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"[elpere]
        deployIfNotExists Runners test","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbfa9fc0-5202-4001-8759-1aa2387f825b","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"identity":{"principalId":"e03bea12-ca8e-46f4-9414-e19a2127642e","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/e68b39995d0e4bb8807f71ae","type":"Microsoft.Authorization/policyAssignments","name":"e68b39995d0e4bb8807f71ae","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Access
        KV as part of remidiation deployment test (elpere)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d35ce9be-f51b-4d3e-bc7f-dde2936381b0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"identity":{"principalId":"bfe59578-3f94-4a23-b110-303cf11c9971","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/e9cfe872284b49aeba2f45b7","type":"Microsoft.Authorization/policyAssignments","name":"e9cfe872284b49aeba2f45b7","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"elpere
        template paramters function tests","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d2532053-bf59-4095-a1ae-2b7e4744f119","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Elad
        Perets","parameterScopes":{}}},"identity":{"principalId":"4766dcc8-a57a-403e-9b37-80d193889006","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.Authorization/policyAssignments/eeb18edc813c42d0ad5a9eab","type":"Microsoft.Authorization/policyAssignments","name":"eeb18edc813c42d0ad5a9eab","location":"westus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"allowedOS","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipshrg3","notScopes":[],"parameters":{"listOfAllowedWindows":{"value":["2016-Datacenter"]},"listOfAllowedUbuntus":{"value":["16.04
        Lts"]}},"description":"a","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/sandipshrg3/providers/Microsoft.Authorization/policyAssignments/ce50243878b84aee93c86e73","type":"Microsoft.Authorization/policyAssignments","name":"ce50243878b84aee93c86e73"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Apply
        tag and its default value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/gokmenhtestnew","notScopes":[],"parameters":{"tagName":{"value":"Test-test"},"tagValue":{"value":"test"}},"description":"CSS
        issue","metadata":{"assignedBy":"Gokmen Gok","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/gokmenhtestnew/providers/Microsoft.Authorization/policyAssignments/ead1b53494c14003926e4008","type":"Microsoft.Authorization/policyAssignments","name":"ead1b53494c14003926e4008","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"GOKMENH
        - Apply tag and its default value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/gokmenhtestnew","notScopes":[],"parameters":{"tagName":{"value":"CoolTag"},"tagValue":{"value":"CoolValue"}},"description":"Test
        Test test","metadata":{"assignedBy":"Gokmen Gok","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/gokmenhtestnew/providers/Microsoft.Authorization/policyAssignments/f2ba865fc8414233896ff61e","type":"Microsoft.Authorization/policyAssignments","name":"f2ba865fc8414233896ff61e","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Enforce
        tag and its value test","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","notScopes":[],"parameters":{"tagName":{"value":"2018-07-25T00:53:12Z"},"tagValue":{"value":"2018-07-25T00:53:12.3067173Z
        "}},"metadata":{"assignedBy":"Narine Mossikyan","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh/providers/Microsoft.Authorization/policyAssignments/400aff512a774d8782cbfb08","type":"Microsoft.Authorization/policyAssignments","name":"400aff512a774d8782cbfb08"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"narinem
        - 2 defaultValue: all parameters","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","notScopes":[],"parameters":{"locations":{"value":["eastus","westus"]},"location":{"value":"eastus"},"resourceGroups":{"value":["camarvin"]},"resourceGroup":{"value":"camarvin"},"tags":{"value":["London","New
        York"]},"allowedLocations":{"value":["eastus"]},"allowedLocation":{"value":"eastus"},"allowedStorageSKUs":{"value":["Standard_LRS","Standard_ZRS","Standard_GRS"]},"allowedStorageSKU":{"value":"Standard_LRS"},"allowedTags":{"value":["FirstName","LastName","Age"]},"allowedTag":{"value":"FirstName"}},"metadata":{"assignedBy":"Narine
        Mossikyan","parameterScopes":{"locations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","location":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","resourceGroups":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","resourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedLocations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedLocation":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedStorageSKUs":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedStorageSKU":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh/providers/Microsoft.Authorization/policyAssignments/46b2dd438ab547eaa10e2bc3","type":"Microsoft.Authorization/policyAssignments","name":"46b2dd438ab547eaa10e2bc3"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"narinem
        - Enforce tag and its value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","notScopes":[],"parameters":{"tagName":{"value":"name"},"tagValue":{"value":"value"}},"metadata":{"assignedBy":"Narine
        Mossikyan","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh/providers/Microsoft.Authorization/policyAssignments/77fec4647f8442e3b7ce96db","type":"Microsoft.Authorization/policyAssignments","name":"77fec4647f8442e3b7ce96db"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"narinem
        - defaultValue: all parameters with overwrites","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","notScopes":[],"parameters":{"locations":{"value":["eastus","westus","eastus2","centralus"]},"location":{"value":"eastus"},"resourceGroups":{"value":["camarvin"]},"resourceGroup":{"value":"camarvin"},"allowedLocations":{"value":["eastus"]},"allowedLocation":{"value":"eastus"},"allowedStorageSKUs":{"value":["Standard_LRS","Standard_ZRS","Standard_GRS"]},"allowedStorageSKU":{"value":"Standard_LRS"},"allowedTags":{"value":["FirstName","LastName","Age"]},"allowedTag":{"value":"FirstName"}},"metadata":{"assignedBy":"Narine
        Mossikyan","parameterScopes":{"locations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","location":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","resourceGroups":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","resourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedLocations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedLocation":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedStorageSKUs":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","allowedStorageSKU":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh/providers/Microsoft.Authorization/policyAssignments/78a2dfec07014d659619515d","type":"Microsoft.Authorization/policyAssignments","name":"78a2dfec07014d659619515d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Enforce
        tag and its value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh","notScopes":[],"parameters":{"tagName":{"value":"er"},"tagValue":{"value":"wete"}},"metadata":{"assignedBy":"Narine
        Mossikyan","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/argh/providers/Microsoft.Authorization/policyAssignments/beb85152cea0475ba4942c26","type":"Microsoft.Authorization/policyAssignments","name":"beb85152cea0475ba4942c26"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"rohitbh:
        icm 102226001","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bc732353-948c-47b9-934e-b16e99c23254","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_bulente-k8stest-rg_bulente-k8stest_centralus","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_bulente-k8stest-rg_bulente-k8stest_centralus/providers/Microsoft.Authorization/policyAssignments/6519b43bfa064d09a8e68599","type":"Microsoft.Authorization/policyAssignments","name":"6519b43bfa064d09a8e68599","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Apply
        tag and its default value","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/DefaultResourceGroup-EUS","notScopes":[],"parameters":{"tagName":{"value":"case"},"tagValue":{"value":"118102225002278
        "}},"metadata":{"assignedBy":"Camille Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/DefaultResourceGroup-EUS/providers/Microsoft.Authorization/policyAssignments/677b0cab4d454f52bf46a52f","type":"Microsoft.Authorization/policyAssignments","name":"677b0cab4d454f52bf46a52f","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robgaNSGtest","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/aeb6a524-e3d1-4b8a-afa8-26ae4e291116","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robga-testNSG","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robga-testNSG/providers/Microsoft.Authorization/policyAssignments/043713b123d3462d804683fc","type":"Microsoft.Authorization/policyAssignments","name":"043713b123d3462d804683fc","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robga-nsgtemplate-test","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ddfee46-9b63-4313-a529-cfbf968d8118","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robga-testNSG","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robga-testNSG/providers/Microsoft.Authorization/policyAssignments/77bc6633cbd14c23967fffcc","type":"Microsoft.Authorization/policyAssignments","name":"77bc6633cbd14c23967fffcc","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86230190-deployIfNotExists","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5632","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190","notScopes":[],"parameters":{},"description":"adding
        this to help custmomer for incident 86230190","metadata":{"assignedBy":"Akif
        Heren","parameterScopes":{}}},"identity":{"principalId":"59840ddc-3e4e-4f5c-8418-67d57253b859","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190/providers/Microsoft.Authorization/policyAssignments/2b3657d96b224ee3a708d815","type":"Microsoft.Authorization/policyAssignments","name":"2b3657d96b224ee3a708d815","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86230190-v2","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/83daa8ee-7c9a-470c-81a8-5a99ac09d134","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190","notScopes":[],"parameters":{},"description":"audits
        if a resource doesn''t have a lock","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190/providers/Microsoft.Authorization/policyAssignments/4c15b85c96404165be04889e","type":"Microsoft.Authorization/policyAssignments","name":"4c15b85c96404165be04889e","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86230190","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca8d6","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190","notScopes":[],"parameters":{},"description":"reproing
        incident 86230190","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86230190/providers/Microsoft.Authorization/policyAssignments/d2101b18c58142acafa06f07","type":"Microsoft.Authorization/policyAssignments","name":"d2101b18c58142acafa06f07","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"sandipsh
        CRI 90803744 [Preview]: Audit Dependency Agent Deployment - VM Image (OS)
        unlisted","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/04ced0a3c6e84233b7051314","type":"Microsoft.Authorization/policyAssignments","name":"04ced0a3c6e84233b7051314","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"testSandipsh
        metric alert policy3","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{"resourceType":{"value":"Microsoft.Storage/storageAccounts1"},"alertNamePrefix":{"value":"testSandipsh3"},"alertDescription":{"value":"This
        is test 3 policy assignment"},"alertSeverity":{"value":"4"},"isEnabled":{"value":"true"},"metricName":{"value":"Transactions"},"operator":{"value":"GreaterThan"},"threshold":{"value":"1"},"timeAggregation":{"value":"Total"},"windowSize":{"value":"PT5M"},"evaluationFrequency":{"value":"PT1M"},"actionGroupId":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/default-activitylogalerts/providers/microsoft.insights/actiongroups/sandipsh"}},"description":"This
        is a test assignment created using \"testSandipsh metric alert policy3\" policy
        definition.","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/123a95223c214e4eaf7b88d9","type":"Microsoft.Authorization/policyAssignments","name":"123a95223c214e4eaf7b88d9"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robga
        test not for VM","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/2e78fedb83df4cd4bc4525f6","type":"Microsoft.Authorization/policyAssignments","name":"2e78fedb83df4cd4bc4525f6","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"detect
        ''allow All'' NSG rule","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4c915617-16f0-4c62-b021-e66d5409d11d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Liz
        Kim","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/4710061986c740bb92427daf","type":"Microsoft.Authorization/policyAssignments","name":"4710061986c740bb92427daf"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        enabling of diagnostic logs in Azure Data Lake Store","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test1_OsDisk_1_66b67e4f12ae4a8f9a79e6727c525dfc","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test2_OsDisk_1_184c70ce1f6545d5915f65edcd71a86a","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test3_OsDisk_1_3e2ed03e36b44533b9e0734a31a54acc","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test4_OsDisk_1_612fba0fd6bc472b8fcf471d9d34201f"],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/4b99c540071c4163a31036e2","type":"Microsoft.Authorization/policyAssignments","name":"4b99c540071c4163a31036e2","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"tags","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/875cf75e-49c3-47f8-ab8d-89ba3d2311a0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/57f3f848f38346ea8614463f","type":"Microsoft.Authorization/policyAssignments","name":"57f3f848f38346ea8614463f","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Audit
        existence of a tag2","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test1_OsDisk_1_66b67e4f12ae4a8f9a79e6727c525dfc","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TESTSANDIPSH/providers/Microsoft.Compute/disks/test2_OsDisk_1_184c70ce1f6545d5915f65edcd71a86a"],"parameters":{"tagName":{"value":"env"}},"description":"test
        description....","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/8b3c4695be824259a66370e1","type":"Microsoft.Authorization/policyAssignments","name":"8b3c4695be824259a66370e1","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"robga
        test for vm","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/testSandipsh","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Compute/virtualMachines/testVM"],"parameters":{},"metadata":{"assignedBy":"Robert
        Gao","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/99121cfe6ca14f839088f505","type":"Microsoft.Authorization/policyAssignments","name":"99121cfe6ca14f839088f505","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"[Preview]:
        Apply Diagnostic Settings for Network Security Groups","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{"storagePrefix":{"value":"testSandipsh"},"rgName":{"value":"testSandipsh"}},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{"rgName":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/b72ec05b04624c87b35e5d97","type":"Microsoft.Authorization/policyAssignments","name":"b72ec05b04624c87b35e5d97"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"storage_httpsTrafficOnly_testSandipshRG","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/023217dd-81bb-461f-93ea-8799caac50c7","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/bc650b603c02494bb890837e","type":"Microsoft.Authorization/policyAssignments","name":"bc650b603c02494bb890837e"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"testSandipsh
        metric alert policy Assignment1","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{"resourceType":{"value":"Microsoft.Storage/storageAccounts1"},"alertNamePrefix":{"value":"testSandipshPrefix"},"alertDescription":{"value":"this
        is dummy alert"},"alertSeverity":{"value":"4"},"isEnabled":{"value":"true"},"metricName":{"value":"Transactions"},"operator":{"value":"GreaterThan"},"threshold":{"value":"1"},"timeAggregation":{"value":"Total"},"windowSize":{"value":"PT5M"},"evaluationFrequency":{"value":"PT1M"},"actionGroupId":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/default-activitylogalerts/providers/microsoft.insights/actiongroups/sandipsh"}},"metadata":{"assignedBy":"Sandip
        Shahane","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/e2737c4f650a4c569ad6df20","type":"Microsoft.Authorization/policyAssignments","name":"e2737c4f650a4c569ad6df20"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"testSandipsh.Assignment.draft","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh","notScopes":[],"parameters":{"resourceType":{"value":"Microsoft.Storage/storageAccounts"},"alertNamePrefix":{"value":"testSandipsh.draft"},"alertDescription":{"value":"This
        is test draft policy assignment"},"alertSeverity":{"value":"4"},"isEnabled":{"value":"true"},"metricName":{"value":"Transactions"},"operator":{"value":"GreaterThan"},"threshold":{"value":"1"},"timeAggregation":{"value":"Total"},"windowSize":{"value":"PT5M"},"evaluationFrequency":{"value":"PT1M"},"actionGroupId":{"value":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/default-activitylogalerts/providers/microsoft.insights/actiongroups/sandipsh"}},"description":"test
        assignment","metadata":{"assignedBy":"Sandip Shahane","parameterScopes":{}}},"identity":{"principalId":"1c1c6097-c40f-4959-acc3-77a973f7d2b8","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testSandipsh/providers/Microsoft.Authorization/policyAssignments/testSandipsh.Assignment.draft","type":"Microsoft.Authorization/policyAssignments","name":"testSandipsh.Assignment.draft","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"joelpo-Audit
        VMs that do not use managed disks","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/joelpogroup","notScopes":[],"parameters":{},"description":"test_rg_assignment","metadata":{"assignedBy":"Joel
        Pothering","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/joelpogroup/providers/Microsoft.Authorization/policyAssignments/7df9280324ba4f41a41ce08a","type":"Microsoft.Authorization/policyAssignments","name":"7df9280324ba4f41a41ce08a"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Test
        storage alias","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5fa69139-9a49-464e-90b5-0d243a469138","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin-asr","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/camarvin-asr/providers/Microsoft.Authorization/policyAssignments/a164f0ceb98d474685ecf9ab","type":"Microsoft.Authorization/policyAssignments","name":"a164f0ceb98d474685ecf9ab"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim
        allowed set 1","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/762007ec-c5ba-41ae-a52d-db0834bea096","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2","notScopes":[],"parameters":{"LISTOFALLOWEDSKUS_1":{"value":["Basic_A0"]},"LISTOFRESOURCETYPESNOTALLOWED_1":{"value":["Microsoft.Network/networkSecurityGroups","Aspera.Transfers/listCommunicationPreference"]}},"metadata":{"assignedBy":"Rohit
        Bhardwaj","parameterScopes":{"LISTOFALLOWEDSKUS_1":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2","LISTOFRESOURCETYPESNOTALLOWED_1":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2/providers/Microsoft.Authorization/policyAssignments/8828df941b124d42841bfe69","type":"Microsoft.Authorization/policyAssignments","name":"8828df941b124d42841bfe69","location":"eastus"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"jilimpolicytest2
        Allowed locations","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2","notScopes":[],"parameters":{"listOfAllowedLocations":{"value":["japanwest","japaneast"]}},"metadata":{"assignedBy":"Jin
        Soon Lim","parameterScopes":{"listOfAllowedLocations":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/jilimpolicytest2/providers/Microsoft.Authorization/policyAssignments/e9860612d8ec4a469f59af06","type":"Microsoft.Authorization/policyAssignments","name":"e9860612d8ec4a469f59af06"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"chegg:
        Deploy azsecpack autoupgrade (VMSS)","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ec05dac-e529-48ef-8c20-f7e6af99a12b","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{}}},"identity":{"principalId":"92349a94-b991-49ba-8ee8-b2a1935ec215","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/7b690125bcf4469db6c2b7a1","type":"Microsoft.Authorization/policyAssignments","name":"7b690125bcf4469db6c2b7a1","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"cheggert:
        Append VMSS extension","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/01b105ed-6ded-4a1d-894c-df85fd9351cb","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Chris
        Eggert","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cheggpolicy/providers/Microsoft.Authorization/policyAssignments/7e030a52dca84213870d637e","type":"Microsoft.Authorization/policyAssignments","name":"7e030a52dca84213870d637e","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86226837-v2","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0e0d567a-6089-46fc-b12c-ca5af1287abe","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"description":"second
        attempt to repro the incident ","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/3f1e5705173546d59712ba1f","type":"Microsoft.Authorization/policyAssignments","name":"3f1e5705173546d59712ba1f","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"jilim-incident-86226837-fix","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/15358dd8-671e-4c96-be33-2b668791418f","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Akif
        Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/49f23c95c52242f5b9762c0d","type":"Microsoft.Authorization/policyAssignments","name":"49f23c95c52242f5b9762c0d","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86226837","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca376","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"description":"reproing
        incident 86226837","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/631306c13e2f42b3abc414b7","type":"Microsoft.Authorization/policyAssignments","name":"631306c13e2f42b3abc414b7","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"Deny
        ActiveDirectory administrators","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7e520b19-dac2-4bbf-b27b-dcd67a3f60e0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"metadata":{"assignedBy":"Camille
        Marvin","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/c84873e3d84342bf976e385a","type":"Microsoft.Authorization/policyAssignments","name":"c84873e3d84342bf976e385a","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86318519","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca600","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"description":"reproing
        incident 86318519","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/e1e4cc3cbdfb435b9268cd4b","type":"Microsoft.Authorization/policyAssignments","name":"e1e4cc3cbdfb435b9268cd4b","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-86226837-v3","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5002","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837","notScopes":[],"parameters":{},"description":"3rd","metadata":{"assignedBy":"Akif
        Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-86226837/providers/Microsoft.Authorization/policyAssignments/e992cf28e75942d3a66e894d","type":"Microsoft.Authorization/policyAssignments","name":"e992cf28e75942d3a66e894d","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"akhe-incident-85944710-combined","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/290b38e4-eff9-434b-b4d3-3ddd6084180f","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-85944710","notScopes":[],"parameters":{"locationNames":{"value":["westus","westus2","West
        US"]}},"description":"combined policy.","metadata":{"assignedBy":"Akif Heren","parameterScopes":{}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/akhe-incident-85944710/providers/Microsoft.Authorization/policyAssignments/e67bd210931a420a87f41ad5","type":"Microsoft.Authorization/policyAssignments","name":"e67bd210931a420a87f41ad5","location":"eastus"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['112474']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:08 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition delete]
      Connection: [keep-alive]
      Content-Length: ['0']
      ParameterSetName: [-n]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","policyDefinitions":[{"policyDefinitionReferenceId":"14473501781414709750","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['693']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:08 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-deletes: ['14999']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition list]
      Connection: [keep-alive]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-05-01
  response:
    body: {string: '{"value":[{"properties":{"displayName":"[Preview]: Enable Monitoring
        in Azure Security Center","policyType":"BuiltIn","description":"Monitor all
        the available security recommendations in Azure Security Center. This is the
        default policy for Azure Security Center.","metadata":{"category":"Security
        Center"},"parameters":{"systemUpdatesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        system updates","description":"Enable or disable reporting of system updates"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        OS vulnerabilities","description":"Enable or disable OS vulnerabilities monitoring
        (based on a configured baseline)"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        endpoint protection","description":"Enable or disable endpoint protection
        monitoring"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disk encryption","description":"Enable or disable the monitoring for VM disk
        encryption"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        network security groups","description":"Enable or disable monitoring of network
        security groups with permissive rules"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        web application firewall","description":"Enable or disable the monitoring
        of unprotected web applications"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Enable
        Next Generation Firewall (NGFW) monitoring","description":"Enable or disable
        monitoring network endpoints without a Next Generation Firewall"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        vulnerability assesment","description":"Enable or disable the detection of
        VM vulnerabilities by a vulnerability assessment solution"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        storage blob encryption","description":"Enable or disable the monitoring of
        blob encryption for storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"jitNetworkAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        JIT network access","description":"Enable or disable the monitoring of network
        just In time access"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        application whitelisting","description":"Enable or disable the monitoring
        of application whitelisting in Azure Security Center"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL auditing","description":"Enable or disable the monitoring of unaudited
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlServerAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL Servers auditing","description":"Enable or disable the monitoring of unaudited
        SQL Servers"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInAppServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure App Services","description":"Enable or disable the
        monitoring of diagnostics logs in Azure App Services"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"encryptionOfAutomationAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        encryption of automation accounts","description":"Enable or disable the monitoring
        of automation account encryption"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Batch accounts","description":"Enable or disable the monitoring
        of diagnostic logs in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInBatchAccountRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) for logs in Batch accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"metricAlertsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        metric alerts in Batch accounts","description":"Enable or disable the monitoring
        of metric alerts in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"classicComputeVMsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic compute VMs","description":"Enable or disable the monitoring of classic
        compute VMs"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"classicStorageAccountsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic storage accounts","description":"Enable or disable the monitoring
        of classic storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Analytics accounts","description":"Enable or
        disable the monitoring of diagnostic logs in Data Lake Analytics accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Analytics accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Store accounts","description":"Enable or disable
        the monitoring of diagnostic logs in Data Lake Store accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Store accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Event Hub accounts","description":"Enable or disable the
        monitoring of diagnostic logs in Event Hub accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInEventHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Event Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Key Vault vaults","description":"Enable or disable the
        monitoring of diagnostic logs in Key Vault vaults"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Key Vault vaults","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Logic Apps workflows","description":"Enable or disable
        the monitoring of diagnostic logs in Logic Apps workflows"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Logic Apps workflows","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Redis Cache","description":"Enable or disable the
        monitoring of diagnostic logs in Azure Redis Cache"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Search service","description":"Enable or disable
        the monitoring of diagnostic logs in Azure Search service"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInSearchServiceRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Azure Search service","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"aadAuthenticationInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Azure Active Directory authentication in Service Fabric","description":"Enable
        or disable the monitoring of Azure Active Directory for client authentication
        in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        cluster protection level in Service Fabric","description":"Enable or disable
        the monitoring of cluster protection level in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Bus","description":"Enable or disable the monitoring
        of diagnostic logs in Service Bus"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInServiceBusRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Service Bus","description":"The required diagnostic
        logs retention period in days"},"defaultValue":"365"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Service Bus namespace authorization rules","description":"Enable or disable
        the monitoring of Service Bus namespace authorization rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the provisioning of an Azure AD admininistrator for SQL server","description":"Enable
        or disable the monitoring of an Azure AD admininistrator for SQL server"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the secure transfer to storage account","description":"Enable or disable the
        monitoring of secure transfer to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Stream Analytics","description":"Enable or disable the
        monitoring of diagnostic logs in Stream Analytics"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInStreamAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Stream Analytics","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"useRbacRulesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        of using built-in RBAC rules","description":"Enable or disable the monitoring
        of using built-in RBAC rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disabling of unrestricted network access to storage account","description":"Enable
        or disable the monitoring of network access to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Fabric","description":"Enable or disable the monitoring
        of diagnostic logs in Service Fabric"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"accessRulesInEventHubNamespaceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hub namespaces","description":"Enable or disable the
        monitoring of access rules in Event Hub namespaces"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"accessRulesInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hubs","description":"Enable or disable the monitoring
        of access rules in Event Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbVulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL vulnerability assessment results","description":"Enable or disable the
        monitoring of Vulnerability Assessment scan results and recommendations for
        how to remediate database vulnerabilities."},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateLessThanOwnersMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        maximum number of owners","description":"Enable or disable the monitoring
        of maximum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateMoreThanOneOwnerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        minimus number of owners","description":"Enable or disable the monitoring
        of minimum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with owner permissions","description":"Enable or disable
        the monitoring of MFA for accounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with write permissions","description":"Enable or disable
        the monitoring of MFA for accounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with read permissions","description":"Enable or disable the
        monitoring of MFA for accounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts with owner permissions","description":"Enable or
        disable the monitoring of deprecated acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts","description":"Enable or disable the monitoring
        of deprecated acounts in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with owner permissions","description":"Enable or
        disable the monitoring of external acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with write permissions","description":"Enable or
        disable the monitoring of external acounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with read permissions","description":"Enable or disable
        the monitoring of external acounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for API App","description":"Enable or disable the
        monitoring of IP restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Function App","description":"Enable or disable
        the monitoring of IP restrictions for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Web App","description":"Enable or disable the
        monitoring of IP restrictions for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for API App","description":"Enable or disable the
        monitoring of remote debugging for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Function App","description":"Enable or disable
        the monitoring of remote debugging for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Web App","description":"Enable or disable the
        monitoring of remote debugging for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for API App","description":"Enable or disable the monitoring
        of web sockets for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Function App","description":"Enable or disable the
        monitoring of web sockets for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Web App","description":"Enable or disable the monitoring
        of web sockets for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in API App","description":"Enable or disable the monitoring
        of the use of HTTPS in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in function App","description":"Enable or disable the monitoring
        of the use of HTTPS in function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in Web App","description":"Enable or disable the monitoring
        of the use of HTTPS in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API App","description":"Enable or disable the monitoring
        of CORS restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Function","description":"Enable or disable the
        monitoring of CORS restrictions for API Function"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Web","description":"Enable or disable the monitoring
        of CORS restrictions for API Web"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in API App","description":"Enable or disable the monitoring
        of custom domain use in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Function App","description":"Enable or disable the
        monitoring of custom domain use in Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Web App","description":"Enable or disable the monitoring
        of custom domain use in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in API App","description":"Enable or disable the monitoring
        of .Net version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in Web App","description":"Enable or disable the monitoring
        of .Net version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in API App","description":"Enable or disable the monitoring
        of Java version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in Web App","description":"Enable or disable the monitoring
        of Java version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestNodeJsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Node.js in Web App","description":"Enable or disable the monitoring
        of Node.js version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in API App","description":"Enable or disable the monitoring
        of PHP version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in Web App","description":"Enable or disable the monitoring
        of PHP version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in API App","description":"Enable or disable the monitoring
        of Python version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in Web App","description":"Enable or disable the monitoring
        of Python version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vnetEnableDDoSProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use of DDoS protection for virtual network","description":"Enable or disable
        the monitoring of DDoS protection for virtual network"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in IoT Hubs","description":"Enable or disable the monitoring
        of diagnostic logs in IoT Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in IoT Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"sqlServerAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL servers without Advanced Data Security","description":"Enable or disable
        the monitoring of SQL servers without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL managed instances without Advanced Data Security","description":"Enable
        or disable the monitoring of SQL managed instances without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyDefinitions":[{"policyDefinitionReferenceId":"diagnosticsLogsInIoTHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInIoTHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInIoTHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceFabricMonitoringEffect","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubNamespaceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubNamespaceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"disableUnrestrictedNetworkToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","parameters":{"effect":{"value":"[parameters(''disableUnrestrictedNetworkToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"useRbacRulesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","parameters":{"effect":{"value":"[parameters(''useRbacRulesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInStreamAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"secureTransferToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","parameters":{"effect":{"value":"[parameters(''secureTransferToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInSqlServerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInSqlServerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"namespaceAuthorizationRulesInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","parameters":{"effect":{"value":"[parameters(''namespaceAuthorizationRulesInServiceBusMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceBusMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInServiceBusRetentionDays'')]"}}},{"policyDefinitionReferenceId":"clusterProtectionLevelInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","parameters":{"effect":{"value":"[parameters(''clusterProtectionLevelInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInSearchServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInSearchServiceMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInSearchServiceRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInRedisCacheMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInRedisCacheMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInLogicAppsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInLogicAppsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInLogicAppsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInKeyVaultMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInKeyVaultMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInKeyVaultRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInEventHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInEventHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeStoreMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"classicStorageAccountsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","parameters":{"effect":{"value":"[parameters(''classicStorageAccountsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"classicComputeVMsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","parameters":{"effect":{"value":"[parameters(''classicComputeVMsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"metricAlertsInBatchAccountPoolDeleteStart","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","parameters":{"effect":{"value":"[parameters(''metricAlertsInBatchAccountMonitoringEffect'')]"},"metricName":{"value":"PoolDeleteStartEvent"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInBatchAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInBatchAccountMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInBatchAccountRetentionDays'')]"}}},{"policyDefinitionReferenceId":"encryptionOfAutomationAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","parameters":{"effect":{"value":"[parameters(''encryptionOfAutomationAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInAppServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInAppServiceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","parameters":{"effect":{"value":"[parameters(''sqlDbEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","parameters":{"effect":{"value":"[parameters(''sqlServerAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","parameters":{"effect":{"value":"[parameters(''sqlEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","parameters":{"effect":{"value":"[parameters(''sqlAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemUpdatesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","parameters":{"effect":{"value":"[parameters(''systemUpdatesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"storageEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{"effect":{"value":"[parameters(''storageEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"jitNetworkAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","parameters":{"effect":{"value":"[parameters(''jitNetworkAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"adaptiveApplicationControlsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","parameters":{"effect":{"value":"[parameters(''adaptiveApplicationControlsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"networkSecurityGroupsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","parameters":{"effect":{"value":"[parameters(''networkSecurityGroupsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemConfigurationsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","parameters":{"effect":{"value":"[parameters(''systemConfigurationsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"endpointProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","parameters":{"effect":{"value":"[parameters(''endpointProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diskEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","parameters":{"effect":{"value":"[parameters(''diskEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","parameters":{"effect":{"value":"[parameters(''vulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webApplicationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","parameters":{"effect":{"value":"[parameters(''webApplicationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"nextGenerationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","parameters":{"effect":{"value":"[parameters(''nextGenerationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbVulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","parameters":{"effect":{"value":"[parameters(''sqlDbVulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateLessThanOwnersMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","parameters":{"effect":{"value":"[parameters(''identityDesignateLessThanOwnersMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateMoreThanOneOwnerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","parameters":{"effect":{"value":"[parameters(''identityDesignateMoreThanOneOwnerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53","parameters":{"effect":{"value":"[parameters(''apiAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90","parameters":{"effect":{"value":"[parameters(''functionAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe","parameters":{"effect":{"value":"[parameters(''webAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e","parameters":{"effect":{"value":"[parameters(''apiAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9","parameters":{"effect":{"value":"[parameters(''functionAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71","parameters":{"effect":{"value":"[parameters(''webAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951","parameters":{"effect":{"value":"[parameters(''apiAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{"effect":{"value":"[parameters(''functionAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e","parameters":{"effect":{"value":"[parameters(''webAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d","parameters":{"effect":{"value":"[parameters(''apiAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55","parameters":{"effect":{"value":"[parameters(''functionAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0","parameters":{"effect":{"value":"[parameters(''webAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac","parameters":{"effect":{"value":"[parameters(''apiAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5","parameters":{"effect":{"value":"[parameters(''functionAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9","parameters":{"effect":{"value":"[parameters(''webAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac","parameters":{"effect":{"value":"[parameters(''apiAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c","parameters":{"effect":{"value":"[parameters(''functionAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a","parameters":{"effect":{"value":"[parameters(''webAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestNodeJsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestNodeJsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vnetEnableDDoSProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd","parameters":{"effect":{"value":"[parameters(''vnetEnableDDoSProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9","parameters":{"effect":{"value":"[parameters(''sqlServerAdvancedDataSecurityMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlManagedInstanceAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9","parameters":{"effect":{"value":"[parameters(''sqlManagedInstanceAdvancedDataSecurityMonitoringEffect'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","type":"Microsoft.Authorization/policySetDefinitions","name":"1f3afdf9-d0c9-4c3d-847f-89da613e70a8"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"installedApplication":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6","parameters":{"installedApplication":{"value":"[parameters(''installedApplication'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1","type":"Microsoft.Authorization/policySetDefinitions","name":"25ef9b72-4af2-4501-acd1-fc814e73dde1"},{"properties":{"displayName":"[Preview]:
        Audit that password security settings are set correctly inside Linux and Windows
        machines","policyType":"BuiltIn","description":"This initiative will both
        deploy the policy requirements and audit that password security settings are
        set correctly inside Linux and Windows machines. For more information on guest
        configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df"},{"policyDefinitionReferenceId":"Deploy_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"policyDefinitionReferenceId":"Deploy_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"policyDefinitionReferenceId":"Deploy_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe"},{"policyDefinitionReferenceId":"Audit_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"policyDefinitionReferenceId":"Audit_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"policyDefinitionReferenceId":"Audit_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"policyDefinitionReferenceId":"Audit_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6","type":"Microsoft.Authorization/policySetDefinitions","name":"3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VMs","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the Virtual Machines (VMs) in the specified scope (Management
        group, Subscription or resource group). Takes Log Analytics workspace as parameter.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a","type":"Microsoft.Authorization/policySetDefinitions","name":"55f3eceb-5573-4f18-9695-226972c6d74a"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VM Scale Sets (VMSS)","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the VM Scale Sets in the specified scope (Management group,
        Subscription or resource group). Takes Log Analytics workspace as parameter.
        Note: if your scale set upgradePolicy is set to Manual, you need to apply
        the extension to the all VMs in the set by calling upgrade on them. In CLI
        this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad","type":"Microsoft.Authorization/policySetDefinitions","name":"75714362-cae7-409e-9b99-a8e5075b7fad"},{"properties":{"displayName":"[Preview]
        Audit that Windows web servers are using secure communication protocols","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that Windows
        web servers are using secure communication protocols (TLS 1.1 or TLS 1.2).
        For more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"policyDefinitionReferenceId":"Audit_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c","type":"Microsoft.Authorization/policySetDefinitions","name":"8bc55e6b-e9d5-4266-8dac-f688d151ec9c"},{"properties":{"displayName":"[Preview]:
        Enable Data Protection Suite","policyType":"BuiltIn","description":"Enable
        data protection for SQL servers. This initiative is assigned automatically
        by Azure Security Center Standard Tier.","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"deployThreatDetectionOnSqlServers","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","type":"Microsoft.Authorization/policySetDefinitions","name":"9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e","type":"Microsoft.Authorization/policySetDefinitions","name":"c937dcb4-4398-4b39-8d63-4a6be432252e"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2","type":"Microsoft.Authorization/policySetDefinitions","name":"d7fff7ea-9d47-4952-b854-b7da261e48f2"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20","type":"Microsoft.Authorization/policySetDefinitions","name":"f48bcc78-5400-4fb0-b913-5140a2e5fa20"},{"properties":{"displayName":"rohitbh
        : Azure Monitor","policyType":"Custom","description":"Contains many policies
        with DeployIfNotExists effect with assignPermissions set at the parameter
        at the individual policy definition level.","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2476fb6f-011e-4bc4-9d07-ba137949735d","type":"Microsoft.Authorization/policySetDefinitions","name":"2476fb6f-011e-4bc4-9d07-ba137949735d"},{"properties":{"displayName":"robga
        test category","policyType":"Custom","metadata":{"category":"test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"12670347827388363681","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2616b647-f45e-4c9b-96fe-4928dfde615a","type":"Microsoft.Authorization/policySetDefinitions","name":"2616b647-f45e-4c9b-96fe-4928dfde615a"},{"properties":{"displayName":"rohitbh
        : No DINE","policyType":"Custom","description":"Contains no policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring"},"parameters":{"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/351907c4-cd47-4e63-8246-c591645a58d6","type":"Microsoft.Authorization/policySetDefinitions","name":"351907c4-cd47-4e63-8246-c591645a58d6"},{"properties":{"displayName":"cosmosdb
        new aliases test","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"5701618597132748228","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0","parameters":{}},{"policyDefinitionReferenceId":"9148562625737659571","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7","parameters":{}},{"policyDefinitionReferenceId":"1317257300482699336","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd","parameters":{}},{"policyDefinitionReferenceId":"636235743263978372","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce","parameters":{}},{"policyDefinitionReferenceId":"6540762518326135304","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160","parameters":{}},{"policyDefinitionReferenceId":"16237668974108817340","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164","type":"Microsoft.Authorization/policySetDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd164"},{"properties":{"displayName":"rohitbh:
        Initiative containing some definitions with deployIfNotExists effect","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"3301615874834833614","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}},{"policyDefinitionReferenceId":"8044870099827093134","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/471eddb2-9421-4b81-8a25-3a0b849544dd","type":"Microsoft.Authorization/policySetDefinitions","name":"471eddb2-9421-4b81-8a25-3a0b849544dd"},{"properties":{"displayName":"rohitbh
        : oms vm linux parameterized effect","policyType":"Custom","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Effect","strongType":"omsWorkspace"},"allowedValues":["deployIfNotExists","disabled"]},"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7548235847093577126","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/539147f6-940a-49c1-a0f3-db04b8a7d9db","type":"Microsoft.Authorization/policySetDefinitions","name":"539147f6-940a-49c1-a0f3-db04b8a7d9db"},{"properties":{"displayName":"Diagnostic
        logs test","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypes":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"16751317232073684559","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","parameters":{"listOfResourceTypes":{"value":["Microsoft.HDInsight/clusters","Microsoft.HDInsight/clusters/applications","Microsoft.HDInsight/clusters/operationresults","Microsoft.HDInsight/locations","Microsoft.HDInsight/locations/azureasyncoperations","Microsoft.HDInsight/locations/operationresults","Microsoft.HDInsight/locations/capabilities","Microsoft.HDInsight/operations","Microsoft.HDInsight/locations/validateCreateRequest","Microsoft.HDInsight/locations/usages"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/68bcb2cc-b088-472f-a877-ac858014f0bb","type":"Microsoft.Authorization/policySetDefinitions","name":"68bcb2cc-b088-472f-a877-ac858014f0bb"},{"properties":{"displayName":"Policy
        tracked resources SDK tests","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"6346022531429970426","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/71289c53-22e7-4f31-a6dd-780b532380c2","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/71289c53-22e7-4f31-a6dd-780b532380c6","type":"Microsoft.Authorization/policySetDefinitions","name":"71289c53-22e7-4f31-a6dd-780b532380c6"},{"properties":{"displayName":"robgatestinitmultiparam","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name1"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value1"}},"TAGNAME_2":{"type":"String","metadata":{"displayName":"Tag
        Name2"}},"TAGVALUE_2":{"type":"String","metadata":{"displayName":"Tag Value2"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}},{"policyDefinitionReferenceId":"14987881155449304382","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_2'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/73933cd4-bc06-4e14-8166-3a7109eca21b","type":"Microsoft.Authorization/policySetDefinitions","name":"73933cd4-bc06-4e14-8166-3a7109eca21b"},{"properties":{"displayName":"rohitbh
        : One DINE","policyType":"Custom","description":"Contains one policy with
        DeployIfNotExists effect","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"},"category":"Monitoring"},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"12822089530504669560","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"}}},{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/74016c36-0a9a-436a-8436-291d54eab1a2","type":"Microsoft.Authorization/policySetDefinitions","name":"74016c36-0a9a-436a-8436-291d54eab1a2"},{"properties":{"displayName":"jilim
        allowed set","policyType":"Custom","metadata":{"category":"Test"},"parameters":{"LISTOFALLOWEDSKUS_1":{"type":"Array","metadata":{"displayName":"Allowed
        SKUs","strongType":"VMSKUs"}},"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"8962248944013962433","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","parameters":{"listOfAllowedSKUs":{"value":"[parameters(''LISTOFALLOWEDSKUS_1'')]"}}},{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/762007ec-c5ba-41ae-a52d-db0834bea096","type":"Microsoft.Authorization/policySetDefinitions","name":"762007ec-c5ba-41ae-a52d-db0834bea096"},{"properties":{"displayName":"TestAdditionalResourceType","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4146325350290724164","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Sql/servers/firewallRules","TrendMicro.DeepSecurity/listCommunicationPreference"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/80894954-5ae1-4391-975d-630e5586d07a","type":"Microsoft.Authorization/policySetDefinitions","name":"80894954-5ae1-4391-975d-630e5586d07a"},{"properties":{"displayName":"jilim
        rt group set","policyType":"Custom","description":"1","metadata":{"category":"Test","parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"ALLOWEDTYPES_1":{"type":"Array","metadata":{"displayName":"Allowed
        resource types","description":null,"strongType":"resourceTypes"},"allowedValues":["Microsoft.EventGrid/domains","Microsoft.EventGrid/domains/topics","Microsoft.EventGrid/locations"]}},"policyDefinitions":[{"policyDefinitionReferenceId":"18341726042324576950","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Cdn/checkNameAvailability","Microsoft.Cdn/checkResourceUsage","Microsoft.Cdn/profiles"]}}},{"policyDefinitionReferenceId":"1359233886895761531","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c872f951-1c5d-4c61-89dd-aee2350a11ba","parameters":{"allowedTypes":{"value":"[parameters(''ALLOWEDTYPES_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/82d42e20-f682-48dc-95b1-144f0963f0c1","type":"Microsoft.Authorization/policySetDefinitions","name":"82d42e20-f682-48dc-95b1-144f0963f0c1"},{"properties":{"displayName":"tags","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9736595915162791837","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t1"},"tagValue":{"value":"t1v"}}},{"policyDefinitionReferenceId":"5376449293497609056","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t2"},"tagValue":{"value":"t2v"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/875cf75e-49c3-47f8-ab8d-89ba3d2311a0","type":"Microsoft.Authorization/policySetDefinitions","name":"875cf75e-49c3-47f8-ab8d-89ba3d2311a0"},{"properties":{"displayName":"ComplianceTestInitiative","policyType":"Custom","description":"Compliance
        test initiative ","metadata":{"category":"Compliance test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4047897157028507992","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus"]}}},{"policyDefinitionReferenceId":"4859121137597195236","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["centralus"]}}},{"policyDefinitionReferenceId":"8935913113203900114","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus2"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad","type":"Microsoft.Authorization/policySetDefinitions","name":"a03db67e-a286-43c3-9098-b2da83d361ad"},{"properties":{"displayName":"test_policysetgqko4b_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"6058980588454309585","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policygehbsyfdw","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policysetjf4n3w","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policysetjf4n3w"},{"properties":{"displayName":"rohitbh
        : DINE mulitple policies with no role definitions","policyType":"Custom","metadata":{"parameterScopes":{"storageAccountsResourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"661064339838764944","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","parameters":{"storageAccountsResourceGroup":{"value":"rohitbhtest"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/b03bf722-f2a8-4a84-8af6-f43b28b5a917","type":"Microsoft.Authorization/policySetDefinitions","name":"b03bf722-f2a8-4a84-8af6-f43b28b5a917"},{"properties":{"displayName":"robgaparamtest","policyType":"Custom","metadata":{},"parameters":{"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/c020e9eb-47d4-434a-8627-e202808ed117","type":"Microsoft.Authorization/policySetDefinitions","name":"c020e9eb-47d4-434a-8627-e202808ed117"},{"properties":{"displayName":"rohitbh
        : Many DINE","policyType":"Custom","description":"Contains many policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/da84593c-b133-40c2-8524-c79fd38e7450","type":"Microsoft.Authorization/policySetDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7450"},{"properties":{"displayName":"test_sandipsh123","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002","type":"Microsoft.Authorization/policySetDefinitions","name":"db6c5074-a529-4cc8-8882-43f10ef42002"},{"properties":{"displayName":"MuratTest","policyType":"Custom","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and it''s value","parameters":{"tagName":{"value":"murat"},"tagValue":{"value":"ersan"}}},{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}},{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and its value","parameters":{"tagName":{"value":"testupdate"},"tagValue":{"value":"ignite"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f","type":"Microsoft.Authorization/policySetDefinitions","name":"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f"},{"properties":{"displayName":"Initiative
        with my parameterized effect policy","policyType":"Custom","metadata":{"category":"camarvin","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Initiative
        effect","description":null},"defaultValue":"audit"}},"policyDefinitions":[{"policyDefinitionReferenceId":"16025301204423402856","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"audit"}}},{"policyDefinitionReferenceId":"15232055014610564026","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078","type":"Microsoft.Authorization/policySetDefinitions","name":"e6884163-54c6-4f5e-9570-9e4cbd95b078"},{"properties":{"displayName":"robga:
        initiative parameters","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/f872dbd0-c410-4182-b982-bd24169b4222","type":"Microsoft.Authorization/policySetDefinitions","name":"f872dbd0-c410-4182-b982-bd24169b4222"},{"properties":{"displayName":"testDisplay","policyType":"Custom","description":"Updated
        Unit test junk: sorry for littering. Please delete me!","policyDefinitions":[{"policyDefinitionReferenceId":"6782502132987446742","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps9867"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/ps3866","type":"Microsoft.Authorization/policySetDefinitions","name":"ps3866"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['99802']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:19 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: 'b''b\''{"properties": {"displayName": "test_policyset000005_new", "description":
      "desc_for_test_policyset_123_new", "parameters": {"allowedLocations": {"type":
      "array", "metadata": {"description": "The list of locations that can be specified
      when deploying resources", "strongType": "location", "displayName": "Allowed
      locations"}}}, "policyDefinitions": [{"policyDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002",
      "parameters": {"allowedLocations": {"value": "[parameters(\\\''allowedLocations\\\'')]"}}}]}}\'''''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition create]
      Connection: [keep-alive]
      Content-Length: ['595']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-n --definitions --display-name --description --params]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"10659472440009052076","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['887']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:20 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1198']
    status: {code: 201, message: Created}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition update]
      Connection: [keep-alive]
      ParameterSetName: [-n --params]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"10659472440009052076","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['887']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:21 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: 'b''b\''{"properties": {"displayName": "test_policyset000005_new", "description":
      "desc_for_test_policyset_123_new", "parameters": {"allowedLocations": {"type":
      "array", "metadata": {"displayName": "Allowed locations 2"}}}, "policyDefinitions":
      [{"policyDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002",
      "parameters": {"allowedLocations": {"value": "[parameters(\\\''allowedLocations\\\'')]"}}}]}}\'''''
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition update]
      Connection: [keep-alive]
      Content-Length: ['484']
      Content-Type: [application/json; charset=utf-8]
      ParameterSetName: [-n --params]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations 2"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"10659472440009052076","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['780']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:22 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-writes: ['1199']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition delete]
      Connection: [keep-alive]
      Content-Length: ['0']
      ParameterSetName: [-n]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policyset000005_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations 2"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"10659472440009052076","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policyset000004","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policyset000004"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['780']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:22 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-deletes: ['14998']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy set-definition list]
      Connection: [keep-alive]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-05-01
  response:
    body: {string: '{"value":[{"properties":{"displayName":"[Preview]: Enable Monitoring
        in Azure Security Center","policyType":"BuiltIn","description":"Monitor all
        the available security recommendations in Azure Security Center. This is the
        default policy for Azure Security Center.","metadata":{"category":"Security
        Center"},"parameters":{"systemUpdatesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        system updates","description":"Enable or disable reporting of system updates"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        OS vulnerabilities","description":"Enable or disable OS vulnerabilities monitoring
        (based on a configured baseline)"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        endpoint protection","description":"Enable or disable endpoint protection
        monitoring"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disk encryption","description":"Enable or disable the monitoring for VM disk
        encryption"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        network security groups","description":"Enable or disable monitoring of network
        security groups with permissive rules"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        web application firewall","description":"Enable or disable the monitoring
        of unprotected web applications"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"type":"String","metadata":{"displayName":"Enable
        Next Generation Firewall (NGFW) monitoring","description":"Enable or disable
        monitoring network endpoints without a Next Generation Firewall"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        vulnerability assesment","description":"Enable or disable the detection of
        VM vulnerabilities by a vulnerability assessment solution"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        storage blob encryption","description":"Enable or disable the monitoring of
        blob encryption for storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"jitNetworkAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        JIT network access","description":"Enable or disable the monitoring of network
        just In time access"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        application whitelisting","description":"Enable or disable the monitoring
        of application whitelisting in Azure Security Center"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL auditing","description":"Enable or disable the monitoring of unaudited
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbEncryptionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL encryption","description":"Enable or disable the monitoring of unencrypted
        SQL databases"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlServerAuditingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL Servers auditing","description":"Enable or disable the monitoring of unaudited
        SQL Servers"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInAppServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure App Services","description":"Enable or disable the
        monitoring of diagnostics logs in Azure App Services"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"encryptionOfAutomationAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        encryption of automation accounts","description":"Enable or disable the monitoring
        of automation account encryption"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Batch accounts","description":"Enable or disable the monitoring
        of diagnostic logs in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInBatchAccountRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) for logs in Batch accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"metricAlertsInBatchAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        metric alerts in Batch accounts","description":"Enable or disable the monitoring
        of metric alerts in Batch accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"classicComputeVMsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic compute VMs","description":"Enable or disable the monitoring of classic
        compute VMs"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"classicStorageAccountsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        classic storage accounts","description":"Enable or disable the monitoring
        of classic storage accounts"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Analytics accounts","description":"Enable or
        disable the monitoring of diagnostic logs in Data Lake Analytics accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Analytics accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Data Lake Store accounts","description":"Enable or disable
        the monitoring of diagnostic logs in Data Lake Store accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Data Lake Store accounts","description":"The
        required diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Event Hub accounts","description":"Enable or disable the
        monitoring of diagnostic logs in Event Hub accounts"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInEventHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Event Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Key Vault vaults","description":"Enable or disable the
        monitoring of diagnostic logs in Key Vault vaults"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Key Vault vaults","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Logic Apps workflows","description":"Enable or disable
        the monitoring of diagnostic logs in Logic Apps workflows"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Logic Apps workflows","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Redis Cache","description":"Enable or disable the
        monitoring of diagnostic logs in Azure Redis Cache"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Azure Search service","description":"Enable or disable
        the monitoring of diagnostic logs in Azure Search service"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInSearchServiceRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Azure Search service","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"aadAuthenticationInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Azure Active Directory authentication in Service Fabric","description":"Enable
        or disable the monitoring of Azure Active Directory for client authentication
        in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        cluster protection level in Service Fabric","description":"Enable or disable
        the monitoring of cluster protection level in Service Fabric"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Bus","description":"Enable or disable the monitoring
        of diagnostic logs in Service Bus"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInServiceBusRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Service Bus","description":"The required diagnostic
        logs retention period in days"},"defaultValue":"365"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Service Bus namespace authorization rules","description":"Enable or disable
        the monitoring of Service Bus namespace authorization rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the provisioning of an Azure AD admininistrator for SQL server","description":"Enable
        or disable the monitoring of an Azure AD admininistrator for SQL server"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the secure transfer to storage account","description":"Enable or disable the
        monitoring of secure transfer to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Stream Analytics","description":"Enable or disable the
        monitoring of diagnostic logs in Stream Analytics"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInStreamAnalyticsRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in Stream Analytics","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"useRbacRulesMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        of using built-in RBAC rules","description":"Enable or disable the monitoring
        of using built-in RBAC rules"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disabling of unrestricted network access to storage account","description":"Enable
        or disable the monitoring of network access to storage account"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"diagnosticsLogsInServiceFabricMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in Service Fabric","description":"Enable or disable the monitoring
        of diagnostic logs in Service Fabric"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"accessRulesInEventHubNamespaceMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hub namespaces","description":"Enable or disable the
        monitoring of access rules in Event Hub namespaces"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"},"accessRulesInEventHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        access rules in Event Hubs","description":"Enable or disable the monitoring
        of access rules in Event Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlDbVulnerabilityAssesmentMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        SQL vulnerability assessment results","description":"Enable or disable the
        monitoring of Vulnerability Assessment scan results and recommendations for
        how to remediate database vulnerabilities."},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateLessThanOwnersMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        maximum number of owners","description":"Enable or disable the monitoring
        of maximum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityDesignateMoreThanOneOwnerMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        minimus number of owners","description":"Enable or disable the monitoring
        of minimum owners in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with owner permissions","description":"Enable or disable
        the monitoring of MFA for accounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with write permissions","description":"Enable or disable
        the monitoring of MFA for accounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityEnableMFAForReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        MFA for accounts with read permissions","description":"Enable or disable the
        monitoring of MFA for accounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts with owner permissions","description":"Enable or
        disable the monitoring of deprecated acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveDeprecatedAccountMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove deprecated accounts","description":"Enable or disable the monitoring
        of deprecated acounts in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with owner permissions","description":"Enable or
        disable the monitoring of external acounts with owner permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with write permissions","description":"Enable or
        disable the monitoring of external acounts with write permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        remove external accounts with read permissions","description":"Enable or disable
        the monitoring of external acounts with read permissions in subscription"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for API App","description":"Enable or disable the
        monitoring of IP restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Function App","description":"Enable or disable
        the monitoring of IP restrictions for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppConfigureIPRestrictionsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        Configure IP restrictions for Web App","description":"Enable or disable the
        monitoring of IP restrictions for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for API App","description":"Enable or disable the
        monitoring of remote debugging for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Function App","description":"Enable or disable
        the monitoring of remote debugging for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableRemoteDebuggingMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable remote debugging for Web App","description":"Enable or disable the
        monitoring of remote debugging for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for API App","description":"Enable or disable the monitoring
        of web sockets for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Function App","description":"Enable or disable the
        monitoring of web sockets for Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppDisableWebSocketsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        disable web sockets for Web App","description":"Enable or disable the monitoring
        of web sockets for Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in API App","description":"Enable or disable the monitoring
        of the use of HTTPS in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in function App","description":"Enable or disable the monitoring
        of the use of HTTPS in function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppEnforceHttpsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the use of HTTPS in Web App","description":"Enable or disable the monitoring
        of the use of HTTPS in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API App","description":"Enable or disable the monitoring
        of CORS restrictions for API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Function","description":"Enable or disable the
        monitoring of CORS restrictions for API Function"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppRestrictCORSAccessMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the CORS restrictions for API Web","description":"Enable or disable the monitoring
        of CORS restrictions for API Web"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in API App","description":"Enable or disable the monitoring
        of custom domain use in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"functionAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Function App","description":"Enable or disable the
        monitoring of custom domain use in Function App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedCustomDomainsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        the custom domain use in Web App","description":"Enable or disable the monitoring
        of custom domain use in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in API App","description":"Enable or disable the monitoring
        of .Net version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestDotNetMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest .Net in Web App","description":"Enable or disable the monitoring
        of .Net version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in API App","description":"Enable or disable the monitoring
        of Java version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestJavaMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Java in Web App","description":"Enable or disable the monitoring
        of Java version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestNodeJsMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Node.js in Web App","description":"Enable or disable the monitoring
        of Node.js version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in API App","description":"Enable or disable the monitoring
        of PHP version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPHPMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest PHP in Web App","description":"Enable or disable the monitoring
        of PHP version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"apiAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in API App","description":"Enable or disable the monitoring
        of Python version in API App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"webAppUsedLatestPythonMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use latest Python in Web App","description":"Enable or disable the monitoring
        of Python version in Web App"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"vnetEnableDDoSProtectionMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        use of DDoS protection for virtual network","description":"Enable or disable
        the monitoring of DDoS protection for virtual network"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubMonitoringEffect":{"type":"String","metadata":{"displayName":"Monitor
        diagnostic logs in IoT Hubs","description":"Enable or disable the monitoring
        of diagnostic logs in IoT Hubs"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"diagnosticsLogsInIoTHubRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (in days) of logs in IoT Hub accounts","description":"The required
        diagnostic logs retention period in days"},"defaultValue":"365"},"sqlServerAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL servers without Advanced Data Security","description":"Enable or disable
        the monitoring of SQL servers without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect":{"type":"String","metadata":{"displayName":"Audit
        SQL managed instances without Advanced Data Security","description":"Enable
        or disable the monitoring of SQL managed instances without Advanced Data Security"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyDefinitions":[{"policyDefinitionReferenceId":"diagnosticsLogsInIoTHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInIoTHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInIoTHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceFabricMonitoringEffect","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubNamespaceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubNamespaceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"accessRulesInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","parameters":{"effect":{"value":"[parameters(''accessRulesInEventHubMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"disableUnrestrictedNetworkToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","parameters":{"effect":{"value":"[parameters(''disableUnrestrictedNetworkToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"useRbacRulesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","parameters":{"effect":{"value":"[parameters(''useRbacRulesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInStreamAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInStreamAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"secureTransferToStorageAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","parameters":{"effect":{"value":"[parameters(''secureTransferToStorageAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInSqlServerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInSqlServerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"namespaceAuthorizationRulesInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","parameters":{"effect":{"value":"[parameters(''namespaceAuthorizationRulesInServiceBusMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInServiceBusMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInServiceBusMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInServiceBusRetentionDays'')]"}}},{"policyDefinitionReferenceId":"clusterProtectionLevelInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","parameters":{"effect":{"value":"[parameters(''clusterProtectionLevelInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"aadAuthenticationInServiceFabricMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","parameters":{"effect":{"value":"[parameters(''aadAuthenticationInServiceFabricMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInSearchServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInSearchServiceMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInSearchServiceRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInRedisCacheMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInRedisCacheMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInLogicAppsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInLogicAppsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInLogicAppsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInKeyVaultMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInKeyVaultMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInKeyVaultRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInEventHubMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInEventHubMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInEventHubRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeStoreMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeStoreRetentionDays'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInDataLakeAnalyticsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInDataLakeAnalyticsRetentionDays'')]"}}},{"policyDefinitionReferenceId":"classicStorageAccountsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","parameters":{"effect":{"value":"[parameters(''classicStorageAccountsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"classicComputeVMsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","parameters":{"effect":{"value":"[parameters(''classicComputeVMsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"metricAlertsInBatchAccountPoolDeleteStart","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","parameters":{"effect":{"value":"[parameters(''metricAlertsInBatchAccountMonitoringEffect'')]"},"metricName":{"value":"PoolDeleteStartEvent"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInBatchAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInBatchAccountMonitoringEffect'')]"},"requiredRetentionDays":{"value":"[parameters(''diagnosticsLogsInBatchAccountRetentionDays'')]"}}},{"policyDefinitionReferenceId":"encryptionOfAutomationAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","parameters":{"effect":{"value":"[parameters(''encryptionOfAutomationAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diagnosticsLogsInAppServiceMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","parameters":{"effect":{"value":"[parameters(''diagnosticsLogsInAppServiceMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","parameters":{"effect":{"value":"[parameters(''sqlDbEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","parameters":{"effect":{"value":"[parameters(''sqlServerAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","parameters":{"effect":{"value":"[parameters(''sqlEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlAuditingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","parameters":{"effect":{"value":"[parameters(''sqlAuditingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemUpdatesMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","parameters":{"effect":{"value":"[parameters(''systemUpdatesMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"storageEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{"effect":{"value":"[parameters(''storageEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"jitNetworkAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","parameters":{"effect":{"value":"[parameters(''jitNetworkAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"adaptiveApplicationControlsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","parameters":{"effect":{"value":"[parameters(''adaptiveApplicationControlsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"networkSecurityGroupsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","parameters":{"effect":{"value":"[parameters(''networkSecurityGroupsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"systemConfigurationsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","parameters":{"effect":{"value":"[parameters(''systemConfigurationsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"endpointProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","parameters":{"effect":{"value":"[parameters(''endpointProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"diskEncryptionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","parameters":{"effect":{"value":"[parameters(''diskEncryptionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","parameters":{"effect":{"value":"[parameters(''vulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webApplicationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","parameters":{"effect":{"value":"[parameters(''webApplicationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"nextGenerationFirewallMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","parameters":{"effect":{"value":"[parameters(''nextGenerationFirewallMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlDbVulnerabilityAssesmentMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","parameters":{"effect":{"value":"[parameters(''sqlDbVulnerabilityAssesmentMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateLessThanOwnersMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","parameters":{"effect":{"value":"[parameters(''identityDesignateLessThanOwnersMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityDesignateMoreThanOneOwnerMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","parameters":{"effect":{"value":"[parameters(''identityDesignateMoreThanOneOwnerMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityEnableMFAForReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","parameters":{"effect":{"value":"[parameters(''identityEnableMFAForReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveDeprecatedAccountMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","parameters":{"effect":{"value":"[parameters(''identityRemoveDeprecatedAccountMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithOwnerPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithWritePermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithWritePermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"identityRemoveExternalAccountWithReadPermissionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","parameters":{"effect":{"value":"[parameters(''identityRemoveExternalAccountWithReadPermissionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53","parameters":{"effect":{"value":"[parameters(''apiAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90","parameters":{"effect":{"value":"[parameters(''functionAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppConfigureIPRestrictionsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe","parameters":{"effect":{"value":"[parameters(''webAppConfigureIPRestrictionsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e","parameters":{"effect":{"value":"[parameters(''apiAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9","parameters":{"effect":{"value":"[parameters(''functionAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableRemoteDebuggingMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71","parameters":{"effect":{"value":"[parameters(''webAppDisableRemoteDebuggingMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951","parameters":{"effect":{"value":"[parameters(''apiAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{"effect":{"value":"[parameters(''functionAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppDisableWebSocketsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e","parameters":{"effect":{"value":"[parameters(''webAppDisableWebSocketsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d","parameters":{"effect":{"value":"[parameters(''apiAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55","parameters":{"effect":{"value":"[parameters(''functionAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppEnforceHttpsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0","parameters":{"effect":{"value":"[parameters(''webAppEnforceHttpsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac","parameters":{"effect":{"value":"[parameters(''apiAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5","parameters":{"effect":{"value":"[parameters(''functionAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppRestrictCORSAccessMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9","parameters":{"effect":{"value":"[parameters(''webAppRestrictCORSAccessMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac","parameters":{"effect":{"value":"[parameters(''apiAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"functionAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c","parameters":{"effect":{"value":"[parameters(''functionAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedCustomDomainsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a","parameters":{"effect":{"value":"[parameters(''webAppUsedCustomDomainsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestDotNetMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestDotNetMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestJavaMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestJavaMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestNodeJsMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestNodeJsMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPHPMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPHPMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"apiAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644","parameters":{"effect":{"value":"[parameters(''apiAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"webAppUsedLatestPythonMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06","parameters":{"effect":{"value":"[parameters(''webAppUsedLatestPythonMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"vnetEnableDDoSProtectionMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd","parameters":{"effect":{"value":"[parameters(''vnetEnableDDoSProtectionMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlServerAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9","parameters":{"effect":{"value":"[parameters(''sqlServerAdvancedDataSecurityMonitoringEffect'')]"}}},{"policyDefinitionReferenceId":"sqlManagedInstanceAdvancedDataSecurityMonitoring","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9","parameters":{"effect":{"value":"[parameters(''sqlManagedInstanceAdvancedDataSecurityMonitoringEffect'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","type":"Microsoft.Authorization/policySetDefinitions","name":"1f3afdf9-d0c9-4c3d-847f-89da613e70a8"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"installedApplication":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6","parameters":{"installedApplication":{"value":"[parameters(''installedApplication'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1","type":"Microsoft.Authorization/policySetDefinitions","name":"25ef9b72-4af2-4501-acd1-fc814e73dde1"},{"properties":{"displayName":"[Preview]:
        Audit that password security settings are set correctly inside Linux and Windows
        machines","policyType":"BuiltIn","description":"This initiative will both
        deploy the policy requirements and audit that password security settings are
        set correctly inside Linux and Windows machines. For more information on guest
        configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df"},{"policyDefinitionReferenceId":"Deploy_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"policyDefinitionReferenceId":"Deploy_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"policyDefinitionReferenceId":"Deploy_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"policyDefinitionReferenceId":"Deploy_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"policyDefinitionReferenceId":"Deploy_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe"},{"policyDefinitionReferenceId":"Audit_MaximumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordAge","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"policyDefinitionReferenceId":"Audit_PasswordMustMeetComplexityRequirements","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"policyDefinitionReferenceId":"Audit_StorePasswordsUsingReversibleEncryption","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"policyDefinitionReferenceId":"Audit_EnforcePasswordHistory","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"policyDefinitionReferenceId":"Audit_MinimumPasswordLength","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid110","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid121","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b"},{"policyDefinitionReferenceId":"Audit_PasswordPolicy_msid232","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6","type":"Microsoft.Authorization/policySetDefinitions","name":"3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VMs","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the Virtual Machines (VMs) in the specified scope (Management
        group, Subscription or resource group). Takes Log Analytics workspace as parameter.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VM_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a","type":"Microsoft.Authorization/policySetDefinitions","name":"55f3eceb-5573-4f18-9695-226972c6d74a"},{"properties":{"displayName":"[Preview]:
        Enable Azure Monitor for VM Scale Sets (VMSS)","policyType":"BuiltIn","description":"Enable
        Azure Monitor for the VM Scale Sets in the specified scope (Management group,
        Subscription or resource group). Takes Log Analytics workspace as parameter.
        Note: if your scale set upgradePolicy is set to Manual, you need to apply
        the extension to the all VMs in the set by calling upgrade on them. In CLI
        this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"LogAnalyticsExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"LogAnalyticsExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069","parameters":{"logAnalytics":{"value":"[parameters(''logAnalytics_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Windows_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"}}},{"policyDefinitionReferenceId":"DependencyAgentExtension_Linux_VMSS_Deploy","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"LogAnalytics_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}},{"policyDefinitionReferenceId":"DependencyAgent_OSImage_VMSS_Audit","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''listOfImageIdToInclude_windows'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''listOfImageIdToInclude_linux'')]"}}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad","type":"Microsoft.Authorization/policySetDefinitions","name":"75714362-cae7-409e-9b99-a8e5075b7fad"},{"properties":{"displayName":"[Preview]
        Audit that Windows web servers are using secure communication protocols","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that Windows
        web servers are using secure communication protocols (TLS 1.1 or TLS 1.2).
        For more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"policyDefinitionReferenceId":"Audit_WindowsTLS","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c","type":"Microsoft.Authorization/policySetDefinitions","name":"8bc55e6b-e9d5-4266-8dac-f688d151ec9c"},{"properties":{"displayName":"[Preview]:
        Enable Data Protection Suite","policyType":"BuiltIn","description":"Enable
        data protection for SQL servers. This initiative is assigned automatically
        by Azure Security Center Standard Tier.","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"deployThreatDetectionOnSqlServers","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","type":"Microsoft.Authorization/policySetDefinitions","name":"9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_InstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e","type":"Microsoft.Authorization/policySetDefinitions","name":"c937dcb4-4398-4b39-8d63-4a6be432252e"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Windows VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Windows virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApp","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2","type":"Microsoft.Authorization/policySetDefinitions","name":"d7fff7ea-9d47-4952-b854-b7da261e48f2"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Linux VMs","policyType":"BuiltIn","description":"This
        initiative will both deploy the policy requirements and audit that the specified
        application is not installed inside Linux virtual machines. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyDefinitions":[{"policyDefinitionReferenceId":"Deploy_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0","parameters":{"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}}},{"policyDefinitionReferenceId":"Audit_NotInstalledApplicationLinux","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8"}]},"id":"/providers/Microsoft.Authorization/policySetDefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20","type":"Microsoft.Authorization/policySetDefinitions","name":"f48bcc78-5400-4fb0-b913-5140a2e5fa20"},{"properties":{"displayName":"rohitbh
        : Azure Monitor","policyType":"Custom","description":"Contains many policies
        with DeployIfNotExists effect with assignPermissions set at the parameter
        at the individual policy definition level.","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2476fb6f-011e-4bc4-9d07-ba137949735d","type":"Microsoft.Authorization/policySetDefinitions","name":"2476fb6f-011e-4bc4-9d07-ba137949735d"},{"properties":{"displayName":"robga
        test category","policyType":"Custom","metadata":{"category":"test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"12670347827388363681","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/2616b647-f45e-4c9b-96fe-4928dfde615a","type":"Microsoft.Authorization/policySetDefinitions","name":"2616b647-f45e-4c9b-96fe-4928dfde615a"},{"properties":{"displayName":"rohitbh
        : No DINE","policyType":"Custom","description":"Contains no policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring"},"parameters":{"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope"},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope"},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/351907c4-cd47-4e63-8246-c591645a58d6","type":"Microsoft.Authorization/policySetDefinitions","name":"351907c4-cd47-4e63-8246-c591645a58d6"},{"properties":{"displayName":"cosmosdb
        new aliases test","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"5701618597132748228","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0","parameters":{}},{"policyDefinitionReferenceId":"9148562625737659571","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7","parameters":{}},{"policyDefinitionReferenceId":"1317257300482699336","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd","parameters":{}},{"policyDefinitionReferenceId":"636235743263978372","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce","parameters":{}},{"policyDefinitionReferenceId":"6540762518326135304","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160","parameters":{}},{"policyDefinitionReferenceId":"16237668974108817340","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164","type":"Microsoft.Authorization/policySetDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd164"},{"properties":{"displayName":"rohitbh:
        Initiative containing some definitions with deployIfNotExists effect","policyType":"Custom","metadata":{"category":"Test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"3301615874834833614","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","parameters":{}},{"policyDefinitionReferenceId":"8044870099827093134","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/471eddb2-9421-4b81-8a25-3a0b849544dd","type":"Microsoft.Authorization/policySetDefinitions","name":"471eddb2-9421-4b81-8a25-3a0b849544dd"},{"properties":{"displayName":"rohitbh
        : oms vm linux parameterized effect","policyType":"Custom","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Effect","strongType":"omsWorkspace"},"allowedValues":["deployIfNotExists","disabled"]},"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","strongType":"omsWorkspace"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7548235847093577126","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/539147f6-940a-49c1-a0f3-db04b8a7d9db","type":"Microsoft.Authorization/policySetDefinitions","name":"539147f6-940a-49c1-a0f3-db04b8a7d9db"},{"properties":{"displayName":"Diagnostic
        logs test","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypes":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"16751317232073684559","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","parameters":{"listOfResourceTypes":{"value":["Microsoft.HDInsight/clusters","Microsoft.HDInsight/clusters/applications","Microsoft.HDInsight/clusters/operationresults","Microsoft.HDInsight/locations","Microsoft.HDInsight/locations/azureasyncoperations","Microsoft.HDInsight/locations/operationresults","Microsoft.HDInsight/locations/capabilities","Microsoft.HDInsight/operations","Microsoft.HDInsight/locations/validateCreateRequest","Microsoft.HDInsight/locations/usages"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/68bcb2cc-b088-472f-a877-ac858014f0bb","type":"Microsoft.Authorization/policySetDefinitions","name":"68bcb2cc-b088-472f-a877-ac858014f0bb"},{"properties":{"displayName":"Policy
        tracked resources SDK tests","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"6346022531429970426","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/71289c53-22e7-4f31-a6dd-780b532380c2","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/71289c53-22e7-4f31-a6dd-780b532380c6","type":"Microsoft.Authorization/policySetDefinitions","name":"71289c53-22e7-4f31-a6dd-780b532380c6"},{"properties":{"displayName":"robgatestinitmultiparam","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name1"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value1"}},"TAGNAME_2":{"type":"String","metadata":{"displayName":"Tag
        Name2"}},"TAGVALUE_2":{"type":"String","metadata":{"displayName":"Tag Value2"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}},{"policyDefinitionReferenceId":"14987881155449304382","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_2'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/73933cd4-bc06-4e14-8166-3a7109eca21b","type":"Microsoft.Authorization/policySetDefinitions","name":"73933cd4-bc06-4e14-8166-3a7109eca21b"},{"properties":{"displayName":"rohitbh
        : One DINE","policyType":"Custom","description":"Contains one policy with
        DeployIfNotExists effect","metadata":{"parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"},"category":"Monitoring"},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_WINDOWS_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_LINUX_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"12822089530504669560","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"}}},{"policyDefinitionReferenceId":"492067171675640903","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}},{"policyDefinitionReferenceId":"2492943854376579140","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_WINDOWS_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_LINUX_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/74016c36-0a9a-436a-8436-291d54eab1a2","type":"Microsoft.Authorization/policySetDefinitions","name":"74016c36-0a9a-436a-8436-291d54eab1a2"},{"properties":{"displayName":"jilim
        allowed set","policyType":"Custom","metadata":{"category":"Test"},"parameters":{"LISTOFALLOWEDSKUS_1":{"type":"Array","metadata":{"displayName":"Allowed
        SKUs","strongType":"VMSKUs"}},"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"8962248944013962433","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","parameters":{"listOfAllowedSKUs":{"value":"[parameters(''LISTOFALLOWEDSKUS_1'')]"}}},{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/762007ec-c5ba-41ae-a52d-db0834bea096","type":"Microsoft.Authorization/policySetDefinitions","name":"762007ec-c5ba-41ae-a52d-db0834bea096"},{"properties":{"displayName":"TestAdditionalResourceType","policyType":"Custom","metadata":{"parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4146325350290724164","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Sql/servers/firewallRules","TrendMicro.DeepSecurity/listCommunicationPreference"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/80894954-5ae1-4391-975d-630e5586d07a","type":"Microsoft.Authorization/policySetDefinitions","name":"80894954-5ae1-4391-975d-630e5586d07a"},{"properties":{"displayName":"jilim
        rt group set","policyType":"Custom","description":"1","metadata":{"category":"Test","parameterScopes":{"listOfResourceTypesAllowed":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"ALLOWEDTYPES_1":{"type":"Array","metadata":{"displayName":"Allowed
        resource types","description":null,"strongType":"resourceTypes"},"allowedValues":["Microsoft.EventGrid/domains","Microsoft.EventGrid/domains/topics","Microsoft.EventGrid/locations"]}},"policyDefinitions":[{"policyDefinitionReferenceId":"18341726042324576950","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","parameters":{"listOfResourceTypesAllowed":{"value":["Microsoft.Cdn/checkNameAvailability","Microsoft.Cdn/checkResourceUsage","Microsoft.Cdn/profiles"]}}},{"policyDefinitionReferenceId":"1359233886895761531","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c872f951-1c5d-4c61-89dd-aee2350a11ba","parameters":{"allowedTypes":{"value":"[parameters(''ALLOWEDTYPES_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/82d42e20-f682-48dc-95b1-144f0963f0c1","type":"Microsoft.Authorization/policySetDefinitions","name":"82d42e20-f682-48dc-95b1-144f0963f0c1"},{"properties":{"displayName":"tags","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9736595915162791837","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t1"},"tagValue":{"value":"t1v"}}},{"policyDefinitionReferenceId":"5376449293497609056","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"t2"},"tagValue":{"value":"t2v"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/875cf75e-49c3-47f8-ab8d-89ba3d2311a0","type":"Microsoft.Authorization/policySetDefinitions","name":"875cf75e-49c3-47f8-ab8d-89ba3d2311a0"},{"properties":{"displayName":"ComplianceTestInitiative","policyType":"Custom","description":"Compliance
        test initiative ","metadata":{"category":"Compliance test"},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"4047897157028507992","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus"]}}},{"policyDefinitionReferenceId":"4859121137597195236","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["centralus"]}}},{"policyDefinitionReferenceId":"8935913113203900114","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","parameters":{"allowedLocations":{"value":["eastus2"]}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad","type":"Microsoft.Authorization/policySetDefinitions","name":"a03db67e-a286-43c3-9098-b2da83d361ad"},{"properties":{"displayName":"test_policysetgqko4b_new","policyType":"Custom","description":"desc_for_test_policyset_123_new","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"6058980588454309585","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policygehbsyfdw","parameters":{"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/azure-cli-test-policysetjf4n3w","type":"Microsoft.Authorization/policySetDefinitions","name":"azure-cli-test-policysetjf4n3w"},{"properties":{"displayName":"rohitbh
        : DINE mulitple policies with no role definitions","policyType":"Custom","metadata":{"parameterScopes":{"storageAccountsResourceGroup":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{},"policyDefinitions":[{"policyDefinitionReferenceId":"9705281775767545600","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","parameters":{}},{"policyDefinitionReferenceId":"661064339838764944","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","parameters":{"storageAccountsResourceGroup":{"value":"rohitbhtest"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/b03bf722-f2a8-4a84-8af6-f43b28b5a917","type":"Microsoft.Authorization/policySetDefinitions","name":"b03bf722-f2a8-4a84-8af6-f43b28b5a917"},{"properties":{"displayName":"robgaparamtest","policyType":"Custom","metadata":{},"parameters":{"LISTOFRESOURCETYPESNOTALLOWED_1":{"type":"Array","metadata":{"displayName":"Not
        allowed resource types","strongType":"resourceTypes"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"13081098409154781365","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","parameters":{"listOfResourceTypesNotAllowed":{"value":"[parameters(''LISTOFRESOURCETYPESNOTALLOWED_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/c020e9eb-47d4-434a-8627-e202808ed117","type":"Microsoft.Authorization/policySetDefinitions","name":"c020e9eb-47d4-434a-8627-e202808ed117"},{"properties":{"displayName":"rohitbh
        : Many DINE","policyType":"Custom","description":"Contains many policies with
        DeployIfNotExists effect","metadata":{"category":"Monitoring","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"LOGANALYTICS_1":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":null,"strongType":"omsWorkspace","assignPermissions":true}},"LISTOFIMAGEIDTOINCLUDE_1":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":null},"defaultValue":[]},"LISTOFIMAGEIDTOINCLUDE_2":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":null},"defaultValue":[]}},"policyDefinitions":[{"policyDefinitionReferenceId":"4755676876307240960","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"13418251844728914181","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","parameters":{"logAnalytics":{"value":"[parameters(''LOGANALYTICS_1'')]"},"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"12068070188350812865","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"}}},{"policyDefinitionReferenceId":"8310573323379365078","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","parameters":{"listOfImageIdToInclude":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"560174196401503668","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}},{"policyDefinitionReferenceId":"7752708915834271964","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","parameters":{"listOfImageIdToInclude_windows":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_1'')]"},"listOfImageIdToInclude_linux":{"value":"[parameters(''LISTOFIMAGEIDTOINCLUDE_2'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/da84593c-b133-40c2-8524-c79fd38e7450","type":"Microsoft.Authorization/policySetDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7450"},{"properties":{"displayName":"test_sandipsh123","policyType":"Custom","metadata":{},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002","type":"Microsoft.Authorization/policySetDefinitions","name":"db6c5074-a529-4cc8-8882-43f10ef42002"},{"properties":{"displayName":"MuratTest","policyType":"Custom","metadata":{"category":"Security
        Center"},"parameters":{},"policyDefinitions":[{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and it''s value","parameters":{"tagName":{"value":"murat"},"tagValue":{"value":"ersan"}}},{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","parameters":{}},{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and its value","parameters":{"tagName":{"value":"testupdate"},"tagValue":{"value":"ignite"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f","type":"Microsoft.Authorization/policySetDefinitions","name":"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f"},{"properties":{"displayName":"Initiative
        with my parameterized effect policy","policyType":"Custom","metadata":{"category":"camarvin","parameterScopes":{"logAnalytics":"/subscriptions/00000000-0000-0000-0000-000000000000"}},"parameters":{"EFFECT_1":{"type":"String","metadata":{"displayName":"Initiative
        effect","description":null},"defaultValue":"audit"}},"policyDefinitions":[{"policyDefinitionReferenceId":"16025301204423402856","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"audit"}}},{"policyDefinitionReferenceId":"15232055014610564026","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","parameters":{"effect":{"value":"[parameters(''EFFECT_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078","type":"Microsoft.Authorization/policySetDefinitions","name":"e6884163-54c6-4f5e-9570-9e4cbd95b078"},{"properties":{"displayName":"robga:
        initiative parameters","policyType":"Custom","metadata":{},"parameters":{"TAGNAME_1":{"type":"String","metadata":{"displayName":"Tag
        Name"}},"TAGVALUE_1":{"type":"String","metadata":{"displayName":"Tag Value"}}},"policyDefinitions":[{"policyDefinitionReferenceId":"7154720483946859542","policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","parameters":{"tagName":{"value":"[parameters(''TAGNAME_1'')]"},"tagValue":{"value":"[parameters(''TAGVALUE_1'')]"}}}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/f872dbd0-c410-4182-b982-bd24169b4222","type":"Microsoft.Authorization/policySetDefinitions","name":"f872dbd0-c410-4182-b982-bd24169b4222"},{"properties":{"displayName":"testDisplay","policyType":"Custom","description":"Updated
        Unit test junk: sorry for littering. Please delete me!","policyDefinitions":[{"policyDefinitionReferenceId":"6782502132987446742","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps9867"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policySetDefinitions/ps3866","type":"Microsoft.Authorization/policySetDefinitions","name":"ps3866"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['99802']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:33 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition delete]
      Connection: [keep-alive]
      Content-Length: ['0']
      ParameterSetName: [-n]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002?api-version=2018-05-01
  response:
    body: {string: '{"properties":{"displayName":"test_policy000003","policyType":"Custom","description":"desc_for_test_policy_123","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policy000002","type":"Microsoft.Authorization/policyDefinitions","name":"azure-cli-test-policy000002"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['670']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:34 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-deletes: ['14999']
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition list]
      Connection: [keep-alive]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions?api-version=2018-05-01
  response:
    body: {string: '{"value":[{"properties":{"displayName":"Audit virtual machines
        without disaster recovery configured","policyType":"BuiltIn","mode":"All","description":"Audit
        virtual machines which do not have disaster recovery configured. To learn
        more about disaster recovery, visit https://aka.ms/asr-doc.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Resources/links","existenceCondition":{"field":"name","like":"ASR-Protect-*"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56","type":"Microsoft.Authorization/policyDefinitions","name":"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56"},{"properties":{"displayName":"[Preview]:
        Audit Web Sockets state for a Function App","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within an Function app must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","type":"Microsoft.Authorization/policyDefinitions","name":"001802d1-4969-4c82-a700-c29c6c6f9bbd"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","type":"Microsoft.Authorization/policyDefinitions","name":"053d3325-282c-4e5c-b944-24faffd30d77"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Azure Data Lake Store","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","type":"Microsoft.Authorization/policyDefinitions","name":"057ef27e-665e-4328-8ea3-04b3122bd9fb"},{"properties":{"displayName":"Audit
        SQL DB Level Audit Setting","policyType":"BuiltIn","mode":"All","description":"Audit
        DB level audit setting for SQL databases","metadata":{"category":"SQL","deprecated":true},"parameters":{"setting":{"type":"String","metadata":{"displayName":"Audit
        Setting"},"allowedValues":["enabled","disabled"]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/auditingSettings","name":"default","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"Audit
        VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"},{"properties":{"displayName":"[Preview]:  Audit
        CORS resource access restrictions for a Function App","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        Function app. Allow only required domains to interact with your Function app.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RestrictCORSAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5","type":"Microsoft.Authorization/policyDefinitions","name":"0820b7b9-23aa-4725-a1ce-ae4558f718e5"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed. The list of OS images will be updated over
        time as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        values: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","type":"Microsoft.Authorization/policyDefinitions","name":"0868462e-646c-4fe3-9ced-a733534b6a2c"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using latest supported PHP Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported PHP version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPHP","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c","type":"Microsoft.Authorization/policyDefinitions","name":"08b17839-76c6-4015-90e0-33d9d54d219c"},{"properties":{"displayName":"[Preview]:
        Audit minimum number of owners for subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate more than one subscription owner in order to have
        administrator access redundancy.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateMoreThanOneOwner","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","type":"Microsoft.Authorization/policyDefinitions","name":"09024ccc-0c5f-475e-9457-b7c0d9ed487b"},{"properties":{"displayName":"[Preview]:
        Monitor unencrypted VM Disks in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"VMs
        without an enabled disk encryption will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","type":"Microsoft.Authorization/policyDefinitions","name":"0961003e-5a0a-4549-abde-af6a37f2724d"},{"properties":{"displayName":"Audit
        resource location matches resource group location","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that the resource location matches its resource group location","metadata":{"category":"General"},"policyRule":{"if":{"field":"location","notIn":["[resourcegroup().location]","global"]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","type":"Microsoft.Authorization/policyDefinitions","name":"0a914e76-4921-4c19-b460-a2d36003525a"},{"properties":{"displayName":"[Preview]:
        Audit remote debugging state for a Function App","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on an function app.  Remote
        debugging should be turned off.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableRemoteDebugging","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9","type":"Microsoft.Authorization/policyDefinitions","name":"0e60b895-3786-45da-8377-9c6b4b6ac5f9"},{"properties":{"displayName":"[Preview]:
        Audit Dependency Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed. The list of OS images will be updated over time as
        support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","type":"Microsoft.Authorization/policyDefinitions","name":"11ac78e3-31bc-4f0c-8434-37ab963cea07"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that an application is installed inside Windows
        VMs","policyType":"BuiltIn","mode":"Indexed","description":"Include this rule
        to deploy the VM extension for Microsoft Guest Configuration, the VM extension
        for Microsoft Azure Managed Service Identity, and the required content to
        audit that an application is installed inside Windows virtual machines. This
        policy should only be used along with its corresponding audit policy in an
        initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"installedApplication":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WhitelistedApplication","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WhitelistedApplication"},"installedApplication":{"value":"[parameters(''installedApplication'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"installedApplication":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[InstalledApplication]bwhitelistedapp;Name","value":"[parameters(''installedApplication'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6","type":"Microsoft.Authorization/policyDefinitions","name":"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs have a minimum password age
        of 1 day","policyType":"BuiltIn","mode":"Indexed","description":"Include this
        rule to deploy the requirements to audit that Windows machines have the minimum
        password age setting set to 1 day. This security setting determines the period
        of time (in days) that a password must be used before the user can change
        it. This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordAge","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df","type":"Microsoft.Authorization/policyDefinitions","name":"16390df4-2f73-4b42-af13-c801066763df"},{"properties":{"displayName":"Audit
        transparent data encryption status","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        transparent data encryption status for SQL databases","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"enabled"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"17k78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed. The list of OS images will be updated over
        time as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","type":"Microsoft.Authorization/policyDefinitions","name":"1c210e94-a481-4beb-95fa-1571b434fb04"},{"properties":{"displayName":"Audit
        use of classic virtual machines","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your virtual machines to provide security
        enhancements such as: stronger access control (RBAC), better auditing, ARM-based
        deployment and governance, access to managed identities, access to key vault
        for secrets, Azure AD-based authentication and support for tags and resource
        groups for easier security management","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicCompute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","type":"Microsoft.Authorization/policyDefinitions","name":"1d84d5fb-01f6-4d12-ba4f-4a26081d403d"},{"properties":{"displayName":"[Preview]:
        Audit API Applications that are not using latest supported .NET Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported .NET Framework version for the latest security classes.
        Using older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestDotNet","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb","type":"Microsoft.Authorization/policyDefinitions","name":"1de7b11d-1870-41a5-8181-507e7c663cfb"},{"properties":{"displayName":"Enforce
        tag and its value","policyType":"BuiltIn","mode":"Indexed","description":"Enforces
        a required tag and its value. Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"not":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","type":"Microsoft.Authorization/policyDefinitions","name":"1e30110a-5ceb-460c-a204-c1c3969c6d62"},{"properties":{"displayName":"Audit
        provisioning of an Azure Active Directory administrator for SQL server","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        provisioning of an Azure Active Directory administrator for your SQL server
        to enable Azure AD authentication. Azure AD authentication enables simplified
        permission management and centralized identity management of database users
        and other Microsoft services","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/administrators"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","type":"Microsoft.Authorization/policyDefinitions","name":"1f314764-cb73-4fc9-b863-8eca98ac36e9"},{"properties":{"displayName":"[Preview]:
        Monitor unprotected web application in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Web
        applications without a Web Application Firewall protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames","Microsoft.Web/hostingEnvironments"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","type":"Microsoft.Authorization/policyDefinitions","name":"201ea587-7c90-41c3-910f-c280ae01cfd6"},{"properties":{"displayName":"[Preview]:
        Audit API Apps that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a API app from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac","type":"Microsoft.Authorization/policyDefinitions","name":"224da9fe-0d38-4e79-adb3-0a6e2af942ac"},{"properties":{"displayName":"Audit
        enabling of only secure connections to your Redis Cache","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of only connections via SSL to Redis Cache. Use of secure connections
        ensures authentication between the server and the service and protects data
        in transit from network layer attacks such as man-in-the-middle, eavesdropping,
        and session-hijacking","metadata":{"category":"Cache"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/redis"},{"field":"Microsoft.Cache/Redis/enableNonSslPort","equals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","type":"Microsoft.Authorization/policyDefinitions","name":"22bee202-a82f-4305-9a2a-6d7f44d4dedb"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs restrict the minimum password
        length to 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Windows machines have the
        minimum password length setting set to at least 14 characters. This security
        setting determines the least number of characters that a password for a user
        account may contain. This policy should only be used along with its corresponding
        audit policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordLength","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordLength"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca","type":"Microsoft.Authorization/policyDefinitions","name":"23020aa6-1135-4be2-bae2-149982b06eca"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs have a maximum password age of 70 days","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the maximum password age setting
        set to at least 70 days. This security setting determines the period of time
        (in days) that a password can be used before the system requires the user
        to change it. This policy should only be used along with its corresponding
        deploy policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MaximumPasswordAge"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc","type":"Microsoft.Authorization/policyDefinitions","name":"24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"properties":{"displayName":"Audit
        configuration of metric alert rules on Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        configuration of metric alert rules on Batch account to enable the required
        metric","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name that an alert rule must be enabled on"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/alertRules","existenceScope":"Subscription","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/alertRules/isEnabled","equals":"true"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.metricName","equals":"[parameters(''metricName'')]"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.resourceUri","equals":"[concat(''/subscriptions/'',
        subscription().subscriptionId, ''/resourcegroups/'', resourceGroup().name,
        ''/providers/Microsoft.Batch/batchAccounts/'', field(''name''))]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","type":"Microsoft.Authorization/policyDefinitions","name":"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7"},{"properties":{"displayName":"Deploy
        default Microsoft IaaSAntimalware extension for Windows Server","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys a Microsoft IaaSAntimalware extension with a default configuraion
        when a VM is not configured with the antimalware extension.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"ExclusionsPaths":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file paths or locations to exclude from scanning"}},"ExclusionsExtensions":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file extensions to exclude from scanning"}},"ExclusionsProcesses":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of process names to exclude from scanning"}},"RealtimeProtectionEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Indicates
        whether or not real time protection is enabled (default is true)"}},"ScheduledScanSettingsIsEnabled":{"type":"string","defaultValue":"false","metadata":{"description":"Indicates
        whether or not custom scheduled scan settings are enabled (default is false)"}},"ScheduledScanSettingsScanType":{"type":"string","defaultValue":"Quick","metadata":{"description":"Indicates
        whether scheduled scan setting type is set to Quick or Full (default is Quick)"}},"ScheduledScanSettingsDay":{"type":"string","defaultValue":"7","metadata":{"description":"Day
        of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)"}},"ScheduledScanSettingsTime":{"type":"string","defaultValue":"120","metadata":{"description":"When
        to perform the scheduled scan, measured in minutes from midnight (0-1440).
        For example: 0 = 12AM, 60 = 1AM, 120 = 2AM."}}},"resources":[{"name":"[concat(parameters(''vmName''),''/IaaSAntimalware'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.Azure.Security","type":"IaaSAntimalware","typeHandlerVersion":"1.3","autoUpgradeMinorVersion":true,"settings":{"AntimalwareEnabled":true,"RealtimeProtectionEnabled":"[parameters(''RealtimeProtectionEnabled'')]","ScheduledScanSettings":{"isEnabled":"[parameters(''ScheduledScanSettingsIsEnabled'')]","day":"[parameters(''ScheduledScanSettingsDay'')]","time":"[parameters(''ScheduledScanSettingsTime'')]","scanType":"[parameters(''ScheduledScanSettingsScanType'')]"},"Exclusions":{"Extensions":"[parameters(''ExclusionsExtensions'')]","Paths":"[parameters(''ExclusionsPaths'')]","Processes":"[parameters(''ExclusionsProcesses'')]"}}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"RealtimeProtectionEnabled":{"value":"true"},"ScheduledScanSettingsIsEnabled":{"value":"true"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc","type":"Microsoft.Authorization/policyDefinitions","name":"2835b622-407b-4114-9198-6f7064cbe0dc"},{"properties":{"displayName":"Apply
        tag and its default value","policyType":"BuiltIn","mode":"Indexed","description":"Applies
        a required tag and its default value if it is not specified by the user. Does
        not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","type":"Microsoft.Authorization/policyDefinitions","name":"2a0e14a6-b0a6-4fab-991a-187a4f81c498"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs store passwords using reversible encryption","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the setting to store passwords
        using reversible encryption enabled. This security setting determines that
        the operating system stores passwords using reversible encryption. This policy
        should only be used along with its corresponding deploy policy in an initiative/policy
        set. For more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"StorePasswordsUsingReversibleEncryption"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6","type":"Microsoft.Authorization/policyDefinitions","name":"2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"properties":{"displayName":"[Preview]:
        Audit that Linux VMs do not allow remote connections from accounts without
        passwords","policyType":"BuiltIn","mode":"All","description":"This policy
        will audit that Linux machines do not allow remote connections from accounts
        without passwords. This security setting verifies remote connections from
        accounts with empty passwords is disabled. This policy should only be used
        along with its corresponding deploy policy in an initiative/policy set. For
        more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid110"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83","type":"Microsoft.Authorization/policyDefinitions","name":"2d67222d-05fd-4526-a171-2ee132ad9e83"},{"properties":{"displayName":"[Preview]:
        Audit HTTPS only access for a Web Application","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnforceHttps","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0","type":"Microsoft.Authorization/policyDefinitions","name":"2fde8a98-6892-426a-83ba-050e640c0ce0"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed. The list of OS images will be updated over time as
        support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","type":"Microsoft.Authorization/policyDefinitions","name":"32133ab0-ee4b-4b44-98d6-042180979d50"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Linux VMs do not have accounts without passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Linux machines do not have
        accounts without passwords. This security setting verifies there are no accounts
        without passwords. This policy should only be used along with its corresponding
        audit policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid232","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid232"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe","type":"Microsoft.Authorization/policyDefinitions","name":"3470477a-b35a-49db-aca5-1073d04524fe"},{"properties":{"displayName":"Audit
        unrestricted network access to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        unrestricted network access in your storage account firewall settings. Instead,
        configure network rules so only applications from allowed networks can access
        the storage account. To allow connections from specific internet or on-premise
        clients, access can be granted to traffic from specific Azure virtual networks
        or to public internet IP address ranges","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/networkAcls.defaultAction","equals":"Allow"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","type":"Microsoft.Authorization/policyDefinitions","name":"34c877ad-507e-4c82-993e-3452a6e0ad3c"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Logic Apps","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Logic Apps"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Logic/workflows"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","type":"Microsoft.Authorization/policyDefinitions","name":"34f95f76-5386-4de7-b824-0d8478470c9d"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs have a maximum password age
        of 70 days","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Windows machines have the
        maximum password age setting set to at least 70 days. This security setting
        determines the period of time (in days) that a password can be used before
        the system requires the user to change it. This policy should only be used
        along with its corresponding audit policy in an initiative/policy set. For
        more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MaximumPasswordAge","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MaximumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934","type":"Microsoft.Authorization/policyDefinitions","name":"356a906e-05e5-4625-8729-90771e0ee934"},{"properties":{"displayName":"[Preview]:  Audit
        CORS resource access restrictions for an API App","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        API app. Allow only required domains to interact with your API app.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RestrictCORSAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac","type":"Microsoft.Authorization/policyDefinitions","name":"358c20a6-3f9e-4f0e-97ff-c6ce485e2aac"},{"properties":{"displayName":"Audit
        enablement of encryption of Automation account variables","policyType":"BuiltIn","mode":"All","description":"It
        is important to enable encryption of Automation account variable assets when
        storing sensitive data","metadata":{"category":"Automation"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Automation/automationAccounts/variables"},{"field":"Microsoft.Automation/automationAccounts/variables/isEncrypted","notEquals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","type":"Microsoft.Authorization/policyDefinitions","name":"3657f5a0-770e-44a3-b44e-9431ba1e9735"},{"properties":{"displayName":"Deploy
        Threat Detection on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Threat Detection is enabled on SQL Servers.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"}},"variables":{},"resources":[{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}}]},"parameters":{"serverName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","type":"Microsoft.Authorization/policyDefinitions","name":"36d49e87-48c4-4f2e-beed-ba4ed02b71f5"},{"properties":{"displayName":"Audit
        use of classic storage accounts","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your storage accounts to provide security
        enhancements such as: stronger access control (RBAC), better auditing, Azure
        Resource Manager based deployment and governance, access to managed identities,
        access to key vault for secrets, Azure AD-based authentication and support
        for tags and resource groups for easier security management","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicStorage/storageAccounts"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","type":"Microsoft.Authorization/policyDefinitions","name":"37e0d2fe-28a5-43d6-a273-67d37d1f5606"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in IoT Hubs","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables recreation of
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Internet of Things"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Devices/IotHubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4","type":"Microsoft.Authorization/policyDefinitions","name":"383856f8-de7f-44a2-81fc-e5135b5c2aa4"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Windows VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. The list of OS images will be
        updated over time as support is updated. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.7"},"resources":[{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9","type":"Microsoft.Authorization/policyDefinitions","name":"3be22e3b-d919-47aa-805e-8985dbeb0ad9"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Windows VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. The list of OS images will be
        updated over time as support is updated. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293","/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038","type":"Microsoft.Authorization/policyDefinitions","name":"3c1b3629-c8f8-4bf6-862c-037cb9094038"},{"properties":{"displayName":"Deploy
        default Log Analytics Agent for Ubuntu VMs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the
        selected Log Analytics workspace","metadata":{"category":"Compute","deprecated":true},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS","16.04-LTS","16.04.0-LTS","14.04.2-LTS","12.04.5-LTS"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38","type":"Microsoft.Authorization/policyDefinitions","name":"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38"},{"properties":{"displayName":"[Preview]:
        Audit API Applications that are not using latest supported PHP Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported PHP version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPHP","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66","type":"Microsoft.Authorization/policyDefinitions","name":"3fe37002-5d00-4b37-a301-da09e3a0ca66"},{"properties":{"displayName":"Audit
        secure transfer to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        requirment of Secure transfer in your storage account. Secure transfer is
        an option that forces your storage account to accept requests only from secure
        connections (HTTPS). Use of HTTPS ensures authentication between the server
        and the service and protects data in transit from network layer attacks such
        as man-in-the-middle, eavesdropping, and session-hijacking","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","type":"Microsoft.Authorization/policyDefinitions","name":"404c3081-a854-4457-ae30-26a93ef643f9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","type":"Microsoft.Authorization/policyDefinitions","name":"428256e6-1fac-4f48-a757-df34c2b3336d"},{"properties":{"displayName":"[Preview]:
        Monitor permissive network access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        Security Groups with too permissive rules will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"permissiveNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","type":"Microsoft.Authorization/policyDefinitions","name":"44452482-524f-4bf4-b852-0bff7cc4a3ed"},{"properties":{"displayName":"Require
        SQL Server version 12.0","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures all SQL servers use version 12.0","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"not":{"field":"Microsoft.Sql/servers/version","equals":"12.0"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf","type":"Microsoft.Authorization/policyDefinitions","name":"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using latest supported Python Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Python version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPython","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06","type":"Microsoft.Authorization/policyDefinitions","name":"46544d7b-1f0d-46f5-81da-5c1351de1b06"},{"properties":{"displayName":"Enforce
        automatic OS upgrade with app health checks on VMSS","policyType":"BuiltIn","mode":"All","description":"This
        policy enforces usage of automatic OS upgrade with application health checks
        through health probes, which enables safer rollout by evaluating application
        health after each OS upgrade batch.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"not":{"field":"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade","equals":"True"}},{"field":"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id","exists":"False"}]}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"465f0161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"[Preview]:
        Monitor possible app Whitelisting in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        Application Whitelist configuration will be monitored by Azure Security Center","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"applicationWhitelisting","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","type":"Microsoft.Authorization/policyDefinitions","name":"47a6b606-51aa-4496-8bb7-64b11cf66adc"},{"properties":{"displayName":"[Preview]:
        Audit IP restrictions configuration for an API App","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects an API app from common attacks.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53","type":"Microsoft.Authorization/policyDefinitions","name":"48893b84-a2c8-4d9a-badf-835d5d1b7d53"},{"properties":{"displayName":"Apply
        tag and its default value to resource groups","policyType":"BuiltIn","mode":"All","description":"Applies
        a required tag and its default value to resource groups if it is not specified
        by the user.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71","type":"Microsoft.Authorization/policyDefinitions","name":"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that an application is installed inside Linux
        VMs","policyType":"BuiltIn","mode":"Indexed","description":"Include this rule
        to deploy the VM extension for Microsoft Guest Configuration, the VM extension
        for Microsoft Azure Managed Service Identity, and the content required to
        audit that an application is installed inside Linux virtual machines. This
        policy should only be used along with its corresponding audit policy in an
        initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"installed_application_linux","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"installed_application_linux"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent","value":"[concat(''packages:
        ['', parameters(''ApplicationName''), '']'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721","type":"Microsoft.Authorization/policyDefinitions","name":"4d1c04de-2172-403f-901b-90608c35c721"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","type":"Microsoft.Authorization/policyDefinitions","name":"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee"},{"properties":{"displayName":"[Preview]:
        Audit maximum number of owners for a subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate up to 3 subscription owners in order to reduce
        the potential for breach by a compromised owner.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateLessThanXOwners","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healty"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","type":"Microsoft.Authorization/policyDefinitions","name":"4f11b553-d42e-4e3a-89be-32ca364cad4c"},{"properties":{"displayName":"[Preview]:
        Audit CORS resource access restrictions for a Web Application","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        web application. Allow only required domains to interact with your web app.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RestrictCORSAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9","type":"Microsoft.Authorization/policyDefinitions","name":"5744710e-cc2f-4ee8-8809-3b11e89f4bc9"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs have a minimum password age of 1 day","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the minimum password age setting
        set to 1 day. This security setting determines the period of time (in days)
        that a password must be used before the user can change it. This policy should
        only be used along with its corresponding deploy policy in an initiative/policy
        set. For more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MinimumPasswordAge"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7","type":"Microsoft.Authorization/policyDefinitions","name":"5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs restrict the minimum password length to 14 characters","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the minimum password length setting
        set to at least 14 characters. This security setting determines the least
        number of characters that a password for a user account may contain. This
        policy should only be used along with its corresponding deploy policy in an
        initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MinimumPasswordLength"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec","type":"Microsoft.Authorization/policyDefinitions","name":"5aebc8d1-020d-4037-89a0-02043a7524ec"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Linux VMs","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that the specified application is not installed inside Linux
        virtual machines. This policy should only be used along with its corresponding
        deploy policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"not_installed_application_linux"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8","type":"Microsoft.Authorization/policyDefinitions","name":"5b842acb-0fe7-41b0-9f40-880ec4ad84d8"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMSS as non-compliant if the VM Image (OS) is not in the list defined and
        the agent is not installed. The list of OS images will be updated over time
        as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138","type":"Microsoft.Authorization/policyDefinitions","name":"5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with write permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with write privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","type":"Microsoft.Authorization/policyDefinitions","name":"5c607a2e-c700-4744-8254-d77e7c9eb5e4"},{"properties":{"displayName":"[Preview]:
        Audit HTTPS only access for a Function App","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnforceHttps","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55","type":"Microsoft.Authorization/policyDefinitions","name":"5df82f4f-773a-4a2d-97a2-422a806f1a55"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using latest supported .NET Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported .NET Framework version for the latest security classes.
        Using older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestDotNet","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2","type":"Microsoft.Authorization/policyDefinitions","name":"5e3315e0-a414-4efb-a4d2-c7bd2b0443d2"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Windows VMs","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that the specified application is installed inside Windows
        virtual machines. This policy should only be used along with its corresponding
        deploy policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WhitelistedApplication"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9","type":"Microsoft.Authorization/policyDefinitions","name":"5e393799-e3ca-4e43-a9a5-0ec4648a57d9"},{"properties":{"displayName":"Allow
        resource creation only in India data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: West India, South India,
        Central India","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["westindia","southindia","centralindia"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54","type":"Microsoft.Authorization/policyDefinitions","name":"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Linux VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293","/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069","type":"Microsoft.Authorization/policyDefinitions","name":"5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with read permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with read privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","type":"Microsoft.Authorization/policyDefinitions","name":"5f76cf89-fbf2-47fd-a3f4-b891fa780b60"},{"properties":{"displayName":"[Preview]
        Audit that Windows web servers are using secure communication protocols","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows web servers are using secure communication
        protocols (TLS 1.1 or TLS 1.2). This policy should only be used along with
        its corresponding deploy policy in an initiative/policy set. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"AuditSecureProtocol"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c","type":"Microsoft.Authorization/policyDefinitions","name":"60ffe3e2-4604-4460-8f22-0f1da058266c"},{"properties":{"displayName":"Deploy
        Advanced Data Security on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables Advanced Data Security on SQL Servers. This includes turning
        on Threat Detection and Vulnerability Assessment. It will automatically create
        a storage account in the same region and resource group as the SQL server
        to store scan results, with a ''sqlva'' prefix.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"location":{"type":"string"}},"variables":{"serverResourceGroupName":"[resourceGroup().name]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        variables(''serverResourceGroupName''), parameters(''location''))]","storageName":"[tolower(concat(''sqlva'',
        variables(''uniqueStorage'')))]"},"resources":[{"type":"Microsoft.Storage/storageAccounts","name":"[variables(''storageName'')]","apiVersion":"2016-01-01","location":"[parameters(''location'')]","sku":{"name":"Standard_LRS"},"kind":"Storage","properties":{}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/vulnerabilityAssessments","apiVersion":"2018-06-01-preview","properties":{"storageContainerPath":"[concat(reference(resourceId(''Microsoft.Storage/storageAccounts'',
        variables(''storageName''))).primaryEndpoints.blob, ''vulnerability-assessment'')]","storageAccountAccessKey":"[listKeys(resourceId(''Microsoft.Storage/storageAccounts'',
        variables(''storageName'')), ''2018-02-01'').keys[0].value]","recurringScans":{"isEnabled":true,"emailSubscriptionAdmins":true,"emails":[]}},"dependsOn":["[concat(''Microsoft.Storage/storageAccounts/'',
        variables(''storageName''))]","[concat(''Microsoft.Sql/servers/'', parameters(''serverName''),
        ''/securityAlertPolicies/Default'')]"]}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6","type":"Microsoft.Authorization/policyDefinitions","name":"6134c3db-786f-471e-87bc-8f479dc890f6"},{"properties":{"displayName":"Audit
        the setting of ClusterProtectionLevel property to EncryptAndSign in Service
        Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Service Fabric
        provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node
        communication using a primary cluster certificate. Set the protection level
        to ensure that all node-to-node messages are encrypted and digitally signed","metadata":{"category":"Service
        Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].name","notEquals":"Security"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name","notEquals":"ClusterProtectionLevel"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value","notEquals":"EncryptAndSign"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","type":"Microsoft.Authorization/policyDefinitions","name":"617c02be-7f02-4efd-8836-3180d47b6c68"},{"properties":{"displayName":"[Preview]:
        Audit missing blob encryption for storage accounts","policyType":"BuiltIn","mode":"All","description":"This
        policy audits storage accounts without blob encryption. It only applies to
        Microsoft.Storage resource types, not other storage providers. Possible network
        Just In Time access will be monitored by Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","type":"Microsoft.Authorization/policyDefinitions","name":"655cb504-bcee-4362-bd4c-402e6aa38759"},{"properties":{"displayName":"[Preview]:
        Audit IP restrictions configuration for a Function App","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects a Function app from common
        attacks.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90","type":"Microsoft.Authorization/policyDefinitions","name":"664346d9-be92-43fb-a219-d595eeb76a90"},{"properties":{"displayName":"[Preview]:
        Audit IP restrictions configuration for a Web Application","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects a web application from common
        attacks.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe","type":"Microsoft.Authorization/policyDefinitions","name":"6a8450e2-6c61-43b4-be65-62e3a197bffe"},{"properties":{"displayName":"[Preview]:
        Audit deprecated accounts on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts should be removed from your subscriptions.  Deprecated accounts are
        accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccounts","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","type":"Microsoft.Authorization/policyDefinitions","name":"6b1cbf55-e8b6-442f-ba4c-7246b6381474"},{"properties":{"displayName":"Not
        allowed resource types","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to specify the resource types that your organization cannot
        deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesNotAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that cannot be deployed.","displayName":"Not allowed
        resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypesNotAllowed'')]"},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","type":"Microsoft.Authorization/policyDefinitions","name":"6c112d4e-5bc7-47ae-a041-ea2d9dccd749"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4","type":"Microsoft.Authorization/policyDefinitions","name":"6fdb9205-3462-4cfc-87d8-16c7860b53f4"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs cannot re-use the previous 24
        passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Windows machines have the
        setting for number of previous passwords that cannot be used set to 24. This
        security setting determines the number of unique new passwords that have to
        be associated with a user account before an old password can be reused. This
        policy should only be used along with its corresponding audit policy in an
        initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"EnforcePasswordHistory","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"EnforcePasswordHistory"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6","type":"Microsoft.Authorization/policyDefinitions","name":"726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"properties":{"displayName":"Allowed
        storage account SKUs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify a set of storage account SKUs that your organization
        can deploy.","metadata":{"category":"Storage"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for storage accounts.","displayName":"Allowed
        SKUs","strongType":"StorageSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1","type":"Microsoft.Authorization/policyDefinitions","name":"7433c107-6db4-4ad1-b57a-a76dce0154a1"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in App Services","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of diagnostic logs on the app. This enables you to recreate activity
        trails for investigation purposes if a security incident occurs or your network
        is compromised","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"web"},{"anyOf":[{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/httpLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/requestTracingEnabled","notEquals":"true"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","type":"Microsoft.Authorization/policyDefinitions","name":"752c6934-9bcc-4749-b004-655e676ae2ac"},{"properties":{"displayName":"[Preview]:
        Monitor VM Vulnerabilities in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Monitors
        vulnerabilities detected by Vulnerability Assessment solution and VMs without
        a Vulnerability Assessment solution in Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"vulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","type":"Microsoft.Authorization/policyDefinitions","name":"760a85ff-6162-42b3-8d70-698e268f648c"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Linux VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VM Scale Sets if the VM Image (OS) is in the list
        defined and the agent is not installed. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.7"},"resources":[{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0","type":"Microsoft.Authorization/policyDefinitions","name":"765266ab-e40e-4c61-bcb2-5a5275d0b7c0"},{"properties":{"displayName":"Audit
        enabling of diagnostics logs in Service Fabric and Virtual Machine Scale Sets","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable Logs so that activity trail can be recreated when
        investigations are required in the event of an incident or a compromise.","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"IaaSDiagnostics"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Diagnostics"}]},{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"LinuxDiagnostic"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.OSTCExtensions"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","type":"Microsoft.Authorization/policyDefinitions","name":"7c1b1214-f927-48bf-8882-84f0af6588b1"},{"properties":{"displayName":"Require
        blob encryption for storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures blob encryption for storage accounts is turned on. It only
        applies to Microsoft.Storage resource types, not other storage providers.","metadata":{"category":"Storage"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f","type":"Microsoft.Authorization/policyDefinitions","name":"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f"},{"properties":{"displayName":"[Preview]:
        Audit that an application is not installed inside Windows VMs.","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that the specified application is not installed inside Windows
        virtual machines. This policy should only be used along with its corresponding
        deploy policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"NotInstalledApplication"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c","type":"Microsoft.Authorization/policyDefinitions","name":"7e56b49b-5990-4159-a734-511ea19b731c"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs have the password complexity
        setting enabled","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Windows machines have the
        password complexity setting enabled. More information on this security setting
        can be found here: https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/password-must-meet-complexity-requirements.
        This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordMustMeetComplexityRequirements","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordMustMeetComplexityRequirements"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8","type":"Microsoft.Authorization/policyDefinitions","name":"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"properties":{"displayName":"Audit
        diagnostic setting","policyType":"BuiltIn","mode":"All","description":"Audit
        diagnostic setting for selected resource types","metadata":{"category":"Monitoring"},"parameters":{"listOfResourceTypes":{"type":"Array","metadata":{"displayName":"Resource
        Types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypes'')]"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","type":"Microsoft.Authorization/policyDefinitions","name":"7f89b1eb-583c-429a-8828-af049802c1d9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Event Hub","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables recreation of
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","type":"Microsoft.Authorization/policyDefinitions","name":"83a214f7-d01a-484b-91a9-ed54470c9a6a"},{"properties":{"displayName":"Deploy
        SQL DB transparent data encryption","policyType":"BuiltIn","mode":"Indexed","description":"Enables
        transparent data encryption on SQL databases","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullDbName":{"type":"string"}},"resources":[{"name":"[concat(parameters(''fullDbName''),
        ''/current'')]","type":"Microsoft.Sql/servers/databases/transparentDataEncryption","apiVersion":"2014-04-01","properties":{"status":"Enabled"}}]},"parameters":{"fullDbName":{"value":"[field(''fullName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f","type":"Microsoft.Authorization/policyDefinitions","name":"86a912f6-9a06-4e26-b447-11b16ba8659f"},{"properties":{"displayName":"[Preview]:
        Monitor missing system updates in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Missing
        security system updates on your servers will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"systemUpdates","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","type":"Microsoft.Authorization/policyDefinitions","name":"86b3d65f-7626-441e-b690-81a8b71cff60"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that an application is not installed inside Linux
        VMs","policyType":"BuiltIn","mode":"Indexed","description":"Include this rule
        to deploy the VM extension for Microsoft Guest Configuration, the VM extension
        for Microsoft Azure Managed Service Identity, and the content required to
        audit that an application is not installed inside Linux virtual machines.
        This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name","description":"Application name. Example: ''python'' or ''powershell''."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"not_installed_application_linux","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"not_installed_application_linux"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent","value":"[concat(''packages:
        ['', parameters(''ApplicationName''), '']'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0","type":"Microsoft.Authorization/policyDefinitions","name":"884b209a-963b-4520-8006-d20cb3c213e0"},{"properties":{"displayName":"Enforce
        tag and its value on resource groups","policyType":"BuiltIn","mode":"All","description":"Enforces
        a required tag and its value on resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46","type":"Microsoft.Authorization/policyDefinitions","name":"8ce3da23-7156-49e4-b145-24f95f9dcb46"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Windows VMs store passwords using reversible
        encryption","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Windows machines have the
        setting to store passwords using reversible encryption enabled. This security
        setting determines that the operating system stores passwords using reversible
        encryption. This policy should only be used along with its corresponding audit
        policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"StorePasswordsUsingReversibleEncryption","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"StorePasswordsUsingReversibleEncryption"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78","type":"Microsoft.Authorization/policyDefinitions","name":"8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"properties":{"displayName":"[Preview]:
        Audit accounts with write permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        write privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","type":"Microsoft.Authorization/policyDefinitions","name":"9297c21d-2ed6-4474-b48f-163f75654ce3"},{"properties":{"displayName":"Allow
        resource creation only in European data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: North Europe, West Europe","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["northeurope","westeurope"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b","type":"Microsoft.Authorization/policyDefinitions","name":"94c19f19-8192-48cd-a11b-e37099d3e36b"},{"properties":{"displayName":"Allow
        resource creation only in United States data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Central US, East US, East
        US2, North Central US, South Central US, West US","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["centralus","eastus","eastus2","northcentralus","southcentralus","westus"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869","type":"Microsoft.Authorization/policyDefinitions","name":"983211ba-f348-4758-983b-21fa29294869"},{"properties":{"displayName":"[Preview]:
        Audit API Applications that are not using latest supported Java Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Java version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestJava","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745","type":"Microsoft.Authorization/policyDefinitions","name":"9bfe3727-0a17-471f-a2fe-eddd6b668745"},{"properties":{"displayName":"[Preview]:
        Monitor unprotected network endpoints in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        endpoints without a Next Generation Firewall''s protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedNetworkEndpoint","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","type":"Microsoft.Authorization/policyDefinitions","name":"9daedab3-fb2d-461e-b861-71790eead4f6"},{"properties":{"displayName":"Allowed
        resource types","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify the resource types that your organization can
        deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that can be deployed.","displayName":"Allowed resource
        types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''listOfResourceTypesAllowed'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","type":"Microsoft.Authorization/policyDefinitions","name":"a08ec900-254a-4555-9bf5-e42af04b5c5c"},{"properties":{"displayName":"Audit
        authorization rules on Service Bus namespaces","policyType":"BuiltIn","mode":"All","description":"Service
        Bus clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Service
        Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceBus/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","type":"Microsoft.Authorization/policyDefinitions","name":"a1817ec0-a368-432a-8057-8371e17ac6ee"},{"properties":{"displayName":"Audit
        usage of custom RBAC rules","policyType":"BuiltIn","mode":"All","description":"Audit
        built-in roles such as ''Owner, Contributer, Reader'' instead of custom RBAC
        roles, which are error prone. Using custom roles is treated as an exception
        and requires a rigorous review and threat modeling","metadata":{"category":"General"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Authorization/roleDefinitions"},{"field":"Microsoft.Authorization/roleDefinitions/type","equals":"CustomRole"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","type":"Microsoft.Authorization/policyDefinitions","name":"a451c1ef-c6ca-483d-87ed-f49761e3ffb5"},{"properties":{"displayName":"Audit
        SQL server level Auditing settings","policyType":"BuiltIn","mode":"Indexed","description":"Audits
        the existence of SQL Auditing at the server level","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"setting":{"type":"String","metadata":{"displayName":"Desired
        Auditing setting"},"allowedValues":["enabled","disabled"],"defaultValue":"enabled"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","type":"Microsoft.Authorization/policyDefinitions","name":"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9"},{"properties":{"displayName":"[Preview]:
        Audit standard tier of DDoS protection is enabled for a virtual network","policyType":"BuiltIn","mode":"All","description":"DDoS
        protection standard should be enabled for all virtual networks with a subnet
        that is part of an application gateway with a public IP.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"microsoft.network/virtualNetworks"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableDDoSProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd","type":"Microsoft.Authorization/policyDefinitions","name":"a7aca53f-2ed4-4466-a25e-0b45ade68efd"},{"properties":{"displayName":"Enforce
        encryption on Data Lake Store accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures encryption is enabled on all Data Lake Store accounts","metadata":{"category":"Data
        Lake"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},{"field":"Microsoft.DataLakeStore/accounts/encryptionState","equals":"Disabled"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"a7ff3161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"[Preview]:
        Monitor unencrypted SQL database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Unencrypted
        SQL servers or databases will be monitored by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","type":"Microsoft.Authorization/policyDefinitions","name":"a8bef009-a5c9-4d0f-90d7-6018734e8a16"},{"properties":{"displayName":"Deploy
        network watcher when virtual networks are created","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a network watcher resource in regions with virtual networks.
        You need to ensure existence of a resource group named networkWatcherRG, which
        will be used to deploy network watcher instances.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/virtualNetworks"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Network/networkWatchers","resourceGroupName":"networkWatcherRG","existenceCondition":{"field":"location","equals":"[field(''location'')]"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"}},"resources":[{"apiVersion":"2016-09-01","type":"Microsoft.Network/networkWatchers","name":"[concat(''networkWacher_'',
        parameters(''location''))]","location":"[parameters(''location'')]"}]},"parameters":{"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9","type":"Microsoft.Authorization/policyDefinitions","name":"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9"},{"properties":{"displayName":"[Preview]:
        Audit accounts with owner permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        owner permissions to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","type":"Microsoft.Authorization/policyDefinitions","name":"aa633080-8b72-40c4-a2d7-d00c03e80bed"},{"properties":{"displayName":"[Preview]:
        Automatic provisioning of security monitoring agent","policyType":"BuiltIn","mode":"All","description":"Installs
        security agent on VMs for advanced security alerts and preventions in Azure
        Security Center. Applies only for subscriptions that use Azure Security Center.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Security/complianceResults","name":"securityAgent","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24","type":"Microsoft.Authorization/policyDefinitions","name":"abcc6037-1fc4-47f6-aac5-89706589be24"},{"properties":{"displayName":"Audit
        SQL servers without Advanced Data Security","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        SQL servers without Advanced Data Security","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9","type":"Microsoft.Authorization/policyDefinitions","name":"abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9"},{"properties":{"displayName":"Audit
        SQL managed instances without Advanced Data Security","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        SQL managed instances without Advanced Data Security","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9","type":"Microsoft.Authorization/policyDefinitions","name":"abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9"},{"properties":{"displayName":"Allow
        resource creation if ''environment'' tag value in allowed values","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation if the ''environment'' tag is set to one of the following
        values: production, dev, test, staging","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.environment","in":["production","dev","test","staging"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9","type":"Microsoft.Authorization/policyDefinitions","name":"ac7e5fc0-c029-4b12-91d4-a8500ce697f9"},{"properties":{"displayName":"[Preview]:
        Monitor missing Endpoint Protection in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        without an installed Endpoint Protection agent will be monitored by Azure
        Security Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"endpointProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","type":"Microsoft.Authorization/policyDefinitions","name":"af6cd1bd-1635-48cb-bde7-5b15693900b9"},{"properties":{"displayName":"[Preview]:
        Monitor unaudited SQL database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"SQL
        servers and databases which doesn''t have SQL auditing turned on will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"auditing","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","type":"Microsoft.Authorization/policyDefinitions","name":"af8051bf-258b-44e2-a2bf-165330459f9d"},{"properties":{"displayName":"[Preview]:
        Monitor possible network Just In Time (JIT) access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        network Just In Time (JIT) access will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"jitNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","type":"Microsoft.Authorization/policyDefinitions","name":"b0f33259-77d7-4c9e-aac6-3aabcfae693c"},{"properties":{"displayName":"[Preview]:
        Audit that Linux VMs have the passwd file permissions set to 0644","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Linux machines have the passwd file permissions set
        to 0644. This security setting verifies /etc/passwd file permissions are set
        to 0644 to prevent unauthorized changes that could allow access to the server.
        This policy should only be used along with its corresponding deploy policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid121"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b","type":"Microsoft.Authorization/policyDefinitions","name":"b18175dd-c599-4c64-83ba-bb018a06d35b"},{"properties":{"displayName":"Audit
        authorization rules on Event Hub namespaces","policyType":"BuiltIn","mode":"All","description":"Event
        Hub clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Event
        Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.EventHub/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","type":"Microsoft.Authorization/policyDefinitions","name":"b278e460-7cfc-4451-8294-cccc40a940d7"},{"properties":{"displayName":"[Preview]
        Deploy VM extension to audit that Windows web servers are using secure communication
        protocols","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extension for Microsoft Guest Configuration, the
        VM extension for Microsoft Azure Managed Service Identity, and the required
        content to audit that Windows web servers are using secure communication protocols
        (TLS 1.1 or TLS 1.2). This policy should only be used along with its corresponding
        audit policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AuditSecureProtocol","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AuditSecureProtocol"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8","type":"Microsoft.Authorization/policyDefinitions","name":"b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs for Search service","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Search"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Search/searchServices"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","type":"Microsoft.Authorization/policyDefinitions","name":"b4330a05-a843-4bc8-bf9a-cacce50c67f4"},{"properties":{"displayName":"[Preview]:
        Audit Web Sockets state for an API App","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within an API app must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951","type":"Microsoft.Authorization/policyDefinitions","name":"b48334a4-911b-4084-b1ab-3e6a4e50b951"},{"properties":{"displayName":"Audit
        usage of Azure Active Directory for client authentication in Service Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        usage of client authentication only via Azure Active Directory in Service
        Fabric","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","exists":"false"},{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","equals":""}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","type":"Microsoft.Authorization/policyDefinitions","name":"b54ed75b-3e1a-44ac-a333-05ba39b99ff0"},{"properties":{"displayName":"[Preview]:
        Audit API Applications that are not using latest supported Python Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Python version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPython","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644","type":"Microsoft.Authorization/policyDefinitions","name":"bc0378bb-d7ab-4614-a0f6-5a6e3f02d644"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using latest supported Java Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Java version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestJava","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6","type":"Microsoft.Authorization/policyDefinitions","name":"be0a7681-bed4-48dc-9ff3-f0171ee170b6"},{"properties":{"displayName":"Allow
        resource creation only in Asia data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: East Asia, Southeast Asia,
        West India, South India, Central India, Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastasia","southeastasia","westindia","southindia","centralindia","japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94","type":"Microsoft.Authorization/policyDefinitions","name":"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94"},{"properties":{"displayName":"[Preview]:
        Audit that Linux VMs do not have accounts without passwords","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Linux machines do not have accounts without passwords.
        This security setting verifies there are no accounts without passwords. This
        policy should only be used along with its corresponding deploy policy in an
        initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid232"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05","type":"Microsoft.Authorization/policyDefinitions","name":"c40c9087-1981-4e73-9f53-39743eda9d05"},{"properties":{"displayName":"[Preview]:
        Audit HTTPS only access for an API App","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnforceHttps","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d","type":"Microsoft.Authorization/policyDefinitions","name":"c85538c1-b527-4ce4-bdb4-1dabcb3fd90d"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Data Lake Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeAnalytics/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","type":"Microsoft.Authorization/policyDefinitions","name":"c95c74d9-38fe-4f0d-af86-0c7d626a315c"},{"properties":{"displayName":"Apply
        Diagnostic Settings for Network Security Groups","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy automatically deploys diagnostic settings to network security groups.","metadata":{"category":"Monitoring"},"parameters":{"storagePrefix":{"type":"String","metadata":{"displayName":"Storage
        Account Prefix for Regional Storage Account","description":"This prefix will
        be combined with the network security group location to form the created storage
        account name."}},"rgName":{"type":"String","metadata":{"displayName":"Resource
        Group Name for Storage Account (must exist)","description":"This resource
        group must already exist","strongType":"ExistingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"setbypolicy","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"},"nsgName":{"type":"string"},"rgName":{"type":"string"}},"variables":{"storageDeployName":"[concat(''policyStorage_'',
        uniqueString(parameters(''location''), parameters(''nsgName'')))]"},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings","name":"[concat(parameters(''nsgName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","dependsOn":["[variables(''storageDeployName'')]"],"properties":{"storageAccountId":"[reference(variables(''storageDeployName'')).outputs.storageAccountId.value]","logs":[{"category":"NetworkSecurityGroupEvent","enabled":true,"retentionPolicy":{"enabled":false,"days":0}},{"category":"NetworkSecurityGroupRuleCounter","enabled":true,"retentionPolicy":{"enabled":false,"days":0}}]}},{"apiVersion":"2017-05-10","name":"[variables(''storageDeployName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''rgName'')]","properties":{"mode":"incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"}},"resources":[{"apiVersion":"2017-06-01","type":"Microsoft.Storage/storageAccounts","name":"[concat(parameters(''storageprefix''),
        parameters(''location''))]","sku":{"name":"Standard_LRS","tier":"Standard"},"kind":"Storage","location":"[parameters(''location'')]","tags":{"created-by":"policy"},"scale":null,"properties":{"networkAcls":{"bypass":"AzureServices","defaultAction":"Allow","ipRules":[],"virtualNetworkRules":[]},"supportsHttpsTrafficOnly":true}}],"outputs":{"storageAccountId":{"type":"string","value":"[resourceId(parameters(''rgName''),
        ''Microsoft.Storage/storageAccounts'',concat(parameters(''storagePrefix''),
        parameters(''location'')))]"}}}}}]},"parameters":{"location":{"value":"[field(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"},"rgName":{"value":"[parameters(''rgName'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89","type":"Microsoft.Authorization/policyDefinitions","name":"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89"},{"properties":{"displayName":"[Preview]:
        Audit remote debugging state for a Web Application","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on a web application.  Remote
        debugging should be turned off.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableRemoteDebugging","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71","type":"Microsoft.Authorization/policyDefinitions","name":"cb510bfd-1cba-4d9f-a230-cb0976f4bb71"},{"properties":{"displayName":"Allowed
        virtual machine SKUs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify a set of virtual machine SKUs that your organization
        can deploy.","metadata":{"category":"Compute"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for virtual machines.","displayName":"Allowed
        SKUs","strongType":"VMSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","type":"Microsoft.Authorization/policyDefinitions","name":"cccc23c7-8427-4f53-ad12-b6a63eb452b3"},{"properties":{"displayName":"Allow
        resource creation if ''department'' tag set","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation only if the ''department'' tag is set","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags","containsKey":"department"}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064","type":"Microsoft.Authorization/policyDefinitions","name":"cd8dc879-a2ae-43c3-8211-1877c5755064"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs cannot re-use the previous 24 passwords","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the setting for number of previous
        passwords that cannot be used set to 24. This security setting determines
        the number of unique new passwords that have to be associated with a user
        account before an old password can be reused. This policy should only be used
        along with its corresponding deploy policy in an initiative/policy set. For
        more information on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"EnforcePasswordHistory"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293","type":"Microsoft.Authorization/policyDefinitions","name":"cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Key Vault","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Key Vault"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","type":"Microsoft.Authorization/policyDefinitions","name":"cf820ca0-f99e-4f3e-84fb-66e913812d21"},{"properties":{"displayName":"[Preview]:
        Audit Function Apps that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a Function app from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c","type":"Microsoft.Authorization/policyDefinitions","name":"d1cb47db-b7a1-4c46-814e-aad1c0e84f3c"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a web application from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a","type":"Microsoft.Authorization/policyDefinitions","name":"dd2ea520-6b06-45c3-806e-ea297c23e06a"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697","type":"Microsoft.Authorization/policyDefinitions","name":"e01598e8-6538-41ed-95e8-8b29746cd697"},{"properties":{"displayName":"[Preview]:
        Monitor OS vulnerabilities in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        which do not satisfy the configured baseline will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"osVulnerabilities","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","type":"Microsoft.Authorization/policyDefinitions","name":"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15"},{"properties":{"displayName":"[Preview]:
        Audit Dependency Agent Deployment in VMSS - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMSS as non-compliant if the VM Image (OS) is not in the list defined and
        the agent is not installed. The list of OS images will be updated over time
        as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10","type":"Microsoft.Authorization/policyDefinitions","name":"e2dd799a-a932-4e9d-ac17-d473bc3c6c10"},{"properties":{"displayName":"[Preview]:
        Audit accounts with read permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        read privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","type":"Microsoft.Authorization/policyDefinitions","name":"e3576e28-8b17-4677-84c3-db2990658d64"},{"properties":{"displayName":"Allowed
        locations","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        enables you to restrict the locations your organization can specify when deploying
        resources. Use to enforce your geo-compliance requirements. Excludes resource
        groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that
        use the ''global'' region.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"location","notEquals":"global"},{"field":"type","notEquals":"Microsoft.AzureActiveDirectory/b2cDirectories"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c","type":"Microsoft.Authorization/policyDefinitions","name":"e56962a6-4747-49cd-b67b-bf8b01975c4c"},{"properties":{"displayName":"[Preview]:
        Audit Web Applications that are not using latest supported Node.js Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Node.js version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestNodeJS","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008","type":"Microsoft.Authorization/policyDefinitions","name":"e67687e8-08d5-4e7f-8226-5b4753bba008"},{"properties":{"displayName":"Allowed
        locations for resource groups","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to restrict the locations your organization can create
        resource groups in. Use to enforce your geo-compliance requirements.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that resource groups can be created in.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988","type":"Microsoft.Authorization/policyDefinitions","name":"e765b5de-1225-4ba3-bd56-1ac6695af988"},{"properties":{"displayName":"[Preview]:
        Audit Web Sockets state for a Web Application","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within a web application must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e","type":"Microsoft.Authorization/policyDefinitions","name":"e797f851-8be7-4c40-bb56-2e3395215b0e"},{"properties":{"displayName":"[Preview]:
        Audit remote debugging state for an API App","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on an API app.  Remote debugging
        should be turned off.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableRemoteDebugging","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e","type":"Microsoft.Authorization/policyDefinitions","name":"e9c8d085-d9cc-4b17-9cdc-059f1f01f19e"},{"properties":{"displayName":"[Preview]:
        Audit deprecated accounts with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts with owner permissions should be removed from your subscription.  Deprecated
        accounts are accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","type":"Microsoft.Authorization/policyDefinitions","name":"ebb62a0c-3560-49e1-89ed-27e074e9f8ad"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Linux VMs do not allow remote connections
        from accounts without passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Linux machines do not allow
        remote connections from accounts without passwords. This security setting
        verifies remote connections from accounts with empty passwords are disabled.
        This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid110","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid110"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592","type":"Microsoft.Authorization/policyDefinitions","name":"ec49586f-4939-402d-a29e-6ff502b20592"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that an application is not installed inside Windows
        VMs","policyType":"BuiltIn","mode":"Indexed","description":"Include this rule
        to deploy the VM extension for Microsoft Guest Configuration, the VM extension
        for Microsoft Azure Managed Service Identity, and the content required to
        audit that an application is not installed inside Windows virtual machines.
        This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        name (supports wildcard)","description":"Application name. Example: ''Microsoft
        SQL Server 2014 (64-bit)'' or ''Microsoft SQL Server 2014*'' to match any
        application starting with ''Microsoft SQL Server 2014''."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftDynamicsAX","MicrosoftWindowsDesktop","MicrosoftVisualStudio","incredibuild","MicrosoftWindowsServerHPCPack","esri"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"NotInstalledApplication","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"NotInstalledApplication"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[InstalledApplication]NotInstalledApplicationResource1;Name","value":"[parameters(''ApplicationName'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2","type":"Microsoft.Authorization/policyDefinitions","name":"f0633351-c7b2-41ff-9981-508fc08553c2"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit that Linux VMs have the passwd file permissions
        set to 0644","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the requirements to audit that Linux machines have the
        passwd file permissions set to 0644. This security setting verifies /etc/passwd
        file permissions are set to 0644 to prevent unauthorized changes that could
        allow access to the server. This policy should only be used along with its
        corresponding audit policy in an initiative/policy set. For more information
        on guest configuration policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid121","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid121"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9","type":"Microsoft.Authorization/policyDefinitions","name":"f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Workspace for VM - Report Mismatch","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if they not logging to the LA workspace specified in
        the policy/initiative assignment.","metadata":{"category":"Monitoring"},"parameters":{"logAnalyticsWorkspaceId":{"type":"String","metadata":{"displayName":"Log
        Analytics Workspace Id that VMs should be configured for","description":"This
        is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured
        for."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId","notEquals":"[parameters(''logAnalyticsWorkspaceId'')]"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917","type":"Microsoft.Authorization/policyDefinitions","name":"f47b5582-33ec-4c5c-87c0-b010a6b2e917"},{"properties":{"displayName":"Audit
        existence of authorization rules on Event Hub entities","policyType":"BuiltIn","mode":"All","description":"Audit
        existence of authorization rules on Event Hub entities to grant least-privileged
        access","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces/eventhubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.EventHub/namespaces/eventHubs/authorizationRules"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","type":"Microsoft.Authorization/policyDefinitions","name":"f4826e5f-6a27-407c-ae3e-9582eb39891d"},{"properties":{"displayName":"[Preview]:
        Audit that Windows VMs have the password complexity setting enabled","policyType":"BuiltIn","mode":"All","description":"This
        policy will audit that Windows machines have the password complexity setting
        enabled. More information on this security setting can be found here: https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/password-must-meet-complexity-requirements.
        This policy should only be used along with its corresponding deploy policy
        in an initiative/policy set. For more information on guest configuration policies,
        please visit http://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordMustMeetComplexityRequirements"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb","type":"Microsoft.Authorization/policyDefinitions","name":"f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"properties":{"displayName":"Deploy
        Auditing on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"SQL"},"parameters":{"retentionDays":{"type":"String","metadata":{"description":"The
        value in days of the retention period (0 indicates unlimited retention)","displayName":"Retention
        days (optional, 180 days if unspecified)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036","type":"Microsoft.Authorization/policyDefinitions","name":"f4c68484-132f-41f9-9b6d-3e4b1cb55036"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with owner permissions should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","type":"Microsoft.Authorization/policyDefinitions","name":"f8456c1c-aa66-4dfb-861a-25d127b775c9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Service Bus","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Service Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ServiceBus/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","type":"Microsoft.Authorization/policyDefinitions","name":"f8d36e2f-389b-4ee4-898d-21aeb69a0f45"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Azure Stream Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Stream Analytics"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.StreamAnalytics/streamingJobs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","type":"Microsoft.Authorization/policyDefinitions","name":"f9be5368-9bf5-4b84-9e0a-7850da98bb46"},{"properties":{"displayName":"[Preview]:
        Audit that an application is installed inside Linux VMs","policyType":"BuiltIn","mode":"All","description":"This
        policy audits that the specified application is installed inside Linux virtual
        machines. This policy should only be used along with its corresponding deploy
        policy in an initiative/policy set. For more information on guest configuration
        policies, please visit http://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"installed_application_linux"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004","type":"Microsoft.Authorization/policyDefinitions","name":"fee5cb2b-9d9b-410e-afe3-2902d90d0004"},{"properties":{"displayName":"[Preview]:
        Monitor SQL vulnerability assessment results in Azure Security Center","policyType":"BuiltIn","mode":"Indexed","description":"Monitor
        Vulnerability Assessment scan results and recommendations for how to remediate
        database vulnerabilities.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Sql/servers/databases","Microsoft.Sql/managedinstances/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"sqlVulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","type":"Microsoft.Authorization/policyDefinitions","name":"feedbf84-6b99-488c-acc2-71c829aa5ffc"},{"properties":{"displayName":"cheggert:
        Append VMSS extension","policyType":"Custom","mode":"indexed","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osProfile.windowsConfiguration","exists":"true"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"}]},{"field":"Microsoft.Compute/VirtualMachineScaleSets/virtualMachineProfile","exists":"true"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/extensionProfile.extensions[*].type","notEquals":"GenevaMonitoring"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/extensionProfile.extensions[*]","value":{"name":"Microsoft.Azure.Geneva.GenevaMonitoring","properties":{"publisher":"Microsoft.Azure.Geneva","type":"GenevaMonitoring","typeHandlerVersion":"1.8","autoUpgradeMinorVersion":true,"settings":{}}}}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/01b105ed-6ded-4a1d-894c-df85fd9351cb","type":"Microsoft.Authorization/policyDefinitions","name":"01b105ed-6ded-4a1d-894c-df85fd9351cb"},{"properties":{"displayName":"storage_httpsTrafficOnly","policyType":"Custom","mode":"All","metadata":{"category":"Demo"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/023217dd-81bb-461f-93ea-8799caac50c7","type":"Microsoft.Authorization/policyDefinitions","name":"023217dd-81bb-461f-93ea-8799caac50c7"},{"properties":{"displayName":"This
        shouldn''t work","policyType":"Custom","mode":"All","description":"This customer''s
        policy is attempting to append multiple tags at once. I expect it will just
        append one tag with a really long name","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags[''CostCenter'',''Department'',''ContactPerson'',''Environment'',''DataClassification'']","exists":"false"},"then":{"effect":"append","details":[{"field":"tags[''CostCenter'',''Department'',''ContactPerson'',''Environment'',''DataClassification'']","value":["","","","",""]}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/04183864-11ae-4e7a-aadb-c600e40ed1b9","type":"Microsoft.Authorization/policyDefinitions","name":"04183864-11ae-4e7a-aadb-c600e40ed1b9"},{"properties":{"displayName":"Inherit
        named tag from resource group","policyType":"Custom","mode":"indexed","description":"Applies
        the tag value from the resource group if it is not specified by the user.
        Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[resourcegroup().tags[parameters(''tagName'')]]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/04904947-4d10-4454-9a50-f423d590e11b","type":"Microsoft.Authorization/policyDefinitions","name":"04904947-4d10-4454-9a50-f423d590e11b"},{"properties":{"displayName":"Ramya
        - effect parametrization test","policyType":"Custom","mode":"all","description":"Policy
        to force allocations to a set of given locations","metadata":{"category":"cstack"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}},"effectName":{"type":"String","metadata":{"displayName":"Effect
        Name","description":"Parametrized effect name"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"[parameters(''effectName'')]"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0b7f02db-cef2-47c8-9d7e-9e0a015122c5","type":"Microsoft.Authorization/policyDefinitions","name":"0b7f02db-cef2-47c8-9d7e-9e0a015122c5"},{"properties":{"displayName":"rohitbh
        : AuditIfNotExists","policyType":"Custom","mode":"all","description":"deploys
        a delete lock for a resource ","metadata":{"category":"rohitbh"},"parameters":{},"policyRule":{"if":{"not":{"field":"type","equals":"Microsoft.Authorization/locks"}},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Authorization/locks","roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"Microsoft.Authorization/locks/level","in":["CanNotDelete"]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{},"variables":{},"resources":[{"type":"Microsoft.Authorization/locks","apiVersion":"2015-01-01","name":"DeleteLock","properties":{"level":"CanNotDelete","notes":"prevent
        deletion"}}],"outputs":{}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ddd96d8-fccd-40cb-81d2-5072a4ed061c","type":"Microsoft.Authorization/policyDefinitions","name":"0ddd96d8-fccd-40cb-81d2-5072a4ed061c"},{"properties":{"displayName":"robga-nsgtemplate-test","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange","equals":"3389"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]","notEquals":"3389"}}]},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ddfee46-9b63-4313-a529-cfbf968d8118","type":"Microsoft.Authorization/policyDefinitions","name":"0ddfee46-9b63-4313-a529-cfbf968d8118"},{"properties":{"displayName":"akif
        incident - 85944710","policyType":"Custom","mode":"All","description":"reproing
        incident 85944710\nhttps://icm.ad.msft.net/imp/v3/incidents/details/85944710/home\n","metadata":{"category":"akhe"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"anyOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0e0d567a-6089-46fc-b12c-ca5af12870bd","type":"Microsoft.Authorization/policyDefinitions","name":"0e0d567a-6089-46fc-b12c-ca5af12870bd"},{"properties":{"displayName":"akhe-incident-86226837-v2","policyType":"Custom","mode":"All","description":"second
        attempt to repro this incident. ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Sql/servers/firewallRules","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"0.0.0.0"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","equals":"0.0.0.0"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0e0d567a-6089-46fc-b12c-ca5af1287abe","type":"Microsoft.Authorization/policyDefinitions","name":"0e0d567a-6089-46fc-b12c-ca5af1287abe"},{"properties":{"displayName":"chegg:
        Deploy azsecpack autoupgrade (VMSS)","policyType":"Custom","mode":"indexed","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osProfile.windowsConfiguration","exists":"true"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"}]},{"not":{"field":"Microsoft.Compute/VirtualMachineScaleSets/extensionProfile.extensions[*].name","notEquals":"Microsoft.Azure.Geneva.GenevaMonitoring"}}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"Microsoft.Azure.Geneva.GenevaMonitoring","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"GenevaMonitoring"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Geneva"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/enableAutomaticUpgrade","equals":"true"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmssName":{"type":"string"},"location":{"type":"string"}},"resources":[{"apiVersion":"2018-10-01","name":"[concat(parameters(''vmssName''),
        ''/Microsoft.Azure.Geneva.GenevaMonitoring'')]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","properties":{"enableAutomaticUpgrade":true}}]},"parameters":{"vmssName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0ec05dac-e529-48ef-8c20-f7e6af99a12b","type":"Microsoft.Authorization/policyDefinitions","name":"0ec05dac-e529-48ef-8c20-f7e6af99a12b"},{"properties":{"displayName":"testSandipsh
        metric alert policy","policyType":"Custom","mode":"All","description":"test","metadata":{"category":"testSandipsh"},"parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":"The description of alert."}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"]},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"]},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        operator comparing the current value with the threshold value."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"Period of time used to monitor alert activity based on
        the threshold. Must be between five minutes and one day. ISO 8601 duration
        format."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"How often the metric alert is evaluated represented
        in ISO 8601 duration format"}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","equals":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'', field(''name''))]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'',  parameters(''targetResourceName''))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3","type":"Microsoft.Authorization/policyDefinitions","name":"123c6354-fc96-4f54-984e-8d49d06a80a3"},{"properties":{"displayName":"jilim
        nsg repro","policyType":"Custom","mode":"all","description":"fix","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix","notEquals":"*"}}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"*"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/14ac45e9-df97-455d-b6ee-dd216f15f694","type":"Microsoft.Authorization/policyDefinitions","name":"14ac45e9-df97-455d-b6ee-dd216f15f694"},{"properties":{"displayName":"jilim-incident-86226837-fix","policyType":"Custom","mode":"all","description":"1
        - reproing the incident: https://icm.ad.msft.net/imp/v3/incidents/details/86226837/home","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/firewallRules"},{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"0.0.0.0"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","equals":"0.0.0.0"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/15358dd8-671e-4c96-be33-2b668791418f","type":"Microsoft.Authorization/policyDefinitions","name":"15358dd8-671e-4c96-be33-2b668791418f"},{"properties":{"displayName":"Attempt
        service bus","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Insights/logProfiles"},{"anyOf":[{"field":"Microsoft.Insights/logProfiles/serviceBusRuleId","exists":"false"}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/163c640e-681c-445f-92ba-cd434bd8c11c","type":"Microsoft.Authorization/policyDefinitions","name":"163c640e-681c-445f-92ba-cd434bd8c11c"},{"properties":{"displayName":"jilim
        exists2","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.zyx","exists":"false"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/17d43473-870f-4bc8-93c6-3961fa1d91cc","type":"Microsoft.Authorization/policyDefinitions","name":"17d43473-870f-4bc8-93c6-3961fa1d91cc"},{"properties":{"displayName":"inherit
        all tags","policyType":"Custom","mode":"All","metadata":{"category":"tags"},"parameters":{},"policyRule":{"if":{"field":"tags","exists":"false"},"then":{"effect":"append","details":[{"field":"tags","value":"[resourceGroup().tags]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1e3c9312-c011-40a3-ac40-3bf3ddc24120","type":"Microsoft.Authorization/policyDefinitions","name":"1e3c9312-c011-40a3-ac40-3bf3ddc24120"},{"properties":{"displayName":"Allowed
        resource group locations","policyType":"Custom","mode":"All","description":"Allowed
        resource group locations","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"},{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f20036f-28c3-48f3-9266-05d50fe391f4","type":"Microsoft.Authorization/policyDefinitions","name":"1f20036f-28c3-48f3-9266-05d50fe391f4"},{"properties":{"displayName":"docdb_aliases_test","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c","type":"Microsoft.Authorization/policyDefinitions","name":"1f5360b7-fe59-43f7-8af5-825df420d09c"},{"properties":{"displayName":"Deploy
        security rule with restricted source IPs","policyType":"Custom","mode":"All","description":"Ovewrites
        security rules with IP restrictions at the securityRule level","metadata":{"category":"Port
        Lockdown"},"parameters":{"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Limit to one protocol. The most inclusive should come last. I.e. 22;22-22;22-23"}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","in":"[parameters(''destinationPortRanges'')]"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","exists":"true"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notLike":"*"}},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notEquals":"VirtualNetwork"}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","exists":"true"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":"VirtualNetwork"}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","equals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":""}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullRuleName":{"type":"string"},"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"},"priority":{"type":"int"}},"resources":[{"name":"[parameters(''fullRuleName'')]","type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2018-02-01","properties":{"protocol":"*","sourceAddressPrefixes":"[parameters(''sourceAddressPrefixes'')]","destinationAddressPrefix":"*","sourcePortRange":"*","destinationPortRange":"[last(parameters(''destinationPortRanges''))]","access":"Allow","direction":"Inbound","priority":"[parameters(''priority'')]"}}]},"parameters":{"fullRuleName":{"value":"[field(''fullName'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"priority":{"value":"[field(''Microsoft.Network/networksecurityGroups/securityRules/priority'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111","type":"Microsoft.Authorization/policyDefinitions","name":"20c4afd0-8a77-4433-b8b0-4ad06e4c7111"},{"properties":{"displayName":"jilim-Audit
        SQL Server firewall rule","policyType":"Custom","mode":"all","description":"Audits
        the existence of a rule that enables traffic from a specific IP range to a
        SQL Server.","metadata":{},"parameters":{"startIpAddress":{"type":"String","metadata":{"displayName":"Start
        IP Address","description":"The beginning of the IP address range. Example:
        1.23.191.10"}},"endIpAddress":{"type":"String","metadata":{"displayName":"End
        IP Address","description":"The end of the IP address range. Example: 1.23.191.50"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/firewallRules","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"[parameters(''startIpAddress'')]"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","equals":"[parameters(''endIpAddress'')]"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/20e2cbc3-cc16-4fa9-ab9a-5cfd8a137127","type":"Microsoft.Authorization/policyDefinitions","name":"20e2cbc3-cc16-4fa9-ab9a-5cfd8a137127"},{"properties":{"displayName":"Deploy
        NSGs on Subnets","policyType":"Custom","mode":"All","description":"Enforce
        that all subnets have a Network Security Group.  If a subnet does not have
        one an NSG with the default Internet Exposed Endpoint restrictions will be
        created and associated with it.","metadata":{"category":"Port Lockdown"},"parameters":{"nsgPrefix":{"type":"String","metadata":{"displayName":"NSG
        name prefix","description":"The prefix string to apply to all automatically
        created network security groups."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Ranges must not overlap."}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"anyOf":[{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"false"},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","equals":""}]}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks"},{"anyOf":[{"field":"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id","exists":"false"},{"not":{"field":"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id","notEquals":"null"}}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullResourceName":{"type":"string"},"resourceName":{"type":"string"},"location":{"type":"string"},"nsgPrefix":{"type":"string"},"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"}},"variables":{"nsgName":"[concat(parameters(''nsgPrefix''),
        ''-'', parameters(''location''))]","vnetName":"[split(parameters(''fullResourceName''),
        ''/'')[0]]","vnetResourceId":"[resourceId(''Microsoft.Network/virtualNetworks'',
        variables(''vnetName''))]","getVnetDeploymentName":"[concat(''getVnet-'',
        variables(''vnetName''))]","collectSubnetsDeploymentName":"[concat(''collectSubnets-'',
        variables(''vnetName''))]","overwriteVnetDeploymentName":"[concat(''overwriteVnet-'',
        variables(''vnetName''))]"},"resources":[{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''getVnetDeploymentName'')]","properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[],"outputs":{"vnetProperties":{"type":"object","value":"[reference(variables(''vnetResourceId''),
        ''2018-03-01'', ''Full'')]"}}}}},{"name":"[variables(''nsgName'')]","type":"Microsoft.Network/networkSecurityGroups","apiVersion":"2018-03-01","location":"[parameters(''location'')]","properties":{"securityRules":[{"name":"PortLockdown_ControlledPorts_Restrict","properties":{"description":"Allow
        controlled port connections from specific IP ranges (either corpnet or SAW)","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"","sourceAddressPrefixes":"[parameters(''sourceAddressPrefixes'')]","destinationAddressPrefix":"*","access":"Allow","priority":3997,"direction":"Inbound"}},{"name":"PortLockdown_ControlledPorts_AllowVnet","properties":{"description":"Allow
        controlled port connections from within the VNET","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"VirtualNetwork","destinationAddressPrefix":"*","access":"Allow","priority":3998,"direction":"Inbound"}},{"name":"PortLockdown_ControlledPorts_Deny","properties":{"description":"Deny
        any controlled port connections that aren''t explicitly allowed in higher
        priority rules","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Deny","priority":3999,"direction":"Inbound"}},{"name":"PortLockdown_AllowAll","properties":{"description":"Allow
        all inbound traffic that isn''t explicitly blocked by Port Lockdown restrictions","protocol":"*","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":4000,"direction":"Inbound"}}]}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''collectSubnetsDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_collectSubnets_template.json","contentVersion":"1.0.0.0"},"parameters":{"vnetProperties":{"value":"[reference(variables(''getVnetDeploymentName'')).outputs.vnetProperties.value]"},"nsgResourceId":{"value":"[resourceid(''Microsoft.Network/networkSecurityGroups'',
        variables(''nsgName''))]"},"vnetName":{"value":"[variables(''vnetName'')]"}}}},{"dependsOn":["[variables(''nsgName'')]"],"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''overwriteVnetDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_overwriteVnet_template.json","contentVersion":"1.0.0.0"},"parameters":{"vnetProperties":{"value":"[reference(variables(''getVnetDeploymentName'')).outputs.vnetProperties.value]"},"location":{"value":"[parameters(''location'')]"},"updatedSubnets":{"value":"[reference(variables(''collectSubnetsDeploymentName'')).outputs.updatedSubnets.value]"},"vnetName":{"value":"[variables(''vnetName'')]"}}}}]},"parameters":{"fullResourceName":{"value":"[field(''fullName'')]"},"resourceName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"nsgPrefix":{"value":"[parameters(''nsgPrefix'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288","type":"Microsoft.Authorization/policyDefinitions","name":"210ed8bd-6b07-4d5e-a62c-c34f07293288"},{"properties":{"displayName":"Audit
        all Microsoft.Web/sites/config/authsettings","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"authsettings"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/211a466d-b2be-46e8-b029-8c28f566f118","type":"Microsoft.Authorization/policyDefinitions","name":"211a466d-b2be-46e8-b029-8c28f566f118"},{"properties":{"displayName":"Audit
        existence of a tag2","policyType":"Custom","mode":"All","description":"Audits
        that a required tag is present on resources","metadata":{},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":null}}},"policyRule":{"if":{"field":"tags","notcontainsKey":"[parameters(''tagName'')]"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1","type":"Microsoft.Authorization/policyDefinitions","name":"24813039-7534-408a-9842-eb99f45721b1"},{"properties":{"displayName":"Append
        single location","policyType":"Custom","mode":"all","metadata":{"category":"camarvin"},"parameters":{"allowedLocation":{"type":"String","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","equals":"[parameters(''allowedLocation'')]"}},"then":{"effect":"append","details":[{"field":"tags.locationTest","value":"[parameters(''allowedLocation'')]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/25e0ce73-3c96-46fd-9f4d-b83b99ec11bf","type":"Microsoft.Authorization/policyDefinitions","name":"25e0ce73-3c96-46fd-9f4d-b83b99ec11bf"},{"properties":{"displayName":"camarvin
        oms vm linux parameterized effect","policyType":"Custom","mode":"all","metadata":{},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list","strongType":"omsWorkspace"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Select
        Log Analytics workspace from dropdown list","strongType":"omsWorkspace"},"allowedValues":["deployIfNotExists","disabled"],"defaultValue":"deployIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","type":"Microsoft.Authorization/policyDefinitions","name":"263f13f4-6b88-4788-bead-34beedde70ce"},{"properties":{"displayName":"elpere
        strange alias in field function","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"not":{"field":"Tags[''asdasd'']","equals":"[concat(''whatever'',
        ''a'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/26556185-593c-4866-9c0c-114ac0bf6120","type":"Microsoft.Authorization/policyDefinitions","name":"26556185-593c-4866-9c0c-114ac0bf6120"},{"properties":{"displayName":"test
        guest assignment","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/28e54a72-2fd7-40d3-afe2-b05423e0147a","type":"Microsoft.Authorization/policyDefinitions","name":"28e54a72-2fd7-40d3-afe2-b05423e0147a"},{"properties":{"displayName":"akhe-incident-85944710-v2","policyType":"Custom","mode":"all","description":"2nd
        attempt on this policy. ","metadata":{"category":"akhe"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","notIn":"[parameters(''allowedLocations'')]"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/290b38e4-eff9-434b-b4d3-3ddd60841400","type":"Microsoft.Authorization/policyDefinitions","name":"290b38e4-eff9-434b-b4d3-3ddd60841400"},{"properties":{"displayName":"akhe-incident-85944710-combined","policyType":"Custom","mode":"all","description":"the
        combined policy attempt for both cosmos db cases. ","metadata":{},"parameters":{"locationNames":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"anyOf":[{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","In":"[parameters(''locationNames'')]"}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/290b38e4-eff9-434b-b4d3-3ddd6084180f","type":"Microsoft.Authorization/policyDefinitions","name":"290b38e4-eff9-434b-b4d3-3ddd6084180f"},{"properties":{"displayName":"storage
        ip rules append 2","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Storage/storageAccounts/networkAcls.ipRules","value":[{"value":"8.8.8.8","action":"Allow"}]}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f","type":"Microsoft.Authorization/policyDefinitions","name":"2b2317a7-ab02-47b5-8159-eb7e6227709f"},{"properties":{"displayName":"[demo]
        Enforce KeyVault diagnostic log storage","policyType":"Custom","mode":"all","description":"Ensures
        that AuditEvents are collected from all Key Vaults in the subscription and
        stored in a specific storage account for 30 days.","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},"roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","variables":{"storageName":"[tolower(concat(''cheggkv'',
        parameters(''location'')))]"},"resources":[{"type":"Microsoft.KeyVault/vaults/providers/diagnosticSettings","name":"[concat(parameters(''vaultName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","properties":{"storageAccountId":"[resourceid(''cheggremdemo'',
        ''Microsoft.Storage/storageAccounts'', variables(''storageName''))]","logs":[{"category":"AuditEvent","enabled":true,"retentionPolicy":{"enabled":true,"days":30}}]}}],"parameters":{"vaultName":{"type":"string"},"location":{"type":"string"}}},"parameters":{"vaultName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/332ce4ac-9200-4573-8c66-92b85fc82c8d","type":"Microsoft.Authorization/policyDefinitions","name":"332ce4ac-9200-4573-8c66-92b85fc82c8d"},{"properties":{"displayName":"audit_cosmosdb_enableAutomaticFailover","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/enableAutomaticFailover","equals":"false"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0a0"},{"properties":{"displayName":"audit_cosmosdb_defaultConsistencyLevel","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/consistencyPolicy.defaultConsistencyLevel","equals":"lalala"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0b7"},{"properties":{"displayName":"audit_cosmosdb_readLocations","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0bd"},{"properties":{"displayName":"audit_cosmosdb_writeLocations","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0ce"},{"properties":{"displayName":"audit_cosmosdb_failoverPolicies","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd160"},{"properties":{"displayName":"Deploy
        Threat Detection on ManagedInstances","policyType":"Custom","mode":"indexed","description":"Deploy
        Threat Detection on ManagedInstances","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"anyOf":[{"field":"type","equals":"Microsoft.Sql/managedInstances"}]},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"}},"variables":{},"resources":[{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/managedInstances/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}}]},"parameters":{"serverName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/388f3717-f877-4c56-9083-d448c837c0df","type":"Microsoft.Authorization/policyDefinitions","name":"388f3717-f877-4c56-9083-d448c837c0df"},{"properties":{"displayName":"Audit
        SQL  and Managed Instance TDE","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases/transparentDataEncryption"},{"field":"type","equals":"Microsoft.Sql/managedInstances/databases/transparentDataEncryption"},{"field":"Microsoft.Sql/transparentDataEncryption.status","notEquals":"enabled"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/388f3717-f877-4c56-9083-d448c837c144","type":"Microsoft.Authorization/policyDefinitions","name":"388f3717-f877-4c56-9083-d448c837c144"},{"properties":{"displayName":"jilim
        recovery services vaults test","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{"vault":{"type":"String","metadata":{"displayName":"Recovery
        Services Vault","description":"The Recovery Services Vault.","strongType":"Microsoft.RecoveryServices/vaults"}},"vaults":{"type":"Array","metadata":{"displayName":"Recovery
        Services Vaults","description":"The list of Recovery Services Vaults.","strongType":"Microsoft.RecoveryServices/vaults"}}},"policyRule":{"if":{"allOf":[{"field":"location","equals":"[parameters(''vault'')]"},{"field":"location","in":"[parameters(''vaults'')]"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3b2c1b0f-63c5-4943-8578-6d37fbe411bb","type":"Microsoft.Authorization/policyDefinitions","name":"3b2c1b0f-63c5-4943-8578-6d37fbe411bb"},{"properties":{"displayName":"Append
        HTTPS For Web Apps","policyType":"Custom","mode":"all","description":"CSS","metadata":{"category":"WebApps"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"field":"Microsoft.Web/sites/httpsOnly","exists":"false"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Web/sites/httpsOnly","value":"true"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3b788cf8-ff6f-4075-86a1-ab76270790e0","type":"Microsoft.Authorization/policyDefinitions","name":"3b788cf8-ff6f-4075-86a1-ab76270790e0"},{"properties":{"displayName":"rohitbh
        : Deploy Log Analytics Agent for Windows VMs","policyType":"Custom","mode":"indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"rohitbh"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        values: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3cc5820a-cbb8-4977-9c90-d90ced95f12c","type":"Microsoft.Authorization/policyDefinitions","name":"3cc5820a-cbb8-4977-9c90-d90ced95f12c"},{"properties":{"displayName":"Name
        should have prefix and suffix","policyType":"Custom","description":"Name should
        have prefix and suffix","parameters":{"prefix":{"type":"String","metadata":{"displayName":"The
        prefix","description":"The name prefix"},"allowedValues":[]},"suffix":{"type":"String","metadata":{"displayName":"The
        suffix","description":"The name suffix."},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"name","like":"[concat(parameters(''prefix''),
        ''*'', parameters(''suffix''))]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007","type":"Microsoft.Authorization/policyDefinitions","name":"3e275e2e-a157-4ade-8f91-43b3ea370007"},{"properties":{"displayName":"Restrict
        VM skus","policyType":"Custom","mode":"All","description":"Restricts allowed
        VM skus to a predefined regex","parameters":{"allowedSkuTemplate":{"type":"String","metadata":{"displayName":"Allowed
        VM sku template","description":"The VM sku template. Supports wildcards via
        ''*''"}}},"policyRule":{"if":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/sku.name","like":"[parameters(''allowedSkuTemplate'')]"},{"field":"type","equals":"Microsoft.Compute/virtualMachines"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8","type":"Microsoft.Authorization/policyDefinitions","name":"3e3807c1-65c9-49e0-a406-82d8ae3e34c8"},{"properties":{"displayName":"Audit
        storage account SKU","policyType":"Custom","mode":"All","description":"Audits
        the use of storage account SKUs that don''t meet organizational cost policy.","parameters":{"listOfAllowedSkus":{"type":"Array","metadata":{"displayName":"List
        of allowed SKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSkus'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682","type":"Microsoft.Authorization/policyDefinitions","name":"3e3807c1-65c9-49e0-a406-82d8ae3e3682"},{"properties":{"displayName":"RobgaDataFactoryTest1","policyType":"Custom","mode":"all","description":"RobgaDataFactoryTest","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataFactory/factories"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/workspaceId","equals":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgatestworkspace/providers/Microsoft.OperationalInsights/workspaces/robgatestworkspace"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3ffb9f8c-fdaa-41b0-ad4b-b0f55e2860c9","type":"Microsoft.Authorization/policyDefinitions","name":"3ffb9f8c-fdaa-41b0-ad4b-b0f55e2860c9"},{"properties":{"displayName":"Enforce
        autoUpgrade on VM/VMSS extensions","policyType":"Custom","mode":"All","description":"Denies
        any VM or VMSS extensions that do not have autoUpgradeMinorVersion set to
        true.","metadata":{},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","notEquals":"true"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets/extensions"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","notEquals":"true"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f772"},{"properties":{"displayName":"Append
        autoUpgrade to VM extensions","policyType":"Custom","mode":"All","description":"Automatically
        enabled autoUpgradeMinorVersion on VM extensions","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","exists":"false"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","value":"true"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f783"},{"properties":{"displayName":"Append
        autoUpgrade to VM scale set extensions","policyType":"Custom","mode":"All","description":"Automatically
        appends autoUpgradeMinorVersion=true to VMSS extensions","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets/extensions"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","exists":"false"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","value":"true"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f7a3"},{"properties":{"displayName":"MSIT
        - AppService must use serverFarm","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyOf":[{"field":"Microsoft.Web/sites/serverFarmId","exists":"false"},{"field":"Microsoft.Web/sites/serverFarmId","equals":""}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39fc12"},{"properties":{"displayName":"MSIT
        - AppService serverFarm must have capacity > 1","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/serverFarms"},{"field":"Microsoft.Web/serverFarms/sku.capacity","in":["0","1"]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39fc23"},{"properties":{"displayName":"Do_Not_Delete","policyType":"Custom","mode":"All","description":"This
        policy is used for unit tests. Please do not delete it.","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60","type":"Microsoft.Authorization/policyDefinitions","name":"4a0425e4-97bf-4ad0-ab36-145b94083c60"},{"properties":{"displayName":"Deny
        MySQL firewallRules starting with 0","policyType":"Custom","mode":"all","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"0.0.0.0"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4b94c320-ce63-4fb6-ba9d-7dbe648b90de","type":"Microsoft.Authorization/policyDefinitions","name":"4b94c320-ce63-4fb6-ba9d-7dbe648b90de"},{"properties":{"displayName":"ICM
        83686598","policyType":"Custom","mode":"All","description":"deny the creation
        of storage if supportsHttpsTrafficOnly is false","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4c03a3e3-e038-4a55-a6a6-abf8e7bb9175","type":"Microsoft.Authorization/policyDefinitions","name":"4c03a3e3-e038-4a55-a6a6-abf8e7bb9175"},{"properties":{"displayName":"detect
        ''allow All'' NSG rule","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","equals":"*"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notEquals":"*"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4c915617-16f0-4c62-b021-e66d5409d11d","type":"Microsoft.Authorization/policyDefinitions","name":"4c915617-16f0-4c62-b021-e66d5409d11d"},{"properties":{"displayName":"rohitbh:
        Deploy Auditing on SQL servers without role definitions","policyType":"Custom","mode":"indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"rohitbh"},"parameters":{"retentionDays":{"type":"String","metadata":{"displayName":"Retention
        days (optional, 180 days if unspecified)","description":"The value in days
        of the retention period (0 indicates unlimited retention)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf332195"},{"properties":{"displayName":"rohitbh:
        Deploy Auditing on SQL servers with role definitions","policyType":"Custom","mode":"indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"Test"},"parameters":{"retentionDays":{"type":"String","metadata":{"displayName":"Retention
        days (optional, 180 days if unspecified)","description":"The value in days
        of the retention period (0 indicates unlimited retention)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332199","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf332199"},{"properties":{"displayName":"rohitbh:
        Audit VMs that do not use managed disks without role definitions","policyType":"Custom","mode":"all","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf33219f","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf33219f"},{"properties":{"displayName":"rohitbh:
        Audit VMs that do not use managed disks with role definitions","policyType":"Custom","mode":"all","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit","details":{"type":"Microsoft.Sql/servers/auditingSettings","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"]}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf3321a3","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf3321a3"},{"properties":{"displayName":"Deny
        storage container creation","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Storage/storageAccounts/blobServices/containers"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4d2f8837-7acb-4488-b580-95960ee3f116","type":"Microsoft.Authorization/policyDefinitions","name":"4d2f8837-7acb-4488-b580-95960ee3f116"},{"properties":{"displayName":"Ensure
        auto-created NSG rules exist","policyType":"Custom","mode":"All","description":"Ensures
        that security rules created in auto-created PortLockdown NSGs are not tampered
        with","metadata":{"category":"Port Lockdown"},"parameters":{"nsgPrefix":{"type":"String","metadata":{"displayName":"NSG
        name prefix","description":"The prefix string applied to automatically created
        network security groups."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"Expected
        IP restriction prefixes","description":"The IP ranges incoming traffic will
        be restricted to in the expected security rule. I.e. 192.4.0.0/8;192.5.0.0/8
        or *"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Expected
        destination port ranges","description":"Destination port ranges requiring
        IP restrictions in the expected security rule"}},"priority":{"type":"String","metadata":{"displayName":"Expected
        priority","description":"The priority of the expected security rule."}},"access":{"type":"String","metadata":{"displayName":"Expected
        access","description":"The access (allow/deny) of the expected security rule."},"allowedValues":["Allow","Deny"]},"name":{"type":"String","metadata":{"displayName":"Expected
        name","description":"The name of the expected security rule."}}},"policyRule":{"if":{"allOf":[{"field":"name","equals":"[concat(parameters(''nsgPrefix''),
        ''-'', field(''location''))]"},{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''priority'')]"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","in":"[parameters(''sourceAddressPrefixes'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":"[parameters(''sourceAddressPrefixes'')]"}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","in":"[parameters(''destinationPortRanges'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''access'')]"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"},"name":{"type":"string"},"priority":{"type":"string"},"access":{"type":"string"},"nsgName":{"type":"string"}},"variables":{"isSinglePrefix":"[equals(count(parameters(''sourceAddressPrefixes'')),
        1)]","isSinglePortRange":"[equals(count(parameters(''destinationPortRanges'')),
        1)]"},"resources":[{"name":"[concat(parameters(''nsgName''), ''/'', parameters(''name''))]","type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2018-03-01","properties":{"description":"Rule
        auto-created by Internet Exposed Endpoints protection","protocol":"*","sourcePortRange":"*","destinationPortRange":"[if(variables(''isSinglePortRange''),
        first(parameters(''destinationPortRanges'')), '''')]","destinationPortRanges":"[if(not(variables(''isSinglePortRange'')),
        parameters(''destinationPortRanges''), json(''[]''))]","sourceAddressPrefix":"[if(variables(''isSinglePrefix''),
        first(parameters(''sourceAddressPrefixes'')), '''')]","sourceAddressPrefixes":"[if(not(variables(''isSinglePrefix'')),
        parameters(''sourceAddressPrefixes''), json(''[]''))]","destinationAddressPrefix":"*","access":"[parameters(''access'')]","priority":"[int(parameters(''priority''))]","direction":"Inbound"}}]},"parameters":{"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"name":{"value":"[parameters(''name'')]"},"priority":{"value":"[parameters(''priority'')]"},"access":{"value":"[parameters(''access'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115","type":"Microsoft.Authorization/policyDefinitions","name":"4f283ec4-25a9-46df-bbf2-806ed5a3e115"},{"properties":{"displayName":"rs
        defaultvalue backslash","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{"ExclusionsExtensions":{"type":"String","metadata":{"displayName":"Extensions
        to Exclude","description":"Semicolon delimited list of file extensions to
        exclude from scanning"},"defaultValue":".FWD;.GSC;.GSE;.MYD;.MYI;.SMD;.VAC;.BAK;.CHK;.FRM;.LDF;.LOG;.MBX;.MDF;.NDF;.TRN;.UND;.UNF;.UNH;.UNI;.UNQ;.UNS;.VHD;.VMDX;.WCI;.EDB;.SDS"},"ExclusionsPaths":{"type":"String","metadata":{"displayName":"Paths
        to Exclude","description":"Semicolon delimited list of file paths or locations
        to exclude from scanning"},"defaultValue":"C:\\rs-pkgs;C:\\System Volume Information\\DFSR;C:\\Sysvol;C:\\ProgramData\\Microsoft\\SharePoint;C:\\Program
        Files\\Common Files\\Microsoft Shared\\Web Server Extensions;C:\\Program Files\\Operations
        Manager;C:\\Program Files\\Microsoft Monitoring Agent;C:\\Program Files\\Microsoft
        Office Servers;C:\\Program Files\\Microsoft System Center 2012 R2\\Server;C:\\Program
        Files\\System Center Operations Manager;C:\\Program Files\\System Center Operations
        Manager 2007;C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\Temporary
        ASP.NET Files;C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary
        ASP.NET Files;C:\\Windows\\NTDS;C:\\Windows\\System32\\LogFiles;C:\\Windows\\Sysvol;C:\\Program
        Files\\Double-Take Software;C:\\Program Files\\DoubleTake;C:\\Program Files\\Exchsrvr;C:\\Program
        Files\\Ipswitch;C:\\Program Files\\LogMeIn;C:\\Windows\\SoftwareDistribution\\Datastore;C:\\Windows\\Temp\\Gthrsvc"},"ExclusionsProcesses":{"type":"String","metadata":{"displayName":"Processes
        to Exclude","description":"Semicolon delimited list of processes to exclude
        from scanning"},"defaultValue":"HealthService.exe;ManagementService.exe;Microsoft.Mom.Sdk.Service.exe;Microsoft.Mom.ConfigServiceHost.exe;MonitoringHost.exe;pagefile.sys"},"RealtimeProtectionEnabled":{"type":"String","metadata":{"displayName":"Enable
        real time protection","description":"Indicates whether or not real time protection
        is enabled (default is true)"},"defaultValue":"true"},"ScheduledScanSettingsIsEnabled":{"type":"String","metadata":{"displayName":"Enable
        Scheduled scans","description":"Indicates whether or not custom scheduled
        scan settings are enabled (default is false)"},"defaultValue":"false"},"ScheduledScanSettingsScanType":{"type":"String","metadata":{"displayName":"Scheduled
        Scan Type","description":"Indicates whether scheduled scan setting type is
        set to Quick or Full (default is Quick)"},"defaultValue":"Quick"},"ScheduledScanSettingsDay":{"type":"String","metadata":{"displayName":"Day
        of Scheduled Scan","description":"Day of the week for scheduled scan (1-Sunday,
        2-Monday, ..., 7-Saturday)"},"defaultValue":"7"},"ScheduledScanSettingsTime":{"type":"String","metadata":{"displayName":"Time
        of Scheduled Scan","description":"Semicolon delimited list of file extensions
        to exclude from scanning"},"defaultValue":"120"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"ExclusionsPaths":{"type":"string"},"ExclusionsExtensions":{"type":"string"},"ExclusionsProcesses":{"type":"string"},"RealtimeProtectionEnabled":{"type":"string"},"ScheduledScanSettingsIsEnabled":{"type":"string"},"ScheduledScanSettingsScanType":{"type":"string"},"ScheduledScanSettingsDay":{"type":"string"},"ScheduledScanSettingsTime":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/IaaSAntimalware'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.Azure.Security","type":"IaaSAntimalware","typeHandlerVersion":"1.3","autoUpgradeMinorVersion":true,"settings":{"AntimalwareEnabled":true,"RealtimeProtectionEnabled":"[parameters(''RealtimeProtectionEnabled'')]","ScheduledScanSettings":{"isEnabled":"[parameters(''ScheduledScanSettingsIsEnabled'')]","day":"[parameters(''ScheduledScanSettingsDay'')]","time":"[parameters(''ScheduledScanSettingsTime'')]","scanType":"[parameters(''ScheduledScanSettingsScanType'')]"},"Exclusions":{"Extensions":"[parameters(''ExclusionsExtensions'')]","Paths":"[parameters(''ExclusionsPaths'')]","Processes":"[parameters(''ExclusionsProcesses'')]"}}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"ExclusionsExtensions":{"value":"[parameters(''ExclusionsExtensions'')]"},"ExclusionsPaths":{"value":"[parameters(''ExclusionsPaths'')]"},"ExclusionsProcesses":{"value":"[parameters(''ExclusionsProcesses'')]"},"RealtimeProtectionEnabled":{"value":"[parameters(''RealtimeProtectionEnabled'')]"},"ScheduledScanSettingsIsEnabled":{"value":"[parameters(''ScheduledScanSettingsIsEnabled'')]"},"ScheduledScanSettingsScanType":{"value":"[parameters(''ScheduledScanSettingsScanType'')]"},"ScheduledScanSettingsDay":{"value":"[parameters(''ScheduledScanSettingsDay'')]"},"ScheduledScanSettingsTime":{"value":"[parameters(''ScheduledScanSettingsTime'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50877efd-8dd9-43d5-b4e6-3b70e64311b9","type":"Microsoft.Authorization/policyDefinitions","name":"50877efd-8dd9-43d5-b4e6-3b70e64311b9"},{"properties":{"displayName":"rohitbh:
        Deploy key vault KV_B if key vault KV_A does not exist.","policyType":"Custom","mode":"indexed","description":"This
        policy will deploy a key vault named KV_B if a key vault named KV_A does not
        exist.","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.KeyVault/vaults","existenceCondition":{"field":"name","equals":"KV_B"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[{"apiVersion":"2016-10-01","name":"KV_A","type":"Microsoft.KeyVault/vaults","location":"eastus2","properties":{"tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","sku":{"family":"A","name":"standard"},"accessPolicies":[]}}]}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","type":"Microsoft.Authorization/policyDefinitions","name":"50e2972e-143c-4edf-9ef6-bee0f84212d6"},{"properties":{"displayName":"robga
        test asr2","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/extensions/resources[*].type","equals":"testvm-umgd"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/54418a6f-081a-4b57-b758-fc9defb1f126","type":"Microsoft.Authorization/policyDefinitions","name":"54418a6f-081a-4b57-b758-fc9defb1f126"},{"properties":{"displayName":"RobgaTestRbac","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Authorization/roleAssignments/principalId","equals":"Admin"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/560482cd-dac5-41e6-9cef-b0aecd6020de","type":"Microsoft.Authorization/policyDefinitions","name":"560482cd-dac5-41e6-9cef-b0aecd6020de"},{"properties":{"displayName":"rohitbh
        : definition param with assignPermissions","policyType":"Custom","mode":"indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/57ef268f-b414-436a-9894-125a81d80b30","type":"Microsoft.Authorization/policyDefinitions","name":"57ef268f-b414-436a-9894-125a81d80b30"},{"properties":{"displayName":"elpere
        patch test- should get additional contant","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","equals":"asdsasadsadsadasd"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/58b241c7-c392-4efe-b4da-f1872d8c30ba","type":"Microsoft.Authorization/policyDefinitions","name":"58b241c7-c392-4efe-b4da-f1872d8c30ba"},{"properties":{"displayName":"GokmenhAuditLocation","policyType":"Custom","mode":"all","description":"Audit
        if not west us","metadata":{},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastus"]}},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5948d091-78b7-4d3b-a404-cc6a0329b0c6","type":"Microsoft.Authorization/policyDefinitions","name":"5948d091-78b7-4d3b-a404-cc6a0329b0c6"},{"properties":{"displayName":"deployifnotexist
        template alias tests - redis","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/Redis"},{"field":"Microsoft.Cache/Redis/sku.family","equals":"C"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Resources/links","existenceCondition":{"field":"name","like":"Whatever*"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"skuFamily":{"type":"string"},"enableNonSslPort":{"type":"string"},"nameField":{"type":"string"}},"resources":[],"outputs":{"skuFamilyOut":{"value":"[parameters(''skuFamily'')]","type":"string"},"enableNonSslPortOut":{"value":"[parameters(''enableNonSslPort'')]","type":"string"},"nameFieldOut":{"value":"[parameters(''nameField'')]","type":"string"}}},"parameters":{"skuFamily":{"value":"[field(''Microsoft.Cache/Redis/sku.family'')]"},"enableNonSslPort":{"value":"[field(''Microsoft.Cache/Redis/enableNonSslPort'')]"},"nameField":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5a8a68e8-ae1c-420a-9639-a94ebeb3c0c8","type":"Microsoft.Authorization/policyDefinitions","name":"5a8a68e8-ae1c-420a-9639-a94ebeb3c0c8"},{"properties":{"displayName":"akhe-incident-86226837","policyType":"Custom","mode":"All","description":"reproing
        the incident: https://icm.ad.msft.net/imp/v3/incidents/details/86226837/home","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","exists":"false"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","exists":"
        false"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca376","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca376"},{"properties":{"displayName":"akhe-incident-86318519","policyType":"Custom","mode":"all","description":"reproing
        incident 86318519","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/firewallrules"},{"field":"name","equals":"AllowAllWindowsAzureIps"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca600","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca600"},{"properties":{"displayName":"akhe-incident-86230190","policyType":"Custom","mode":"All","description":"reproing
        incident 86230190, https://icm.ad.msft.net/imp/v3/incidents/details/86230190/home\n\nAudits
        if a resource doesn''t have a lock","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","exists":"true"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"Microsoft.Authorization/locks/level","notIn":["ReadOnly","CanNotDelete"]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca8d6","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca8d6"},{"properties":{"displayName":"Test
        storage alias","policyType":"Custom","mode":"all","description":"Test storage
        alias","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Storage/storageAccounts"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"httpsOnly":{"type":"string"},"encrypt":{"type":"string"},"accessTier":{"type":"string"},"skuName":{"type":"string"}},"resources":[],"outputs":{"skuNameOut":{"type":"string","value":"[parameters(''skuName'')]"},"accessTierOut":{"type":"string","value":"[parameters(''accessTier'')]"},"httpsOnlyOut":{"type":"String","value":"[parameters(''httpsOnly'')]"},"encryptOut":{"type":"String","value":"[parameters(''encrypt'')]"}}},"parameters":{"httpsOnly":{"value":"[field(''Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly'')]"},"encrypt":{"value":"[field(''Microsoft.Storage/storageAccounts/enableBlobEncryption'')]"},"accessTier":{"value":"[field(''Microsoft.Storage/storageAccounts/accessTier'')]"},"skuName":{"value":"[field(''Microsoft.Storage/storageAccounts/sku.name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5fa69139-9a49-464e-90b5-0d243a469138","type":"Microsoft.Authorization/policyDefinitions","name":"5fa69139-9a49-464e-90b5-0d243a469138"},{"properties":{"displayName":"inherit
        costcenter tag","policyType":"Custom","mode":"all","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"tags.CostCenter","exists":"false"}]},"then":{"effect":"append","details":[{"field":"tags.CostCenter","value":"[resourceGroup().tags.CostCenter]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6ced0d17-98f3-41e2-8038-08c8f4fb90e3","type":"Microsoft.Authorization/policyDefinitions","name":"6ced0d17-98f3-41e2-8038-08c8f4fb90e3"},{"properties":{"displayName":"jilim
        Apply allowed tag and its default value","policyType":"Custom","mode":"indexed","description":"3","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"},"allowedValues":["TagA","TagB"]},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''","strongType":"omsWorkspace"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6d1735de-f3e3-4c40-a8b2-7b3a1042a895","type":"Microsoft.Authorization/policyDefinitions","name":"6d1735de-f3e3-4c40-a8b2-7b3a1042a895"},{"properties":{"displayName":"testSandipsh
        metric alert policy1","policyType":"Custom","mode":"All","metadata":{"category":"testSandipsh"},"parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":null}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"],"defaultValue":"3"},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"],"defaultValue":"true"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"Metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        metric operator."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"The
        timeAggregation."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"The window size."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"The evaluation frequency."}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        action group id."}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","like":"[concat(parameters(''alertNamePrefix''),
        ''*'')]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(toLower(parameters(''alertNamePrefix'')),
        uniqueString(resourceGroup().id))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3","type":"Microsoft.Authorization/policyDefinitions","name":"6f2c6354-fc96-4f54-984e-8d49d06a80a3"},{"properties":{"displayName":"testImageId","policyType":"Custom","mode":"All","metadata":{"category":"css"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.Compute/VirtualMachineScaleSets"]},{"not":{"field":"Microsoft.Compute/imageId","contains":"resourceGroups/testSandipsh"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/70dc1e8d-61c9-4089-8bf5-895b227c1298","type":"Microsoft.Authorization/policyDefinitions","name":"70dc1e8d-61c9-4089-8bf5-895b227c1298"},{"properties":{"displayName":"Policy
        tracked resources SDK tests","policyType":"Custom","mode":"all","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"name","equals":"policyTrackedResources-sdk-tests"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"field":"name","notIn":["policyTrackedResources-sdk-tests-rule1","policyTrackedResources-sdk-tests-rule2"]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"}},"resources":[{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/policyTrackedResources-sdk-tests-rule1'')]","properties":{"description":"Test
        Rule","protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":2000,"direction":"Outbound"}},{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/policyTrackedResources-sdk-tests-rule2'')]","properties":{"description":"Test
        Rule","protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":2001,"direction":"Outbound"}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/71289c53-22e7-4f31-a6dd-780b532380c2","type":"Microsoft.Authorization/policyDefinitions","name":"71289c53-22e7-4f31-a6dd-780b532380c2"},{"properties":{"displayName":"Deny
        if blob is not encrypted","policyType":"Custom","mode":"All","parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a","type":"Microsoft.Authorization/policyDefinitions","name":"74d5cf40-7293-46a4-a285-7ea971e3719a"},{"properties":{"displayName":"[cstack]
        Location restriction","policyType":"Custom","mode":"All","description":"Policy
        to force allocations to a set of given locations","metadata":{"category":"cstack"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335","type":"Microsoft.Authorization/policyDefinitions","name":"763dcd1d-a4a9-46a8-8bd3-357c4533a335"},{"properties":{"displayName":"ICM
        83577342 deny proxy resource location","policyType":"Custom","mode":"All","description":"https://icm.ad.msft.net/imp/v3/incidents/details/83577342/home","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"location","notEquals":"eastus"},{"field":"type","equals":"Microsoft.StreamAnalytics/streamingjobs/transformations"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/77429b44-aac1-4417-a53e-6900c07e11ac","type":"Microsoft.Authorization/policyDefinitions","name":"77429b44-aac1-4417-a53e-6900c07e11ac"},{"properties":{"displayName":"SQL
        firewall applicability test","policyType":"Custom","mode":"all","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/firewallRules"},{"field":"name","notEquals":"////"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/78c26c94-429b-48f5-8a89-3a56ea2151ae","type":"Microsoft.Authorization/policyDefinitions","name":"78c26c94-429b-48f5-8a89-3a56ea2151ae"},{"properties":{"displayName":"Block
        TLS < 1.2","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"anyOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"type","equals":"Microsoft.Web/sites/slots/config"}]},{"field":"name","equals":"web"},{"field":"Microsoft.Web/sites/config/minTlsVersion","notEquals":"1.2"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/78c5df31-2f05-4f4d-acfe-3e536d88c1bc","type":"Microsoft.Authorization/policyDefinitions","name":"78c5df31-2f05-4f4d-acfe-3e536d88c1bc"},{"properties":{"displayName":"Deny
        ActiveDirectory administrators","policyType":"Custom","mode":"All","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"Microsoft.Sql/servers/administrators/administratorType","equals":"ActiveDirectory"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7e520b19-dac2-4bbf-b27b-dcd67a3f60e0","type":"Microsoft.Authorization/policyDefinitions","name":"7e520b19-dac2-4bbf-b27b-dcd67a3f60e0"},{"properties":{"displayName":"default
        value backslash weird chars","policyType":"Custom","mode":"all","metadata":{},"parameters":{"allowedLocations":{"type":"String","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."},"defaultValue":"C:\\rs-pkgs;C:\\System
        Volume Information\\DFSR!@#$%^&*()_+=-{}[];:'',.<>?~`/;C:\\hello\\there"}},"policyRule":{"if":{"not":{"field":"location","equals":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7f4d769f-78db-46eb-ac3c-0b8214f8c245","type":"Microsoft.Authorization/policyDefinitions","name":"7f4d769f-78db-46eb-ac3c-0b8214f8c245"},{"properties":{"displayName":"akhe-incident-86230190-v2","policyType":"Custom","mode":"all","description":"reproing
        incident 86230190, https://icm.ad.msft.net/imp/v3/incidents/details/86230190/home\n\nAudits
        if a resource doesn''t have a lock v2","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"not":{"field":"type","equals":"Microsoft.Authorization/locks"}},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"Microsoft.Authorization/locks/level","in":["ReadOnly","CanNotDelete"]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/83daa8ee-7c9a-470c-81a8-5a99ac09d134","type":"Microsoft.Authorization/policyDefinitions","name":"83daa8ee-7c9a-470c-81a8-5a99ac09d134"},{"properties":{"displayName":"Case
        118113021002127","policyType":"Custom","mode":"all","metadata":{},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":null}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Web/sites","existenceCondition":{"anyOf":[{"field":"Microsoft.Web/sites/hostNames[*]","contains":"northwell.io"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/86cd412c-c557-473b-984c-a5f15cdcb116","type":"Microsoft.Authorization/policyDefinitions","name":"86cd412c-c557-473b-984c-a5f15cdcb116"},{"properties":{"displayName":"Parameterized
        effect (if location != eastus)","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"The
        policy effect."}}},"policyRule":{"if":{"not":{"field":"location","equals":"eastus"}},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","type":"Microsoft.Authorization/policyDefinitions","name":"885f1dcb-a9c5-4c8c-8996-2702db44a2d2"},{"properties":{"displayName":"jilim
        exists","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.xyz","exists":false}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8959fd87-c1dd-4831-9034-a4f876bee1cc","type":"Microsoft.Authorization/policyDefinitions","name":"8959fd87-c1dd-4831-9034-a4f876bee1cc"},{"properties":{"displayName":"Kubernetes
        ingress policy","policyType":"Custom","mode":"indexed","description":"Only
        specified ingress is allowed based on names","metadata":{"category":"Kubernetes"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8dc89b7c-4ffa-4051-b93e-4e8f1bd5631a","type":"Microsoft.Authorization/policyDefinitions","name":"8dc89b7c-4ffa-4051-b93e-4e8f1bd5631a"},{"properties":{"displayName":"elpere
        applicability test 1","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"anyOf":[{"field":"type","equals":"Microsoft.Network/whatever"},{"field":"tags.applicability","exists":"true"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8e6b598c-1a45-404b-97dd-983e37c040da","type":"Microsoft.Authorization/policyDefinitions","name":"8e6b598c-1a45-404b-97dd-983e37c040da"},{"properties":{"displayName":"audit_cosmosdb_ipRangeFilter","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter","equals":"lalala"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c","type":"Microsoft.Authorization/policyDefinitions","name":"9012b1cd-b045-46c6-a510-6137e06a009c"},{"properties":{"displayName":"elperetest","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"field":"tags.Hyphen-test","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.Hyphen-test","value":"[resourceGroup().tags[''Hyphen-test'']]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9389a21b-2134-414a-a579-e9f2709b2131","type":"Microsoft.Authorization/policyDefinitions","name":"9389a21b-2134-414a-a579-e9f2709b2131"},{"properties":{"displayName":"default
        value backslash (array)","policyType":"Custom","mode":"all","metadata":{},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."},"defaultValue":["C:\\rs-pkgs","C:\\System
        Volume Information\\DFSR"]}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/985adbc0-6d2e-448a-ac26-89d3688191d5","type":"Microsoft.Authorization/policyDefinitions","name":"985adbc0-6d2e-448a-ac26-89d3688191d5"},{"properties":{"displayName":"github209","policyType":"Custom","mode":"all","description":"Audit
        diagnostic setting for selected resource types","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/virtualNetworkRules"}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9a060c03-fda7-4b0a-b4da-15e2b7e4d117","type":"Microsoft.Authorization/policyDefinitions","name":"9a060c03-fda7-4b0a-b4da-15e2b7e4d117"},{"properties":{"displayName":"akhe
        - Subscription Lvl test","policyType":"Custom","mode":"All","description":"Subscriptionlevel
        auditIfNotExist policy","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/subscriptions/write"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"name","equals":"testlock"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d1de","type":"Microsoft.Authorization/policyDefinitions","name":"a1b067c8-2970-4c0b-b0da-31ae7f33d1de"},{"properties":{"displayName":"[cstack]
        Noop","policyType":"Custom","mode":"All","description":"Don''t do anything","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","in":["yabba","dabba","doo"]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b4218b6","type":"Microsoft.Authorization/policyDefinitions","name":"a309ad64-0bae-48d9-a6b1-d99c0b4218b6"},{"properties":{"displayName":"HTTPS
        For Web Apps","policyType":"Custom","mode":"all","description":"CSS","metadata":{"category":"WebApps"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyof":[{"not":{"field":"Microsoft.Web/sites/httpsOnly","exists":"true"}},{"field":"Microsoft.Web/sites/httpsOnly","equals":"false"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a337c781-c7d8-4e12-ae69-1951c7e74378","type":"Microsoft.Authorization/policyDefinitions","name":"a337c781-c7d8-4e12-ae69-1951c7e74378"},{"properties":{"displayName":"Case
        118113021002127 - better","policyType":"Custom","mode":"all","metadata":{},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":null},"allowedValues":["Audit","Disabled","Deny"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]},{"field":"Microsoft.Web/sites/hostNames[*]","contains":"81196380"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a514cb15-f9d8-49c9-a1e1-8b6d1fe19121","type":"Microsoft.Authorization/policyDefinitions","name":"a514cb15-f9d8-49c9-a1e1-8b6d1fe19121"},{"properties":{"displayName":"Audit
        allowed virtual machine SKUs","policyType":"Custom","mode":"indexed","description":"This
        policy enables you to specify a set of virtual machine SKUs that your organization
        can deploy.","metadata":{"category":"Compute"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"displayName":"Allowed
        SKUs","description":"The list of SKUs that can be specified for virtual machines.","strongType":"VMSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a54cf76d-5680-4cd2-9fe9-b1bc82b8c1a8","type":"Microsoft.Authorization/policyDefinitions","name":"a54cf76d-5680-4cd2-9fe9-b1bc82b8c1a8"},{"properties":{"displayName":"Ensure
        https traffic only for storage account","policyType":"Custom","mode":"all","description":"Ensure
        https traffic only for storage account","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"true"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a5f66345-5fb9-4dfd-864a-e3464ee6c0c4","type":"Microsoft.Authorization/policyDefinitions","name":"a5f66345-5fb9-4dfd-864a-e3464ee6c0c4"},{"properties":{"displayName":"add
        subscription name tag","policyType":"Custom","mode":"All","description":"add
        subscription name tag","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.subscriptionname","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.subscriptionname","value":"[subscription().displayName]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d82a2"},{"properties":{"displayName":"Add
        subscription \"id\" tag","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.id","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.id","value":"[subscription().id]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d8339"},{"properties":{"displayName":"add
        subscriptionId tag","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.subscriptionId","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.subscriptionId","value":"[subscription().subscriptionId]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d8635"},{"properties":{"displayName":"robgaNSGtest","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","equals":"3389"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notEquals":"3389"}}]},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/aeb6a524-e3d1-4b8a-afa8-26ae4e291116","type":"Microsoft.Authorization/policyDefinitions","name":"aeb6a524-e3d1-4b8a-afa8-26ae4e291116"},{"properties":{"displayName":"Allowed
        Location Indexed","policyType":"Custom","mode":"Indexed","description":"hackathon
        policy","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Allowed-Locations-Indexed","type":"Microsoft.Authorization/policyDefinitions","name":"Allowed-Locations-Indexed"},{"properties":{"displayName":"Audit
        if antiMalware extension does not exist","policyType":"Custom","description":"This
        policy audits if the anti malware extension .","policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"},{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists","type":"Microsoft.Authorization/policyDefinitions","name":"antiMalwareExtensionExists"},{"properties":{"displayName":"Web
        socket must be disabled on App Services","policyType":"Custom","description":"Ensures
        web sockets are disabled on App Services.","policyRule":{"if":{"field":"location","equals":"foo"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets","type":"Microsoft.Authorization/policyDefinitions","name":"AppServiceWebSockets"},{"properties":{"displayName":"Azure
        Security Center must be enabled","policyType":"Custom","description":"Ensures
        Azure Security Center is enabled.","policyRule":{"if":{"field":"location","equals":"foo"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled","type":"Microsoft.Authorization/policyDefinitions","name":"ASCEnabled"},{"properties":{"displayName":"Audit
        a tag and it''s value","policyType":"Custom","description":"Audits if a tag
        and it''s value doesn''t exist for a given resource","parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."},"allowedValues":[]},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and it''s value","type":"Microsoft.Authorization/policyDefinitions","name":"Audit
        a tag and it''s value"},{"properties":{"displayName":"Audit a tag and it''s
        value","policyType":"Custom","mode":"indexed","description":"Audits if a tag
        and it''s value doesn''t exist for a given resource","metadata":{},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."}},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"}}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and its value","type":"Microsoft.Authorization/policyDefinitions","name":"Audit
        a tag and its value"},{"properties":{"displayName":"Audit if extension does
        not exist","policyType":"Custom","mode":"All","description":"This policy audits
        if a required extension doesn''t exist.","parameters":{"publisher":{"type":"String","metadata":{"description":"The
        publisher of the extension","displayName":"Extension Publisher"}},"type":{"type":"String","metadata":{"description":"The
        type of the extension","displayName":"Extension Type"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftWindowsServer"]},{"field":"Microsoft.Compute/imageOffer","in":["WindowsServer"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"[parameters(''publisher'')]"},{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"[parameters(''type'')]"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/audit-vm-extension","type":"Microsoft.Authorization/policyDefinitions","name":"audit-vm-extension"},{"properties":{"displayName":"CanCrudPolicyAssignment
        Policy Definition $[Auto Test]","policyType":"Custom","policyRule":{"if":{"source":"action","equals":"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azsmnet6487","type":"Microsoft.Authorization/policyDefinitions","name":"azsmnet6487"},{"properties":{"displayName":"test_policydv3uswjx7","policyType":"Custom","description":"desc_for_test_policy_123","parameters":{"allowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policygehbsyfdw","type":"Microsoft.Authorization/policyDefinitions","name":"azure-cli-test-policygehbsyfdw"},{"properties":{"displayName":"89322663
        audit diag setting","policyType":"Custom","mode":"All","metadata":{},"parameters":{"listOfResourceTypes":{"type":"Array","metadata":{"displayName":"Resource
        Types","description":"The list of resources types to audit for missing diagnostic
        log settings."}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypes'')]"},"then":{"details":{"existenceCondition":{"allOf":[{"equals":"true","field":"Microsoft.Insights/diagnosticSettings/logs.enabled"}]},"type":"Microsoft.Insights/diagnosticSettings"},"effect":"AuditIfNotExists"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b350b9b0-8ba5-4867-bc9c-63b4544671b9","type":"Microsoft.Authorization/policyDefinitions","name":"b350b9b0-8ba5-4867-bc9c-63b4544671b9"},{"properties":{"displayName":"makharchtest","policyType":"Custom","mode":"All","description":"policy","metadata":{"category":""},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b36f6195-0fc5-4a41-bbce-875248400f5f","type":"Microsoft.Authorization/policyDefinitions","name":"b36f6195-0fc5-4a41-bbce-875248400f5f"},{"properties":{"displayName":"default
        value backslash really long string","policyType":"Custom","mode":"all","metadata":{},"parameters":{"allowedLocations":{"type":"String","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."},"defaultValue":"C:\\rs-pkgs;C:\\System
        Volume Information\\DFSR;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple;C:\\Really Long Path\\We Want Multiple;C:\\Really
        Long Path\\We Want Multiple"}},"policyRule":{"if":{"not":{"field":"location","equals":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b9203c56-0565-434a-a315-87f4da9f21b9","type":"Microsoft.Authorization/policyDefinitions","name":"b9203c56-0565-434a-a315-87f4da9f21b9"},{"properties":{"displayName":"NSG
        Rules exists test","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].protocol","notLike":"*"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bb6a78ae-8737-41e0-9c41-cc777c8c00a0","type":"Microsoft.Authorization/policyDefinitions","name":"bb6a78ae-8737-41e0-9c41-cc777c8c00a0"},{"properties":{"displayName":"rohitbh:
        icm 102226001","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"name","match":"aks-default?###########"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bc732353-948c-47b9-934e-b16e99c23254","type":"Microsoft.Authorization/policyDefinitions","name":"bc732353-948c-47b9-934e-b16e99c23254"},{"properties":{"policyType":"Custom","mode":"All","metadata":{"Category":"Flintstones"},"policyRule":{"if":{"field":"type","in":["yabba","dabba","doo"]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/BedrockPolicy","type":"Microsoft.Authorization/policyDefinitions","name":"BedrockPolicy"},{"properties":{"displayName":"Audit
        allowed locations","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9","type":"Microsoft.Authorization/policyDefinitions","name":"c0f586f1-abe5-4801-8588-7332e49e60c9"},{"properties":{"displayName":"234","policyType":"Custom","mode":"indexed","metadata":{},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Insights/logprofiles"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/logprofiles","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/logprofiles/retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/logprofiles/retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c37cc5ff-3fbb-4444-a39d-09b9e6fb7116","type":"Microsoft.Authorization/policyDefinitions","name":"c37cc5ff-3fbb-4444-a39d-09b9e6fb7116"},{"properties":{"displayName":"Doublecheck
        the lifecycle tag policy","policyType":"Custom","mode":"All","description":"This
        policy refers to tags[''Lifecycle''], which with the current implementation
        of the escaped tags syntax will refer to a tag named ''Lifecycle'' (quotes
        and all). This is a customer policy that would be broken when I switch the
        meaning of tags[''Lifecycle''] to refer simply to a tag named Lifecycle (no
        quotes)","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags[''Lifecycle'']","notIn":["dev","tst","stg","prd","trn","prf"]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c6be98a9-8108-40aa-b726-d2ae8e2891b9","type":"Microsoft.Authorization/policyDefinitions","name":"c6be98a9-8108-40aa-b726-d2ae8e2891b9"},{"properties":{"displayName":"Inherit
        tag from resource group","policyType":"Custom","mode":"indexed","description":"Inherits
        a tag value from the tag of the same name on the resource group of the evaluated
        resource.","metadata":{"category":"camarvin"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[resourcegroup().tags[parameters(''tagName'')]]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c7b04f89-4d7d-4205-ab3d-a41081791aef","type":"Microsoft.Authorization/policyDefinitions","name":"c7b04f89-4d7d-4205-ab3d-a41081791aef"},{"properties":{"displayName":"akhe
        resource group auditIfNotExists","policyType":"Custom","mode":"All","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"name","equals":"testlock"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c7b9982d-2f50-4730-935f-5c241982a441","type":"Microsoft.Authorization/policyDefinitions","name":"c7b9982d-2f50-4730-935f-5c241982a441"},{"properties":{"displayName":"jilim
        allowed resource types","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"allowedTypes":{"type":"Array","metadata":{"displayName":"Allowed
        resource types","description":"The list of allowed resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''allowedTypes'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c872f951-1c5d-4c61-89dd-aee2350a11ba","type":"Microsoft.Authorization/policyDefinitions","name":"c872f951-1c5d-4c61-89dd-aee2350a11ba"},{"properties":{"displayName":"Audit
        location","policyType":"Custom","mode":"All","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","type":"Microsoft.Authorization/policyDefinitions","name":"c8b79b49-a579-4045-984e-1b249ab8b474"},{"properties":{"displayName":"Audit
        SQL TDE","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases/transparentDataEncryption"},{"field":"Microsoft.Sql/transparentDataEncryption.status","notEquals":"enabled"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8cedfaa-4aa0-465a-8b90-49caf8177158","type":"Microsoft.Authorization/policyDefinitions","name":"c8cedfaa-4aa0-465a-8b90-49caf8177158"},{"properties":{"displayName":"elpere
        css block NSG changes","policyType":"Custom","mode":"all","description":"https://icm.ad.msft.net/imp/v3/incidents/details/95894791/home","metadata":{},"parameters":{"nsgName":{"type":"String","metadata":{"displayName":"nsgName","description":"The
        name of the NSG."},"defaultValue":"nsgName"}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"name","equals":"[parameters(''nsgName'')]"}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"fullName","like":"[concat(parameters(''nsgName''),
        ''/*'')]"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ca01432d-4278-45a6-8137-69f2155d2248","type":"Microsoft.Authorization/policyDefinitions","name":"ca01432d-4278-45a6-8137-69f2155d2248"},{"properties":{"displayName":"camarvin
        empty string","policyType":"Custom","mode":"all","description":"Ensure resource
        names meet the like condition for a pattern.","metadata":{},"parameters":{"namePattern":{"type":"String","metadata":{"displayName":"namePattern","description":"Pattern
        to use for names. Can include wildcard (*)."},"allowedValues":["","one","two"],"defaultValue":""}},"policyRule":{"if":{"not":{"field":"name","equals":"[parameters(''namePattern'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/camarvin-test-empty-assign","type":"Microsoft.Authorization/policyDefinitions","name":"camarvin-test-empty-assign"},{"properties":{"displayName":"elpere
        append ''test'' tag","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"name","equals":"elpereKv"},"then":{"effect":"append","details":[{"field":"tags.test","value":"1"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ced59ff0-9061-49dd-94de-093b33a640cf","type":"Microsoft.Authorization/policyDefinitions","name":"ced59ff0-9061-49dd-94de-093b33a640cf"},{"properties":{"displayName":"elpere
        deny on ''test'' tag","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"tags.test","equals":"1"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ced59ff0-9061-49dd-94de-093b33a640d7","type":"Microsoft.Authorization/policyDefinitions","name":"ced59ff0-9061-49dd-94de-093b33a640d7"},{"properties":{"displayName":"Resource
        name contains resource group name","policyType":"Custom","mode":"Indexed","description":"Require
        resources to contain the resource group''s name","policyRule":{"if":{"field":"name","notContains":"[resourceGroup().name]"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/contain-resource-group-name","type":"Microsoft.Authorization/policyDefinitions","name":"contain-resource-group-name"},{"properties":{"displayName":"akhe-incident-86226837-v3","policyType":"Custom","mode":"all","description":"third
        attempt to repro this incident. ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Sql/servers/firewallRules"}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5002","type":"Microsoft.Authorization/policyDefinitions","name":"d03e03ca-6424-4e28-8842-5796dc0b5002"},{"properties":{"displayName":"akhe-incident-86230190-deployIfNotExists","policyType":"Custom","mode":"all","description":"deploys
        a delete lock for a resource ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"not":{"field":"type","equals":"Microsoft.Authorization/locks"}},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/locks","roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"Microsoft.Authorization/locks/level","in":["CanNotDelete"]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{},"variables":{},"resources":[{"type":"Microsoft.Authorization/locks","apiVersion":"2015-01-01","name":"DeleteLock","properties":{"level":"CanNotDelete","notes":"prevent
        deletion"}}],"outputs":{}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5632","type":"Microsoft.Authorization/policyDefinitions","name":"d03e03ca-6424-4e28-8842-5796dc0b5632"},{"properties":{"displayName":"Enforce
        KeyVault diagnostic log storage (elpere)","policyType":"Custom","mode":"all","description":"Ensures
        that AuditEvents are collected from all Key Vaults in the subscription and
        stored in a specific storage account for 30 days.","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},"roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","variables":{"storageName":"elperetest"},"resources":[{"type":"Microsoft.KeyVault/vaults/providers/diagnosticSettings","name":"[concat(parameters(''vaultName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","properties":{"storageAccountId":"[resourceid(''elpere'',
        ''Microsoft.Storage/storageAccounts'', variables(''storageName''))]","logs":[{"category":"AuditEvent","enabled":true,"retentionPolicy":{"enabled":true,"days":30}}]}}],"parameters":{"vaultName":{"type":"string"},"location":{"type":"string"}}},"parameters":{"vaultName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d0d9349d-843c-443a-9f27-5ce84f08c37e","type":"Microsoft.Authorization/policyDefinitions","name":"d0d9349d-843c-443a-9f27-5ce84f08c37e"},{"properties":{"displayName":"elpere
        deny test","policyType":"Custom","mode":"all","description":"","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"field":"name","equals":"elpereKv"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d1c0e77c-53b4-4c4d-a1f5-c535a370b0c5","type":"Microsoft.Authorization/policyDefinitions","name":"d1c0e77c-53b4-4c4d-a1f5-c535a370b0c5"},{"properties":{"displayName":"elpere
        template paramters function tests","policyType":"Custom","mode":"all","description":"testing
        strange array behavior","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"name","contains":"lmao"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"String"},"dataDisks":{"type":"object"},"osDisk":{"type":"String"}},"variables":{"vmVar":"[parameters(''vmName'')]","dataDisksVar":"[parameters(''dataDisks'')]"},"resources":[],"outputs":{"vmNameOut":{"value":"[variables(''vmVar'')]","type":"String"},"dataDisksOut":{"value":"[concat(array(parameters(''osDisk'')),
        if(empty(parameters(''dataDisks'').rawValue), parameters(''dataDisks'').emptyArray,
        array(parameters(''dataDisks'').rawValue)))]","type":"array"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"dataDisks":{"value":{"rawValue":"[field(''Microsoft.Compute/virtualMachines/storageProfile.dataDisks[*].managedDisk.id'')]","emptyArray":[]}},"osDisk":{"value":"[field(''Microsoft.Compute/virtualMachines/storageProfile.osDisk.managedDisk.id'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d2532053-bf59-4095-a1ae-2b7e4744f119","type":"Microsoft.Authorization/policyDefinitions","name":"d2532053-bf59-4095-a1ae-2b7e4744f119"},{"properties":{"displayName":"Access
        KV as part of remidiation deployment test (elpere)","policyType":"Custom","mode":"all","description":"","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"hello"},"deployment":{"properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","resources":[],"parameters":{"testSecret":{"type":"string"}},"outputs":{"testSecretOutput":{"type":"string","value":"[parameters(''testSecret'')]"}}},"parameters":{"testSecret":{"reference":{"keyVault":{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.KeyVault/vaults/elpereKv"},"secretName":"test"}}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d35ce9be-f51b-4d3e-bc7f-dde2936381b0","type":"Microsoft.Authorization/policyDefinitions","name":"d35ce9be-f51b-4d3e-bc7f-dde2936381b0"},{"properties":{"displayName":"akhe
        - inv","policyType":"Custom","mode":"All","description":"inv ","metadata":{"category":"akhe"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit","details":{"functionId":"subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/resourcegroups/AKif2WebApp/providers/Microsoft.Logic/workflows/deneme","payload":{"locations":"[parameters(''allowedLocations'')]"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d54722e7-4665-47ce-9a82-2f96cebfe238","type":"Microsoft.Authorization/policyDefinitions","name":"d54722e7-4665-47ce-9a82-2f96cebfe238"},{"properties":{"displayName":"akhe
        - incident - gardner","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"}]},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Web/sites/config","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","equals":"true"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"name":{"type":"string"}},"resources":[],"outputs":{"text":{"type":"string","value":"Policy
        executed for resource [parameters(''name'')]"}}},"parameters":{"name":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d54722e7-4665-47ce-9a82-2f96cebfe353","type":"Microsoft.Authorization/policyDefinitions","name":"d54722e7-4665-47ce-9a82-2f96cebfe353"},{"properties":{"displayName":"Deploy
        security rule with restricted source IPs (NSG level)","policyType":"Custom","mode":"All","description":"Overwrites
        security rules with IP restrictions at the NSG level","metadata":{"category":"Port
        Lockdown"},"parameters":{"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Ranges may overlap."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"anyOf":[{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange","notIn":"[parameters(''destinationPortRanges'')]"}},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","in":"[parameters(''destinationPortRanges'')]"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","exists":"true"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notLike":"*"}},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","exists":"true"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notIn":["*","Internet"]}]}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"},"location":{"type":"string"},"destinationPortRanges":{"type":"array"},"sourceAddressPrefixes":{"type":"array"}},"variables":{"getNsgDeploymentName":"[concat(''getNSGContent-'',
        parameters(''nsgName''))]","collectorDeploymentName":"[concat(''collectRules-'',
        parameters(''nsgName''))]","overwriteNsgDeploymentName":"[concat(''overwriteNsg-'',
        parameters(''nsgName''))]","nsgResourceId":"[resourceId(subscription().subscriptionId,
        resourceGroup().name, ''Microsoft.Network/networkSecurityGroups'', parameters(''nsgName''))]"},"resources":[{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''getNsgDeploymentName'')]","properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[],"outputs":{"nsgProperties":{"type":"object","value":"[reference(variables(''nsgResourceId''),
        ''2018-03-01'', ''Full'')]"}}}}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''collectorDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_collectRules_template.json","contentVersion":"1.0.0.0"},"parameters":{"nsgProperties":{"value":"[reference(variables(''getNsgDeploymentName'')).outputs.nsgProperties.value]"},"nsgName":{"value":"[parameters(''nsgName'')]"},"location":{"value":"[parameters(''location'')]"},"portRangesToRestrict":{"value":"[parameters(''destinationPortRanges'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"}}}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''overwriteNsgDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_overwriteNSG_template.json","contentVersion":"1.0.0.0"},"parameters":{"originalNsgProperties":{"value":"[reference(variables(''getNsgDeploymentName'')).outputs.nsgProperties.value]"},"updatedSecurityRules":{"value":"[reference(variables(''collectorDeploymentName'')).outputs.updatedSecurityRules.value]"},"nsgName":{"value":"[parameters(''nsgName'')]"},"location":{"value":"[parameters(''location'')]"}}}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086","type":"Microsoft.Authorization/policyDefinitions","name":"d7b13c30-e6aa-47e1-b50a-8e33f152d086"},{"properties":{"displayName":"rohitbh
        : [Preview]: Deploy Log Analytics Agent for Windows VMs","policyType":"Custom","mode":"indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        values: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7121","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7121"},{"properties":{"displayName":"rohitbh
        : [Preview]: Deploy Log Analytics Agent for Linux VMs","policyType":"Custom","mode":"indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7126","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7126"},{"properties":{"displayName":"rohitbh
        : [Preview]: Deploy Dependency Agent for Windows VMs","policyType":"Custom","mode":"indexed","description":"Deploy
        Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e712b","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e712b"},{"properties":{"displayName":"rohitbh
        : [Preview]: Deploy Dependency Agent for Linux VMs","policyType":"Custom","mode":"indexed","description":"Deploy
        Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7130","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7130"},{"properties":{"displayName":"rohitbh
        : [Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted","policyType":"Custom","mode":"indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e7135","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e7135"},{"properties":{"displayName":"rohitbh
        : [Preview]: Audit Dependency Agent Deployment - VM Image (OS) unlisted","policyType":"Custom","mode":"indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/da84593c-b133-40c2-8524-c79fd38e713a","type":"Microsoft.Authorization/policyDefinitions","name":"da84593c-b133-40c2-8524-c79fd38e713a"},{"properties":{"displayName":"Audit
        storage account SKUs","policyType":"Custom","mode":"All","metadata":{"category":"Demo
        323"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"displayName":"Audited
        skus","description":"The list of skus.","strongType":"storageSkus"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee","type":"Microsoft.Authorization/policyDefinitions","name":"dbe1e663-7265-4cf4-96b5-7435b21e90ee"},{"properties":{"displayName":"Audit
        virtual machines SKUs","policyType":"Custom","mode":"All","metadata":{"category":"Demo
        323"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"displayName":"List
        Of Allowed SKUs","description":"The list of allowed locations for resources.","strongType":"vmSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170","type":"Microsoft.Authorization/policyDefinitions","name":"dbe1e663-7265-4cf4-96b5-7435b21e9170"},{"properties":{"displayName":"[elpere]
        deployIfNotExists Runners test","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"deployIfNotExistsTestsRule","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"}},"resources":[{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/deployIfNotExistsTestsRule'')]","properties":{"protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Deny","priority":2000,"direction":"Outbound"}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbfa9fc0-5202-4001-8759-1aa2387f825b","type":"Microsoft.Authorization/policyDefinitions","name":"dbfa9fc0-5202-4001-8759-1aa2387f825b"},{"properties":{"displayName":"allowedOS","policyType":"Custom","mode":"All","metadata":{"category":"test_sandipsh"},"parameters":{"listOfAllowedWindows":{"type":"Array","metadata":{"displayName":"Allowed
        Windows VMs","description":"The list of allowed VMs for Windows."}},"listOfAllowedUbuntus":{"type":"Array","metadata":{"displayName":"Allowed
        Ubuntu VMs","description":"The list of allowed VMs for Ubuntu."}}},"policyRule":{"if":{"allOf":[{"field":"type","in":["Microsoft.Compute/disks","Microsoft.Compute/virtualMachines","Microsoft.Compute/VirtualMachineScaleSets"]},{"not":{"allOf":[{"field":"Microsoft.Compute/imagePublisher","in":["Canonical"]},{"field":"Microsoft.Compute/imageOffer","in":["UbuntuServer"]},{"field":"Microsoft.Compute/imageSku","in":"[parameters(''listOfAllowedUbuntus'')]"},{"field":"Microsoft.Compute/imageVersion","in":["latest"]}]}},{"not":{"allOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftWindowsServer"]},{"field":"Microsoft.Compute/imageOffer","in":["WindowsServer"]},{"field":"Microsoft.Compute/imageSku","in":"[parameters(''listOfAllowedWindows'')]"},{"field":"Microsoft.Compute/imageVersion","in":["latest"]}]}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091","type":"Microsoft.Authorization/policyDefinitions","name":"e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091"},{"properties":{"displayName":"jilim
        recovery services backup policies","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{"policies":{"type":"Array","metadata":{"displayName":"Allowed
        Recovery Services backup policies","description":"The list of allowed Recovery
        Services backup policies.","strongType":"Microsoft.RecoveryServices/vaults/backupPolicies"}},"policy":{"type":"String","metadata":{"displayName":"Allowed
        Recovery Services backup policy","description":"Allowed Recovery Services
        backup policy.","strongType":"Microsoft.RecoveryServices/vaults/backupPolicies"}}},"policyRule":{"if":{"allOf":[{"not":{"field":"location","in":"[parameters(''policies'')]"}},{"not":{"field":"location","equals":"[parameters(''policy'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e3f9a624-b17d-4dc8-9649-65814d3241bb","type":"Microsoft.Authorization/policyDefinitions","name":"e3f9a624-b17d-4dc8-9649-65814d3241bb"},{"properties":{"displayName":"Audit
        web sites with tags on their authsettings","policyType":"Custom","mode":"all","description":"Seeing
        if authsettings can even be used in a ifnotexists policy before adding aliases.","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Web/sites"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Web/sites/config","name":"authSettings","existenceCondition":{"field":"tags","exists":"false"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e7c6ee79-2fdb-4c28-9a1f-9dcad3100120","type":"Microsoft.Authorization/policyDefinitions","name":"e7c6ee79-2fdb-4c28-9a1f-9dcad3100120"},{"properties":{"displayName":"Audit
        web sites with tags on their logs config","policyType":"Custom","mode":"all","description":"Seeing
        if authsettings can even be used in a ifnotexists policy before adding aliases.","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Web/sites"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Web/sites/config","name":"logs","existenceCondition":{"field":"tags","exists":"false"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e7c6ee79-2fdb-4c28-9a1f-9dcad3100125","type":"Microsoft.Authorization/policyDefinitions","name":"e7c6ee79-2fdb-4c28-9a1f-9dcad3100125"},{"properties":{"displayName":"Deny
        changing sites authsettings","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"authsettings"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e7c6ee79-2fdb-4c28-9a1f-9dcad31001bb","type":"Microsoft.Authorization/policyDefinitions","name":"e7c6ee79-2fdb-4c28-9a1f-9dcad31001bb"},{"properties":{"displayName":"defaultValue:
        all parameters","policyType":"Custom","mode":"All","metadata":{"category":"defaultValue"},"parameters":{"locations":{"type":"Array","metadata":{"displayName":"Strong
        type (no scope, array)","description":"The list of locations for resources.","strongType":"location"},"defaultValue":["eastus","westus"]},"location":{"type":"String","metadata":{"displayName":"Strong
        type (no scope, string)","description":"The location for resources.","strongType":"location"},"defaultValue":"eastus"},"resourceGroups":{"type":"Array","metadata":{"displayName":"Strong
        type (array)","description":"The list of resource groups.","strongType":"existingResourceGroups"},"defaultValue":["camarvin"]},"resourceGroup":{"type":"String","metadata":{"displayName":"Strong
        type (string)","description":"The resource group.","strongType":"existingResourceGroups"},"defaultValue":"camarvin"},"tags":{"type":"Array","metadata":{"displayName":"Non
        strong type (array)","description":"The list of tags."},"defaultValue":[]},"tag":{"type":"String","metadata":{"displayName":"Non
        strong type (string)","description":"The tag."},"defaultValue":""},"allowedLocations":{"type":"Array","metadata":{"displayName":"Strong
        type (no scope, array, av)","description":"The list of allowed locations for
        resources.","strongType":"location"},"allowedValues":["eastus","westus","southus"],"defaultValue":["eastus"]},"allowedLocation":{"type":"String","metadata":{"displayName":"Strong
        type (no scope, string, av)","description":"The allowed location for resources.","strongType":"location"},"allowedValues":["eastus","westus","southus"],"defaultValue":"eastus"},"allowedStorageSKUs":{"type":"Array","metadata":{"displayName":"Strong
        type (array, av)","description":"The list of allowed storage SKUs for resources.","strongType":"storageSkus"},"allowedValues":["Standard_LRS","Standard_ZRS","Standard_GRS"],"defaultValue":["Standard_LRS","Standard_ZRS","Standard_GRS"]},"allowedStorageSKU":{"type":"String","metadata":{"displayName":"Strong
        type (string, av)","description":"The allowed storage SKU for resources.","strongType":"storageSkus"},"allowedValues":["Standard_LRS","Standard_ZRS","Standard_GRS"],"defaultValue":"Standard_LRS"},"allowedTags":{"type":"Array","metadata":{"displayName":"Non
        strong type (array, av)","description":"The list of allowed tags."},"allowedValues":["FirstName","LastName","Age"],"defaultValue":["FirstName","LastName","Age"]},"allowedTag":{"type":"String","metadata":{"displayName":"Non
        strong type (string, av)","description":"The allowed tag."},"allowedValues":["FirstName","LastName","Age"],"defaultValue":"FirstName"}},"policyRule":{"if":{"allOf":[{"field":"location","in":"[parameters(''locations'')]"},{"field":"location","equals":"[parameters(''location'')]"},{"field":"location","in":"[parameters(''resourceGroups'')]"},{"field":"location","equals":"[parameters(''resourceGroup'')]"},{"field":"location","in":"[parameters(''tags'')]"},{"field":"location","equals":"[parameters(''tag'')]"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"location","equals":"[parameters(''allowedLocation'')]"},{"field":"location","in":"[parameters(''allowedStorageSkus'')]"},{"field":"location","Equals":"[parameters(''allowedStorageSku'')]"},{"field":"location","in":"[parameters(''allowedTags'')]"},{"field":"location","NotEquals":"[parameters(''allowedTag'')]"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0","type":"Microsoft.Authorization/policyDefinitions","name":"ea1688b3-022e-4add-af39-2fe60689a3b0"},{"properties":{"displayName":"robga
        asr test","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"name","equals":"testvm-umgd"}]},"then":{"effect":"deployIfNotExists","details":{"resourceGroupName":"testrsv03","type":"Microsoft.Resources/links","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"name","like":"ASR-Protect-*"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"encryptionIds":{"type":"array"}},"variables":{},"resources":[],"outputs":{"encryptIdOut":{"value":"[parameters(''encryptionIds'')]","type":"array"}}},"parameters":{"encryptionIds":{"value":"[field(''Microsoft.Storage/storageAccounts/networkAcls.ipRules[*].value'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/eb246a0c-baa7-4e46-bf91-83c8cb89f1a9","type":"Microsoft.Authorization/policyDefinitions","name":"eb246a0c-baa7-4e46-bf91-83c8cb89f1a9"},{"properties":{"displayName":"Deny
        \"Allow All\" NSG rules","policyType":"Custom","mode":"All","description":"Denies
        the creation of sourceAddressPrefix=\"*\", destinationPortRange=\"*\" NSG
        security rules","metadata":{"category":"Port Lockdown"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"name","notEquals":"PortLockdown_AllowAll"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","notEquals":"4000"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","equals":"*"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notEquals":"*"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321","type":"Microsoft.Authorization/policyDefinitions","name":"ebcd21e9-b89f-4a22-8654-dd3a4d8b9321"},{"properties":{"displayName":"Audit
        Sql database for vulnerability assessments periodic scan enabled","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled","notEquals":"enabled"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ecafb65b-480d-4889-9d87-b3b116249c9c","type":"Microsoft.Authorization/policyDefinitions","name":"ecafb65b-480d-4889-9d87-b3b116249c9c"},{"properties":{"displayName":"github264","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"Microsoft.Web/sites/config/siteAuthSettings.enabled","equals":"false"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ef00ee9d-fe45-4d14-8bee-789eea392116","type":"Microsoft.Authorization/policyDefinitions","name":"ef00ee9d-fe45-4d14-8bee-789eea392116"},{"properties":{"displayName":"GokmenhTestTagWithHyphen5","policyType":"Custom","mode":"All","description":"GokmenhTestTagWithHyphen5","metadata":{},"parameters":{},"policyRule":{"if":{"field":"tags.Hyphen-test","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.Hyphen-test","value":"[resourceGroup().tags[''Hyphen-test'']]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f2320be5-23be-4b58-8d8e-08c3044dd60f","type":"Microsoft.Authorization/policyDefinitions","name":"f2320be5-23be-4b58-8d8e-08c3044dd60f"},{"properties":{"displayName":"Audit
        allowed locations","policyType":"Custom","description":"This policy enables
        you to audit your location.","parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''listOfAllowedLocations'')]"}},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition","type":"Microsoft.Authorization/policyDefinitions","name":"LocationAuditDefinition"},{"properties":{"policyType":"Custom","parameters":{},"policyRule":{"if":{"field":"location","equals":"northeurope"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/policy2","type":"Microsoft.Authorization/policyDefinitions","name":"policy2"},{"properties":{"policyType":"Custom","mode":"All","description":"Unit
        test junk: sorry for littering. Please delete me!","policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/Subscriptions/ResourceGroups/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps4344","type":"Microsoft.Authorization/policyDefinitions","name":"ps4344"},{"properties":{"displayName":"testDisplay","policyType":"Custom","mode":"Indexed","description":"Updated
        Unit test junk: sorry for littering. Please delete me!","metadata":{"testName":"testValue"},"policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/Subscriptions/ResourceGroups/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps6386","type":"Microsoft.Authorization/policyDefinitions","name":"ps6386"},{"properties":{"displayName":"testDisplay","policyType":"Custom","mode":"Indexed","description":"Updated
        Unit test junk: sorry for littering. Please delete me!","metadata":{"testName":"testValue"},"policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/Subscriptions/ResourceGroups/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps9652","type":"Microsoft.Authorization/policyDefinitions","name":"ps9652"},{"properties":{"policyType":"Custom","mode":"All","description":"Unit
        test junk: sorry for littering. Please delete me!","policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/Subscriptions/ResourceGroups/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ps9867","type":"Microsoft.Authorization/policyDefinitions","name":"ps9867"},{"properties":{"policyType":"Custom","mode":"All","description":"test
        policy","parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":"The description of alert."}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"]},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"]},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        operator comparing the current value with the threshold value."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"Period of time used to monitor alert activity based on
        the threshold. Must be between five minutes and one day. ISO 8601 duration
        format."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"How often the metric alert is evaluated represented
        in ISO 8601 duration format"}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","equals":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'', field(''name''))]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'',  parameters(''targetResourceName''))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft","type":"Microsoft.Authorization/policyDefinitions","name":"testSandipsh.draft"},{"properties":{"displayName":"testtest","policyType":"Custom","description":"testtest","parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."},"allowedValues":[]},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/testtest","type":"Microsoft.Authorization/policyDefinitions","name":"testtest"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['508416']
      content-type: [application/json; charset=utf-8]
      date: ['Fri, 08 Feb 2019 19:20:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [group delete]
      Connection: [keep-alive]
      Content-Length: ['0']
      ParameterSetName: [--name --yes --no-wait]
      User-Agent: [python/3.7.1 (Windows-10-10.0.17763-SP0) msrest/0.6.2 msrest_azure/0.4.34
          resourcemanagementclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.58]
      accept-language: [en-US]
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policyset000001?api-version=2018-05-01
  response:
    body: {string: ''}
    headers:
      cache-control: [no-cache]
      content-length: ['0']
      date: ['Fri, 08 Feb 2019 19:20:46 GMT']
      expires: ['-1']
      location: ['https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/operationresults/eyJqb2JJZCI6IlJFU09VUkNFR1JPVVBERUxFVElPTkpPQi1DTEk6NUZURVNUOjVGUE9MSUNZU0VUT1FCNVZLNlYzTzc0VVVJTExaUEFDVkpQVnxFQTFDNjhFQjdBMEQ5RjIwLVdFU1RVUyIsImpvYkxvY2F0aW9uIjoid2VzdHVzIn0?api-version=2018-05-01']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
      x-ms-ratelimit-remaining-subscription-deletes: ['14999']
    status: {code: 202, message: Accepted}
version: 1
