interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - security automation list
      Connection:
      - keep-alive
      User-Agent:
      - AZURECLI/2.35.0 azsdk-python-mgmt-security/2.0.0b1 Python/3.10.4 (Windows-10-10.0.22000-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Security/automations?api-version=2019-01-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-05T12:18:09.4575499Z","createdBy":"e457f972-a6c1-4015-9a30-b706d312f7f7","lastUpdatedDateTimeUtc":"2022-04-05T12:18:09.4575499Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"scope
        for subscription 487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"Assessments","ruleSets":[{"rules":[{"propertyJPath":"type","propertyType":"String","expectedValue":"Microsoft.Security/assessments","operator":"Contains"}]}]},{"eventSource":"SubAssessments"},{"eventSource":"Alerts","ruleSets":[{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"low","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"medium","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"high","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"informational","operator":"Equals"}]}]},{"eventSource":"SecureScores"},{"eventSource":"SecureScoreControls"},{"eventSource":"RegulatoryComplianceAssessment"}],"actions":[{"workspaceResourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-487bb485-b5b0-471e-9c0d-10717612f869-eus","actionType":"Workspace"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace","name":"ExportToWorkspace","type":"Microsoft.Security/automations","etag":"\"3e015875-0000-0d00-0000-625353e00000\"","kind":"","location":"eastus","tags":{}},{"properties":{"description":"this
        is the general description","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-05T15:03:29.2891423Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-05T15:36:15.1371685Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"test","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"Assessments","ruleSets":[{"rules":[{"propertyJPath":"type","propertyType":"String","expectedValue":"Microsoft.Security/assessments","operator":"Contains"}]}]},{"eventSource":"SubAssessments"},{"eventSource":"Alerts","ruleSets":[{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"low","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"medium","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"high","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"informational","operator":"Equals"}]}]},{"eventSource":"SecureScores"},{"eventSource":"SecureScoreControls"},{"eventSource":"RegulatoryComplianceAssessment"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace2","name":"ExportToWorkspace2","type":"Microsoft.Security/automations","etag":"\"3e014f75-0000-0d00-0000-625353e00000\"","location":"eastus","tags":{"tag1":"1"}},{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-10T19:28:09.5050338Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-11T18:05:14.5554217Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"SubAssessments"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspaceTemp","name":"ExportToWorkspaceTemp","type":"Microsoft.Security/automations","etag":"\"8601c10a-0000-0d00-0000-62546dda0000\"","location":"eastus","tags":{}},{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-11T17:12:46.2947051Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-11T17:53:13.8850295Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"Scope
        for 487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"SubAssessments"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/sampleAutomation","name":"sampleAutomation","type":"Microsoft.Security/automations","etag":"\"8501c483-0000-0d00-0000-62546b090000\"","location":"eastus","tags":{}}]}'
    headers:
      api-supported-versions:
      - 2019-01-01-preview
      cache-control:
      - no-cache
      content-length:
      - '5614'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 11 Apr 2022 18:07:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-resource-requests:
      - '99'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - security automation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - AZURECLI/2.35.0 azsdk-python-mgmt-security/2.0.0b1 Python/3.10.4 (Windows-10-10.0.22000-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Sample-RG/providers/Microsoft.Security/automations?api-version=2019-01-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-05T12:18:09.4575499Z","createdBy":"e457f972-a6c1-4015-9a30-b706d312f7f7","lastUpdatedDateTimeUtc":"2022-04-05T12:18:09.4575499Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"scope
        for subscription 487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"Assessments","ruleSets":[{"rules":[{"propertyJPath":"type","propertyType":"String","expectedValue":"Microsoft.Security/assessments","operator":"Contains"}]}]},{"eventSource":"SubAssessments"},{"eventSource":"Alerts","ruleSets":[{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"low","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"medium","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"high","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"informational","operator":"Equals"}]}]},{"eventSource":"SecureScores"},{"eventSource":"SecureScoreControls"},{"eventSource":"RegulatoryComplianceAssessment"}],"actions":[{"workspaceResourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-487bb485-b5b0-471e-9c0d-10717612f869-eus","actionType":"Workspace"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace","name":"ExportToWorkspace","type":"Microsoft.Security/automations","etag":"\"3e015875-0000-0d00-0000-625353e00000\"","kind":"","location":"eastus","tags":{}},{"properties":{"description":"this
        is the general description","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-05T15:03:29.2891423Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-05T15:36:15.1371685Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"test","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"Assessments","ruleSets":[{"rules":[{"propertyJPath":"type","propertyType":"String","expectedValue":"Microsoft.Security/assessments","operator":"Contains"}]}]},{"eventSource":"SubAssessments"},{"eventSource":"Alerts","ruleSets":[{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"low","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"medium","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"high","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"informational","operator":"Equals"}]}]},{"eventSource":"SecureScores"},{"eventSource":"SecureScoreControls"},{"eventSource":"RegulatoryComplianceAssessment"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace2","name":"ExportToWorkspace2","type":"Microsoft.Security/automations","etag":"\"3e014f75-0000-0d00-0000-625353e00000\"","location":"eastus","tags":{"tag1":"1"}},{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-10T19:28:09.5050338Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-11T18:05:14.5554217Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"SubAssessments"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspaceTemp","name":"ExportToWorkspaceTemp","type":"Microsoft.Security/automations","etag":"\"8601c10a-0000-0d00-0000-62546dda0000\"","location":"eastus","tags":{}},{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-11T17:12:46.2947051Z","createdBy":"dc6a9278-25c3-47fc-98da-51506fa32469","lastUpdatedDateTimeUtc":"2022-04-11T17:53:13.8850295Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"Scope
        for 487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"SubAssessments"}],"actions":[{"sasPolicyName":"Send","eventHubResourceId":"subscriptions/212f9889-769e-45ae-ab43-6da33674bd26/resourceGroups/ContosoSiemPipeRg/providers/Microsoft.EventHub/namespaces/contososiempipe-ns/eventhubs/surashed-test","actionType":"EventHub"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/Sample-RG/providers/Microsoft.Security/automations/sampleAutomation","name":"sampleAutomation","type":"Microsoft.Security/automations","etag":"\"8501c483-0000-0d00-0000-62546b090000\"","location":"eastus","tags":{}}]}'
    headers:
      api-supported-versions:
      - 2019-01-01-preview
      cache-control:
      - no-cache
      content-length:
      - '5614'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 11 Apr 2022 18:07:14 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-resource-requests:
      - '99'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - security automation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.35.0 azsdk-python-mgmt-security/2.0.0b1 Python/3.10.4 (Windows-10-10.0.22000-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace?api-version=2019-01-01-preview
  response:
    body:
      string: '{"properties":{"description":"","isEnabled":true,"metadata":{"createdDateTimeUtc":"2022-04-05T12:18:09.4575499Z","createdBy":"e457f972-a6c1-4015-9a30-b706d312f7f7","lastUpdatedDateTimeUtc":"2022-04-05T12:18:09.4575499Z","lastUpdatedBy":"dc6a9278-25c3-47fc-98da-51506fa32469"},"scopes":[{"description":"scope
        for subscription 487bb485-b5b0-471e-9c0d-10717612f869","scopePath":"/subscriptions/00000000-0000-0000-0000-000000000000"}],"sources":[{"eventSource":"Assessments","ruleSets":[{"rules":[{"propertyJPath":"type","propertyType":"String","expectedValue":"Microsoft.Security/assessments","operator":"Contains"}]}]},{"eventSource":"SubAssessments"},{"eventSource":"Alerts","ruleSets":[{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"low","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"medium","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"high","operator":"Equals"}]},{"rules":[{"propertyJPath":"Severity","propertyType":"String","expectedValue":"informational","operator":"Equals"}]}]},{"eventSource":"SecureScores"},{"eventSource":"SecureScoreControls"},{"eventSource":"RegulatoryComplianceAssessment"}],"actions":[{"workspaceResourceId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-487bb485-b5b0-471e-9c0d-10717612f869-eus","actionType":"Workspace"}]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/Sample-RG/providers/Microsoft.Security/automations/ExportToWorkspace","name":"ExportToWorkspace","type":"Microsoft.Security/automations","etag":"\"3e015875-0000-0d00-0000-625353e00000\"","kind":"","location":"eastus","tags":{}}'
    headers:
      api-supported-versions:
      - 2019-01-01-preview
      cache-control:
      - no-cache
      content-length:
      - '1814'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 11 Apr 2022 18:07:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Kestrel
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-resource-requests:
      - '99'
    status:
      code: 200
      message: OK
version: 1
