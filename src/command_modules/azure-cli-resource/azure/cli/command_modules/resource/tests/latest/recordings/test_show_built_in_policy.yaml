interactions:
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition list]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions?api-version=2018-03-01
  response:
    body: {string: '{"value":[{"properties":{"displayName":"[Preview]: Deploy Log
        Analytics Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","type":"Microsoft.Authorization/policyDefinitions","name":"053d3325-282c-4e5c-b944-24faffd30d77"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Azure Data Lake Store","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","type":"Microsoft.Authorization/policyDefinitions","name":"057ef27e-665e-4328-8ea3-04b3122bd9fb"},{"properties":{"displayName":"Audit
        SQL DB Level Audit Setting","policyType":"BuiltIn","mode":"All","description":"Audit
        DB level audit setting for SQL databases","metadata":{"category":"SQL","deprecated":true},"parameters":{"setting":{"type":"String","metadata":{"displayName":"Audit
        Setting"},"allowedValues":["enabled","disabled"]}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/auditingSettings","name":"default","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"Audit
        VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","type":"Microsoft.Authorization/policyDefinitions","name":"0868462e-646c-4fe3-9ced-a733534b6a2c"},{"properties":{"displayName":"[Preview]:
        Audit minimum number of owners for subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate more than one subscription owner in order to have
        administrator access redundancy.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateMoreThanOneOwner","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","type":"Microsoft.Authorization/policyDefinitions","name":"09024ccc-0c5f-475e-9457-b7c0d9ed487b"},{"properties":{"displayName":"[Preview]:
        Monitor unencrypted VM Disks in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"VMs
        without an enabled disk encryption will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","type":"Microsoft.Authorization/policyDefinitions","name":"0961003e-5a0a-4549-abde-af6a37f2724d"},{"properties":{"displayName":"Audit
        resource location matches resource group location","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that the resource location matches its resource group location","metadata":{"category":"General"},"policyRule":{"if":{"field":"location","notIn":["[resourcegroup().location]","global"]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","type":"Microsoft.Authorization/policyDefinitions","name":"0a914e76-4921-4c19-b460-a2d36003525a"},{"properties":{"displayName":"[Preview]:
        Audit Dependency Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.2-LTS","14.04.3-LTS","14.04.4-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","type":"Microsoft.Authorization/policyDefinitions","name":"11ac78e3-31bc-4f0c-8434-37ab963cea07"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM minimum password age 1 day","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the period of time (in
        days) that a password must be used before the user can change it.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MinimumPasswordAge","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df","type":"Microsoft.Authorization/policyDefinitions","name":"16390df4-2f73-4b42-af13-c801066763df"},{"properties":{"displayName":"Audit
        transparent data encryption status","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        transparent data encryption status for SQL databases","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"enabled"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"17k78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","type":"Microsoft.Authorization/policyDefinitions","name":"1c210e94-a481-4beb-95fa-1571b434fb04"},{"properties":{"displayName":"Audit
        use of classic virtual machines","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your virtual machines to provide security
        enhancements such as: stronger access control (RBAC), better auditing, ARM-based
        deployment and governance, access to managed identities, access to key vault
        for secrets, Azure AD-based authentication and support for tags and resource
        groups for easier security management","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicCompute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","type":"Microsoft.Authorization/policyDefinitions","name":"1d84d5fb-01f6-4d12-ba4f-4a26081d403d"},{"properties":{"displayName":"Enforce
        tag and its value","policyType":"BuiltIn","description":"Enforces a required
        tag and its value. Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"not":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","type":"Microsoft.Authorization/policyDefinitions","name":"1e30110a-5ceb-460c-a204-c1c3969c6d62"},{"properties":{"displayName":"Audit
        provisioning of an Azure Active Directory administrator for SQL server","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        provisioning of an Azure Active Directory administrator for your SQL server
        to enable Azure AD authentication. Azure AD authentication enables simplified
        permission management and centralized identity management of database users
        and other Microsoft services","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/administrators"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","type":"Microsoft.Authorization/policyDefinitions","name":"1f314764-cb73-4fc9-b863-8eca98ac36e9"},{"properties":{"displayName":"[Preview]:
        Monitor unprotected web application in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Web
        applications without a Web Application Firewall protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames","Microsoft.Web/hostingEnvironments"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","type":"Microsoft.Authorization/policyDefinitions","name":"201ea587-7c90-41c3-910f-c280ae01cfd6"},{"properties":{"displayName":"Audit
        enabling of only secure connections to your Redis Cache","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of only connections via SSL to Redis Cache. Use of secure connections
        ensures authentication between the server and the service and protects data
        in transit from network layer attacks such as man-in-the-middle, eavesdropping,
        and session-hijacking","metadata":{"category":"Cache"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/redis"},{"field":"Microsoft.Cache/Redis/enableNonSslPort","equals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","type":"Microsoft.Authorization/policyDefinitions","name":"22bee202-a82f-4305-9a2a-6d7f44d4dedb"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM passwords must be at least 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the least number of
        characters that a password for a user account may contain.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MinimumPasswordLength","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordLength"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca","type":"Microsoft.Authorization/policyDefinitions","name":"23020aa6-1135-4be2-bae2-149982b06eca"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM maximum password age 70 days","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the period of time (in days) that a password can
        be used before the system requires the user to change it.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MaximumPasswordAge","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc","type":"Microsoft.Authorization/policyDefinitions","name":"24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"properties":{"displayName":"Audit
        configuration of metric alert rules on Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        configuration of metric alert rules on Batch account to enable the required
        metric","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name that an alert rule must be enabled on"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/alertRules","existenceScope":"Subscription","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/alertRules/isEnabled","equals":"true"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.metricName","equals":"[parameters(''metricName'')]"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.resourceUri","equals":"[concat(''/subscriptions/'',
        subscription().subscriptionId, ''/resourcegroups/'', resourceGroup().name,
        ''/providers/Microsoft.Batch/batchAccounts/'', field(''name''))]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","type":"Microsoft.Authorization/policyDefinitions","name":"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7"},{"properties":{"displayName":"Deploy
        default Microsoft IaaSAntimalware extension for Windows Server","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys a Microsoft IaaSAntimalware extension with a default configuraion
        when a VM is not configured with the antimalware extension.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"ExclusionsPaths":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file paths or locations to exclude from scanning"}},"ExclusionsExtensions":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file extensions to exclude from scanning"}},"ExclusionsProcesses":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of process names to exclude from scanning"}},"RealtimeProtectionEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Indicates
        whether or not real time protection is enabled (default is true)"}},"ScheduledScanSettingsIsEnabled":{"type":"string","defaultValue":"false","metadata":{"description":"Indicates
        whether or not custom scheduled scan settings are enabled (default is false)"}},"ScheduledScanSettingsScanType":{"type":"string","defaultValue":"Quick","metadata":{"description":"Indicates
        whether scheduled scan setting type is set to Quick or Full (default is Quick)"}},"ScheduledScanSettingsDay":{"type":"string","defaultValue":"7","metadata":{"description":"Day
        of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)"}},"ScheduledScanSettingsTime":{"type":"string","defaultValue":"120","metadata":{"description":"When
        to perform the scheduled scan, measured in minutes from midnight (0-1440).
        For example: 0 = 12AM, 60 = 1AM, 120 = 2AM."}}},"resources":[{"name":"[concat(parameters(''vmName''),''/IaaSAntimalware'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.Azure.Security","type":"IaaSAntimalware","typeHandlerVersion":"1.3","autoUpgradeMinorVersion":true,"settings":{"AntimalwareEnabled":true,"RealtimeProtectionEnabled":"[parameters(''RealtimeProtectionEnabled'')]","ScheduledScanSettings":{"isEnabled":"[parameters(''ScheduledScanSettingsIsEnabled'')]","day":"[parameters(''ScheduledScanSettingsDay'')]","time":"[parameters(''ScheduledScanSettingsTime'')]","scanType":"[parameters(''ScheduledScanSettingsScanType'')]"},"Exclusions":{"Extensions":"[parameters(''ExclusionsExtensions'')]","Paths":"[parameters(''ExclusionsPaths'')]","Processes":"[parameters(''ExclusionsProcesses'')]"}}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"RealtimeProtectionEnabled":{"value":"true"},"ScheduledScanSettingsIsEnabled":{"value":"true"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc","type":"Microsoft.Authorization/policyDefinitions","name":"2835b622-407b-4114-9198-6f7064cbe0dc"},{"properties":{"displayName":"Apply
        tag and its default value","policyType":"BuiltIn","description":"Applies a
        required tag and its default value if it is not specified by the user. Does
        not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","type":"Microsoft.Authorization/policyDefinitions","name":"2a0e14a6-b0a6-4fab-991a-187a4f81c498"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM should not store passwords using reversible encryption","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines whether the operating system stores passwords
        using reversible encryption.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"StorePasswordsUsingReversibleEncryption","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6","type":"Microsoft.Authorization/policyDefinitions","name":"2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"properties":{"displayName":"[Preview]:
        Audit Linux VM allowing remote connections from accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies remote connections from accounts with empty passwords
        is disabled.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid110","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83","type":"Microsoft.Authorization/policyDefinitions","name":"2d67222d-05fd-4526-a171-2ee132ad9e83"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","type":"Microsoft.Authorization/policyDefinitions","name":"32133ab0-ee4b-4b44-98d6-042180979d50"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Linux VM accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. For Linux servers this includes Chef Inspec, Ruby, and
        Python. This security setting verifies there are no accounts without passwords.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid232","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid232"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe","type":"Microsoft.Authorization/policyDefinitions","name":"3470477a-b35a-49db-aca5-1073d04524fe"},{"properties":{"displayName":"Audit
        unrestricted network access to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        unrestricted network access in your storage account firewall settings. Instead,
        configure network rules so only applications from allowed networks can access
        the storage account. To allow connections from specific internet or on-premise
        clients, access can be granted to traffic from specific Azure virtual networks
        or to public internet IP address ranges","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/networkAcls.defaultAction","equals":"Allow"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","type":"Microsoft.Authorization/policyDefinitions","name":"34c877ad-507e-4c82-993e-3452a6e0ad3c"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Logic Apps","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Logic Apps"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Logic/workflows"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","type":"Microsoft.Authorization/policyDefinitions","name":"34f95f76-5386-4de7-b824-0d8478470c9d"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM maximum password age 70 days","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the period of time (in
        days) that a password can be used before the system requires the user to change
        it.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MaximumPasswordAge","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MaximumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934","type":"Microsoft.Authorization/policyDefinitions","name":"356a906e-05e5-4625-8729-90771e0ee934"},{"properties":{"displayName":"Audit
        enablement of encryption of Automation account variables","policyType":"BuiltIn","mode":"All","description":"It
        is important to enable encryption of Automation account variable assets when
        storing sensitive data","metadata":{"category":"Automation"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Automation/automationAccounts/variables"},{"field":"Microsoft.Automation/automationAccounts/variables/isEncrypted","notEquals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","type":"Microsoft.Authorization/policyDefinitions","name":"3657f5a0-770e-44a3-b44e-9431ba1e9735"},{"properties":{"displayName":"Deploy
        Threat Detection on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Threat Detection is enabled on SQL Servers.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"}},"variables":{},"resources":[{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}}]},"parameters":{"serverName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","type":"Microsoft.Authorization/policyDefinitions","name":"36d49e87-48c4-4f2e-beed-ba4ed02b71f5"},{"properties":{"displayName":"Audit
        use of classic storage accounts","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your storage accounts to provide security
        enhancements such as: stronger access control (RBAC), better auditing, Azure
        Resource Manager based deployment and governance, access to managed identities,
        access to key vault for secrets, Azure AD-based authentication and support
        for tags and resource groups for easier security management","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicStorage/storageAccounts"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","type":"Microsoft.Authorization/policyDefinitions","name":"37e0d2fe-28a5-43d6-a273-67d37d1f5606"},{"properties":{"displayName":"Deploy
        default Log Analytics Agent for Ubuntu VMs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the
        selected Log Analytics workspace","metadata":{"category":"Compute","deprecated":true},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS","16.04-LTS","16.04.0-LTS","14.04.2-LTS","12.04.5-LTS"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38","type":"Microsoft.Authorization/policyDefinitions","name":"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38"},{"properties":{"displayName":"Audit
        secure transfer to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        requirment of Secure transfer in your storage account. Secure transfer is
        an option that forces your storage account to accept requests only from secure
        connections (HTTPS). Use of HTTPS ensures authentication between the server
        and the service and protects data in transit from network layer attacks such
        as man-in-the-middle, eavesdropping, and session-hijacking","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","type":"Microsoft.Authorization/policyDefinitions","name":"404c3081-a854-4457-ae30-26a93ef643f9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","type":"Microsoft.Authorization/policyDefinitions","name":"428256e6-1fac-4f48-a757-df34c2b3336d"},{"properties":{"displayName":"[Preview]:
        Monitor permissive network access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        Security Groups with too permissive rules will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"permissiveNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","type":"Microsoft.Authorization/policyDefinitions","name":"44452482-524f-4bf4-b852-0bff7cc4a3ed"},{"properties":{"displayName":"Require
        SQL Server version 12.0","policyType":"BuiltIn","description":"This policy
        ensures all SQL servers use version 12.0","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"not":{"field":"Microsoft.Sql/servers/version","equals":"12.0"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf","type":"Microsoft.Authorization/policyDefinitions","name":"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf"},{"properties":{"displayName":"Enforce
        automatic OS upgrade with app health checks on VMSS","policyType":"BuiltIn","mode":"All","description":"This
        policy enforces usage of automatic OS upgrade with application health checks
        through health probes, which enables safer rollout by evaluating application
        health after each OS upgrade batch.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"not":{"field":"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade","equals":"True"}},{"field":"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id","exists":"False"}]}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"465f0161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"[Preview]:
        Monitor possible app Whitelisting in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        Application Whitelist configuration will be monitored by Azure Security Center","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"applicationWhitelisting","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","type":"Microsoft.Authorization/policyDefinitions","name":"47a6b606-51aa-4496-8bb7-64b11cf66adc"},{"properties":{"displayName":"Apply
        tag and its default value to resource groups","policyType":"BuiltIn","mode":"All","description":"Applies
        a required tag and its default value to resource groups if it is not specified
        by the user.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71","type":"Microsoft.Authorization/policyDefinitions","name":"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.2-LTS","14.04.3-LTS","14.04.4-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","type":"Microsoft.Authorization/policyDefinitions","name":"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee"},{"properties":{"displayName":"[Preview]:
        Audit maximum number of owners for a subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate up to 3 subscription owners in order to reduce
        the potential for breach by a compromised owner.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateLessThanXOwners","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","type":"Microsoft.Authorization/policyDefinitions","name":"4f11b553-d42e-4e3a-89be-32ca364cad4c"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM minimum password age 1 day","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the period of time (in days) that a password must
        be used before the user can change it.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordAge","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7","type":"Microsoft.Authorization/policyDefinitions","name":"5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM passwords must be at least 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the least number of characters that a password
        for a user account may contain.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordLength","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec","type":"Microsoft.Authorization/policyDefinitions","name":"5aebc8d1-020d-4037-89a0-02043a7524ec"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with write permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with write privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","type":"Microsoft.Authorization/policyDefinitions","name":"5c607a2e-c700-4744-8254-d77e7c9eb5e4"},{"properties":{"displayName":"Allow
        resource creation only in India data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: West India, South India,
        Central India","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["westindia","southindia","centralindia"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54","type":"Microsoft.Authorization/policyDefinitions","name":"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with read permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with read privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","type":"Microsoft.Authorization/policyDefinitions","name":"5f76cf89-fbf2-47fd-a3f4-b891fa780b60"},{"properties":{"displayName":"[Preview]:
        Audit web servers inside Windows VMs must use TLS minimum version 1.1 encryption","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy will audit instances of Internet Information Services (IIS) running
        inside Windows virtual machines, to verify that TLS minimum version 1.1 is
        used for encryption.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AuditSecureProtocol","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c","type":"Microsoft.Authorization/policyDefinitions","name":"60ffe3e2-4604-4460-8f22-0f1da058266c"},{"properties":{"displayName":"Audit
        the setting of ClusterProtectionLevel property to EncryptAndSign in Service
        Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Service Fabric
        provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node
        communication using a primary cluster certificate. Set the protection level
        to ensure that all node-to-node messages are encrypted and digitally signed","metadata":{"category":"Service
        Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].name","notEquals":"Security"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name","notEquals":"ClusterProtectionLevel"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value","notEquals":"EncryptAndSign"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","type":"Microsoft.Authorization/policyDefinitions","name":"617c02be-7f02-4efd-8836-3180d47b6c68"},{"properties":{"displayName":"[Preview]:
        Audit missing blob encryption for storage accounts","policyType":"BuiltIn","mode":"All","description":"This
        policy audits storage accounts without blob encryption. It only applies to
        Microsoft.Storage resource types, not other storage providers. Possible network
        Just In Time access will be monitored by Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","type":"Microsoft.Authorization/policyDefinitions","name":"655cb504-bcee-4362-bd4c-402e6aa38759"},{"properties":{"displayName":"[Preview]:
        Audit deprecated accounts on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts should be removed from your subscriptions.  Deprecated accounts are
        accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccounts","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","type":"Microsoft.Authorization/policyDefinitions","name":"6b1cbf55-e8b6-442f-ba4c-7246b6381474"},{"properties":{"displayName":"Not
        allowed resource types","policyType":"BuiltIn","description":"This policy
        enables you to specify the resource types that your organization cannot deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesNotAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that cannot be deployed.","displayName":"Not allowed
        resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypesNotAllowed'')]"},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","type":"Microsoft.Authorization/policyDefinitions","name":"6c112d4e-5bc7-47ae-a041-ea2d9dccd749"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4","type":"Microsoft.Authorization/policyDefinitions","name":"6fdb9205-3462-4cfc-87d8-16c7860b53f4"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM should not allow previous 24 passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the number of unique
        new passwords that have to be associated with a user account before an old
        password can be reused.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"EnforcePasswordHistory","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"EnforcePasswordHistory"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6","type":"Microsoft.Authorization/policyDefinitions","name":"726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"properties":{"displayName":"Allowed
        storage account SKUs","policyType":"BuiltIn","description":"This policy enables
        you to specify a set of storage account SKUs that your organization can deploy.","metadata":{"category":"Storage"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for storage accounts.","displayName":"Allowed
        SKUs","strongType":"StorageSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1","type":"Microsoft.Authorization/policyDefinitions","name":"7433c107-6db4-4ad1-b57a-a76dce0154a1"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in App Services","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of diagnostic logs on the app. This enables you to recreate activity
        trails for investigation purposes if a security incident occurs or your network
        is compromised","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"web"},{"anyOf":[{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/httpLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/requestTracingEnabled","notEquals":"true"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","type":"Microsoft.Authorization/policyDefinitions","name":"752c6934-9bcc-4749-b004-655e676ae2ac"},{"properties":{"displayName":"[Preview]:
        Monitor VM Vulnerabilities in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Monitors
        vulnerabilities detected by Vulnerability Assessment solution and VMs without
        a Vulnerability Assessment solution in Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"vulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","type":"Microsoft.Authorization/policyDefinitions","name":"760a85ff-6162-42b3-8d70-698e268f648c"},{"properties":{"displayName":"Audit
        enabling of diagnostics logs in Service Fabric and Virtual Machine Scale Sets","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable Logs so that activity trail can be recreated when
        investigations are required in the event of an incident or a compromise.","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"IaaSDiagnostics"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Diagnostics"}]},{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"LinuxDiagnostic"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.OSTCExtensions"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","type":"Microsoft.Authorization/policyDefinitions","name":"7c1b1214-f927-48bf-8882-84f0af6588b1"},{"properties":{"displayName":"Require
        blob encryption for storage accounts","policyType":"BuiltIn","description":"This
        policy ensures blob encryption for storage accounts is turned on. It only
        applies to Microsoft.Storage resource types, not other storage providers.","metadata":{"category":"Storage"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f","type":"Microsoft.Authorization/policyDefinitions","name":"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM enforces password complexity requirements","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. If this policy is enabled, passwords must meet minimum
        requirements.  See documentation for full details at URL http://aka.ms/gcpol.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordMustMeetComplexityRequirements","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordMustMeetComplexityRequirements"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8","type":"Microsoft.Authorization/policyDefinitions","name":"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"properties":{"displayName":"Audit
        diagnostic setting","policyType":"BuiltIn","mode":"All","description":"Audit
        diagnostic setting for selected resource types","metadata":{"category":"Monitoring"},"parameters":{"listOfResourceTypes":{"type":"Array","metadata":{"displayName":"Resource
        Types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypes'')]"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","type":"Microsoft.Authorization/policyDefinitions","name":"7f89b1eb-583c-429a-8828-af049802c1d9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Event Hub","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables recreation of
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","type":"Microsoft.Authorization/policyDefinitions","name":"83a214f7-d01a-484b-91a9-ed54470c9a6a"},{"properties":{"displayName":"Deploy
        SQL DB transparent data encryption","policyType":"BuiltIn","mode":"Indexed","description":"Enables
        transparent data encryption on SQL databases","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullDbName":{"type":"string"}},"resources":[{"name":"[concat(parameters(''fullDbName''),
        ''/current'')]","type":"Microsoft.Sql/servers/databases/transparentDataEncryption","apiVersion":"2014-04-01","properties":{"status":"Enabled"}}]},"parameters":{"fullDbName":{"value":"[field(''fullName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f","type":"Microsoft.Authorization/policyDefinitions","name":"86a912f6-9a06-4e26-b447-11b16ba8659f"},{"properties":{"displayName":"[Preview]:
        Monitor missing system updates in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Missing
        security system updates on your servers will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"systemUpdates","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","type":"Microsoft.Authorization/policyDefinitions","name":"86b3d65f-7626-441e-b690-81a8b71cff60"},{"properties":{"displayName":"Enforce
        tag and its value on resource groups","policyType":"BuiltIn","mode":"All","description":"Enforces
        a required tag and its value on resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46","type":"Microsoft.Authorization/policyDefinitions","name":"8ce3da23-7156-49e4-b145-24f95f9dcb46"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Windows VM should not store passwords using reversible
        encryption","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines whether the operating
        system stores passwords using reversible encryption.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"StorePasswordsUsingReversibleEncryption","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"StorePasswordsUsingReversibleEncryption"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78","type":"Microsoft.Authorization/policyDefinitions","name":"8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"properties":{"displayName":"[Preview]:
        Audit accounts with write permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        write privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","type":"Microsoft.Authorization/policyDefinitions","name":"9297c21d-2ed6-4474-b48f-163f75654ce3"},{"properties":{"displayName":"Allow
        resource creation only in European data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: North Europe, West Europe","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["northeurope","westeurope"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b","type":"Microsoft.Authorization/policyDefinitions","name":"94c19f19-8192-48cd-a11b-e37099d3e36b"},{"properties":{"displayName":"Allow
        resource creation only in United States data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: Central US, East US, East
        US2, North Central US, South Central US, West US","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["centralus","eastus","eastus2","northcentralus","southcentralus","westus"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869","type":"Microsoft.Authorization/policyDefinitions","name":"983211ba-f348-4758-983b-21fa29294869"},{"properties":{"displayName":"[Preview]:
        Monitor unprotected network endpoints in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        endpoints without a Next Generation Firewall''s protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedNetworkEndpoint","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","type":"Microsoft.Authorization/policyDefinitions","name":"9daedab3-fb2d-461e-b861-71790eead4f6"},{"properties":{"displayName":"Allowed
        resource types","policyType":"BuiltIn","description":"This policy enables
        you to specify the resource types that your organization can deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that can be deployed.","displayName":"Allowed resource
        types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''listOfResourceTypesAllowed'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","type":"Microsoft.Authorization/policyDefinitions","name":"a08ec900-254a-4555-9bf5-e42af04b5c5c"},{"properties":{"displayName":"Audit
        authorization rules on Service Bus namespaces","policyType":"BuiltIn","mode":"All","description":"Service
        Bus clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Service
        Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceBus/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","type":"Microsoft.Authorization/policyDefinitions","name":"a1817ec0-a368-432a-8057-8371e17ac6ee"},{"properties":{"displayName":"Audit
        usage of custom RBAC rules","policyType":"BuiltIn","mode":"All","description":"Audit
        built-in roles such as ''Owner, Contributer, Reader'' instead of custom RBAC
        roles, which are error prone. Using custom roles is treated as an exception
        and requires a rigorous review and threat modeling","metadata":{"category":"General"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Authorization/roleDefinitions"},{"field":"Microsoft.Authorization/roleDefinitions/type","equals":"CustomRole"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","type":"Microsoft.Authorization/policyDefinitions","name":"a451c1ef-c6ca-483d-87ed-f49761e3ffb5"},{"properties":{"displayName":"Audit
        SQL server level Auditing settings","policyType":"BuiltIn","mode":"Indexed","description":"Audits
        the existence of SQL Auditing at the server level","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"setting":{"type":"String","metadata":{"displayName":"Desired
        Auditing setting"},"allowedValues":["enabled","disabled"],"defaultValue":"enabled"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","type":"Microsoft.Authorization/policyDefinitions","name":"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9"},{"properties":{"displayName":"Enforce
        encryption on Data Lake Store accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures encryption is enabled on all Data Lake Store accounts","metadata":{"category":"Data
        Lake"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},{"field":"Microsoft.DataLakeStore/accounts/encryptionState","equals":"Disabled"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"a7ff3161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"[Preview]:
        Monitor unencrypted SQL database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Unencrypted
        SQL servers or databases will be monitored by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","type":"Microsoft.Authorization/policyDefinitions","name":"a8bef009-a5c9-4d0f-90d7-6018734e8a16"},{"properties":{"displayName":"Deploy
        network watcher when virtual networks are created","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a network watcher resource in regions with virtual networks.
        You need to ensure existence of a resource group named networkWatcherRG, which
        will be used to deploy network watcher instances.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/virtualNetworks"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Network/networkWatchers","resourceGroupName":"networkWatcherRG","existenceCondition":{"field":"location","equals":"[field(''location'')]"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"}},"resources":[{"apiVersion":"2016-09-01","type":"Microsoft.Network/networkWatchers","name":"[concat(''networkWacher_'',
        parameters(''location''))]","location":"[parameters(''location'')]"}]},"parameters":{"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9","type":"Microsoft.Authorization/policyDefinitions","name":"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9"},{"properties":{"displayName":"[Preview]:
        Audit accounts with owner permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        owner permissions to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","type":"Microsoft.Authorization/policyDefinitions","name":"aa633080-8b72-40c4-a2d7-d00c03e80bed"},{"properties":{"displayName":"[Preview]:
        Automatic provisioning of security monitoring agent","policyType":"BuiltIn","mode":"All","description":"Installs
        security agent on VMs for advanced security alerts and preventions in Azure
        Security Center. Applies only for subscriptions that use Azure Security Center.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Security/complianceResults","name":"securityAgent","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24","type":"Microsoft.Authorization/policyDefinitions","name":"abcc6037-1fc4-47f6-aac5-89706589be24"},{"properties":{"displayName":"Allow
        resource creation if ''environment'' tag value in allowed values","policyType":"BuiltIn","description":"Allows
        resource creation if the ''environment'' tag is set to one of the following
        values: production, dev, test, staging","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.environment","in":["production","dev","test","staging"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9","type":"Microsoft.Authorization/policyDefinitions","name":"ac7e5fc0-c029-4b12-91d4-a8500ce697f9"},{"properties":{"displayName":"[Preview]:
        Monitor missing Endpoint Protection in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        without an installed Endpoint Protection agent will be monitored by Azure
        Security Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"endpointProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","type":"Microsoft.Authorization/policyDefinitions","name":"af6cd1bd-1635-48cb-bde7-5b15693900b9"},{"properties":{"displayName":"[Preview]:
        Monitor unaudited SQL database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"SQL
        servers and databases which doesn''t have SQL auditing turned on will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"auditing","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","type":"Microsoft.Authorization/policyDefinitions","name":"af8051bf-258b-44e2-a2bf-165330459f9d"},{"properties":{"displayName":"[Preview]:
        Monitor possible network Just In Time (JIT) access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        network Just In Time (JIT) access will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"jitNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","type":"Microsoft.Authorization/policyDefinitions","name":"b0f33259-77d7-4c9e-aac6-3aabcfae693c"},{"properties":{"displayName":"[Preview]:
        Audit Linux VM /etc/passwd file permissions are set to 0644","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies /etc/passwd file permissions are set to 0644 to
        prevent unauthorized changes that could allow access to the server.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid121","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b","type":"Microsoft.Authorization/policyDefinitions","name":"b18175dd-c599-4c64-83ba-bb018a06d35b"},{"properties":{"displayName":"Audit
        authorization rules on Event Hub namespaces","policyType":"BuiltIn","mode":"All","description":"Event
        Hub clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Event
        Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"name","notEquals":"RootManageSharedAccessKey"},{"field":"type","equals":"Microsoft.EventHub/namespaces/authorizationRules"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","type":"Microsoft.Authorization/policyDefinitions","name":"b278e460-7cfc-4451-8294-cccc40a940d7"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit web servers inside Windows VMs must use TLS minimum
        version 1.1 encryption","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to audit instances of
        Internet Information Services (IIS) running inside Windows virtual machines,
        to verify that TLS minimum version 1.1 is used for encryption.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"AuditSecureProtocol","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AuditSecureProtocol"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8","type":"Microsoft.Authorization/policyDefinitions","name":"b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs for Search service","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Search"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Search/searchServices"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","type":"Microsoft.Authorization/policyDefinitions","name":"b4330a05-a843-4bc8-bf9a-cacce50c67f4"},{"properties":{"displayName":"Audit
        usage of Azure Active Directory for client authentication in Service Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        usage of client authentication only via Azure Active Directory in Service
        Fabric","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","exists":"false"},{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","equals":""}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","type":"Microsoft.Authorization/policyDefinitions","name":"b54ed75b-3e1a-44ac-a333-05ba39b99ff0"},{"properties":{"displayName":"Allow
        resource creation only in Asia data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: East Asia, Southeast Asia,
        West India, South India, Central India, Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastasia","southeastasia","westindia","southindia","centralindia","japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94","type":"Microsoft.Authorization/policyDefinitions","name":"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94"},{"properties":{"displayName":"[Preview]:
        Audit Linux VM accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies there are no accounts without passwords.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid232","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05","type":"Microsoft.Authorization/policyDefinitions","name":"c40c9087-1981-4e73-9f53-39743eda9d05"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Data Lake Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeAnalytics/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","type":"Microsoft.Authorization/policyDefinitions","name":"c95c74d9-38fe-4f0d-af86-0c7d626a315c"},{"properties":{"displayName":"Apply
        Diagnostic Settings for Network Security Groups","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy automatically deploys diagnostic settings to network security groups.","metadata":{"category":"Monitoring"},"parameters":{"storagePrefix":{"type":"String","metadata":{"displayName":"Storage
        Account Prefix for Regional Storage Account"}},"rgName":{"type":"String","metadata":{"displayName":"Resource
        Group Name for Storage Account (must exist)","description":"This resource
        group must already exist","strongType":"ExistingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"setbypolicy","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"},"nsgName":{"type":"string"},"rgName":{"type":"string"}},"variables":{"storageDeployName":"[concat(''policyStorage_'',
        uniqueString(parameters(''location''), parameters(''nsgName'')))]"},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings","name":"[concat(parameters(''nsgName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","dependsOn":["[variables(''storageDeployName'')]"],"properties":{"storageAccountId":"[reference(variables(''storageDeployName'')).outputs.storageAccountId.value]","logs":[{"category":"NetworkSecurityGroupEvent","enabled":true,"retentionPolicy":{"enabled":false,"days":0}},{"category":"NetworkSecurityGroupRuleCounter","enabled":true,"retentionPolicy":{"enabled":false,"days":0}}]}},{"apiVersion":"2017-05-10","name":"[variables(''storageDeployName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''rgName'')]","properties":{"mode":"incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"}},"resources":[{"apiVersion":"2017-06-01","type":"Microsoft.Storage/storageAccounts","name":"[concat(parameters(''storageprefix''),
        parameters(''location''))]","sku":{"name":"Standard_LRS","tier":"Standard"},"kind":"Storage","location":"[parameters(''location'')]","tags":{"created-by":"policy"},"scale":null,"properties":{"networkAcls":{"bypass":"AzureServices","defaultAction":"Allow","ipRules":[],"virtualNetworkRules":[]},"supportsHttpsTrafficOnly":true}}],"outputs":{"storageAccountId":{"type":"string","value":"[resourceId(parameters(''rgName''),
        ''Microsoft.Storage/storageAccounts'',concat(parameters(''storagePrefix''),
        parameters(''location'')))]"}}}}}]},"parameters":{"location":{"value":"[field(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"},"rgName":{"value":"[parameters(''rgName'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89","type":"Microsoft.Authorization/policyDefinitions","name":"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89"},{"properties":{"displayName":"Allowed
        virtual machine SKUs","policyType":"BuiltIn","description":"This policy enables
        you to specify a set of virtual machine SKUs that your organization can deploy.","metadata":{"category":"Compute"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for virtual machines.","displayName":"Allowed
        SKUs","strongType":"VMSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","type":"Microsoft.Authorization/policyDefinitions","name":"cccc23c7-8427-4f53-ad12-b6a63eb452b3"},{"properties":{"displayName":"Allow
        resource creation if ''department'' tag set","policyType":"BuiltIn","description":"Allows
        resource creation only if the ''department'' tag is set","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags","containsKey":"department"}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064","type":"Microsoft.Authorization/policyDefinitions","name":"cd8dc879-a2ae-43c3-8211-1877c5755064"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM should not allow previous 24 passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the number of unique new passwords that have to
        be associated with a user account before an old password can be reused.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"EnforcePasswordHistory","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293","type":"Microsoft.Authorization/policyDefinitions","name":"cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Key Vault","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Key Vault"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","type":"Microsoft.Authorization/policyDefinitions","name":"cf820ca0-f99e-4f3e-84fb-66e913812d21"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697","type":"Microsoft.Authorization/policyDefinitions","name":"e01598e8-6538-41ed-95e8-8b29746cd697"},{"properties":{"displayName":"[Preview]:
        Monitor OS vulnerabilities in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        which do not satisfy the configured baseline will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"osVulnerabilities","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","type":"Microsoft.Authorization/policyDefinitions","name":"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15"},{"properties":{"displayName":"[Preview]:
        Audit accounts with read permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        read privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","type":"Microsoft.Authorization/policyDefinitions","name":"e3576e28-8b17-4677-84c3-db2990658d64"},{"properties":{"displayName":"Allowed
        locations","policyType":"BuiltIn","description":"This policy enables you to
        restrict the locations your organization can specify when deploying resources.
        Use to enforce your geo-compliance requirements. Excludes resource groups,
        Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the
        ''global'' region.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"location","notEquals":"global"},{"field":"type","notEquals":"Microsoft.AzureActiveDirectory/b2cDirectories"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c","type":"Microsoft.Authorization/policyDefinitions","name":"e56962a6-4747-49cd-b67b-bf8b01975c4c"},{"properties":{"displayName":"Allowed
        locations for resource groups","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to restrict the locations your organization can create
        resource groups in. Use to enforce your geo-compliance requirements.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that resource groups can be created in.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988","type":"Microsoft.Authorization/policyDefinitions","name":"e765b5de-1225-4ba3-bd56-1ac6695af988"},{"properties":{"displayName":"[Preview]:
        Audit deprecated accounts with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts with owner permissions should be removed from your subscription.  Deprecated
        accounts are accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","type":"Microsoft.Authorization/policyDefinitions","name":"ebb62a0c-3560-49e1-89ed-27e074e9f8ad"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Linux VM allowing remote connections from accounts
        with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration and
        Microsoft Azure Managed Service Identity, and required content to check settings
        inside the virtual machine. For Linux servers this includes Chef Inspec, Ruby,
        and Python. This security setting verifies remote connections from accounts
        with empty passwords is disabled.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid110","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid110"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592","type":"Microsoft.Authorization/policyDefinitions","name":"ec49586f-4939-402d-a29e-6ff502b20592"},{"properties":{"displayName":"[Preview]:
        Deploy VM extension to audit Linux VM passwd file permissions","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. For Linux servers this includes Chef Inspec, Ruby, and
        Python. This security setting verifies /etc/passwd file permissions are set
        to 0644 to prevent unauthorized changes that could allow access to the server.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid121","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid121"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9","type":"Microsoft.Authorization/policyDefinitions","name":"f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Workspace for VM - Report Mismatch","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if they not logging to the LA workspace specified in
        the policy/initiative assignment.","metadata":{"category":"Monitoring"},"parameters":{"logAnalyticsWorkspaceId":{"type":"String","metadata":{"displayName":"Log
        Analytics Workspace Id that VMs should be configured for","description":"This
        is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured
        for."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId","notEquals":"[parameters(''logAnalyticsWorkspaceId'')]"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917","type":"Microsoft.Authorization/policyDefinitions","name":"f47b5582-33ec-4c5c-87c0-b010a6b2e917"},{"properties":{"displayName":"Audit
        existence of authorization rules on Event Hub entities","policyType":"BuiltIn","mode":"All","description":"Audit
        existence of authorization rules on Event Hub entities to grant least-privileged
        access","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces/eventhubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.EventHub/namespaces/eventHubs/authorizationRules"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","type":"Microsoft.Authorization/policyDefinitions","name":"f4826e5f-6a27-407c-ae3e-9582eb39891d"},{"properties":{"displayName":"[Preview]:
        Audit Windows VM enforces password complexity requirements","policyType":"BuiltIn","mode":"Indexed","description":"If
        this policy is enabled, passwords must meet minimum requirements.  See documentation
        for full details at URL http://aka.ms/gcpol.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordMustMeetComplexityRequirements","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb","type":"Microsoft.Authorization/policyDefinitions","name":"f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"properties":{"displayName":"Deploy
        Auditing on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"SQL"},"parameters":{"retentionDays":{"type":"String","metadata":{"description":"The
        value in days of the retention period (0 indicates unlimited retention)","displayName":"Retention
        days (optional, 180 days if unspecified)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036","type":"Microsoft.Authorization/policyDefinitions","name":"f4c68484-132f-41f9-9b6d-3e4b1cb55036"},{"properties":{"displayName":"[Preview]:
        Audit external accounts with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with owner permissions should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","type":"Microsoft.Authorization/policyDefinitions","name":"f8456c1c-aa66-4dfb-861a-25d127b775c9"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Service Bus","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Service Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ServiceBus/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","type":"Microsoft.Authorization/policyDefinitions","name":"f8d36e2f-389b-4ee4-898d-21aeb69a0f45"},{"properties":{"displayName":"Audit
        enabling of diagnostic logs in Azure Stream Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Stream Analytics"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.StreamAnalytics/streamingJobs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","type":"Microsoft.Authorization/policyDefinitions","name":"f9be5368-9bf5-4b84-9e0a-7850da98bb46"},{"properties":{"displayName":"[Preview]:
        Monitor SQL vulnerability assessment results in Azure Security Center","policyType":"BuiltIn","mode":"Indexed","description":"Monitor
        Vulnerability Assessment scan results and recommendations for how to remediate
        database vulnerabilities.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Sql/servers/databases","Microsoft.Sql/managedinstances/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"sqlVulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","type":"Microsoft.Authorization/policyDefinitions","name":"feedbf84-6b99-488c-acc2-71c829aa5ffc"},{"properties":{"displayName":"storage_httpsTrafficOnly","policyType":"Custom","mode":"All","metadata":{"category":"Demo"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/023217dd-81bb-461f-93ea-8799caac50c7","type":"Microsoft.Authorization/policyDefinitions","name":"023217dd-81bb-461f-93ea-8799caac50c7"},{"properties":{"displayName":"test_allowedlocation","policyType":"Custom","mode":"All","metadata":{},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/05bf225f-806e-496d-802c-9d6bc548b0bc","type":"Microsoft.Authorization/policyDefinitions","name":"05bf225f-806e-496d-802c-9d6bc548b0bc"},{"properties":{"displayName":"akif
        incident - 85944710","policyType":"Custom","mode":"All","description":"reproing
        incident 85944710\nhttps://icm.ad.msft.net/imp/v3/incidents/details/85944710/home\n","metadata":{"category":"akhe"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"anyOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","notIn":"[parameters(''listOfAllowedLocations'')]"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0e0d567a-6089-46fc-b12c-ca5af12870bd","type":"Microsoft.Authorization/policyDefinitions","name":"0e0d567a-6089-46fc-b12c-ca5af12870bd"},{"properties":{"displayName":"akhe-incident-86226837-v2","policyType":"Custom","mode":"All","description":"second
        attempt to repro this incident. ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Sql/servers/firewallRules","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"0.0.0.0"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","equals":"0.0.0.0"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0e0d567a-6089-46fc-b12c-ca5af1287abe","type":"Microsoft.Authorization/policyDefinitions","name":"0e0d567a-6089-46fc-b12c-ca5af1287abe"},{"properties":{"displayName":"testSandipsh
        metric alert policy","policyType":"Custom","mode":"All","description":"test","metadata":{"category":"testSandipsh"},"parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":"The description of alert."}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"]},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"]},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        operator comparing the current value with the threshold value."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"Period of time used to monitor alert activity based on
        the threshold. Must be between five minutes and one day. ISO 8601 duration
        format."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"How often the metric alert is evaluated represented
        in ISO 8601 duration format"}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","equals":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'', field(''name''))]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'',  parameters(''targetResourceName''))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3","type":"Microsoft.Authorization/policyDefinitions","name":"123c6354-fc96-4f54-984e-8d49d06a80a3"},{"properties":{"displayName":"jilim-incident-86226837-fix","policyType":"Custom","mode":"all","description":"1
        - reproing the incident: https://icm.ad.msft.net/imp/v3/incidents/details/86226837/home","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/firewallRules"},{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","equals":"0.0.0.0"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","equals":"0.0.0.0"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/15358dd8-671e-4c96-be33-2b668791418f","type":"Microsoft.Authorization/policyDefinitions","name":"15358dd8-671e-4c96-be33-2b668791418f"},{"properties":{"displayName":"Attempt
        service bus","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Insights/logProfiles"},{"anyOf":[{"field":"Microsoft.Insights/logProfiles/serviceBusRuleId","exists":"false"}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/163c640e-681c-445f-92ba-cd434bd8c11c","type":"Microsoft.Authorization/policyDefinitions","name":"163c640e-681c-445f-92ba-cd434bd8c11c"},{"properties":{"displayName":"jilim
        exists2","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.zyx","exists":"false"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/17d43473-870f-4bc8-93c6-3961fa1d91cc","type":"Microsoft.Authorization/policyDefinitions","name":"17d43473-870f-4bc8-93c6-3961fa1d91cc"},{"properties":{"displayName":"inherit
        all tags","policyType":"Custom","mode":"All","metadata":{"category":"tags"},"parameters":{},"policyRule":{"if":{"field":"tags","exists":"false"},"then":{"effect":"append","details":[{"field":"tags","value":"[resourceGroup().tags]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1e3c9312-c011-40a3-ac40-3bf3ddc24120","type":"Microsoft.Authorization/policyDefinitions","name":"1e3c9312-c011-40a3-ac40-3bf3ddc24120"},{"properties":{"displayName":"Allowed
        resource group locations","policyType":"Custom","mode":"All","description":"Allowed
        resource group locations","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"},{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f20036f-28c3-48f3-9266-05d50fe391f4","type":"Microsoft.Authorization/policyDefinitions","name":"1f20036f-28c3-48f3-9266-05d50fe391f4"},{"properties":{"displayName":"docdb_aliases_test","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c","type":"Microsoft.Authorization/policyDefinitions","name":"1f5360b7-fe59-43f7-8af5-825df420d09c"},{"properties":{"displayName":"Deploy
        security rule with restricted source IPs","policyType":"Custom","mode":"All","description":"Ovewrites
        security rules with IP restrictions at the securityRule level","metadata":{"category":"Port
        Lockdown"},"parameters":{"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Limit to one protocol. The most inclusive should come last. I.e. 22;22-22;22-23"}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","in":"[parameters(''destinationPortRanges'')]"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","exists":"true"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notLike":"*"}},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notEquals":"VirtualNetwork"}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","exists":"true"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":"VirtualNetwork"}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","equals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":""}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullRuleName":{"type":"string"},"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"},"priority":{"type":"int"}},"resources":[{"name":"[parameters(''fullRuleName'')]","type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2018-02-01","properties":{"protocol":"*","sourceAddressPrefixes":"[parameters(''sourceAddressPrefixes'')]","destinationAddressPrefix":"*","sourcePortRange":"*","destinationPortRange":"[last(parameters(''destinationPortRanges''))]","access":"Allow","direction":"Inbound","priority":"[parameters(''priority'')]"}}]},"parameters":{"fullRuleName":{"value":"[field(''fullName'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"priority":{"value":"[field(''Microsoft.Network/networksecurityGroups/securityRules/priority'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111","type":"Microsoft.Authorization/policyDefinitions","name":"20c4afd0-8a77-4433-b8b0-4ad06e4c7111"},{"properties":{"displayName":"Deploy
        NSGs on Subnets","policyType":"Custom","mode":"All","description":"Enforce
        that all subnets have a Network Security Group.  If a subnet does not have
        one an NSG with the default Internet Exposed Endpoint restrictions will be
        created and associated with it.","metadata":{"category":"Port Lockdown"},"parameters":{"nsgPrefix":{"type":"String","metadata":{"displayName":"NSG
        name prefix","description":"The prefix string to apply to all automatically
        created network security groups."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Ranges must not overlap."}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"anyOf":[{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"false"},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","equals":""}]}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks"},{"anyOf":[{"field":"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id","exists":"false"},{"not":{"field":"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id","notEquals":"null"}}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullResourceName":{"type":"string"},"resourceName":{"type":"string"},"location":{"type":"string"},"nsgPrefix":{"type":"string"},"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"}},"variables":{"nsgName":"[concat(parameters(''nsgPrefix''),
        ''-'', parameters(''location''))]","vnetName":"[split(parameters(''fullResourceName''),
        ''/'')[0]]","vnetResourceId":"[resourceId(''Microsoft.Network/virtualNetworks'',
        variables(''vnetName''))]","getVnetDeploymentName":"[concat(''getVnet-'',
        variables(''vnetName''))]","collectSubnetsDeploymentName":"[concat(''collectSubnets-'',
        variables(''vnetName''))]","overwriteVnetDeploymentName":"[concat(''overwriteVnet-'',
        variables(''vnetName''))]"},"resources":[{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''getVnetDeploymentName'')]","properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[],"outputs":{"vnetProperties":{"type":"object","value":"[reference(variables(''vnetResourceId''),
        ''2018-03-01'', ''Full'')]"}}}}},{"name":"[variables(''nsgName'')]","type":"Microsoft.Network/networkSecurityGroups","apiVersion":"2018-03-01","location":"[parameters(''location'')]","properties":{"securityRules":[{"name":"PortLockdown_ControlledPorts_Restrict","properties":{"description":"Allow
        controlled port connections from specific IP ranges (either corpnet or SAW)","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"","sourceAddressPrefixes":"[parameters(''sourceAddressPrefixes'')]","destinationAddressPrefix":"*","access":"Allow","priority":3997,"direction":"Inbound"}},{"name":"PortLockdown_ControlledPorts_AllowVnet","properties":{"description":"Allow
        controlled port connections from within the VNET","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"VirtualNetwork","destinationAddressPrefix":"*","access":"Allow","priority":3998,"direction":"Inbound"}},{"name":"PortLockdown_ControlledPorts_Deny","properties":{"description":"Deny
        any controlled port connections that aren''t explicitly allowed in higher
        priority rules","protocol":"*","sourcePortRange":"*","destinationPortRange":"","destinationPortRanges":"[parameters(''destinationPortRanges'')]","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Deny","priority":3999,"direction":"Inbound"}},{"name":"PortLockdown_AllowAll","properties":{"description":"Allow
        all inbound traffic that isn''t explicitly blocked by Port Lockdown restrictions","protocol":"*","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":4000,"direction":"Inbound"}}]}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''collectSubnetsDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_collectSubnets_template.json","contentVersion":"1.0.0.0"},"parameters":{"vnetProperties":{"value":"[reference(variables(''getVnetDeploymentName'')).outputs.vnetProperties.value]"},"nsgResourceId":{"value":"[resourceid(''Microsoft.Network/networkSecurityGroups'',
        variables(''nsgName''))]"},"vnetName":{"value":"[variables(''vnetName'')]"}}}},{"dependsOn":["[variables(''nsgName'')]"],"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''overwriteVnetDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_overwriteVnet_template.json","contentVersion":"1.0.0.0"},"parameters":{"vnetProperties":{"value":"[reference(variables(''getVnetDeploymentName'')).outputs.vnetProperties.value]"},"location":{"value":"[parameters(''location'')]"},"updatedSubnets":{"value":"[reference(variables(''collectSubnetsDeploymentName'')).outputs.updatedSubnets.value]"},"vnetName":{"value":"[variables(''vnetName'')]"}}}}]},"parameters":{"fullResourceName":{"value":"[field(''fullName'')]"},"resourceName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"nsgPrefix":{"value":"[parameters(''nsgPrefix'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288","type":"Microsoft.Authorization/policyDefinitions","name":"210ed8bd-6b07-4d5e-a62c-c34f07293288"},{"properties":{"displayName":"Audit
        existence of a tag2","policyType":"Custom","mode":"All","description":"Audits
        that a required tag is present on resources","metadata":{},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":null}}},"policyRule":{"if":{"field":"tags","notcontainsKey":"[parameters(''tagName'')]"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1","type":"Microsoft.Authorization/policyDefinitions","name":"24813039-7534-408a-9842-eb99f45721b1"},{"properties":{"displayName":"camarvin
        oms vm linux parameterized effect","policyType":"Custom","mode":"all","metadata":{},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list","strongType":"omsWorkspace"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Select
        Log Analytics workspace from dropdown list","strongType":"omsWorkspace"},"allowedValues":["deployIfNotExists","disabled"],"defaultValue":"deployIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/263f13f4-6b88-4788-bead-34beedde70ce","type":"Microsoft.Authorization/policyDefinitions","name":"263f13f4-6b88-4788-bead-34beedde70ce"},{"properties":{"displayName":"akhe-incident-85944710-v2","policyType":"Custom","mode":"all","description":"2nd
        attempt on this policy. ","metadata":{"category":"akhe"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","notIn":"[parameters(''allowedLocations'')]"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/290b38e4-eff9-434b-b4d3-3ddd60841400","type":"Microsoft.Authorization/policyDefinitions","name":"290b38e4-eff9-434b-b4d3-3ddd60841400"},{"properties":{"displayName":"akhe-incident-85944710-combined","policyType":"Custom","mode":"all","description":"the
        combined policy attempt for both cosmos db cases. ","metadata":{},"parameters":{"locationNames":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"anyOf":[{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","In":"[parameters(''locationNames'')]"}}]},{"allOf":[{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","exists":"true"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","In":"[parameters(''locationNames'')]"}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/290b38e4-eff9-434b-b4d3-3ddd6084180f","type":"Microsoft.Authorization/policyDefinitions","name":"290b38e4-eff9-434b-b4d3-3ddd6084180f"},{"properties":{"displayName":"storage
        ip rules append 2","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Storage/storageAccounts/networkAcls.ipRules","value":[{"value":"8.8.8.8","action":"Allow"}]}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f","type":"Microsoft.Authorization/policyDefinitions","name":"2b2317a7-ab02-47b5-8159-eb7e6227709f"},{"properties":{"displayName":"[demo]
        Enforce KeyVault diagnostic log storage","policyType":"Custom","mode":"all","description":"Ensures
        that AuditEvents are collected from all Key Vaults in the subscription and
        stored in a specific storage account for 30 days.","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},"roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","variables":{"storageName":"[tolower(concat(''cheggkv'',
        parameters(''location'')))]"},"resources":[{"type":"Microsoft.KeyVault/vaults/providers/diagnosticSettings","name":"[concat(parameters(''vaultName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","properties":{"storageAccountId":"[resourceid(''cheggremdemo'',
        ''Microsoft.Storage/storageAccounts'', variables(''storageName''))]","logs":[{"category":"AuditEvent","enabled":true,"retentionPolicy":{"enabled":true,"days":30}}]}}],"parameters":{"vaultName":{"type":"string"},"location":{"type":"string"}}},"parameters":{"vaultName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/332ce4ac-9200-4573-8c66-92b85fc82c8d","type":"Microsoft.Authorization/policyDefinitions","name":"332ce4ac-9200-4573-8c66-92b85fc82c8d"},{"properties":{"displayName":"audit_cosmosdb_enableAutomaticFailover","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"field":"Microsoft.DocumentDB/databaseAccounts/enableAutomaticFailover","equals":"false"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0a0"},{"properties":{"displayName":"audit_cosmosdb_defaultConsistencyLevel","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/consistencyPolicy.defaultConsistencyLevel","equals":"lalala"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0b7"},{"properties":{"displayName":"audit_cosmosdb_readLocations","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0bd"},{"properties":{"displayName":"audit_cosmosdb_writeLocations","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd0ce"},{"properties":{"displayName":"audit_cosmosdb_failoverPolicies","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"allof":[{"field":"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName","equals":"lalala"}]}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160","type":"Microsoft.Authorization/policyDefinitions","name":"37501145-d01b-4bc8-92d0-c795a19fd160"},{"properties":{"displayName":"jilim
        recovery services vaults test","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{"vault":{"type":"String","metadata":{"displayName":"Recovery
        Services Vault","description":"The Recovery Services Vault.","strongType":"Microsoft.RecoveryServices/vaults"}},"vaults":{"type":"Array","metadata":{"displayName":"Recovery
        Services Vaults","description":"The list of Recovery Services Vaults.","strongType":"Microsoft.RecoveryServices/vaults"}}},"policyRule":{"if":{"allOf":[{"field":"location","equals":"[parameters(''vault'')]"},{"field":"location","in":"[parameters(''vaults'')]"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3b2c1b0f-63c5-4943-8578-6d37fbe411bb","type":"Microsoft.Authorization/policyDefinitions","name":"3b2c1b0f-63c5-4943-8578-6d37fbe411bb"},{"properties":{"displayName":"Name
        should have prefix and suffix","policyType":"Custom","description":"Name should
        have prefix and suffix","parameters":{"prefix":{"type":"String","metadata":{"displayName":"The
        prefix","description":"The name prefix"},"allowedValues":[]},"suffix":{"type":"String","metadata":{"displayName":"The
        suffix","description":"The name suffix."},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"name","like":"[concat(parameters(''prefix''),
        ''*'', parameters(''suffix''))]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007","type":"Microsoft.Authorization/policyDefinitions","name":"3e275e2e-a157-4ade-8f91-43b3ea370007"},{"properties":{"displayName":"Restrict
        VM skus","policyType":"Custom","mode":"All","description":"Restricts allowed
        VM skus to a predefined regex","parameters":{"allowedSkuTemplate":{"type":"String","metadata":{"displayName":"Allowed
        VM sku template","description":"The VM sku template. Supports wildcards via
        ''*''"}}},"policyRule":{"if":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/sku.name","like":"[parameters(''allowedSkuTemplate'')]"},{"field":"type","equals":"Microsoft.Compute/virtualMachines"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8","type":"Microsoft.Authorization/policyDefinitions","name":"3e3807c1-65c9-49e0-a406-82d8ae3e34c8"},{"properties":{"displayName":"Audit
        storage account SKU","policyType":"Custom","mode":"All","description":"Audits
        the use of storage account SKUs that don''t meet organizational cost policy.","parameters":{"listOfAllowedSkus":{"type":"Array","metadata":{"displayName":"List
        of allowed SKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSkus'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682","type":"Microsoft.Authorization/policyDefinitions","name":"3e3807c1-65c9-49e0-a406-82d8ae3e3682"},{"properties":{"displayName":"RobgaDataFactoryTest1","policyType":"Custom","mode":"all","description":"RobgaDataFactoryTest","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataFactory/factories"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/workspaceId","equals":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/robgatestworkspace/providers/Microsoft.OperationalInsights/workspaces/robgatestworkspace"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3ffb9f8c-fdaa-41b0-ad4b-b0f55e2860c9","type":"Microsoft.Authorization/policyDefinitions","name":"3ffb9f8c-fdaa-41b0-ad4b-b0f55e2860c9"},{"properties":{"displayName":"Enforce
        autoUpgrade on VM/VMSS extensions","policyType":"Custom","mode":"All","description":"Denies
        any VM or VMSS extensions that do not have autoUpgradeMinorVersion set to
        true.","metadata":{},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","notEquals":"true"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets/extensions"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","notEquals":"true"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f772"},{"properties":{"displayName":"Append
        autoUpgrade to VM extensions","policyType":"Custom","mode":"All","description":"Automatically
        enabled autoUpgradeMinorVersion on VM extensions","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","exists":"false"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion","value":"true"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f783"},{"properties":{"displayName":"Append
        autoUpgrade to VM scale set extensions","policyType":"Custom","mode":"All","description":"Automatically
        appends autoUpgradeMinorVersion=true to VMSS extensions","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets/extensions"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","exists":"false"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion","value":"true"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39f7a3"},{"properties":{"displayName":"MSIT
        - AppService must use serverFarm","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyOf":[{"field":"Microsoft.Web/sites/serverFarmId","exists":"false"},{"field":"Microsoft.Web/sites/serverFarmId","equals":""}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39fc12"},{"properties":{"displayName":"MSIT
        - AppService serverFarm must have capacity > 1","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/serverFarms"},{"field":"Microsoft.Web/serverFarms/sku.capacity","in":["0","1"]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23","type":"Microsoft.Authorization/policyDefinitions","name":"41f9e24d-1586-455f-811a-92a2ca39fc23"},{"properties":{"displayName":"rohitbh:
        Definition to be deleted.","policyType":"Custom","mode":"indexed","description":"This
        policy will deploy a key vault named KV_B if a key vault named KV_A does not
        exist.","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.KeyVault/vaults","existenceCondition":{"field":"name","equals":"KV_B"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[{"apiVersion":"2016-10-01","name":"KV_A","type":"Microsoft.KeyVault/vaults","location":"eastus2","properties":{"tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","sku":{"family":"A","name":"standard"},"accessPolicies":[]}}]}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/48ba81c1-0012-4796-8166-c2efb4304190","type":"Microsoft.Authorization/policyDefinitions","name":"48ba81c1-0012-4796-8166-c2efb4304190"},{"properties":{"displayName":"Do_Not_Delete","policyType":"Custom","mode":"All","description":"This
        policy is used for unit tests. Please do not delete it.","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60","type":"Microsoft.Authorization/policyDefinitions","name":"4a0425e4-97bf-4ad0-ab36-145b94083c60"},{"properties":{"displayName":"ICM
        83686598","policyType":"Custom","mode":"All","description":"deny the creation
        of storage if supportsHttpsTrafficOnly is false","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4c03a3e3-e038-4a55-a6a6-abf8e7bb9175","type":"Microsoft.Authorization/policyDefinitions","name":"4c03a3e3-e038-4a55-a6a6-abf8e7bb9175"},{"properties":{"displayName":"detect
        ''allow All'' NSG rule","policyType":"Custom","mode":"All","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","equals":"*"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notEquals":"*"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4c915617-16f0-4c62-b021-e66d5409d11d","type":"Microsoft.Authorization/policyDefinitions","name":"4c915617-16f0-4c62-b021-e66d5409d11d"},{"properties":{"displayName":"rohitbh:
        Deploy Auditing on SQL servers without role definitions","policyType":"Custom","mode":"indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"rohitbh"},"parameters":{"retentionDays":{"type":"String","metadata":{"displayName":"Retention
        days (optional, 180 days if unspecified)","description":"The value in days
        of the retention period (0 indicates unlimited retention)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332195","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf332195"},{"properties":{"displayName":"rohitbh:
        Deploy Auditing on SQL servers with role definitions","policyType":"Custom","mode":"indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"Test"},"parameters":{"retentionDays":{"type":"String","metadata":{"displayName":"Retention
        days (optional, 180 days if unspecified)","description":"The value in days
        of the retention period (0 indicates unlimited retention)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf332199","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf332199"},{"properties":{"displayName":"rohitbh:
        Audit VMs that do not use managed disks without role definitions","policyType":"Custom","mode":"all","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf33219f","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf33219f"},{"properties":{"displayName":"rohitbh:
        Audit VMs that do not use managed disks with role definitions","policyType":"Custom","mode":"all","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit","details":{"type":"Microsoft.Sql/servers/auditingSettings","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"]}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4cf9b9fd-45d3-4126-8ba7-cc9adf3321a3","type":"Microsoft.Authorization/policyDefinitions","name":"4cf9b9fd-45d3-4126-8ba7-cc9adf3321a3"},{"properties":{"displayName":"Ensure
        auto-created NSG rules exist","policyType":"Custom","mode":"All","description":"Ensures
        that security rules created in auto-created PortLockdown NSGs are not tampered
        with","metadata":{"category":"Port Lockdown"},"parameters":{"nsgPrefix":{"type":"String","metadata":{"displayName":"NSG
        name prefix","description":"The prefix string applied to automatically created
        network security groups."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"Expected
        IP restriction prefixes","description":"The IP ranges incoming traffic will
        be restricted to in the expected security rule. I.e. 192.4.0.0/8;192.5.0.0/8
        or *"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Expected
        destination port ranges","description":"Destination port ranges requiring
        IP restrictions in the expected security rule"}},"priority":{"type":"String","metadata":{"displayName":"Expected
        priority","description":"The priority of the expected security rule."}},"access":{"type":"String","metadata":{"displayName":"Expected
        access","description":"The access (allow/deny) of the expected security rule."},"allowedValues":["Allow","Deny"]},"name":{"type":"String","metadata":{"displayName":"Expected
        name","description":"The name of the expected security rule."}}},"policyRule":{"if":{"allOf":[{"field":"name","equals":"[concat(parameters(''nsgPrefix''),
        ''-'', field(''location''))]"},{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''priority'')]"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","in":"[parameters(''sourceAddressPrefixes'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":"[parameters(''sourceAddressPrefixes'')]"}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","in":"[parameters(''destinationPortRanges'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''access'')]"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"sourceAddressPrefixes":{"type":"array"},"destinationPortRanges":{"type":"array"},"name":{"type":"string"},"priority":{"type":"string"},"access":{"type":"string"},"nsgName":{"type":"string"}},"variables":{"isSinglePrefix":"[equals(count(parameters(''sourceAddressPrefixes'')),
        1)]","isSinglePortRange":"[equals(count(parameters(''destinationPortRanges'')),
        1)]"},"resources":[{"name":"[concat(parameters(''nsgName''), ''/'', parameters(''name''))]","type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2018-03-01","properties":{"description":"Rule
        auto-created by Internet Exposed Endpoints protection","protocol":"*","sourcePortRange":"*","destinationPortRange":"[if(variables(''isSinglePortRange''),
        first(parameters(''destinationPortRanges'')), '''')]","destinationPortRanges":"[if(not(variables(''isSinglePortRange'')),
        parameters(''destinationPortRanges''), json(''[]''))]","sourceAddressPrefix":"[if(variables(''isSinglePrefix''),
        first(parameters(''sourceAddressPrefixes'')), '''')]","sourceAddressPrefixes":"[if(not(variables(''isSinglePrefix'')),
        parameters(''sourceAddressPrefixes''), json(''[]''))]","destinationAddressPrefix":"*","access":"[parameters(''access'')]","priority":"[int(parameters(''priority''))]","direction":"Inbound"}}]},"parameters":{"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"name":{"value":"[parameters(''name'')]"},"priority":{"value":"[parameters(''priority'')]"},"access":{"value":"[parameters(''access'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115","type":"Microsoft.Authorization/policyDefinitions","name":"4f283ec4-25a9-46df-bbf2-806ed5a3e115"},{"properties":{"displayName":"rohitbh:
        Deploy key vault KV_B if key vault KV_A does not exist.","policyType":"Custom","mode":"indexed","description":"This
        policy will deploy a key vault named KV_B if a key vault named KV_A does not
        exist.","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.KeyVault/vaults","existenceCondition":{"field":"name","equals":"KV_B"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[{"apiVersion":"2016-10-01","name":"KV_A","type":"Microsoft.KeyVault/vaults","location":"eastus2","properties":{"tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","sku":{"family":"A","name":"standard"},"accessPolicies":[]}}]}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/50e2972e-143c-4edf-9ef6-bee0f84212d6","type":"Microsoft.Authorization/policyDefinitions","name":"50e2972e-143c-4edf-9ef6-bee0f84212d6"},{"properties":{"displayName":"GokmenhAuditLocation","policyType":"Custom","mode":"all","description":"Audit
        if not west us","metadata":{},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastus"]}},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5948d091-78b7-4d3b-a404-cc6a0329b0c6","type":"Microsoft.Authorization/policyDefinitions","name":"5948d091-78b7-4d3b-a404-cc6a0329b0c6"},{"properties":{"displayName":"deployifnotexist
        template alias tests - redis","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/Redis"},{"field":"Microsoft.Cache/Redis/sku.family","equals":"C"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Resources/links","existenceCondition":{"field":"name","like":"Whatever*"},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"skuFamily":{"type":"string"},"enableNonSslPort":{"type":"string"},"nameField":{"type":"string"}},"resources":[],"outputs":{"skuFamilyOut":{"value":"[parameters(''skuFamily'')]","type":"string"},"enableNonSslPortOut":{"value":"[parameters(''enableNonSslPort'')]","type":"string"},"nameFieldOut":{"value":"[parameters(''nameField'')]","type":"string"}}},"parameters":{"skuFamily":{"value":"[field(''Microsoft.Cache/Redis/sku.family'')]"},"enableNonSslPort":{"value":"[field(''Microsoft.Cache/Redis/enableNonSslPort'')]"},"nameField":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5a8a68e8-ae1c-420a-9639-a94ebeb3c0c8","type":"Microsoft.Authorization/policyDefinitions","name":"5a8a68e8-ae1c-420a-9639-a94ebeb3c0c8"},{"properties":{"displayName":"akhe-incident-86226837","policyType":"Custom","mode":"All","description":"reproing
        the incident: https://icm.ad.msft.net/imp/v3/incidents/details/86226837/home","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"field":"Microsoft.Sql/servers/firewallRules/startIpAddress","exists":"false"},{"field":"Microsoft.Sql/servers/firewallRules/endIpAddress","exists":"
        false"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca376","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca376"},{"properties":{"displayName":"akhe-incident-86318519","policyType":"Custom","mode":"all","description":"reproing
        incident 86318519","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/firewallrules"},{"field":"name","equals":"AllowAllWindowsAzureIps"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca600","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca600"},{"properties":{"displayName":"akhe-incident-86230190","policyType":"Custom","mode":"All","description":"reproing
        incident 86230190, https://icm.ad.msft.net/imp/v3/incidents/details/86230190/home\n\nAudits
        if a resource doesn''t have a lock","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","exists":"true"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"Microsoft.Authorization/locks/level","notIn":["ReadOnly","CanNotDelete"]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5b02be71-b0a4-4942-a376-9dc88d9ca8d6","type":"Microsoft.Authorization/policyDefinitions","name":"5b02be71-b0a4-4942-a376-9dc88d9ca8d6"},{"properties":{"displayName":"Test
        storage alias","policyType":"Custom","mode":"all","description":"Test storage
        alias","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Storage/storageAccounts"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExist101","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"httpsOnly":{"type":"string"},"encrypt":{"type":"string"},"accessTier":{"type":"string"},"skuName":{"type":"string"}},"resources":[],"outputs":{"skuNameOut":{"type":"string","value":"[parameters(''skuName'')]"},"accessTierOut":{"type":"string","value":"[parameters(''accessTier'')]"},"httpsOnlyOut":{"type":"String","value":"[parameters(''httpsOnly'')]"},"encryptOut":{"type":"String","value":"[parameters(''encrypt'')]"}}},"parameters":{"httpsOnly":{"value":"[field(''Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly'')]"},"encrypt":{"value":"[field(''Microsoft.Storage/storageAccounts/enableBlobEncryption'')]"},"accessTier":{"value":"[field(''Microsoft.Storage/storageAccounts/accessTier'')]"},"skuName":{"value":"[field(''Microsoft.Storage/storageAccounts/sku.name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5fa69139-9a49-464e-90b5-0d243a469138","type":"Microsoft.Authorization/policyDefinitions","name":"5fa69139-9a49-464e-90b5-0d243a469138"},{"properties":{"displayName":"testSandipsh
        metric alert policy1","policyType":"Custom","mode":"All","metadata":{"category":"testSandipsh"},"parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":null}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"],"defaultValue":"3"},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"],"defaultValue":"true"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"Metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        metric operator."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"The
        timeAggregation."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"The window size."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"The evaluation frequency."}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        action group id."}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","like":"[concat(parameters(''alertNamePrefix''),
        ''*'')]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(toLower(parameters(''alertNamePrefix'')),
        uniqueString(resourceGroup().id))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3","type":"Microsoft.Authorization/policyDefinitions","name":"6f2c6354-fc96-4f54-984e-8d49d06a80a3"},{"properties":{"displayName":"testImageId","policyType":"Custom","mode":"All","metadata":{"category":"css"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.Compute/VirtualMachineScaleSets"]},{"not":{"field":"Microsoft.Compute/imageId","contains":"resourceGroups/testSandipsh"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/70dc1e8d-61c9-4089-8bf5-895b227c1298","type":"Microsoft.Authorization/policyDefinitions","name":"70dc1e8d-61c9-4089-8bf5-895b227c1298"},{"properties":{"displayName":"Policy
        tracked resources SDK tests","policyType":"Custom","mode":"all","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"name","equals":"policyTrackedResources-sdk-tests"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"field":"name","notIn":["policyTrackedResources-sdk-tests-rule1","policyTrackedResources-sdk-tests-rule2"]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"}},"resources":[{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/policyTrackedResources-sdk-tests-rule1'')]","properties":{"description":"Test
        Rule","protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":2000,"direction":"Outbound"}},{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/policyTrackedResources-sdk-tests-rule2'')]","properties":{"description":"Test
        Rule","protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":2001,"direction":"Outbound"}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/71289c53-22e7-4f31-a6dd-780b532380c2","type":"Microsoft.Authorization/policyDefinitions","name":"71289c53-22e7-4f31-a6dd-780b532380c2"},{"properties":{"displayName":"Deny
        if blob is not encrypted","policyType":"Custom","mode":"All","parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a","type":"Microsoft.Authorization/policyDefinitions","name":"74d5cf40-7293-46a4-a285-7ea971e3719a"},{"properties":{"displayName":"[cstack]
        Location restriction","policyType":"Custom","mode":"All","description":"Policy
        to force allocations to a set of given locations","metadata":{"category":"cstack"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335","type":"Microsoft.Authorization/policyDefinitions","name":"763dcd1d-a4a9-46a8-8bd3-357c4533a335"},{"properties":{"displayName":"ICM
        83577342 deny proxy resource location","policyType":"Custom","mode":"All","description":"https://icm.ad.msft.net/imp/v3/incidents/details/83577342/home","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"location","notEquals":"eastus"},{"field":"type","equals":"Microsoft.StreamAnalytics/streamingjobs/transformations"}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/77429b44-aac1-4417-a53e-6900c07e11ac","type":"Microsoft.Authorization/policyDefinitions","name":"77429b44-aac1-4417-a53e-6900c07e11ac"},{"properties":{"displayName":"akhe-incident-86230190-v2","policyType":"Custom","mode":"all","description":"reproing
        incident 86230190, https://icm.ad.msft.net/imp/v3/incidents/details/86230190/home\n\nAudits
        if a resource doesn''t have a lock v2","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"not":{"field":"type","equals":"Microsoft.Authorization/locks"}},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"Microsoft.Authorization/locks/level","in":["ReadOnly","CanNotDelete"]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/83daa8ee-7c9a-470c-81a8-5a99ac09d134","type":"Microsoft.Authorization/policyDefinitions","name":"83daa8ee-7c9a-470c-81a8-5a99ac09d134"},{"properties":{"displayName":"Parameterized
        effect (if location != eastus)","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"The
        policy effect."}}},"policyRule":{"if":{"not":{"field":"location","equals":"eastus"}},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2","type":"Microsoft.Authorization/policyDefinitions","name":"885f1dcb-a9c5-4c8c-8996-2702db44a2d2"},{"properties":{"displayName":"jilim
        exists","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.xyz","exists":false}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8959fd87-c1dd-4831-9034-a4f876bee1cc","type":"Microsoft.Authorization/policyDefinitions","name":"8959fd87-c1dd-4831-9034-a4f876bee1cc"},{"properties":{"displayName":"audit_cosmosdb_ipRangeFilter","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.DocumentDB/databaseAccounts"},{"not":{"field":"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter","equals":"lalala"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c","type":"Microsoft.Authorization/policyDefinitions","name":"9012b1cd-b045-46c6-a510-6137e06a009c"},{"properties":{"displayName":"chegg:
        Remediation powershell test policy","policyType":"Custom","mode":"indexed","description":"This
        policy is used in policyinsights powershell testing","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"}},"resources":[],"outputs":{"location":{"type":"string","value":"[parameters(''location'')]"}}},"parameters":{"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9934be7a-0e18-454d-a738-a1d9bcb0c202","type":"Microsoft.Authorization/policyDefinitions","name":"9934be7a-0e18-454d-a738-a1d9bcb0c202"},{"properties":{"displayName":"akhe
        - Subscription Lvl test","policyType":"Custom","mode":"All","description":"Subscriptionlevel
        auditIfNotExist policy","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"source":"action","equals":"Microsoft.Resources/subscriptions/write"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"name","equals":"testlock"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d1de","type":"Microsoft.Authorization/policyDefinitions","name":"a1b067c8-2970-4c0b-b0da-31ae7f33d1de"},{"properties":{"displayName":"[cstack]
        Noop","policyType":"Custom","mode":"All","description":"Don''t do anything","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","in":["yabba","dabba","doo"]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b4218b6","type":"Microsoft.Authorization/policyDefinitions","name":"a309ad64-0bae-48d9-a6b1-d99c0b4218b6"},{"properties":{"displayName":"HTTPS
        For Web Apps","policyType":"Custom","mode":"all","description":"CSS","metadata":{"category":"WebApps"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"anyof":[{"not":{"field":"Microsoft.Web/sites/httpsOnly","exists":"true"}},{"field":"Microsoft.Web/sites/httpsOnly","equals":"false"}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a337c781-c7d8-4e12-ae69-1951c7e74378","type":"Microsoft.Authorization/policyDefinitions","name":"a337c781-c7d8-4e12-ae69-1951c7e74378"},{"properties":{"displayName":"Ensure
        https traffic only for storage account","policyType":"Custom","mode":"all","description":"Ensure
        https traffic only for storage account","metadata":{},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"true"}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a5f66345-5fb9-4dfd-864a-e3464ee6c0c4","type":"Microsoft.Authorization/policyDefinitions","name":"a5f66345-5fb9-4dfd-864a-e3464ee6c0c4"},{"properties":{"displayName":"add
        subscription name tag","policyType":"Custom","mode":"All","description":"add
        subscription name tag","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.subscriptionname","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.subscriptionname","value":"[subscription().displayName]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d82a2"},{"properties":{"displayName":"Add
        subscription \"id\" tag","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.id","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.id","value":"[subscription().id]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d8339"},{"properties":{"displayName":"add
        subscriptionId tag","policyType":"Custom","mode":"All","metadata":{"category":"camarvin"},"parameters":{},"policyRule":{"if":{"field":"tags.subscriptionId","exists":"false"},"then":{"effect":"append","details":[{"field":"tags.subscriptionId","value":"[subscription().subscriptionId]"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635","type":"Microsoft.Authorization/policyDefinitions","name":"a752f8cb-6498-4e40-8431-b658ca4d8635"},{"properties":{"displayName":"Allowed
        Location Indexed","policyType":"Custom","mode":"Indexed","description":"hackathon
        policy","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Allowed-Locations-Indexed","type":"Microsoft.Authorization/policyDefinitions","name":"Allowed-Locations-Indexed"},{"properties":{"displayName":"Audit
        if antiMalware extension does not exist","policyType":"Custom","description":"This
        policy audits if the anti malware extension .","policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"},{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists","type":"Microsoft.Authorization/policyDefinitions","name":"antiMalwareExtensionExists"},{"properties":{"displayName":"Web
        socket must be disabled on App Services","policyType":"Custom","description":"Ensures
        web sockets are disabled on App Services.","policyRule":{"if":{"field":"location","equals":"foo"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets","type":"Microsoft.Authorization/policyDefinitions","name":"AppServiceWebSockets"},{"properties":{"displayName":"Azure
        Security Center must be enabled","policyType":"Custom","description":"Ensures
        Azure Security Center is enabled.","policyRule":{"if":{"field":"location","equals":"foo"},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled","type":"Microsoft.Authorization/policyDefinitions","name":"ASCEnabled"},{"properties":{"displayName":"Audit
        a tag and it''s value","policyType":"Custom","description":"Audits if a tag
        and it''s value doesn''t exist for a given resource","parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."},"allowedValues":[]},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and it''s value","type":"Microsoft.Authorization/policyDefinitions","name":"Audit
        a tag and it''s value"},{"properties":{"displayName":"Audit a tag and it''s
        value","policyType":"Custom","description":"Audits if a tag and it''s value
        doesn''t exist for a given resource","parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."},"allowedValues":[]},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/Audit
        a tag and its value","type":"Microsoft.Authorization/policyDefinitions","name":"Audit
        a tag and its value"},{"properties":{"displayName":"Audit if extension does
        not exist","policyType":"Custom","mode":"All","description":"This policy audits
        if a required extension doesn''t exist.","parameters":{"publisher":{"type":"String","metadata":{"description":"The
        publisher of the extension","displayName":"Extension Publisher"}},"type":{"type":"String","metadata":{"description":"The
        type of the extension","displayName":"Extension Type"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftWindowsServer"]},{"field":"Microsoft.Compute/imageOffer","in":["WindowsServer"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"[parameters(''publisher'')]"},{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"[parameters(''type'')]"}]}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/audit-vm-extension","type":"Microsoft.Authorization/policyDefinitions","name":"audit-vm-extension"},{"properties":{"displayName":"CanCrudPolicyAssignment
        Policy Definition $[Auto Test]","policyType":"Custom","policyRule":{"if":{"source":"action","equals":"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azsmnet6487","type":"Microsoft.Authorization/policyDefinitions","name":"azsmnet6487"},{"properties":{"displayName":"makharchtest","policyType":"Custom","mode":"All","description":"policy","metadata":{"category":""},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b36f6195-0fc5-4a41-bbce-875248400f5f","type":"Microsoft.Authorization/policyDefinitions","name":"b36f6195-0fc5-4a41-bbce-875248400f5f"},{"properties":{"displayName":"NSG
        Rules exists test","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"allof":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].protocol","notLike":"*"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bb6a78ae-8737-41e0-9c41-cc777c8c00a0","type":"Microsoft.Authorization/policyDefinitions","name":"bb6a78ae-8737-41e0-9c41-cc777c8c00a0"},{"properties":{"displayName":"Audit
        allowed locations","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources.","strongType":"location"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9","type":"Microsoft.Authorization/policyDefinitions","name":"c0f586f1-abe5-4801-8588-7332e49e60c9"},{"properties":{"displayName":"akhe
        resource group auditIfNotExists","policyType":"Custom","mode":"All","metadata":{"category":""},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Authorization/locks","existenceCondition":{"field":"name","equals":"testlock"}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c7b9982d-2f50-4730-935f-5c241982a441","type":"Microsoft.Authorization/policyDefinitions","name":"c7b9982d-2f50-4730-935f-5c241982a441"},{"properties":{"displayName":"jilim
        allowed resource types","policyType":"Custom","mode":"All","metadata":{"category":"Test"},"parameters":{"allowedTypes":{"type":"Array","metadata":{"displayName":"Allowed
        resource types","description":"The list of allowed resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''allowedTypes'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c872f951-1c5d-4c61-89dd-aee2350a11ba","type":"Microsoft.Authorization/policyDefinitions","name":"c872f951-1c5d-4c61-89dd-aee2350a11ba"},{"properties":{"displayName":"Audit
        location","policyType":"Custom","mode":"All","parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of allowed locations for resources."}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''allowedLocations'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474","type":"Microsoft.Authorization/policyDefinitions","name":"c8b79b49-a579-4045-984e-1b249ab8b474"},{"properties":{"displayName":"camarvin
        empty string","policyType":"Custom","mode":"all","description":"Ensure resource
        names meet the like condition for a pattern.","metadata":{},"parameters":{"namePattern":{"type":"String","metadata":{"displayName":"namePattern","description":"Pattern
        to use for names. Can include wildcard (*)."},"allowedValues":["","one","two"],"defaultValue":""}},"policyRule":{"if":{"not":{"field":"name","equals":"[parameters(''namePattern'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/camarvin-test-empty-assign","type":"Microsoft.Authorization/policyDefinitions","name":"camarvin-test-empty-assign"},{"properties":{"displayName":"elpere
        append ''test'' tag","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"name","equals":"elpereKv"},"then":{"effect":"append","details":[{"field":"tags.test","value":"1"}]}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ced59ff0-9061-49dd-94de-093b33a640cf","type":"Microsoft.Authorization/policyDefinitions","name":"ced59ff0-9061-49dd-94de-093b33a640cf"},{"properties":{"displayName":"elpere
        deny on ''test'' tag","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"tags.test","equals":"1"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ced59ff0-9061-49dd-94de-093b33a640d7","type":"Microsoft.Authorization/policyDefinitions","name":"ced59ff0-9061-49dd-94de-093b33a640d7"},{"properties":{"displayName":"Resource
        name contains resource group name","policyType":"Custom","mode":"Indexed","description":"Require
        resources to contain the resource group''s name","policyRule":{"if":{"field":"name","notContains":"[resourceGroup().name]"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/contain-resource-group-name","type":"Microsoft.Authorization/policyDefinitions","name":"contain-resource-group-name"},{"properties":{"displayName":"akhe-incident-86226837-v3","policyType":"Custom","mode":"all","description":"third
        attempt to repro this incident. ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Sql/servers/firewallRules"}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5002","type":"Microsoft.Authorization/policyDefinitions","name":"d03e03ca-6424-4e28-8842-5796dc0b5002"},{"properties":{"displayName":"akhe-incident-86230190-deployIfNotExists","policyType":"Custom","mode":"all","description":"deploys
        a delete lock for a resource ","metadata":{"category":"akhe"},"parameters":{},"policyRule":{"if":{"not":{"field":"type","equals":"Microsoft.Authorization/locks"}},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/locks","roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"],"existenceCondition":{"field":"Microsoft.Authorization/locks/level","in":["CanNotDelete"]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{},"variables":{},"resources":[{"type":"Microsoft.Authorization/locks","apiVersion":"2015-01-01","name":"DeleteLock","properties":{"level":"CanNotDelete","notes":"prevent
        deletion"}}],"outputs":{}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d03e03ca-6424-4e28-8842-5796dc0b5632","type":"Microsoft.Authorization/policyDefinitions","name":"d03e03ca-6424-4e28-8842-5796dc0b5632"},{"properties":{"displayName":"Enforce
        KeyVault diagnostic log storage (elpere)","policyType":"Custom","mode":"all","description":"Ensures
        that AuditEvents are collected from all Key Vaults in the subscription and
        stored in a specific storage account for 30 days.","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},"roleDefinitionIds":["/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","variables":{"storageName":"elperetest"},"resources":[{"type":"Microsoft.KeyVault/vaults/providers/diagnosticSettings","name":"[concat(parameters(''vaultName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","properties":{"storageAccountId":"[resourceid(''elpere'',
        ''Microsoft.Storage/storageAccounts'', variables(''storageName''))]","logs":[{"category":"AuditEvent","enabled":true,"retentionPolicy":{"enabled":true,"days":30}}]}}],"parameters":{"vaultName":{"type":"string"},"location":{"type":"string"}}},"parameters":{"vaultName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d0d9349d-843c-443a-9f27-5ce84f08c37e","type":"Microsoft.Authorization/policyDefinitions","name":"d0d9349d-843c-443a-9f27-5ce84f08c37e"},{"properties":{"displayName":"elpere
        deny test","policyType":"Custom","mode":"all","description":"","metadata":{"category":"Test"},"parameters":{},"policyRule":{"if":{"field":"name","equals":"elpereKv"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d1c0e77c-53b4-4c4d-a1f5-c535a370b0c5","type":"Microsoft.Authorization/policyDefinitions","name":"d1c0e77c-53b4-4c4d-a1f5-c535a370b0c5"},{"properties":{"displayName":"Access
        KV as part of remidiation deployment test (elpere)","policyType":"Custom","mode":"all","description":"","metadata":{"category":"Key
        Vault"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"hello"},"deployment":{"properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","resources":[],"parameters":{"testSecret":{"type":"string"}},"outputs":{"testSecretOutput":{"type":"string","value":"[parameters(''testSecret'')]"}}},"parameters":{"testSecret":{"reference":{"keyVault":{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/elpere/providers/Microsoft.KeyVault/vaults/elpereKv"},"secretName":"test"}}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d35ce9be-f51b-4d3e-bc7f-dde2936381b0","type":"Microsoft.Authorization/policyDefinitions","name":"d35ce9be-f51b-4d3e-bc7f-dde2936381b0"},{"properties":{"displayName":"Deploy
        security rule with restricted source IPs (NSG level)","policyType":"Custom","mode":"All","description":"Overwrites
        security rules with IP restrictions at the NSG level","metadata":{"category":"Port
        Lockdown"},"parameters":{"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Destination
        port ranges","description":"Destination port ranges requiring IP restrictions.
        Ranges may overlap."}},"sourceAddressPrefixes":{"type":"Array","metadata":{"displayName":"IP
        restriction prefixes","description":"The IP ranges incoming traffic will be
        restricted to. I.e. 192.4.0.0/8;192.5.0.0/8"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"anyOf":[{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange","notIn":"[parameters(''destinationPortRanges'')]"}},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","existenceCondition":{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","in":"[parameters(''destinationPortRanges'')]"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notIn":"[parameters(''destinationPortRanges'')]"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","exists":"true"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notLike":"*"}},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}]},{"allOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","exists":"true"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notEquals":""},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","notIn":["*","Internet"]}]}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"},"location":{"type":"string"},"destinationPortRanges":{"type":"array"},"sourceAddressPrefixes":{"type":"array"}},"variables":{"getNsgDeploymentName":"[concat(''getNSGContent-'',
        parameters(''nsgName''))]","collectorDeploymentName":"[concat(''collectRules-'',
        parameters(''nsgName''))]","overwriteNsgDeploymentName":"[concat(''overwriteNsg-'',
        parameters(''nsgName''))]","nsgResourceId":"[resourceId(subscription().subscriptionId,
        resourceGroup().name, ''Microsoft.Network/networkSecurityGroups'', parameters(''nsgName''))]"},"resources":[{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''getNsgDeploymentName'')]","properties":{"mode":"Incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[],"outputs":{"nsgProperties":{"type":"object","value":"[reference(variables(''nsgResourceId''),
        ''2018-03-01'', ''Full'')]"}}}}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''collectorDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_collectRules_template.json","contentVersion":"1.0.0.0"},"parameters":{"nsgProperties":{"value":"[reference(variables(''getNsgDeploymentName'')).outputs.nsgProperties.value]"},"nsgName":{"value":"[parameters(''nsgName'')]"},"location":{"value":"[parameters(''location'')]"},"portRangesToRestrict":{"value":"[parameters(''destinationPortRanges'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"}}}},{"apiVersion":"2018-02-01","type":"Microsoft.Resources/deployments","name":"[variables(''overwriteNsgDeploymentName'')]","properties":{"mode":"Incremental","templateLink":{"uri":"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_overwriteNSG_template.json","contentVersion":"1.0.0.0"},"parameters":{"originalNsgProperties":{"value":"[reference(variables(''getNsgDeploymentName'')).outputs.nsgProperties.value]"},"updatedSecurityRules":{"value":"[reference(variables(''collectorDeploymentName'')).outputs.updatedSecurityRules.value]"},"nsgName":{"value":"[parameters(''nsgName'')]"},"location":{"value":"[parameters(''location'')]"}}}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"},"sourceAddressPrefixes":{"value":"[parameters(''sourceAddressPrefixes'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086","type":"Microsoft.Authorization/policyDefinitions","name":"d7b13c30-e6aa-47e1-b50a-8e33f152d086"},{"properties":{"displayName":"Audit
        storage account SKUs","policyType":"Custom","mode":"All","metadata":{"category":"Demo
        323"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"displayName":"Audited
        skus","description":"The list of skus.","strongType":"storageSkus"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee","type":"Microsoft.Authorization/policyDefinitions","name":"dbe1e663-7265-4cf4-96b5-7435b21e90ee"},{"properties":{"displayName":"Audit
        virtual machines SKUs","policyType":"Custom","mode":"All","metadata":{"category":"Demo
        323"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"displayName":"List
        Of Allowed SKUs","description":"The list of allowed locations for resources.","strongType":"vmSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170","type":"Microsoft.Authorization/policyDefinitions","name":"dbe1e663-7265-4cf4-96b5-7435b21e9170"},{"properties":{"displayName":"[elpere]
        deployIfNotExists Runners test","policyType":"Custom","mode":"all","metadata":{},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"deployIfNotExistsTestsRule","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"nsgName":{"type":"string"}},"resources":[{"apiVersion":"2018-08-01","type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''nsgName''),
        ''/deployIfNotExistsTestsRule'')]","properties":{"protocol":"Tcp","sourcePortRange":"*","destinationPortRange":"*","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Deny","priority":2000,"direction":"Outbound"}}]},"parameters":{"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/dbfa9fc0-5202-4001-8759-1aa2387f825b","type":"Microsoft.Authorization/policyDefinitions","name":"dbfa9fc0-5202-4001-8759-1aa2387f825b"},{"properties":{"displayName":"allowedOS","policyType":"Custom","mode":"All","metadata":{"category":"test_sandipsh"},"parameters":{"listOfAllowedWindows":{"type":"Array","metadata":{"displayName":"Allowed
        Windows VMs","description":"The list of allowed VMs for Windows."}},"listOfAllowedUbuntus":{"type":"Array","metadata":{"displayName":"Allowed
        Ubuntu VMs","description":"The list of allowed VMs for Ubuntu."}}},"policyRule":{"if":{"allOf":[{"field":"type","in":["Microsoft.Compute/disks","Microsoft.Compute/virtualMachines","Microsoft.Compute/VirtualMachineScaleSets"]},{"not":{"allOf":[{"field":"Microsoft.Compute/imagePublisher","in":["Canonical"]},{"field":"Microsoft.Compute/imageOffer","in":["UbuntuServer"]},{"field":"Microsoft.Compute/imageSku","in":"[parameters(''listOfAllowedUbuntus'')]"},{"field":"Microsoft.Compute/imageVersion","in":["latest"]}]}},{"not":{"allOf":[{"field":"Microsoft.Compute/imagePublisher","in":["MicrosoftWindowsServer"]},{"field":"Microsoft.Compute/imageOffer","in":["WindowsServer"]},{"field":"Microsoft.Compute/imageSku","in":"[parameters(''listOfAllowedWindows'')]"},{"field":"Microsoft.Compute/imageVersion","in":["latest"]}]}}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091","type":"Microsoft.Authorization/policyDefinitions","name":"e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091"},{"properties":{"displayName":"jilim
        recovery services backup policies","policyType":"Custom","mode":"all","metadata":{"category":"Test"},"parameters":{"policies":{"type":"Array","metadata":{"displayName":"Allowed
        Recovery Services backup policies","description":"The list of allowed Recovery
        Services backup policies.","strongType":"Microsoft.RecoveryServices/vaults/backupPolicies"}},"policy":{"type":"String","metadata":{"displayName":"Allowed
        Recovery Services backup policy","description":"Allowed Recovery Services
        backup policy.","strongType":"Microsoft.RecoveryServices/vaults/backupPolicies"}}},"policyRule":{"if":{"allOf":[{"not":{"field":"location","in":"[parameters(''policies'')]"}},{"not":{"field":"location","equals":"[parameters(''policy'')]"}}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e3f9a624-b17d-4dc8-9649-65814d3241bb","type":"Microsoft.Authorization/policyDefinitions","name":"e3f9a624-b17d-4dc8-9649-65814d3241bb"},{"properties":{"displayName":"defaultValue:
        all parameters","policyType":"Custom","mode":"All","metadata":{"category":"defaultValue"},"parameters":{"locations":{"type":"Array","metadata":{"displayName":"Strong
        type (no scope, array)","description":"The list of locations for resources.","strongType":"location"},"defaultValue":["eastus","westus"]},"location":{"type":"String","metadata":{"displayName":"Strong
        type (no scope, string)","description":"The location for resources.","strongType":"location"},"defaultValue":"eastus"},"resourceGroups":{"type":"Array","metadata":{"displayName":"Strong
        type (array)","description":"The list of resource groups.","strongType":"existingResourceGroups"},"defaultValue":["camarvin"]},"resourceGroup":{"type":"String","metadata":{"displayName":"Strong
        type (string)","description":"The resource group.","strongType":"existingResourceGroups"},"defaultValue":"camarvin"},"tags":{"type":"Array","metadata":{"displayName":"Non
        strong type (array)","description":"The list of tags."},"defaultValue":[]},"tag":{"type":"String","metadata":{"displayName":"Non
        strong type (string)","description":"The tag."},"defaultValue":""},"allowedLocations":{"type":"Array","metadata":{"displayName":"Strong
        type (no scope, array, av)","description":"The list of allowed locations for
        resources.","strongType":"location"},"allowedValues":["eastus","westus","southus"],"defaultValue":["eastus"]},"allowedLocation":{"type":"String","metadata":{"displayName":"Strong
        type (no scope, string, av)","description":"The allowed location for resources.","strongType":"location"},"allowedValues":["eastus","westus","southus"],"defaultValue":"eastus"},"allowedStorageSKUs":{"type":"Array","metadata":{"displayName":"Strong
        type (array, av)","description":"The list of allowed storage SKUs for resources.","strongType":"storageSkus"},"allowedValues":["Standard_LRS","Standard_ZRS","Standard_GRS"],"defaultValue":["Standard_LRS","Standard_ZRS","Standard_GRS"]},"allowedStorageSKU":{"type":"String","metadata":{"displayName":"Strong
        type (string, av)","description":"The allowed storage SKU for resources.","strongType":"storageSkus"},"allowedValues":["Standard_LRS","Standard_ZRS","Standard_GRS"],"defaultValue":"Standard_LRS"},"allowedTags":{"type":"Array","metadata":{"displayName":"Non
        strong type (array, av)","description":"The list of allowed tags."},"allowedValues":["FirstName","LastName","Age"],"defaultValue":["FirstName","LastName","Age"]},"allowedTag":{"type":"String","metadata":{"displayName":"Non
        strong type (string, av)","description":"The allowed tag."},"allowedValues":["FirstName","LastName","Age"],"defaultValue":"FirstName"}},"policyRule":{"if":{"allOf":[{"field":"location","in":"[parameters(''locations'')]"},{"field":"location","equals":"[parameters(''location'')]"},{"field":"location","in":"[parameters(''resourceGroups'')]"},{"field":"location","equals":"[parameters(''resourceGroup'')]"},{"field":"location","in":"[parameters(''tags'')]"},{"field":"location","equals":"[parameters(''tag'')]"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"location","equals":"[parameters(''allowedLocation'')]"},{"field":"location","in":"[parameters(''allowedStorageSkus'')]"},{"field":"location","Equals":"[parameters(''allowedStorageSku'')]"},{"field":"location","in":"[parameters(''allowedTags'')]"},{"field":"location","NotEquals":"[parameters(''allowedTag'')]"}]},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0","type":"Microsoft.Authorization/policyDefinitions","name":"ea1688b3-022e-4add-af39-2fe60689a3b0"},{"properties":{"displayName":"Deny
        \"Allow All\" NSG rules","policyType":"Custom","mode":"All","description":"Denies
        the creation of sourceAddressPrefix=\"*\", destinationPortRange=\"*\" NSG
        security rules","metadata":{"category":"Port Lockdown"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"name","notEquals":"PortLockdown_AllowAll"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","notEquals":"4000"},{"allOf":[{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange","equals":"*"},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]","notEquals":"*"}}]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Allow"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"anyOf":[{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["*","Internet"]},{"not":{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]","notIn":["*","Internet"]}}]}]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321","type":"Microsoft.Authorization/policyDefinitions","name":"ebcd21e9-b89f-4a22-8654-dd3a4d8b9321"},{"properties":{"displayName":"Audit
        allowed locations","policyType":"Custom","description":"This policy enables
        you to audit your location.","parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"not":{"field":"location","in":"[parameters(''listOfAllowedLocations'')]"}},"then":{"effect":"Audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition","type":"Microsoft.Authorization/policyDefinitions","name":"LocationAuditDefinition"},{"properties":{"policyType":"Custom","parameters":{},"policyRule":{"if":{"field":"location","equals":"northeurope"},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/policy2","type":"Microsoft.Authorization/policyDefinitions","name":"policy2"},{"properties":{"policyType":"Custom","mode":"All","description":"test
        policy","parameters":{"resourceType":{"type":"String","metadata":{"displayName":"Resource
        Type","description":"The target resource type."}},"alertNamePrefix":{"type":"String","metadata":{"displayName":"Alert
        name prefix","description":"A prefix to be used for the metrics alert."}},"alertDescription":{"type":"String","metadata":{"displayName":"Alert
        description.","description":"The description of alert."}},"alertSeverity":{"type":"String","metadata":{"displayName":"alertSeverity","description":"Severity
        of alert {0,1,2,3,4}"},"allowedValues":["0","1","2","3","4"]},"isEnabled":{"type":"String","metadata":{"displayName":"isEnabled","description":"Specifies
        whether the alert is enabled."},"allowedValues":["true","false"]},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name."}},"operator":{"type":"String","metadata":{"displayName":"Operator","description":"The
        operator comparing the current value with the threshold value."}},"threshold":{"type":"String","metadata":{"displayName":"Threshold","description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"String","metadata":{"displayName":"TimeAggregation","description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"String","metadata":{"displayName":"Window
        size","description":"Period of time used to monitor alert activity based on
        the threshold. Must be between five minutes and one day. ISO 8601 duration
        format."}},"evaluationFrequency":{"type":"String","metadata":{"displayName":"Evaluation
        Frequency","description":"How often the metric alert is evaluated represented
        in ISO 8601 duration format"}},"actionGroupId":{"type":"String","metadata":{"displayName":"ActionGroupId","description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}}},"policyRule":{"if":{"field":"type","equals":"[parameters(''resourceType'')]"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/metricAlerts","existenceCondition":{"field":"name","equals":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'', field(''name''))]"},"existenceScope":"subscription","deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"alertNamePrefix":{"type":"string","minLength":1,"metadata":{"description":"A
        prefix to be used for the metrics alert."}},"alertDescription":{"type":"string","defaultValue":"This
        is a metric alert","metadata":{"description":"Description of alert"}},"alertSeverity":{"type":"string","defaultValue":"3","allowedValues":["0","1","2","3","4"],"metadata":{"description":"Severity
        of alert {0,1,2,3,4}"}},"isEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Specifies
        whether the alert is enabled"}},"metricName":{"type":"string","minLength":1,"metadata":{"description":"Name
        of the metric used in the comparison to activate the alert."}},"operator":{"type":"string","defaultValue":"GreaterThan","allowedValues":["Equals","NotEquals","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual"],"metadata":{"description":"Operator
        comparing the current value with the threshold value."}},"threshold":{"type":"string","defaultValue":"0","metadata":{"description":"The
        threshold value at which the alert is activated."}},"timeAggregation":{"type":"string","defaultValue":"Average","allowedValues":["Average","Minimum","Maximum","Total"],"metadata":{"description":"How
        the data that is collected should be combined over time."}},"windowSize":{"type":"string","defaultValue":"PT5M","metadata":{"description":"Period
        of time used to monitor alert activity based on the threshold. Must be between
        five minutes and one day. ISO 8601 duration format."}},"evaluationFrequency":{"type":"string","defaultValue":"PT1M","metadata":{"description":"how
        often the metric alert is evaluated represented in ISO 8601 duration format"}},"actionGroupId":{"type":"string","defaultValue":"","metadata":{"description":"The
        ID of the action group that is triggered when the alert is activated or deactivated"}},"resourceType":{"type":"string","metadata":{"description":"The
        resource type of target resource."}},"targetResourceName":{"type":"string","metadata":{"description":"The
        target resource name."}}},"variables":{"targetResourceType":"[parameters(''resourceType'')]","resourceIdentifier":"[resourceId(variables(''targetResourceType''),
        parameters(''targetResourceName''))]","alertName":"[concat(parameters(''alertNamePrefix''),
        ''-'', resourcegroup().name, ''-'',  parameters(''targetResourceName''))]"},"resources":[{"name":"[variables(''alertName'')]","type":"Microsoft.Insights/metricAlerts","location":"global","apiVersion":"2018-03-01","tags":{},"properties":{"description":"[parameters(''alertDescription'')]","severity":"[parameters(''alertSeverity'')]","enabled":"[parameters(''isEnabled'')]","scopes":["[variables(''resourceIdentifier'')]"],"evaluationFrequency":"[parameters(''evaluationFrequency'')]","windowSize":"[parameters(''windowSize'')]","criteria":{"odata.type":"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria","allOf":[{"name":"1st
        criterion","metricName":"[parameters(''metricName'')]","dimensions":[],"operator":"[parameters(''operator'')]","threshold":"[parameters(''threshold'')]","timeAggregation":"[parameters(''timeAggregation'')]"}]},"actions":[{"actionGroupId":"[parameters(''actionGroupId'')]"}]}}]},"parameters":{"alertNamePrefix":{"value":"[parameters(''alertNamePrefix'')]"},"alertDescription":{"value":"[parameters(''alertDescription'')]"},"alertSeverity":{"value":"[parameters(''alertSeverity'')]"},"isEnabled":{"value":"[parameters(''isEnabled'')]"},"metricName":{"value":"[parameters(''metricName'')]"},"operator":{"value":"[parameters(''operator'')]"},"threshold":{"value":"[parameters(''threshold'')]"},"timeAggregation":{"value":"[parameters(''timeAggregation'')]"},"windowSize":{"value":"[parameters(''windowSize'')]"},"evaluationFrequency":{"value":"[parameters(''evaluationFrequency'')]"},"actionGroupId":{"value":"[parameters(''actionGroupId'')]"},"resourceType":{"value":"[parameters(''resourceType'')]"},"targetResourceName":{"value":"[field(''name'')]"}}}}}}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft","type":"Microsoft.Authorization/policyDefinitions","name":"testSandipsh.draft"},{"properties":{"displayName":"testtest","policyType":"Custom","description":"testtest","parameters":{"tagName":{"type":"String","metadata":{"displayName":"The
        name for the tag","description":"The name for the tag."},"allowedValues":[]},"tagValue":{"type":"String","metadata":{"displayName":"The
        value for the tag","description":"The value for the tag"},"allowedValues":[]}},"policyRule":{"if":{"not":{"field":"[concat(''tags.'',parameters(''tagName''))]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"audit"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/testtest","type":"Microsoft.Authorization/policyDefinitions","name":"testtest"}]}'}
    headers:
      cache-control: [no-cache]
      content-length: ['299217']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:36 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''053d3325-282c-4e5c-b944-24faffd30d77'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:37 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy Log Analytics
        Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","type":"Microsoft.Authorization/policyDefinitions","name":"053d3325-282c-4e5c-b944-24faffd30d77"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['4286']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:38 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''057ef27e-665e-4328-8ea3-04b3122bd9fb'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:38 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Azure Data Lake Store","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","type":"Microsoft.Authorization/policyDefinitions","name":"057ef27e-665e-4328-8ea3-04b3122bd9fb"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1410']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:38 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''06a78e20-9358-41c9-923c-fb736d382a12'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit SQL DB Level Audit Setting","policyType":"BuiltIn","mode":"All","description":"Audit
        DB level audit setting for SQL databases","metadata":{"category":"SQL","deprecated":true},"parameters":{"setting":{"type":"String","metadata":{"displayName":"Audit
        Setting"},"allowedValues":["enabled","disabled"]}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/auditingSettings","name":"default","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a12"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['852']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''06a78e20-9358-41c9-923c-fb736d382a4d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit VMs that do not use managed
        disks","policyType":"BuiltIn","mode":"All","description":"This policy audits
        VMs that do not use managed disks","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['897']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''0868462e-646c-4fe3-9ced-a733534b6a2c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy Log Analytics
        Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","type":"Microsoft.Authorization/policyDefinitions","name":"0868462e-646c-4fe3-9ced-a733534b6a2c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['4134']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''09024ccc-0c5f-475e-9457-b7c0d9ed487b'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:41 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit minimum number
        of owners for subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate more than one subscription owner in order to have
        administrator access redundancy.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateMoreThanOneOwner","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","type":"Microsoft.Authorization/policyDefinitions","name":"09024ccc-0c5f-475e-9457-b7c0d9ed487b"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1054']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:41 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''0961003e-5a0a-4549-abde-af6a37f2724d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:42 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor unencrypted VM
        Disks in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"VMs
        without an enabled disk encryption will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","type":"Microsoft.Authorization/policyDefinitions","name":"0961003e-5a0a-4549-abde-af6a37f2724d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1032']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:42 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''0a914e76-4921-4c19-b460-a2d36003525a'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:43 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit resource location matches
        resource group location","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that the resource location matches its resource group location","metadata":{"category":"General"},"policyRule":{"if":{"field":"location","notIn":["[resourcegroup().location]","global"]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","type":"Microsoft.Authorization/policyDefinitions","name":"0a914e76-4921-4c19-b460-a2d36003525a"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['556']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:43 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''11ac78e3-31bc-4f0c-8434-37ab963cea07'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:43 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Dependency Agent
        Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.2-LTS","14.04.3-LTS","14.04.4-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","type":"Microsoft.Authorization/policyDefinitions","name":"11ac78e3-31bc-4f0c-8434-37ab963cea07"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3310']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''16390df4-2f73-4b42-af13-c801066763df'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM minimum password age 1 day","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the period of time (in
        days) that a password must be used before the user can change it.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MinimumPasswordAge","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df","type":"Microsoft.Authorization/policyDefinitions","name":"16390df4-2f73-4b42-af13-c801066763df"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3109']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''17k78e20-9358-41c9-923c-fb736d382a12'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit transparent data encryption
        status","policyType":"BuiltIn","mode":"Indexed","description":"Audit transparent
        data encryption status for SQL databases","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"enabled"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"17k78e20-9358-41c9-923c-fb736d382a12"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['964']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''1c210e94-a481-4beb-95fa-1571b434fb04'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy Dependency Agent
        for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","type":"Microsoft.Authorization/policyDefinitions","name":"1c210e94-a481-4beb-95fa-1571b434fb04"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3454']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''1d84d5fb-01f6-4d12-ba4f-4a26081d403d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit use of classic virtual machines","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your virtual machines to provide security
        enhancements such as: stronger access control (RBAC), better auditing, ARM-based
        deployment and governance, access to managed identities, access to key vault
        for secrets, Azure AD-based authentication and support for tags and resource
        groups for easier security management","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicCompute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","type":"Microsoft.Authorization/policyDefinitions","name":"1d84d5fb-01f6-4d12-ba4f-4a26081d403d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1035']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''1e30110a-5ceb-460c-a204-c1c3969c6d62'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:47 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Enforce tag and its value","policyType":"BuiltIn","description":"Enforces
        a required tag and its value. Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"not":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","type":"Microsoft.Authorization/policyDefinitions","name":"1e30110a-5ceb-460c-a204-c1c3969c6d62"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['805']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:47 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''1f314764-cb73-4fc9-b863-8eca98ac36e9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:48 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit provisioning of an Azure Active
        Directory administrator for SQL server","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        provisioning of an Azure Active Directory administrator for your SQL server
        to enable Azure AD authentication. Azure AD authentication enables simplified
        permission management and centralized identity management of database users
        and other Microsoft services","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/administrators"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","type":"Microsoft.Authorization/policyDefinitions","name":"1f314764-cb73-4fc9-b863-8eca98ac36e9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1047']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:48 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''201ea587-7c90-41c3-910f-c280ae01cfd6'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor unprotected web
        application in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Web
        applications without a Web Application Firewall protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames","Microsoft.Web/hostingEnvironments"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","type":"Microsoft.Authorization/policyDefinitions","name":"201ea587-7c90-41c3-910f-c280ae01cfd6"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1153']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''22bee202-a82f-4305-9a2a-6d7f44d4dedb'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of only secure connections
        to your Redis Cache","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of only connections via SSL to Redis Cache. Use of secure connections
        ensures authentication between the server and the service and protects data
        in transit from network layer attacks such as man-in-the-middle, eavesdropping,
        and session-hijacking","metadata":{"category":"Cache"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/redis"},{"field":"Microsoft.Cache/Redis/enableNonSslPort","equals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","type":"Microsoft.Authorization/policyDefinitions","name":"22bee202-a82f-4305-9a2a-6d7f44d4dedb"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1027']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''23020aa6-1135-4be2-bae2-149982b06eca'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM passwords must be at least 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the least number of
        characters that a password for a user account may contain.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MinimumPasswordLength","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordLength"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca","type":"Microsoft.Authorization/policyDefinitions","name":"23020aa6-1135-4be2-bae2-149982b06eca"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3119']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''24dde96d-f0b1-425e-884f-4a1421e2dcdc'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:51 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM maximum
        password age 70 days","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the period of time (in days) that a password can
        be used before the system requires the user to change it.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MaximumPasswordAge","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc","type":"Microsoft.Authorization/policyDefinitions","name":"24dde96d-f0b1-425e-884f-4a1421e2dcdc"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1361']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:51 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:51 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit configuration of metric alert
        rules on Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        configuration of metric alert rules on Batch account to enable the required
        metric","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name that an alert rule must be enabled on"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/alertRules","existenceScope":"Subscription","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/alertRules/isEnabled","equals":"true"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.metricName","equals":"[parameters(''metricName'')]"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.resourceUri","equals":"[concat(''/subscriptions/'',
        subscription().subscriptionId, ''/resourcegroups/'', resourceGroup().name,
        ''/providers/Microsoft.Batch/batchAccounts/'', field(''name''))]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","type":"Microsoft.Authorization/policyDefinitions","name":"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1491']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:52 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''2835b622-407b-4114-9198-6f7064cbe0dc'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:52 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy default Microsoft IaaSAntimalware
        extension for Windows Server","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys a Microsoft IaaSAntimalware extension with a default configuraion
        when a VM is not configured with the antimalware extension.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"ExclusionsPaths":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file paths or locations to exclude from scanning"}},"ExclusionsExtensions":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file extensions to exclude from scanning"}},"ExclusionsProcesses":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of process names to exclude from scanning"}},"RealtimeProtectionEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Indicates
        whether or not real time protection is enabled (default is true)"}},"ScheduledScanSettingsIsEnabled":{"type":"string","defaultValue":"false","metadata":{"description":"Indicates
        whether or not custom scheduled scan settings are enabled (default is false)"}},"ScheduledScanSettingsScanType":{"type":"string","defaultValue":"Quick","metadata":{"description":"Indicates
        whether scheduled scan setting type is set to Quick or Full (default is Quick)"}},"ScheduledScanSettingsDay":{"type":"string","defaultValue":"7","metadata":{"description":"Day
        of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)"}},"ScheduledScanSettingsTime":{"type":"string","defaultValue":"120","metadata":{"description":"When
        to perform the scheduled scan, measured in minutes from midnight (0-1440).
        For example: 0 = 12AM, 60 = 1AM, 120 = 2AM."}}},"resources":[{"name":"[concat(parameters(''vmName''),''/IaaSAntimalware'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.Azure.Security","type":"IaaSAntimalware","typeHandlerVersion":"1.3","autoUpgradeMinorVersion":true,"settings":{"AntimalwareEnabled":true,"RealtimeProtectionEnabled":"[parameters(''RealtimeProtectionEnabled'')]","ScheduledScanSettings":{"isEnabled":"[parameters(''ScheduledScanSettingsIsEnabled'')]","day":"[parameters(''ScheduledScanSettingsDay'')]","time":"[parameters(''ScheduledScanSettingsTime'')]","scanType":"[parameters(''ScheduledScanSettingsScanType'')]"},"Exclusions":{"Extensions":"[parameters(''ExclusionsExtensions'')]","Paths":"[parameters(''ExclusionsPaths'')]","Processes":"[parameters(''ExclusionsProcesses'')]"}}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"RealtimeProtectionEnabled":{"value":"true"},"ScheduledScanSettingsIsEnabled":{"value":"true"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc","type":"Microsoft.Authorization/policyDefinitions","name":"2835b622-407b-4114-9198-6f7064cbe0dc"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['4287']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:53 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''2a0e14a6-b0a6-4fab-991a-187a4f81c498'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Apply tag and its default value","policyType":"BuiltIn","description":"Applies
        a required tag and its default value if it is not specified by the user. Does
        not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","type":"Microsoft.Authorization/policyDefinitions","name":"2a0e14a6-b0a6-4fab-991a-187a4f81c498"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['933']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:53 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''2d60d3b7-aa10-454c-88a8-de39d99d17c6'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM should
        not store passwords using reversible encryption","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines whether the operating system stores passwords
        using reversible encryption.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"StorePasswordsUsingReversibleEncryption","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6","type":"Microsoft.Authorization/policyDefinitions","name":"2d60d3b7-aa10-454c-88a8-de39d99d17c6"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1376']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''2d67222d-05fd-4526-a171-2ee132ad9e83'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:55 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Linux VM allowing
        remote connections from accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies remote connections from accounts with empty passwords
        is disabled.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid110","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83","type":"Microsoft.Authorization/policyDefinitions","name":"2d67222d-05fd-4526-a171-2ee132ad9e83"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['2063']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''32133ab0-ee4b-4b44-98d6-042180979d50'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:55 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Log Analytics Agent
        Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","type":"Microsoft.Authorization/policyDefinitions","name":"32133ab0-ee4b-4b44-98d6-042180979d50"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3474']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''3470477a-b35a-49db-aca5-1073d04524fe'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Linux VM accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. For Linux servers this includes Chef Inspec, Ruby, and
        Python. This security setting verifies there are no accounts without passwords.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid232","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid232"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe","type":"Microsoft.Authorization/policyDefinitions","name":"3470477a-b35a-49db-aca5-1073d04524fe"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3786']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''34c877ad-507e-4c82-993e-3452a6e0ad3c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:57 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit unrestricted network access
        to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        unrestricted network access in your storage account firewall settings. Instead,
        configure network rules so only applications from allowed networks can access
        the storage account. To allow connections from specific internet or on-premise
        clients, access can be granted to traffic from specific Azure virtual networks
        or to public internet IP address ranges","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/networkAcls.defaultAction","equals":"Allow"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","type":"Microsoft.Authorization/policyDefinitions","name":"34c877ad-507e-4c82-993e-3452a6e0ad3c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1158']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''34f95f76-5386-4de7-b824-0d8478470c9d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Logic Apps","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Logic Apps"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Logic/workflows"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","type":"Microsoft.Authorization/policyDefinitions","name":"34f95f76-5386-4de7-b824-0d8478470c9d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1393']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''356a906e-05e5-4625-8729-90771e0ee934'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM maximum password age 70 days","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the period of time (in
        days) that a password can be used before the system requires the user to change
        it.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"MaximumPasswordAge","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MaximumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934","type":"Microsoft.Authorization/policyDefinitions","name":"356a906e-05e5-4625-8729-90771e0ee934"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3129']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''3657f5a0-770e-44a3-b44e-9431ba1e9735'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:00 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enablement of encryption of
        Automation account variables","policyType":"BuiltIn","mode":"All","description":"It
        is important to enable encryption of Automation account variable assets when
        storing sensitive data","metadata":{"category":"Automation"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Automation/automationAccounts/variables"},{"field":"Microsoft.Automation/automationAccounts/variables/isEncrypted","notEquals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","type":"Microsoft.Authorization/policyDefinitions","name":"3657f5a0-770e-44a3-b44e-9431ba1e9735"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['927']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:59 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''36d49e87-48c4-4f2e-beed-ba4ed02b71f5'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:38:59 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy Threat Detection on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Threat Detection is enabled on SQL Servers.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"}},"variables":{},"resources":[{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}}]},"parameters":{"serverName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","type":"Microsoft.Authorization/policyDefinitions","name":"36d49e87-48c4-4f2e-beed-ba4ed02b71f5"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1349']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:00 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''37e0d2fe-28a5-43d6-a273-67d37d1f5606'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit use of classic storage accounts","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager v2 for your storage accounts to provide security
        enhancements such as: stronger access control (RBAC), better auditing, Azure
        Resource Manager based deployment and governance, access to managed identities,
        access to key vault for secrets, Azure AD-based authentication and support
        for tags and resource groups for easier security management","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicStorage/storageAccounts"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","type":"Microsoft.Authorization/policyDefinitions","name":"37e0d2fe-28a5-43d6-a273-67d37d1f5606"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1054']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''3d8640fc-63f6-4734-8dcb-cfd3d8c78f38'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy default Log Analytics Agent
        for Ubuntu VMs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the
        selected Log Analytics workspace","metadata":{"category":"Compute","deprecated":true},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS","16.04-LTS","16.04.0-LTS","14.04.2-LTS","12.04.5-LTS"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38","type":"Microsoft.Authorization/policyDefinitions","name":"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['2759']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''404c3081-a854-4457-ae30-26a93ef643f9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit secure transfer to storage
        accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit requirment
        of Secure transfer in your storage account. Secure transfer is an option that
        forces your storage account to accept requests only from secure connections
        (HTTPS). Use of HTTPS ensures authentication between the server and the service
        and protects data in transit from network layer attacks such as man-in-the-middle,
        eavesdropping, and session-hijacking","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","type":"Microsoft.Authorization/policyDefinitions","name":"404c3081-a854-4457-ae30-26a93ef643f9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1161']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:03 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''428256e6-1fac-4f48-a757-df34c2b3336d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","type":"Microsoft.Authorization/policyDefinitions","name":"428256e6-1fac-4f48-a757-df34c2b3336d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1396']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:03 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''44452482-524f-4bf4-b852-0bff7cc4a3ed'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor permissive network
        access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        Security Groups with too permissive rules will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"permissiveNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","type":"Microsoft.Authorization/policyDefinitions","name":"44452482-524f-4bf4-b852-0bff7cc4a3ed"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1102']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:05 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Require SQL Server version 12.0","policyType":"BuiltIn","description":"This
        policy ensures all SQL servers use version 12.0","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"not":{"field":"Microsoft.Sql/servers/version","equals":"12.0"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf","type":"Microsoft.Authorization/policyDefinitions","name":"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['569']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:05 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''465f0161-0087-490a-9ad9-ad6217f4f43a'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Enforce automatic OS upgrade with
        app health checks on VMSS","policyType":"BuiltIn","mode":"All","description":"This
        policy enforces usage of automatic OS upgrade with application health checks
        through health probes, which enables safer rollout by evaluating application
        health after each OS upgrade batch.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"not":{"field":"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade","equals":"True"}},{"field":"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id","exists":"False"}]}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"465f0161-0087-490a-9ad9-ad6217f4f43a"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['934']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''47a6b606-51aa-4496-8bb7-64b11cf66adc'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor possible app
        Whitelisting in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        Application Whitelist configuration will be monitored by Azure Security Center","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"applicationWhitelisting","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","type":"Microsoft.Authorization/policyDefinitions","name":"47a6b606-51aa-4496-8bb7-64b11cf66adc"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1078']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:06 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''49c88fc8-6fd1-46fd-a676-f12d1d3a4c71'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:07 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Apply tag and its default value
        to resource groups","policyType":"BuiltIn","mode":"All","description":"Applies
        a required tag and its default value to resource groups if it is not specified
        by the user.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71","type":"Microsoft.Authorization/policyDefinitions","name":"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1038']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:07 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''4da21710-ce6f-4e06-8cdb-5cc4c93ffbee'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:08 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy Dependency Agent
        for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.2-LTS","14.04.3-LTS","14.04.4-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","sles-byos"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","type":"Microsoft.Authorization/policyDefinitions","name":"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3451']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:08 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''4f11b553-d42e-4e3a-89be-32ca364cad4c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:09 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit maximum number
        of owners for a subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate up to 3 subscription owners in order to reduce
        the potential for breach by a compromised owner.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateLessThanXOwners","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","type":"Microsoft.Authorization/policyDefinitions","name":"4f11b553-d42e-4e3a-89be-32ca364cad4c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1068']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:09 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''5aa11bbc-5c76-4302-80e5-aba46a4282e7'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:10 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM minimum
        password age 1 day","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the period of time (in days) that a password must
        be used before the user can change it.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordAge","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7","type":"Microsoft.Authorization/policyDefinitions","name":"5aa11bbc-5c76-4302-80e5-aba46a4282e7"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1341']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:10 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''5aebc8d1-020d-4037-89a0-02043a7524ec'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:10 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM passwords
        must be at least 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the least number of characters that a password
        for a user account may contain.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordLength","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec","type":"Microsoft.Authorization/policyDefinitions","name":"5aebc8d1-020d-4037-89a0-02043a7524ec"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1348']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:11 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''5c607a2e-c700-4744-8254-d77e7c9eb5e4'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:11 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit external accounts
        with write permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with write privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","type":"Microsoft.Authorization/policyDefinitions","name":"5c607a2e-c700-4744-8254-d77e7c9eb5e4"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1091']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:11 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:12 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        India data centers","policyType":"BuiltIn","description":"Allows resource
        creation in the following locations only: West India, South India, Central
        India","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["westindia","southindia","centralindia"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54","type":"Microsoft.Authorization/policyDefinitions","name":"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['602']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:11 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''5f76cf89-fbf2-47fd-a3f4-b891fa780b60'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:12 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit external accounts
        with read permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with read privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","type":"Microsoft.Authorization/policyDefinitions","name":"5f76cf89-fbf2-47fd-a3f4-b891fa780b60"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1088']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:12 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''60ffe3e2-4604-4460-8f22-0f1da058266c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:13 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit web servers inside
        Windows VMs must use TLS minimum version 1.1 encryption","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy will audit instances of Internet Information Services (IIS) running
        inside Windows virtual machines, to verify that TLS minimum version 1.1 is
        used for encryption.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AuditSecureProtocol","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c","type":"Microsoft.Authorization/policyDefinitions","name":"60ffe3e2-4604-4460-8f22-0f1da058266c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1433']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:13 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''617c02be-7f02-4efd-8836-3180d47b6c68'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:14 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit the setting of ClusterProtectionLevel
        property to EncryptAndSign in Service Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Service
        Fabric provides three levels of protection (None, Sign and EncryptAndSign)
        for node-to-node communication using a primary cluster certificate. Set the
        protection level to ensure that all node-to-node messages are encrypted and
        digitally signed","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].name","notEquals":"Security"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name","notEquals":"ClusterProtectionLevel"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value","notEquals":"EncryptAndSign"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","type":"Microsoft.Authorization/policyDefinitions","name":"617c02be-7f02-4efd-8836-3180d47b6c68"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1334']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:14 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''655cb504-bcee-4362-bd4c-402e6aa38759'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:15 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit missing blob encryption
        for storage accounts","policyType":"BuiltIn","mode":"All","description":"This
        policy audits storage accounts without blob encryption. It only applies to
        Microsoft.Storage resource types, not other storage providers. Possible network
        Just In Time access will be monitored by Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","type":"Microsoft.Authorization/policyDefinitions","name":"655cb504-bcee-4362-bd4c-402e6aa38759"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1068']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:15 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''6b1cbf55-e8b6-442f-ba4c-7246b6381474'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:15 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit deprecated accounts
        on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts should be removed from your subscriptions.  Deprecated accounts are
        accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccounts","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","type":"Microsoft.Authorization/policyDefinitions","name":"6b1cbf55-e8b6-442f-ba4c-7246b6381474"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1072']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:15 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''6c112d4e-5bc7-47ae-a041-ea2d9dccd749'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:16 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Not allowed resource types","policyType":"BuiltIn","description":"This
        policy enables you to specify the resource types that your organization cannot
        deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesNotAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that cannot be deployed.","displayName":"Not allowed
        resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypesNotAllowed'')]"},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","type":"Microsoft.Authorization/policyDefinitions","name":"6c112d4e-5bc7-47ae-a041-ea2d9dccd749"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['750']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:16 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''6fdb9205-3462-4cfc-87d8-16c7860b53f4'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:17 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        Japan data centers","policyType":"BuiltIn","description":"Allows resource
        creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4","type":"Microsoft.Authorization/policyDefinitions","name":"6fdb9205-3462-4cfc-87d8-16c7860b53f4"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['570']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:17 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''726671ac-c4de-4908-8c7d-6043ae62e3b6'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:17 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM should not allow previous 24 passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines the number of unique
        new passwords that have to be associated with a user account before an old
        password can be reused.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"EnforcePasswordHistory","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"EnforcePasswordHistory"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6","type":"Microsoft.Authorization/policyDefinitions","name":"726671ac-c4de-4908-8c7d-6043ae62e3b6"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3160']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:18 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''7433c107-6db4-4ad1-b57a-a76dce0154a1'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:18 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allowed storage account SKUs","policyType":"BuiltIn","description":"This
        policy enables you to specify a set of storage account SKUs that your organization
        can deploy.","metadata":{"category":"Storage"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for storage accounts.","displayName":"Allowed
        SKUs","strongType":"StorageSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1","type":"Microsoft.Authorization/policyDefinitions","name":"7433c107-6db4-4ad1-b57a-a76dce0154a1"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['849']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:19 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''752c6934-9bcc-4749-b004-655e676ae2ac'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:19 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in App Services","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of diagnostic logs on the app. This enables you to recreate activity
        trails for investigation purposes if a security incident occurs or your network
        is compromised","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"web"},{"anyOf":[{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/httpLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/requestTracingEnabled","notEquals":"true"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","type":"Microsoft.Authorization/policyDefinitions","name":"752c6934-9bcc-4749-b004-655e676ae2ac"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1162']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:20 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''760a85ff-6162-42b3-8d70-698e268f648c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:20 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor VM Vulnerabilities
        in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Monitors
        vulnerabilities detected by Vulnerability Assessment solution and VMs without
        a Vulnerability Assessment solution in Azure Security Center as recommendations.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"vulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","type":"Microsoft.Authorization/policyDefinitions","name":"760a85ff-6162-42b3-8d70-698e268f648c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1151']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:20 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''7c1b1214-f927-48bf-8882-84f0af6588b1'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:21 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostics logs
        in Service Fabric and Virtual Machine Scale Sets","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable Logs so that activity trail can be recreated when
        investigations are required in the event of an incident or a compromise.","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"IaaSDiagnostics"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Diagnostics"}]},{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"LinuxDiagnostic"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.OSTCExtensions"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","type":"Microsoft.Authorization/policyDefinitions","name":"7c1b1214-f927-48bf-8882-84f0af6588b1"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1456']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:20 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:21 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Require blob encryption for storage
        accounts","policyType":"BuiltIn","description":"This policy ensures blob encryption
        for storage accounts is turned on. It only applies to Microsoft.Storage resource
        types, not other storage providers.","metadata":{"category":"Storage"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f","type":"Microsoft.Authorization/policyDefinitions","name":"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['716']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:22 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:22 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM enforces password complexity requirements","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. If this policy is enabled, passwords must meet minimum
        requirements.  See documentation for full details at URL http://aka.ms/gcpol.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordMustMeetComplexityRequirements","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordMustMeetComplexityRequirements"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8","type":"Microsoft.Authorization/policyDefinitions","name":"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3175']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:23 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''7f89b1eb-583c-429a-8828-af049802c1d9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:23 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit diagnostic setting","policyType":"BuiltIn","mode":"All","description":"Audit
        diagnostic setting for selected resource types","metadata":{"category":"Monitoring"},"parameters":{"listOfResourceTypes":{"type":"Array","metadata":{"displayName":"Resource
        Types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypes'')]"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","type":"Microsoft.Authorization/policyDefinitions","name":"7f89b1eb-583c-429a-8828-af049802c1d9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['890']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:23 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''83a214f7-d01a-484b-91a9-ed54470c9a6a'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:24 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Event Hub","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables recreation of
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","type":"Microsoft.Authorization/policyDefinitions","name":"83a214f7-d01a-484b-91a9-ed54470c9a6a"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1393']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:24 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''86a912f6-9a06-4e26-b447-11b16ba8659f'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:25 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy SQL DB transparent data encryption","policyType":"BuiltIn","mode":"Indexed","description":"Enables
        transparent data encryption on SQL databases","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullDbName":{"type":"string"}},"resources":[{"name":"[concat(parameters(''fullDbName''),
        ''/current'')]","type":"Microsoft.Sql/servers/databases/transparentDataEncryption","apiVersion":"2014-04-01","properties":{"status":"Enabled"}}]},"parameters":{"fullDbName":{"value":"[field(''fullName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f","type":"Microsoft.Authorization/policyDefinitions","name":"86a912f6-9a06-4e26-b447-11b16ba8659f"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1335']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:25 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''86b3d65f-7626-441e-b690-81a8b71cff60'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:26 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor missing system
        updates in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Missing
        security system updates on your servers will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"systemUpdates","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","type":"Microsoft.Authorization/policyDefinitions","name":"86b3d65f-7626-441e-b690-81a8b71cff60"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1130']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:25 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''8ce3da23-7156-49e4-b145-24f95f9dcb46'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:27 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Enforce tag and its value on resource
        groups","policyType":"BuiltIn","mode":"All","description":"Enforces a required
        tag and its value on resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46","type":"Microsoft.Authorization/policyDefinitions","name":"8ce3da23-7156-49e4-b145-24f95f9dcb46"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['905']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:27 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''8ff0b18b-262e-4512-857a-48ad0aeb9a78'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:28 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Windows VM should not store passwords using reversible encryption","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. This security setting determines whether the operating
        system stores passwords using reversible encryption.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"StorePasswordsUsingReversibleEncryption","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"StorePasswordsUsingReversibleEncryption"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78","type":"Microsoft.Authorization/policyDefinitions","name":"8ff0b18b-262e-4512-857a-48ad0aeb9a78"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3165']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:27 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''9297c21d-2ed6-4474-b48f-163f75654ce3'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:28 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit accounts with write
        permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        write privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","type":"Microsoft.Authorization/policyDefinitions","name":"9297c21d-2ed6-4474-b48f-163f75654ce3"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1125']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:28 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''94c19f19-8192-48cd-a11b-e37099d3e36b'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:29 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        European data centers","policyType":"BuiltIn","description":"Allows resource
        creation in the following locations only: North Europe, West Europe","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["northeurope","westeurope"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b","type":"Microsoft.Authorization/policyDefinitions","name":"94c19f19-8192-48cd-a11b-e37099d3e36b"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['579']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:28 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''983211ba-f348-4758-983b-21fa29294869'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:30 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        United States data centers","policyType":"BuiltIn","description":"Allows resource
        creation in the following locations only: Central US, East US, East US2, North
        Central US, South Central US, West US","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["centralus","eastus","eastus2","northcentralus","southcentralus","westus"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869","type":"Microsoft.Authorization/policyDefinitions","name":"983211ba-f348-4758-983b-21fa29294869"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['680']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:30 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''9daedab3-fb2d-461e-b861-71790eead4f6'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:31 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor unprotected network
        endpoints in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        endpoints without a Next Generation Firewall''s protection will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Network/publicIPAddresses","Microsoft.ClassicCompute/domainNames"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedNetworkEndpoint","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","type":"Microsoft.Authorization/policyDefinitions","name":"9daedab3-fb2d-461e-b861-71790eead4f6"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1123']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:31 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a08ec900-254a-4555-9bf5-e42af04b5c5c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:31 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allowed resource types","policyType":"BuiltIn","description":"This
        policy enables you to specify the resource types that your organization can
        deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that can be deployed.","displayName":"Allowed resource
        types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''listOfResourceTypesAllowed'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","type":"Microsoft.Authorization/policyDefinitions","name":"a08ec900-254a-4555-9bf5-e42af04b5c5c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['738']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:32 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a1817ec0-a368-432a-8057-8371e17ac6ee'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:32 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit authorization rules on Service
        Bus namespaces","policyType":"BuiltIn","mode":"All","description":"Service
        Bus clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Service
        Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceBus/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","type":"Microsoft.Authorization/policyDefinitions","name":"a1817ec0-a368-432a-8057-8371e17ac6ee"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1079']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:32 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a451c1ef-c6ca-483d-87ed-f49761e3ffb5'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:33 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit usage of custom RBAC rules","policyType":"BuiltIn","mode":"All","description":"Audit
        built-in roles such as ''Owner, Contributer, Reader'' instead of custom RBAC
        roles, which are error prone. Using custom roles is treated as an exception
        and requires a rigorous review and threat modeling","metadata":{"category":"General"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Authorization/roleDefinitions"},{"field":"Microsoft.Authorization/roleDefinitions/type","equals":"CustomRole"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","type":"Microsoft.Authorization/policyDefinitions","name":"a451c1ef-c6ca-483d-87ed-f49761e3ffb5"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['975']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:33 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:33 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit SQL server level Auditing
        settings","policyType":"BuiltIn","mode":"Indexed","description":"Audits the
        existence of SQL Auditing at the server level","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"setting":{"type":"String","metadata":{"displayName":"Desired
        Auditing setting"},"allowedValues":["enabled","disabled"],"defaultValue":"enabled"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","type":"Microsoft.Authorization/policyDefinitions","name":"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1073']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:34 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a7ff3161-0087-490a-9ad9-ad6217f4f43a'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:34 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Enforce encryption on Data Lake
        Store accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures encryption is enabled on all Data Lake Store accounts","metadata":{"category":"Data
        Lake"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},{"field":"Microsoft.DataLakeStore/accounts/encryptionState","equals":"Disabled"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"a7ff3161-0087-490a-9ad9-ad6217f4f43a"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['654']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:34 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a8bef009-a5c9-4d0f-90d7-6018734e8a16'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:35 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor unencrypted SQL
        database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Unencrypted
        SQL servers or databases will be monitored by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","type":"Microsoft.Authorization/policyDefinitions","name":"a8bef009-a5c9-4d0f-90d7-6018734e8a16"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1054']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:36 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''a9b99dd8-06c5-4317-8629-9d86a3c6e7d9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:36 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy network watcher when virtual
        networks are created","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a network watcher resource in regions with virtual networks.
        You need to ensure existence of a resource group named networkWatcherRG, which
        will be used to deploy network watcher instances.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/virtualNetworks"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Network/networkWatchers","resourceGroupName":"networkWatcherRG","existenceCondition":{"field":"location","equals":"[field(''location'')]"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"}},"resources":[{"apiVersion":"2016-09-01","type":"Microsoft.Network/networkWatchers","name":"[concat(''networkWacher_'',
        parameters(''location''))]","location":"[parameters(''location'')]"}]},"parameters":{"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9","type":"Microsoft.Authorization/policyDefinitions","name":"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1465']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:36 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''aa633080-8b72-40c4-a2d7-d00c03e80bed'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:37 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit accounts with owner
        permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        owner permissions to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","type":"Microsoft.Authorization/policyDefinitions","name":"aa633080-8b72-40c4-a2d7-d00c03e80bed"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1126']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:36 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''abcc6037-1fc4-47f6-aac5-89706589be24'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:37 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Automatic provisioning
        of security monitoring agent","policyType":"BuiltIn","mode":"All","description":"Installs
        security agent on VMs for advanced security alerts and preventions in Azure
        Security Center. Applies only for subscriptions that use Azure Security Center.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Security/complianceResults","name":"securityAgent","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24","type":"Microsoft.Authorization/policyDefinitions","name":"abcc6037-1fc4-47f6-aac5-89706589be24"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['944']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:38 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''ac7e5fc0-c029-4b12-91d4-a8500ce697f9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation if ''environment''
        tag value in allowed values","policyType":"BuiltIn","description":"Allows
        resource creation if the ''environment'' tag is set to one of the following
        values: production, dev, test, staging","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.environment","in":["production","dev","test","staging"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9","type":"Microsoft.Authorization/policyDefinitions","name":"ac7e5fc0-c029-4b12-91d4-a8500ce697f9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['647']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:38 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''af6cd1bd-1635-48cb-bde7-5b15693900b9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor missing Endpoint
        Protection in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        without an installed Endpoint Protection agent will be monitored by Azure
        Security Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"endpointProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","type":"Microsoft.Authorization/policyDefinitions","name":"af6cd1bd-1635-48cb-bde7-5b15693900b9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1147']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''af8051bf-258b-44e2-a2bf-165330459f9d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:39 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor unaudited SQL
        database in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"SQL
        servers and databases which doesn''t have SQL auditing turned on will be monitored
        by Azure Security Center as recommendations","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers","Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"auditing","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","type":"Microsoft.Authorization/policyDefinitions","name":"af8051bf-258b-44e2-a2bf-165330459f9d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1081']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b0f33259-77d7-4c9e-aac6-3aabcfae693c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:41 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor possible network
        Just In Time (JIT) access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Possible
        network Just In Time (JIT) access will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"jitNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","type":"Microsoft.Authorization/policyDefinitions","name":"b0f33259-77d7-4c9e-aac6-3aabcfae693c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1064']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:40 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b18175dd-c599-4c64-83ba-bb018a06d35b'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:41 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Linux VM /etc/passwd
        file permissions are set to 0644","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies /etc/passwd file permissions are set to 0644 to
        prevent unauthorized changes that could allow access to the server.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid121","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b","type":"Microsoft.Authorization/policyDefinitions","name":"b18175dd-c599-4c64-83ba-bb018a06d35b"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['2097']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:41 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b278e460-7cfc-4451-8294-cccc40a940d7'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:42 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit authorization rules on Event
        Hub namespaces","policyType":"BuiltIn","mode":"All","description":"Event Hub
        clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Event
        Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"name","notEquals":"RootManageSharedAccessKey"},{"field":"type","equals":"Microsoft.EventHub/namespaces/authorizationRules"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","type":"Microsoft.Authorization/policyDefinitions","name":"b278e460-7cfc-4451-8294-cccc40a940d7"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1071']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:42 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b2fc8f91-866d-4434-9089-5ebfe38d6fd8'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:43 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit web servers inside Windows VMs must use TLS minimum version 1.1 encryption","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to audit instances of
        Internet Information Services (IIS) running inside Windows virtual machines,
        to verify that TLS minimum version 1.1 is used for encryption.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"AuditSecureProtocol","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AuditSecureProtocol"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8","type":"Microsoft.Authorization/policyDefinitions","name":"b2fc8f91-866d-4434-9089-5ebfe38d6fd8"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3142']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:43 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b4330a05-a843-4bc8-bf9a-cacce50c67f4'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        for Search service","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Search"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Search/searchServices"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","type":"Microsoft.Authorization/policyDefinitions","name":"b4330a05-a843-4bc8-bf9a-cacce50c67f4"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1400']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''b54ed75b-3e1a-44ac-a333-05ba39b99ff0'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:44 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit usage of Azure Active Directory
        for client authentication in Service Fabric","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        usage of client authentication only via Azure Active Directory in Service
        Fabric","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","exists":"false"},{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","equals":""}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","type":"Microsoft.Authorization/policyDefinitions","name":"b54ed75b-3e1a-44ac-a333-05ba39b99ff0"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1019']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''c1b9cbed-08e3-427d-b9ce-7c535b1e9b94'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        Asia data centers","policyType":"BuiltIn","description":"Allows resource creation
        in the following locations only: East Asia, Southeast Asia, West India, South
        India, Central India, Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastasia","southeastasia","westindia","southindia","centralindia","japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94","type":"Microsoft.Authorization/policyDefinitions","name":"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['703']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:45 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''c40c9087-1981-4e73-9f53-39743eda9d05'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Linux VM accounts
        with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting verifies there are no accounts without passwords.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid232","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05","type":"Microsoft.Authorization/policyDefinitions","name":"c40c9087-1981-4e73-9f53-39743eda9d05"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['2004']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:46 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''c95c74d9-38fe-4f0d-af86-0c7d626a315c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:47 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Data Lake Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeAnalytics/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","type":"Microsoft.Authorization/policyDefinitions","name":"c95c74d9-38fe-4f0d-af86-0c7d626a315c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1412']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:47 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''c9c29499-c1d1-4195-99bd-2ec9e3a9dc89'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:48 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Apply Diagnostic Settings for Network
        Security Groups","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy automatically deploys diagnostic settings to network security groups.","metadata":{"category":"Monitoring"},"parameters":{"storagePrefix":{"type":"String","metadata":{"displayName":"Storage
        Account Prefix for Regional Storage Account"}},"rgName":{"type":"String","metadata":{"displayName":"Resource
        Group Name for Storage Account (must exist)","description":"This resource
        group must already exist","strongType":"ExistingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"setbypolicy","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"},"nsgName":{"type":"string"},"rgName":{"type":"string"}},"variables":{"storageDeployName":"[concat(''policyStorage_'',
        uniqueString(parameters(''location''), parameters(''nsgName'')))]"},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings","name":"[concat(parameters(''nsgName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","dependsOn":["[variables(''storageDeployName'')]"],"properties":{"storageAccountId":"[reference(variables(''storageDeployName'')).outputs.storageAccountId.value]","logs":[{"category":"NetworkSecurityGroupEvent","enabled":true,"retentionPolicy":{"enabled":false,"days":0}},{"category":"NetworkSecurityGroupRuleCounter","enabled":true,"retentionPolicy":{"enabled":false,"days":0}}]}},{"apiVersion":"2017-05-10","name":"[variables(''storageDeployName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''rgName'')]","properties":{"mode":"incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"}},"resources":[{"apiVersion":"2017-06-01","type":"Microsoft.Storage/storageAccounts","name":"[concat(parameters(''storageprefix''),
        parameters(''location''))]","sku":{"name":"Standard_LRS","tier":"Standard"},"kind":"Storage","location":"[parameters(''location'')]","tags":{"created-by":"policy"},"scale":null,"properties":{"networkAcls":{"bypass":"AzureServices","defaultAction":"Allow","ipRules":[],"virtualNetworkRules":[]},"supportsHttpsTrafficOnly":true}}],"outputs":{"storageAccountId":{"type":"string","value":"[resourceId(parameters(''rgName''),
        ''Microsoft.Storage/storageAccounts'',concat(parameters(''storagePrefix''),
        parameters(''location'')))]"}}}}}]},"parameters":{"location":{"value":"[field(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"},"rgName":{"value":"[parameters(''rgName'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89","type":"Microsoft.Authorization/policyDefinitions","name":"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3613']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:48 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''cccc23c7-8427-4f53-ad12-b6a63eb452b3'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allowed virtual machine SKUs","policyType":"BuiltIn","description":"This
        policy enables you to specify a set of virtual machine SKUs that your organization
        can deploy.","metadata":{"category":"Compute"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for virtual machines.","displayName":"Allowed
        SKUs","strongType":"VMSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","type":"Microsoft.Authorization/policyDefinitions","name":"cccc23c7-8427-4f53-ad12-b6a63eb452b3"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['844']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''cd8dc879-a2ae-43c3-8211-1877c5755064'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation if ''department''
        tag set","policyType":"BuiltIn","description":"Allows resource creation only
        if the ''department'' tag is set","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags","containsKey":"department"}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064","type":"Microsoft.Authorization/policyDefinitions","name":"cd8dc879-a2ae-43c3-8211-1877c5755064"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['539']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:49 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''cdbf72d9-ac9c-4026-8a3a-491a5ac59293'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM should
        not allow previous 24 passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        security setting determines the number of unique new passwords that have to
        be associated with a user account before an old password can be reused.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"EnforcePasswordHistory","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293","type":"Microsoft.Authorization/policyDefinitions","name":"cdbf72d9-ac9c-4026-8a3a-491a5ac59293"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1388']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''cf820ca0-f99e-4f3e-84fb-66e913812d21'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:50 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Key Vault","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Key Vault"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","type":"Microsoft.Authorization/policyDefinitions","name":"cf820ca0-f99e-4f3e-84fb-66e913812d21"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1391']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:51 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''e01598e8-6538-41ed-95e8-8b29746cd697'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:52 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allow resource creation only in
        Japan data centers","policyType":"BuiltIn","description":"Allows resource
        creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697","type":"Microsoft.Authorization/policyDefinitions","name":"e01598e8-6538-41ed-95e8-8b29746cd697"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['570']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:52 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:53 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor OS vulnerabilities
        in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        which do not satisfy the configured baseline will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines","Microsoft.OperationalInsights/workspaces"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"osVulnerabilities","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","type":"Microsoft.Authorization/policyDefinitions","name":"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1135']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:52 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''e3576e28-8b17-4677-84c3-db2990658d64'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:53 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit accounts with read
        permissions who are not MFA enabled on a subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        read privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","type":"Microsoft.Authorization/policyDefinitions","name":"e3576e28-8b17-4677-84c3-db2990658d64"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1122']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''e56962a6-4747-49cd-b67b-bf8b01975c4c'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:54 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allowed locations","policyType":"BuiltIn","description":"This
        policy enables you to restrict the locations your organization can specify
        when deploying resources. Use to enforce your geo-compliance requirements.
        Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and
        resources that use the ''global'' region.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"location","notEquals":"global"},{"field":"type","notEquals":"Microsoft.AzureActiveDirectory/b2cDirectories"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c","type":"Microsoft.Authorization/policyDefinitions","name":"e56962a6-4747-49cd-b67b-bf8b01975c4c"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1049']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:55 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''e765b5de-1225-4ba3-bd56-1ac6695af988'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:55 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Allowed locations for resource groups","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to restrict the locations your organization can create
        resource groups in. Use to enforce your geo-compliance requirements.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that resource groups can be created in.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988","type":"Microsoft.Authorization/policyDefinitions","name":"e765b5de-1225-4ba3-bd56-1ac6695af988"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['908']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:55 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''ebb62a0c-3560-49e1-89ed-27e074e9f8ad'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit deprecated accounts
        with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts with owner permissions should be removed from your subscription.  Deprecated
        accounts are accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","type":"Microsoft.Authorization/policyDefinitions","name":"ebb62a0c-3560-49e1-89ed-27e074e9f8ad"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1137']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''ec49586f-4939-402d-a29e-6ff502b20592'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Linux VM allowing remote connections from accounts with no passwords","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration and
        Microsoft Azure Managed Service Identity, and required content to check settings
        inside the virtual machine. For Linux servers this includes Chef Inspec, Ruby,
        and Python. This security setting verifies remote connections from accounts
        with empty passwords is disabled.","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid110","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid110"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592","type":"Microsoft.Authorization/policyDefinitions","name":"ec49586f-4939-402d-a29e-6ff502b20592"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3848']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:56 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f19aa1c1-6b91-4c27-ae6a-970279f03db9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:57 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Deploy VM extension to
        audit Linux VM passwd file permissions","policyType":"BuiltIn","mode":"Indexed","description":"Include
        this rule to deploy the VM extensions for Microsoft Guest Configuration, Microsoft
        Azure Managed Service Identity, and required content to check settings inside
        the virtual machine. For Linux servers this includes Chef Inspec, Ruby, and
        Python. This security setting verifies /etc/passwd file permissions are set
        to 0644 to prevent unauthorized changes that could allow access to the server.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","match":"14.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"16.04.#-LTS"},{"field":"Microsoft.Compute/imageSKU","equals":"16.04-LTS"},{"field":"Microsoft.Compute/imageSKU","match":"18.04-LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","equals":"SLES"},{"field":"Microsoft.Compute/imageSKU","equals":"12-SP3"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","in":["7-RAW","7.4"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","in":["9","8"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","equals":"CentOS"},{"field":"Microsoft.Compute/imageSKU","in":["7.5","7.4","7.3"]}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"name":"PasswordPolicy_msid121","deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid121"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-06-30-preview","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9","type":"Microsoft.Authorization/policyDefinitions","name":"f19aa1c1-6b91-4c27-ae6a-970279f03db9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['3858']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f47b5582-33ec-4c5c-87c0-b010a6b2e917'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Log Analytics Workspace
        for VM - Report Mismatch","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if they not logging to the LA workspace specified in
        the policy/initiative assignment.","metadata":{"category":"Monitoring"},"parameters":{"logAnalyticsWorkspaceId":{"type":"String","metadata":{"displayName":"Log
        Analytics Workspace Id that VMs should be configured for","description":"This
        is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured
        for."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId","notEquals":"[parameters(''logAnalyticsWorkspaceId'')]"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917","type":"Microsoft.Authorization/policyDefinitions","name":"f47b5582-33ec-4c5c-87c0-b010a6b2e917"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1136']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:58 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f4826e5f-6a27-407c-ae3e-9582eb39891d'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:59 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit existence of authorization
        rules on Event Hub entities","policyType":"BuiltIn","mode":"All","description":"Audit
        existence of authorization rules on Event Hub entities to grant least-privileged
        access","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces/eventhubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.EventHub/namespaces/eventHubs/authorizationRules"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","type":"Microsoft.Authorization/policyDefinitions","name":"f4826e5f-6a27-407c-ae3e-9582eb39891d"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['902']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:39:59 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f48b2913-1dc5-4834-8c72-ccc1dfd819bb'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:00 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit Windows VM enforces
        password complexity requirements","policyType":"BuiltIn","mode":"Indexed","description":"If
        this policy is enabled, passwords must meet minimum requirements.  See documentation
        for full details at URL http://aka.ms/gcpol.","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH"]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordMustMeetComplexityRequirements","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb","type":"Microsoft.Authorization/policyDefinitions","name":"f48b2913-1dc5-4834-8c72-ccc1dfd819bb"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1387']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:00 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f4c68484-132f-41f9-9b6d-3e4b1cb55036'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Deploy Auditing on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"SQL"},"parameters":{"retentionDays":{"type":"String","metadata":{"description":"The
        value in days of the retention period (0 indicates unlimited retention)","displayName":"Retention
        days (optional, 180 days if unspecified)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036","type":"Microsoft.Authorization/policyDefinitions","name":"f4c68484-132f-41f9-9b6d-3e4b1cb55036"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['4046']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f8456c1c-aa66-4dfb-861a-25d127b775c9'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:01 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Audit external accounts
        with owner permissions on a subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with owner permissions should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","type":"Microsoft.Authorization/policyDefinitions","name":"f8456c1c-aa66-4dfb-861a-25d127b775c9"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1096']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f8d36e2f-389b-4ee4-898d-21aeb69a0f45'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Service Bus","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Service Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ServiceBus/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","type":"Microsoft.Authorization/policyDefinitions","name":"f8d36e2f-389b-4ee4-898d-21aeb69a0f45"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1401']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:02 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''f9be5368-9bf5-4b84-9e0a-7850da98bb46'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:03 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"Audit enabling of diagnostic logs
        in Azure Stream Analytics","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of logs and retain them up to a year. This enables you to recreate
        activity trails for investigation purposes when a security incident occurs
        or your network is compromised","metadata":{"category":"Stream Analytics"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.StreamAnalytics/streamingJobs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","type":"Microsoft.Authorization/policyDefinitions","name":"f9be5368-9bf5-4b84-9e0a-7850da98bb46"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1425']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:03 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc?api-version=2018-03-01
  response:
    body: {string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy
        definition ''feedbf84-6b99-488c-acc2-71c829aa5ffc'' could not be found."}}'}
    headers:
      cache-control: [no-cache]
      content-length: ['138']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      x-content-type-options: [nosniff]
    status: {code: 404, message: Not Found}
- request:
    body: null
    headers:
      Accept: [application/json]
      Accept-Encoding: ['gzip, deflate']
      CommandName: [policy definition show]
      Connection: [keep-alive]
      Content-Type: [application/json; charset=utf-8]
      User-Agent: [python/3.6.6 (Windows-10-10.0.17134-SP0) requests/2.19.1 msrest/0.5.5
          msrest_azure/0.4.34 policyclient/2.0.0 Azure-SDK-For-Python AZURECLI/2.0.48]
      accept-language: [en-US]
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc?api-version=2018-03-01
  response:
    body: {string: '{"properties":{"displayName":"[Preview]: Monitor SQL vulnerability
        assessment results in Azure Security Center","policyType":"BuiltIn","mode":"Indexed","description":"Monitor
        Vulnerability Assessment scan results and recommendations for how to remediate
        database vulnerabilities.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Sql/servers/databases","Microsoft.Sql/managedinstances/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"sqlVulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","equals":"Monitored"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","type":"Microsoft.Authorization/policyDefinitions","name":"feedbf84-6b99-488c-acc2-71c829aa5ffc"}'}
    headers:
      cache-control: [no-cache]
      content-length: ['1119']
      content-type: [application/json; charset=utf-8]
      date: ['Mon, 22 Oct 2018 19:40:04 GMT']
      expires: ['-1']
      pragma: [no-cache]
      strict-transport-security: [max-age=31536000; includeSubDomains]
      transfer-encoding: [chunked]
      vary: ['Accept-Encoding,Accept-Encoding']
      x-content-type-options: [nosniff]
    status: {code: 200, message: OK}
version: 1
