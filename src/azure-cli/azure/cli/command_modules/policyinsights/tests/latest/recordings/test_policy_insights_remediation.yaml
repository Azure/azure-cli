interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2023-04-01
  response:
    body:
      string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy definition
        ''06a78e20-9358-41c9-923c-fb736d382a4d'' could not be found."}}'
    headers:
      cache-control:
      - no-store, no-cache
      content-length:
      - '138'
      content-type:
      - application/json
      date:
      - Mon, 07 Jul 2025 10:26:22 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/325c0a2f-a376-4509-a461-2ab970c76984
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: BA166FB86E6A439D8566AB6411DAC034 Ref B: TYO201100115047 Ref C: 2025-07-07T10:26:23Z'
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2023-04-01
  response:
    body:
      string: '{"properties":{"displayName":"Audit VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"version":"1.0.0","category":"Compute"},"version":"1.0.0","parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}},"versions":["1.0.0"]},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '954'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - ''
      x-msedge-ref:
      - 'Ref A: B60D702F36464941A90506DFE9D892A1 Ref B: TYO201151003054 Ref C: 2025-07-07T10:26:23Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
      "enforcementMode": "Default"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '161'
      Content-Type:
      - application/json
      ParameterSetName:
      - --policy -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2023-04-01
  response:
    body:
      string: '{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","createdOn":"2025-07-07T10:26:24.1434651Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:24.1127247Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:24.1127247Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '859'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/fa47c101-7563-4278-9c0c-3f24c790c4f3
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: D6A80CEBEA694761BD06C159626D392A Ref B: TYO201100113027 Ref C: 2025-07-07T10:26:24Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -a
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2023-04-01
  response:
    body:
      string: '{"value":[{"properties":{"displayName":"deny-nsg-rule-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-rule-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. Assign the policy
        again.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:07:29.1757898Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:23:20.4306328Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/36e07b214d59455886a2b76b","type":"Microsoft.Authorization/policyAssignments","name":"36e07b214d59455886a2b76b","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:23:20.325117Z"}},{"properties":{"displayName":"deny-nsg-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted it from my resource group
        and found that it applied to the the whole subscription.\nRe assign the policy.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:06:22.2583329Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:29:53.8929477Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5b5ec388a1b6480391640d13","type":"Microsoft.Authorization/policyAssignments","name":"5b5ec388a1b6480391640d13","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:29:53.8609992Z"}},{"properties":{"displayName":"deny_load_balancer_rules_and_inbound_nat_rules","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bfedda4d-ba65-4ba3-9df1-9eb8a13a0f09","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_azure-sample-node06b5c4550e194ae5ac_nodejs-sample06b5c4550e194ae5acdev_eastus","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/xichengroup"],"parameters":{},"description":"","metadata":{"assignedBy":"test@example.com
        ","parameterScopes":{},"createdBy":"b5ed59e8-f00d-4396-af62-8297e36d8b52","createdOn":"2020-04-16T10:28:45.5317863Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T07:43:58.5150353Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5d00856604b74b80927cca6e","type":"Microsoft.Authorization/policyAssignments","name":"5d00856604b74b80927cca6e","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T07:43:58.478803Z"}},{"properties":{"displayName":"deny-nic-no-nsg","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nic-no-nsg","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/wls-admin"],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. \nAssign the policy
        again.","metadata":{"assignedBy":"test@example.com ","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:04:31.0026973Z","updatedBy":"f0f844e0-d2fe-4aa3-8e2c-2e429618f305","updatedOn":"2020-09-11T07:46:03.3893374Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/8805e4466db647d1beda40e2","type":"Microsoft.Authorization/policyAssignments","name":"8805e4466db647d1beda40e2"},{"identity":{"principalId":"30601973-dcd6-4c4e-85e8-dc6e057238fa","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"displayName":"ASC
        DataProtection (subscription: 0b1f6471-1bf0-4dda-aec3-cb9272f09590)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","definitionVersion":"3.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center","createdBy":"2f8a138f-0955-44e1-9124-c386dfaecad4","createdOn":"2019-11-25T02:19:57.9086573Z","updatedBy":"062d5f19-c525-48c9-a809-3be8685b85d0","updatedOn":"2024-10-29T05:35:22.9920211Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter","type":"Microsoft.Authorization/policyAssignments","name":"DataProtectionSecurityCenter","location":"eastus","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2024-10-29T05:35:22.8883136Z"}},{"identity":{"principalId":"c44083df-c6be-4cfc-adab-afbe9e55fc6c","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2022-01-06T18:54:58.824404Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentb2i7mjcri","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentb2i7mjcri","location":"westus","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2022-01-06T18:54:57.7694834Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2022-01-06T18:54:57.7694834Z"}},{"properties":{"displayName":"test_assignment37erp","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policymnyzvdlzz","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-08-19T23:02:10.2750241Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj/providers/Microsoft.Authorization/policyAssignments/-bGpNMRxSf6Ecgpsw7K9ww","type":"Microsoft.Authorization/policyAssignments","name":"-bGpNMRxSf6Ecgpsw7K9ww","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2021-08-19T23:02:10.1625651Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-19T23:02:10.1625651Z"}},{"identity":{"principalId":"2e39dbd9-db71-4877-bd52-0b2736ff7370","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-06-24T23:13:58.5161882Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentmkw7g5ydg","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentmkw7g5ydg","location":"westus"},{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","createdOn":"2025-07-07T10:26:24.1434651Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:24.1127247Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:24.1127247Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10416'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:24 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/8c13ef9e-ee47-41db-9892-b7577aa0ddc4
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 1271204265894DD5AD8A2FB79C1B0B8D Ref B: TYO201151006031 Ref C: 2025-07-07T10:26:25Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '183'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g -a
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:26.5914347Z","lastUpdatedOn":"2025-07-07T10:26:26.5915249Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"a07b8337-a05a-4f9f-9357-ed01c39e6604"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:25.8776811Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:25.8776811Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '988'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/66fab4f7-4dfb-4fa7-a3b1-d3aa218171d7
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 8962E19CBB86404994069755706E786D Ref B: TYO201151002029 Ref C: 2025-07-07T10:26:25Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:26.5914347Z","lastUpdatedOn":"2025-07-07T10:26:26.5915249Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"a07b8337-a05a-4f9f-9357-ed01c39e6604"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:25.8776811Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:25.8776811Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '988'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/1cc66f54-5b4e-45e6-b9e0-648ab5d060a3
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '148'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 744C8248CC504729BF7D1CBAE9736DDB Ref B: TYO201151005060 Ref C: 2025-07-07T10:26:27Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:26.5914347Z","lastUpdatedOn":"2025-07-07T10:26:26.5915249Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"a07b8337-a05a-4f9f-9357-ed01c39e6604"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:25.8776811Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:25.8776811Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1000'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:27 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/3c8e45a7-aa47-4fb8-8d13-3ff05004969c
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: ED4CE49138B14BDC95D32314793A6A85 Ref B: TYO201100116025 Ref C: 2025-07-07T10:26:27Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2021-10-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:28 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/7eeff44b-f3a5-411b-afa3-4c6ff3795868
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 0142D0702D2C483FAADC34D2E89A5B4F Ref B: TYO201100113051 Ref C: 2025-07-07T10:26:28Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:26.5914347Z","lastUpdatedOn":"2025-07-07T10:26:26.5915249Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"a07b8337-a05a-4f9f-9357-ed01c39e6604"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:25.8776811Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:25.8776811Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '988'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japanwest/ded9d488-b635-4667-bd07-32e0a6d716b7
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '147'
      x-ms-ratelimit-remaining-subscription-deletes:
      - '199'
      x-ms-ratelimit-remaining-subscription-global-deletes:
      - '2999'
      x-msedge-ref:
      - 'Ref A: CCE546AD37DD44FC8BDFA6CDFBFA8198 Ref B: TYO201151001054 Ref C: 2025-07-07T10:26:29Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/78ce844f-4c20-4af1-af13-6db74bebaaf1
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: CB62BBCD96B5432C9676F97FCA0543D5 Ref B: TYO201151003042 Ref C: 2025-07-07T10:26:30Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -a --location-filters
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2023-04-01
  response:
    body:
      string: '{"value":[{"properties":{"displayName":"deny-nsg-rule-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-rule-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. Assign the policy
        again.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:07:29.1757898Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:23:20.4306328Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/36e07b214d59455886a2b76b","type":"Microsoft.Authorization/policyAssignments","name":"36e07b214d59455886a2b76b","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:23:20.325117Z"}},{"properties":{"displayName":"deny-nsg-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted it from my resource group
        and found that it applied to the the whole subscription.\nRe assign the policy.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:06:22.2583329Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:29:53.8929477Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5b5ec388a1b6480391640d13","type":"Microsoft.Authorization/policyAssignments","name":"5b5ec388a1b6480391640d13","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:29:53.8609992Z"}},{"properties":{"displayName":"deny_load_balancer_rules_and_inbound_nat_rules","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bfedda4d-ba65-4ba3-9df1-9eb8a13a0f09","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_azure-sample-node06b5c4550e194ae5ac_nodejs-sample06b5c4550e194ae5acdev_eastus","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/xichengroup"],"parameters":{},"description":"","metadata":{"assignedBy":"test@example.com
        ","parameterScopes":{},"createdBy":"b5ed59e8-f00d-4396-af62-8297e36d8b52","createdOn":"2020-04-16T10:28:45.5317863Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T07:43:58.5150353Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5d00856604b74b80927cca6e","type":"Microsoft.Authorization/policyAssignments","name":"5d00856604b74b80927cca6e","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T07:43:58.478803Z"}},{"properties":{"displayName":"deny-nic-no-nsg","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nic-no-nsg","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/wls-admin"],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. \nAssign the policy
        again.","metadata":{"assignedBy":"test@example.com ","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:04:31.0026973Z","updatedBy":"f0f844e0-d2fe-4aa3-8e2c-2e429618f305","updatedOn":"2020-09-11T07:46:03.3893374Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/8805e4466db647d1beda40e2","type":"Microsoft.Authorization/policyAssignments","name":"8805e4466db647d1beda40e2"},{"identity":{"principalId":"30601973-dcd6-4c4e-85e8-dc6e057238fa","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"displayName":"ASC
        DataProtection (subscription: 0b1f6471-1bf0-4dda-aec3-cb9272f09590)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","definitionVersion":"3.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center","createdBy":"2f8a138f-0955-44e1-9124-c386dfaecad4","createdOn":"2019-11-25T02:19:57.9086573Z","updatedBy":"062d5f19-c525-48c9-a809-3be8685b85d0","updatedOn":"2024-10-29T05:35:22.9920211Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter","type":"Microsoft.Authorization/policyAssignments","name":"DataProtectionSecurityCenter","location":"eastus","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2024-10-29T05:35:22.8883136Z"}},{"identity":{"principalId":"c44083df-c6be-4cfc-adab-afbe9e55fc6c","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2022-01-06T18:54:58.824404Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentb2i7mjcri","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentb2i7mjcri","location":"westus","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2022-01-06T18:54:57.7694834Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2022-01-06T18:54:57.7694834Z"}},{"properties":{"displayName":"test_assignment37erp","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policymnyzvdlzz","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-08-19T23:02:10.2750241Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj/providers/Microsoft.Authorization/policyAssignments/-bGpNMRxSf6Ecgpsw7K9ww","type":"Microsoft.Authorization/policyAssignments","name":"-bGpNMRxSf6Ecgpsw7K9ww","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2021-08-19T23:02:10.1625651Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-19T23:02:10.1625651Z"}},{"identity":{"principalId":"2e39dbd9-db71-4877-bd52-0b2736ff7370","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-06-24T23:13:58.5161882Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentmkw7g5ydg","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentmkw7g5ydg","location":"westus"},{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","createdOn":"2025-07-07T10:26:24.1434651Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:24.1127247Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:24.1127247Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10416'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/e9d5a9dc-62cf-4a15-8c0d-a8718672e876
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 664B6D4BFF59455A93ACD1E6A441C166 Ref B: TYO201151003023 Ref C: 2025-07-07T10:26:31Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003",
      "filters": {"locations": ["westus"]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '221'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -a --location-filters
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:32.3839951Z","lastUpdatedOn":"2025-07-07T10:26:32.3841674Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"4abf24cb-3cba-41a3-83b8-f2dee33c7466"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:31.8675351Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:31.8675351Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '981'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:31 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japanwest/b3551efa-2c27-40f3-917d-957b645026f7
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 9E9DA83B545B4097BA8449B076E82458 Ref B: TYO201151001054 Ref C: 2025-07-07T10:26:31Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:32.3839951Z","lastUpdatedOn":"2025-07-07T10:26:32.3841674Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"4abf24cb-3cba-41a3-83b8-f2dee33c7466"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:31.8675351Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:31.8675351Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '981'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/3af7885b-39f0-4eb6-905d-64ef7588dfee
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '148'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 09B555E4E1A1469A91E65956F310B4D3 Ref B: TYO201151002036 Ref C: 2025-07-07T10:26:32Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:32.3839951Z","lastUpdatedOn":"2025-07-07T10:26:32.3841674Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"4abf24cb-3cba-41a3-83b8-f2dee33c7466"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:31.8675351Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:31.8675351Z"}},{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediationagta56lk7lutts3cntg4wlntptje25r35afkzw5bjyjail2yrno7tv6/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignmentrbtjrriel","provisioningState":"Canceled","createdOn":"2025-06-19T00:45:37.2104688Z","lastUpdatedOn":"2025-06-19T00:45:52.6574576Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance","correlationId":"b7f0039a-259f-44f0-9a36-69909bfece79"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediationagta56lk7lutts3cntg4wlntptje25r35afkzw5bjyjail2yrno7tv6/providers/microsoft.policyinsights/remediations/azurecli-test-remediationryrqzpwaav3vr67","name":"azurecli-test-remediationryrqzpwaav3vr67","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"05e98f05-c170-4236-968f-5bf6b5884bfc","createdByType":"Application","createdAt":"2025-06-19T00:45:36.7607487Z","lastModifiedBy":"05e98f05-c170-4236-968f-5bf6b5884bfc","lastModifiedByType":"Application","lastModifiedAt":"2025-06-19T00:45:37.9906033Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2196'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japanwest/b62e6a6c-77fd-4d66-aa49-da54cc27179d
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: EF438D827CE94915AF44BCF3692827A8 Ref B: TYO201151001062 Ref C: 2025-07-07T10:26:33Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2021-10-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/7b71ced4-1036-4c23-9afa-4ab7aced8aa9
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: FBB291E64AEB45E8970872E2992529C8 Ref B: TYO201100113039 Ref C: 2025-07-07T10:26:34Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:32.3839951Z","lastUpdatedOn":"2025-07-07T10:26:32.3841674Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"4abf24cb-3cba-41a3-83b8-f2dee33c7466"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:31.8675351Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:31.8675351Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '981'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:34 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/31e8c62e-438b-43d7-b5eb-032ea418355f
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-deletes:
      - '199'
      x-ms-ratelimit-remaining-subscription-global-deletes:
      - '2999'
      x-msedge-ref:
      - 'Ref A: CBD4460FE7684799A02287516561E809 Ref B: TYO201100115047 Ref C: 2025-07-07T10:26:34Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediationagta56lk7lutts3cntg4wlntptje25r35afkzw5bjyjail2yrno7tv6/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignmentrbtjrriel","provisioningState":"Canceled","createdOn":"2025-06-19T00:45:37.2104688Z","lastUpdatedOn":"2025-06-19T00:45:52.6574576Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ReEvaluateCompliance","correlationId":"b7f0039a-259f-44f0-9a36-69909bfece79"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediationagta56lk7lutts3cntg4wlntptje25r35afkzw5bjyjail2yrno7tv6/providers/microsoft.policyinsights/remediations/azurecli-test-remediationryrqzpwaav3vr67","name":"azurecli-test-remediationryrqzpwaav3vr67","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"05e98f05-c170-4236-968f-5bf6b5884bfc","createdByType":"Application","createdAt":"2025-06-19T00:45:36.7607487Z","lastModifiedBy":"05e98f05-c170-4236-968f-5bf6b5884bfc","lastModifiedByType":"Application","lastModifiedAt":"2025-06-19T00:45:37.9906033Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1214'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:35 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/bc178e0c-73fd-4efe-bfa5-3cac085dd576
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '148'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: C0662E434FD14A9FA414034AC2169A92 Ref B: TYO201100115023 Ref C: 2025-07-07T10:26:35Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -a -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2023-04-01
  response:
    body:
      string: '{"value":[{"properties":{"displayName":"deny-nsg-rule-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-rule-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. Assign the policy
        again.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:07:29.1757898Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:23:20.4306328Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/36e07b214d59455886a2b76b","type":"Microsoft.Authorization/policyAssignments","name":"36e07b214d59455886a2b76b","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:23:20.325117Z"}},{"properties":{"displayName":"deny-nsg-internet-inbound","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nsg-internet-inbound","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":[],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted it from my resource group
        and found that it applied to the the whole subscription.\nRe assign the policy.","metadata":{"assignedBy":"test@example.com","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:06:22.2583329Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T08:29:53.8929477Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5b5ec388a1b6480391640d13","type":"Microsoft.Authorization/policyAssignments","name":"5b5ec388a1b6480391640d13","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T08:29:53.8609992Z"}},{"properties":{"displayName":"deny_load_balancer_rules_and_inbound_nat_rules","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/bfedda4d-ba65-4ba3-9df1-9eb8a13a0f09","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/MC_azure-sample-node06b5c4550e194ae5ac_nodejs-sample06b5c4550e194ae5acdev_eastus","/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/xichengroup"],"parameters":{},"description":"","metadata":{"assignedBy":"test@example.com
        ","parameterScopes":{},"createdBy":"b5ed59e8-f00d-4396-af62-8297e36d8b52","createdOn":"2020-04-16T10:28:45.5317863Z","updatedBy":"9ac534f1-d577-4034-a32d-48de400dacbf","updatedOn":"2021-08-30T07:43:58.5150353Z"},"enforcementMode":"DoNotEnforce","nonComplianceMessages":[]},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/5d00856604b74b80927cca6e","type":"Microsoft.Authorization/policyAssignments","name":"5d00856604b74b80927cca6e","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-30T07:43:58.478803Z"}},{"properties":{"displayName":"deny-nic-no-nsg","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/deny-nic-no-nsg","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","notScopes":["/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/wls-admin"],"parameters":{},"description":"The
        policy block deployment of domain service, I deleted the policy in my resource
        group, and found that will apply to the whole subscription. \nAssign the policy
        again.","metadata":{"assignedBy":"test@example.com ","parameterScopes":{},"createdBy":"97233d81-8d2d-4e63-8bd2-ae5707805489","createdOn":"2020-03-04T10:04:31.0026973Z","updatedBy":"f0f844e0-d2fe-4aa3-8e2c-2e429618f305","updatedOn":"2020-09-11T07:46:03.3893374Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/8805e4466db647d1beda40e2","type":"Microsoft.Authorization/policyAssignments","name":"8805e4466db647d1beda40e2"},{"identity":{"principalId":"30601973-dcd6-4c4e-85e8-dc6e057238fa","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"displayName":"ASC
        DataProtection (subscription: 0b1f6471-1bf0-4dda-aec3-cb9272f09590)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","definitionVersion":"3.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center","createdBy":"2f8a138f-0955-44e1-9124-c386dfaecad4","createdOn":"2019-11-25T02:19:57.9086573Z","updatedBy":"062d5f19-c525-48c9-a809-3be8685b85d0","updatedOn":"2024-10-29T05:35:22.9920211Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/DataProtectionSecurityCenter","type":"Microsoft.Authorization/policyAssignments","name":"DataProtectionSecurityCenter","location":"eastus","systemData":{"lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2024-10-29T05:35:22.8883136Z"}},{"identity":{"principalId":"c44083df-c6be-4cfc-adab-afbe9e55fc6c","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2022-01-06T18:54:58.824404Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediationlgndz3xh25i5rksf22v24v5ktefshapzjpxuadgtv52m72m45ioa6i6/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentb2i7mjcri","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentb2i7mjcri","location":"westus","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2022-01-06T18:54:57.7694834Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2022-01-06T18:54:57.7694834Z"}},{"properties":{"displayName":"test_assignment37erp","policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/azure-cli-test-policymnyzvdlzz","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj","parameters":{"allowedLocations":{"value":["australiaeast","eastus","japaneast","westus"]}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-08-19T23:02:10.2750241Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_resource_create_policy_assignment_randomq5oj2eod2ynsnt67h35oskjyuj/providers/Microsoft.Authorization/policyAssignments/-bGpNMRxSf6Ecgpsw7K9ww","type":"Microsoft.Authorization/policyAssignments","name":"-bGpNMRxSf6Ecgpsw7K9ww","systemData":{"createdBy":"azureclitest@azuresdkteam.onmicrosoft.com","createdByType":"User","createdAt":"2021-08-19T23:02:10.1625651Z","lastModifiedBy":"azureclitest@azuresdkteam.onmicrosoft.com","lastModifiedByType":"User","lastModifiedAt":"2021-08-19T23:02:10.1625651Z"}},{"identity":{"principalId":"2e39dbd9-db71-4877-bd52-0b2736ff7370","tenantId":"54826b22-38d6-4fb2-bad9-b7b93a3e9c5a","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw","parameters":{"tagName":{"value":"cliTagKey"},"tagValue":{"value":"cliTagValue"}},"metadata":{"createdBy":"181c08fa-7ac8-48a6-a869-342ab74566a4","createdOn":"2021-06-24T23:13:58.5161882Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation2hjllspdx6jvfnrp2dqxuxfp6cwt5g7w3ypb4qmzr7wlj5ommmeoldw/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignmentmkw7g5ydg","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignmentmkw7g5ydg","location":"westus"},{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","createdOn":"2025-07-07T10:26:24.1434651Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:24.1127247Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:24.1127247Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10416'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:36 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japanwest/2680b49f-b384-43c9-80cf-6e620f8349d7
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: B51FA92C178141028C70C301DCAE8A8B Ref B: TYO201151005040 Ref C: 2025-07-07T10:26:36Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '183'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -a -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:37.3162287Z","lastUpdatedOn":"2025-07-07T10:26:37.3163253Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"92306f4d-2bb9-4a21-9957-fe294e4fe3eb"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:36.9800899Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:36.9800899Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1053'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:36 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/04103b45-aefd-4d42-9a59-2a32b531f9c5
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '147'
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: F0D4FFED98CA4F00B404CE0FED6C0335 Ref B: TYO201100113051 Ref C: 2025-07-07T10:26:36Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:37.3162287Z","lastUpdatedOn":"2025-07-07T10:26:37.3163253Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"92306f4d-2bb9-4a21-9957-fe294e4fe3eb"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:36.9800899Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:36.9800899Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1053'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:37 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japanwest/c88dc1e3-4901-46cd-b6b8-718ca62c617a
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '146'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: E6EEEC440388473291F30197B7ADD3A9 Ref B: TYO201100116051 Ref C: 2025-07-07T10:26:37Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:37.3162287Z","lastUpdatedOn":"2025-07-07T10:26:37.3163253Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"92306f4d-2bb9-4a21-9957-fe294e4fe3eb"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:36.9800899Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:36.9800899Z"}}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1065'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:39 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/0954d2fd-15b2-44e1-ae29-59453437d0c6
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '149'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 8EBF9CD72B12472694C2BE95A34E5DAC Ref B: TYO201100116019 Ref C: 2025-07-07T10:26:39Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2021-10-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:39 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/365fe4da-22a3-4453-b119-a0377ddcab9c
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '148'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 2B1C956686134583A876819E01C2490A Ref B: TYO201151006034 Ref C: 2025-07-07T10:26:39Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2021-10-01
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2025-07-07T10:26:37.3162287Z","lastUpdatedOn":"2025-07-07T10:26:37.3163253Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0},"resourceDiscoveryMode":"ExistingNonCompliant","correlationId":"92306f4d-2bb9-4a21-9957-fe294e4fe3eb"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:36.9800899Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:36.9800899Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1053'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:41 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/051a3ee8-c742-4b23-9bbb-e3bf08d9453b
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '145'
      x-ms-ratelimit-remaining-subscription-deletes:
      - '199'
      x-ms-ratelimit-remaining-subscription-global-deletes:
      - '2999'
      x-msedge-ref:
      - 'Ref A: 66215355CB1F4D039268298F45C6E759 Ref B: TYO201100114029 Ref C: 2025-07-07T10:26:40Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --namespace --resource-type --resource
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations?api-version=2021-10-01
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:41 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/d0edf2e3-99a6-44fa-afcf-4d08e4dddee4
      x-ms-ratelimit-remaining-policy-insights-requests:
      - '148'
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: E8F22F34189A4B0E814FCF330F1EF859 Ref B: TYO201100113047 Ref C: 2025-07-07T10:26:41Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - AZURECLI/2.75.0 azsdk-python-core/1.31.0 Python/3.10.11 (Windows-10-10.0.26100-SP0)
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2023-04-01
  response:
    body:
      string: '{"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"d44a2991-98c6-47c3-b59b-2b30d72cfcc2","createdOn":"2025-07-07T10:26:24.1434651Z","updatedBy":null,"updatedOn":null},"enforcementMode":"Default"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003","systemData":{"createdBy":"test@example.com","createdByType":"User","createdAt":"2025-07-07T10:26:24.1127247Z","lastModifiedBy":"test@example.com","lastModifiedByType":"User","lastModifiedAt":"2025-07-07T10:26:24.1127247Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '859'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 07 Jul 2025 10:26:42 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=54826b22-38d6-4fb2-bad9-b7b93a3e9c5a,objectId=d44a2991-98c6-47c3-b59b-2b30d72cfcc2/japaneast/c6283db1-d77f-49b8-ad7a-2e12f19ee6b5
      x-ms-ratelimit-remaining-subscription-deletes:
      - '199'
      x-ms-ratelimit-remaining-subscription-global-deletes:
      - '2999'
      x-msedge-ref:
      - 'Ref A: 828FE490592D4BDC88BC972A538DCB51 Ref B: TYO201151003025 Ref C: 2025-07-07T10:26:42Z'
    status:
      code: 200
      message: OK
version: 1
