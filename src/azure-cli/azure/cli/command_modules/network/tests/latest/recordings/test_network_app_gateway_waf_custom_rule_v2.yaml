interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_app_gateway_waf_custom_rule_v2_000001?api-version=2022-09-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001","name":"cli_test_app_gateway_waf_custom_rule_v2_000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","test":"test_network_app_gateway_waf_custom_rule_v2","date":"2024-10-14T06:21:48Z","module":"network"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '442'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:21:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 712FF6E0E3874657B72DEA0217E82F4F Ref B: TYO201100115049 Ref C: 2024-10-14T06:21:59Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"location": "westus", "properties": {"managedRules": {"managedRuleSets":
      [{"ruleSetType": "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy create
      Connection:
      - keep-alive
      Content-Length:
      - '147'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"72516a19-61ec-4e45-8f32-0bed2b672dc5\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/a4ac9922-28be-4ff7-977f-859fa8e81db1?api-version=2024-03-01&t=638644837232596587&c=MIIHhzCCBm-gAwIBAgITfAWHizdXQLRDd48J5AAABYeLNzANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDUwHhcNMjQwOTIyMTIwNDAzWhcNMjUwMzIxMTIwNDAzWjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL3CpUYjuxooJSSrwK19FjzhBOC6rpM2nxEk8ZwpswjmQSs4371lD9cjpzoi1V66izrOAQO5dR4T7CBAdxC_T1La7B_GC0BLToEfDbOMLuij5eJKkGy743BYmNo5FXMcmO2f2PyZA8Q8FMkBzYwcpUlCBt0ofvjmFjb0o14-l_wkV8cVq6NA5rj5vzYRXrcBBDx0DXZzx0ey-DalD8BI5Efxzl0sFnA-qqtfi2y6thqMlNPWuGqiYFNmkko5caGs3a7hQy_mx3XdCDy2aWq0YXIqdiyYCA4MGA_vLQtjCUcC4EnHaLnPm-9OGFhKZHQZ2hQEFIYnnCNvsSRVaHBIatkCAwEAAaOCBHQwggRwMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHLBggrBgEFBQcBAQSCAb0wggG5MGMGCCsGAQUFBzAChldodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9DTzFQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDA1LmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDMuYW1lLmdibC9haWEvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MB0GA1UdDgQWBBR539nE3pOaYqC09YY5sInoMk2T-DAOBgNVHQ8BAf8EBAMCBaAwggEmBgNVHR8EggEdMIIBGTCCARWgggERoIIBDYY_aHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBR61hmFKHlscXYeYPjzS--iBUIWHTAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFQ1zkLj2l7rlyrM4j2l8rtJkHitIxnUkLkyeLRrVxZPkfV1_ABjrmrKVHwks1TT5vv190Z1rSszJ8F3BMbapuqZk7TG_eHqRVKnkNYrwXEAn99VULWloNnmsKbnii5qgA26KvYkNcrxJ4L_9pCm3mT47A_mvHkzKnovgy4XLdvqRPL1QGC_Itw4Y4QCb11tEdDabhFYx2hY0zhM3voH4pW_42NbuG3xwNLFeA2LThOsGcf_4F8bzQ6Pm__uo-XrnBE13ERimgL86M-z9h6W2bQUcKXqAf_RhKjv5ai9GEnITD2aoXBO8tu85DelvTvuH12hn2s2xEeYNMURYXNCzYc&s=f0vbiEYGo9PhCOlbHZYjLwFDzrgwwJbOo7xb33DEHVwWiJTCuCWTU1NrOUhvskOalR7ens4uZJe3jbrC4Avy9sGryEqe7GhhDxG69zJ2XCHVGVGqB-1XdsKaWtnXZlqoJEtDDEN0Y0V8xxfScNCYfZHHJnWZwr-519Jyx5j_oiBTstITwY_hWFpW3w06iraMpKvjIHgOywHqmd_ToBhIPb7GZFWW9W48YCkHOJxCbCFRcUYIwqWdRwz9DamKtYNlBk2qx72wgyRAyhswrJm0Fx5lV6A7_-Rhh60hHutt1o7Jv_PV96S8HtLCWTi8BXqh4slJ4MCYWw0M1Q0bf-ryUQ&h=Qitrz13qk79I2aJ2oOxRY7Mb6BAHxwsly0at9lSX-aY
      cache-control:
      - no-cache
      content-length:
      - '801'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:02 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - c0f8d3ec-2107-45f1-8be5-8551918119a8
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 271508C91CBC4FC98E34969890F53495 Ref B: TYO201151004040 Ref C: 2024-10-14T06:22:00Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule rule-set update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --type --version --group-name --rule --rule
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"05213ffe-9b43-4fc4-9dec-875663b9ecfc\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '802'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:03 GMT
      etag:
      - W/"05213ffe-9b43-4fc4-9dec-875663b9ecfc"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - c728bae6-cccc-47cd-87c7-f87062e89a7c
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: F36274D0483C4D2F8F5E5FA2CA2CABE7 Ref B: TYO201100117037 Ref C: 2024-10-14T06:22:03Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType": "Microsoft_DefaultRuleSet",
      "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement": true,
      "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule rule-set update
      Connection:
      - keep-alive
      Content-Length:
      - '661'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --type --version --group-name --rule --rule
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"05213ffe-9b43-4fc4-9dec-875663b9ecfc\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/4c5b6cf6-5cee-4e67-9a23-910db75d66c4?api-version=2024-03-01&t=638644837254284313&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=vxHxvB2jikeTUMj_lz_RwgbOxtRS08kQPH0kYliiM6o49DO--kK7oBBN-xoqvY3oUCpkmN4KjeKZpWB7Yg67MZvG7QR-fYAI7sQKTxQMVBBKXgLXKOkMgnx0cYjnsw52ogfEf2eoYbsIAoBKYHfHLDtcpQaK_opTou7Jcs138Kx7Nk4KP8F0efaDYpzuj69a6B9tUxZexGmnPTfwKh8_2XCgVAbWtqWBFe3ytJm3f1yFGs7vHYA2mwL5tRSvLbP4k19ELMtQGJzryRZV53zYbAgRBbZ5jOpFlHiYt0QeD5vrvGD4vcfJA-w6qQwsRZzPbOLhLZhlmnjOQMTqi1Pwgg&h=BkNr73XEpRQ8wgH27FX4Ogd1Ux6egBiF4QeD9rQPoUM
      cache-control:
      - no-cache
      content-length:
      - '802'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - e2da0ca7-c594-42e3-8d8b-a6fdf1511aac
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 29A5963400BC412AB3645217B078492B Ref B: TYO201100117037 Ref C: 2024-10-14T06:22:04Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version --group-name --rule-ids
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"05213ffe-9b43-4fc4-9dec-875663b9ecfc\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '802'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:06 GMT
      etag:
      - W/"05213ffe-9b43-4fc4-9dec-875663b9ecfc"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - f7992f13-59f9-4947-a164-235108d680f0
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3748'
      x-msedge-ref:
      - 'Ref A: BEB75000313A430495094D748FA629DD Ref B: TYO201151001060 Ref C: 2024-10-14T06:22:06Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      Content-Length:
      - '944'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version --group-name --rule-ids
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"fccd6960-8295-4319-a038-966f7851a4fb\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]}]}]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/09be8672-16ef-47c6-862d-eb2325e927ce?api-version=2024-03-01&t=638644837275975002&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=TUBXxWPQDGn0OAZCx0NwL2jIqIRBsF5ozzhwMZXgJw_C67OfaqYbteDcEPZr4m06WFAYiQFbGgZPL1MSt73dU3UYEdLWd1_gDQf57XSRUZ4Y_TpVAgpsuIezGeer2S9_nf4HudbHoDMxWtBu0OMSgwPn8iPLtvem3BZq3dHVLLLyFV1Znsipr-IB8t5F383_NdB9rWKkdmU3UAVcUFx0VDLkhl0MgJkH8ANN5zmbSu0eDhcoP0bLBU67WGnDE4aTkYrDLJxeS-xUGhhLWkeETgFZ_mzd_fTfGvXBabefpvkLUdIX0DBkYF2ZezpRPySxhW3zDNQU4Jh26UrvGk8K0A&h=yKpoEczuw0K-6tUfwiiAXMTbG-m1dp76eYzVL5lREsM
      cache-control:
      - no-cache
      content-length:
      - '1068'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - b1ab55db-53c4-4c52-b477-16bf31b922ec
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 7B3BD138E67C4610B310C71FC1C6295D Ref B: TYO201151001060 Ref C: 2024-10-14T06:22:06Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version --group-name
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"e5c11217-490b-4771-b11b-9965429f39a8\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]}]}]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1069'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:07 GMT
      etag:
      - W/"e5c11217-490b-4771-b11b-9965429f39a8"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - c5a18ae9-20b1-4273-a664-c596b72b82cd
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: E31A43631DBC47C19E672B72CC43AD84 Ref B: TYO201100113049 Ref C: 2024-10-14T06:22:08Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"}],
      "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType": "Microsoft_DefaultRuleSet",
      "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement": true,
      "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      Content-Length:
      - '1014'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version --group-name
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"aafed940-db64-4833-ab8c-0672f5647a20\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/93d84ce8-c332-4f3b-87c8-83be47ec1994?api-version=2024-03-01&t=638644837293958178&c=MIIHhzCCBm-gAwIBAgITfAWHizdXQLRDd48J5AAABYeLNzANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDUwHhcNMjQwOTIyMTIwNDAzWhcNMjUwMzIxMTIwNDAzWjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL3CpUYjuxooJSSrwK19FjzhBOC6rpM2nxEk8ZwpswjmQSs4371lD9cjpzoi1V66izrOAQO5dR4T7CBAdxC_T1La7B_GC0BLToEfDbOMLuij5eJKkGy743BYmNo5FXMcmO2f2PyZA8Q8FMkBzYwcpUlCBt0ofvjmFjb0o14-l_wkV8cVq6NA5rj5vzYRXrcBBDx0DXZzx0ey-DalD8BI5Efxzl0sFnA-qqtfi2y6thqMlNPWuGqiYFNmkko5caGs3a7hQy_mx3XdCDy2aWq0YXIqdiyYCA4MGA_vLQtjCUcC4EnHaLnPm-9OGFhKZHQZ2hQEFIYnnCNvsSRVaHBIatkCAwEAAaOCBHQwggRwMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHLBggrBgEFBQcBAQSCAb0wggG5MGMGCCsGAQUFBzAChldodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9DTzFQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDA1LmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDMuYW1lLmdibC9haWEvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MB0GA1UdDgQWBBR539nE3pOaYqC09YY5sInoMk2T-DAOBgNVHQ8BAf8EBAMCBaAwggEmBgNVHR8EggEdMIIBGTCCARWgggERoIIBDYY_aHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBR61hmFKHlscXYeYPjzS--iBUIWHTAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFQ1zkLj2l7rlyrM4j2l8rtJkHitIxnUkLkyeLRrVxZPkfV1_ABjrmrKVHwks1TT5vv190Z1rSszJ8F3BMbapuqZk7TG_eHqRVKnkNYrwXEAn99VULWloNnmsKbnii5qgA26KvYkNcrxJ4L_9pCm3mT47A_mvHkzKnovgy4XLdvqRPL1QGC_Itw4Y4QCb11tEdDabhFYx2hY0zhM3voH4pW_42NbuG3xwNLFeA2LThOsGcf_4F8bzQ6Pm__uo-XrnBE13ERimgL86M-z9h6W2bQUcKXqAf_RhKjv5ai9GEnITD2aoXBO8tu85DelvTvuH12hn2s2xEeYNMURYXNCzYc&s=ES_tGPxGIIAGi_rXWtaM1mXCAZD3wxjzw2tRMACVaXNbO_KMA14sB4bOL2i1KaedFImdo-zQzdhP-NgFu6T-MUZrGTYaePWXHGZhYPugZ4bZZaSpwWOkcOV5tujq8avMRc3SX7y6xa3xBBn_DvHbwFQxb5Y3cxQHrq-5AoBgjQ-Ow6JBmnZPXhVkmNJjr37f919_RUYuWivpJeOfheNK5yV58O8TBvFDmPzwNu8uya-XmsJwkNe-JdiLtaGZD-LR-eVmOoYclRDMp-f3V5nPvk6AM-BYJMMgj9rB86gx3F5Nn6w5-hpofp8d1iBZgnbWbSXT53unWMMenqGLqz9KjQ&h=QSBd_eXFl5kFPdF2aSOV4jCzumEaKcexnJNYRbW6_Cc
      cache-control:
      - no-cache
      content-length:
      - '1134'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 89387295-d636-4ac8-8c44-f991e809d98a
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 2761D3A17080461D888888AC170C3BD7 Ref B: TYO201100113049 Ref C: 2024-10-14T06:22:08Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"3eab6f3f-4f61-4517-b297-df056c7725a6\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1135'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:09 GMT
      etag:
      - W/"3eab6f3f-4f61-4517-b297-df056c7725a6"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - ee345cc0-4748-4e4d-9cfc-1d56d16d3ba9
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 95445108379347E19DF7D7456CBC179B Ref B: TYO201100114023 Ref C: 2024-10-14T06:22:10Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion rule-set add
      Connection:
      - keep-alive
      Content-Length:
      - '1209'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector --type
        --version
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"3353fd7b-7979-4617-97d1-7f76491a22df\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/235cf943-aba6-4270-957b-9990ca7e42ac?api-version=2024-03-01&t=638644837318220991&c=MIIHhzCCBm-gAwIBAgITfAWHizdXQLRDd48J5AAABYeLNzANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDUwHhcNMjQwOTIyMTIwNDAzWhcNMjUwMzIxMTIwNDAzWjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL3CpUYjuxooJSSrwK19FjzhBOC6rpM2nxEk8ZwpswjmQSs4371lD9cjpzoi1V66izrOAQO5dR4T7CBAdxC_T1La7B_GC0BLToEfDbOMLuij5eJKkGy743BYmNo5FXMcmO2f2PyZA8Q8FMkBzYwcpUlCBt0ofvjmFjb0o14-l_wkV8cVq6NA5rj5vzYRXrcBBDx0DXZzx0ey-DalD8BI5Efxzl0sFnA-qqtfi2y6thqMlNPWuGqiYFNmkko5caGs3a7hQy_mx3XdCDy2aWq0YXIqdiyYCA4MGA_vLQtjCUcC4EnHaLnPm-9OGFhKZHQZ2hQEFIYnnCNvsSRVaHBIatkCAwEAAaOCBHQwggRwMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHLBggrBgEFBQcBAQSCAb0wggG5MGMGCCsGAQUFBzAChldodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9DTzFQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDA1LmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDMuYW1lLmdibC9haWEvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MB0GA1UdDgQWBBR539nE3pOaYqC09YY5sInoMk2T-DAOBgNVHQ8BAf8EBAMCBaAwggEmBgNVHR8EggEdMIIBGTCCARWgggERoIIBDYY_aHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBR61hmFKHlscXYeYPjzS--iBUIWHTAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFQ1zkLj2l7rlyrM4j2l8rtJkHitIxnUkLkyeLRrVxZPkfV1_ABjrmrKVHwks1TT5vv190Z1rSszJ8F3BMbapuqZk7TG_eHqRVKnkNYrwXEAn99VULWloNnmsKbnii5qgA26KvYkNcrxJ4L_9pCm3mT47A_mvHkzKnovgy4XLdvqRPL1QGC_Itw4Y4QCb11tEdDabhFYx2hY0zhM3voH4pW_42NbuG3xwNLFeA2LThOsGcf_4F8bzQ6Pm__uo-XrnBE13ERimgL86M-z9h6W2bQUcKXqAf_RhKjv5ai9GEnITD2aoXBO8tu85DelvTvuH12hn2s2xEeYNMURYXNCzYc&s=VuP012otml6wZ-svnwuE57bXZI1UJ0q8gcGFPRkXViaTv6nsHJHPW56fbldJBVeadEjQKeFPKxweVVC_Qv-nBSWqMxMci2wvbOYksXPNMsG199eyWDGnY-pnJe9H26OM9dtuQHs-PkBZ2N9fUzrpmNQwu3WgM0cJFsGiaL4q8Ew1Fvl6qzP4lHBNSXps0nTh9GRXESYsuPIIMluZtTb-elfq3e5vIKE6NtNodICXm0jmZAYJ2-oDPTpSABSSe8iDcbAfmIkdUwHQa03-mE4KsCeZFobysz_jVDM4SRhWfR7667irlXVaYUPXxXqYTU-MqcIMDQwxpTIqclYg7R8kqg&h=D9IkLgKj-0omO1D1bwtryudw6BVfVPgkhDGzAt3PnOQ
      cache-control:
      - no-cache
      content-length:
      - '1316'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 97324c02-9b2d-4253-96b6-874df4eecce3
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 47797DCE20C8433F9C649D81F0F22BB8 Ref B: TYO201100114023 Ref C: 2024-10-14T06:22:10Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"8b4bf75f-84e3-4049-a257-a94fbd7b86ca\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1317'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:11 GMT
      etag:
      - W/"8b4bf75f-84e3-4049-a257-a94fbd7b86ca"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - b4189dc8-7e8f-411c-950d-1f3639d87b13
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 423A1DDAE8ED4F24BB9AFD0CFFFA7230 Ref B: TYO201100117021 Ref C: 2024-10-14T06:22:12Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"matchVariable": "RequestArgNames", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion add
      Connection:
      - keep-alive
      Content-Length:
      - '1306'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"c1d1ef1b-d8b7-4595-b0d0-80a13fe3e25c\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/b49cae6b-4dc5-4817-a9c3-03417630fe7e?api-version=2024-03-01&t=638644837334075743&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=dib-1QCFnflaVC7Te-oSdzFHcqtm9tx2h7yUic39ukJp-t1MZCvKQAe7pAP2uIniVDq2FCiCmtfmFAuQmh2v1lEtTidYp68n7kz_jOmbPTKXCWZWqMb_m5oIe2AbxETZIHvg-1omn3-FVPnx6pp5AAPgvGNo1GcJWvdDlIdCjvhhHvgPGvi9YzKOhW8_qhB6t55sviXCeZnB3wIrZkobw60R5RxUKaFtukb_FyWgKrxFyLQfbM0e7HvsJeGgAocOmsy6fchq4HJd-cihEgzAb4HJ_-BwadSQw9Nk0hJE2WWWqjquU4vbTRtFXsaISyZhwY786jyY_c_lYUVS1tHO-A&h=TzzO2RGzjGvCrnIak84iJYrzgo2ycdSk_kRhSiSo38g
      cache-control:
      - no-cache
      content-length:
      - '1437'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 3b3c0a66-e4df-4876-9782-5c2ce2bb99ce
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 2DE4740199734AF4994A0B73C1228C0F Ref B: TYO201100117021 Ref C: 2024-10-14T06:22:12Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"120dd3f1-dedf-4e6d-ae17-41c332c5adf5\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1438'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:13 GMT
      etag:
      - W/"120dd3f1-dedf-4e6d-ae17-41c332c5adf5"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 36024054-c638-4123-9fa7-97d97ad7a2af
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 945AC15707814019BE9EC3AC70425EFE Ref B: TYO201100117029 Ref C: 2024-10-14T06:22:13Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"matchVariable":
      "RequestArgValues", "selector": "test", "selectorMatchOperator": "StartsWith"}],
      "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType": "Microsoft_DefaultRuleSet",
      "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement": true,
      "fileUploadLimitInMb": 100, "maxRequestBodySizeInKb": 128, "mode": "Detection",
      "requestBodyCheck": true, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy managed-rule exclusion add
      Connection:
      - keep-alive
      Content-Length:
      - '1436'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --match-variable --selector-match-operator --selector
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"a37b6a76-128b-4650-83e5-3c4b9ea52a26\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/53586460-76bb-4e04-96e6-490adb970f2c?api-version=2024-03-01&t=638644837353245169&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=RNNzdc1npb2_6lacjFugv9iTlki0PIxBvJnkURPTaDJmmd85IdmafO1l0m_uOAeiAYe8crzZ_mcE7ojiE0W38SRrYC4n_vYPIJGaxGwwyU4M02jHC8aXiyejfvaAb9wy60mb5OZuJ9VQA6xiXiGYKZQ33wiKJIy2x8AsMvYLLJtQzDeem2KffFCSL4aBkJLC2DfcoUrCS8G8c_4TPgxuZcmYZcOVdnzvpSY5XLDMbXhQPa3jzMNp6rDY2GN3PNKgHUk1r_eTRqYMe26G-V5e67lWMojAa6W4OqjoDcMeNnAwlo89hzYJMqvB-oCRi9uiK3zlFKr5LXFxwqMS303mWA&h=W-rRGz43HXmeNsm5E3lbge5vQB6ohqwXNu3xfzT0GKQ
      cache-control:
      - no-cache
      content-length:
      - '1559'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:15 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 51ba20db-8396-4f13-8229-9da0a2be594c
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: D732131AB6E64BDBB404EDB9CB55A1C9 Ref B: TYO201100117029 Ref C: 2024-10-14T06:22:14Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy policy-setting update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name --log-scrubbing-state --scrubbing-rules
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"56f07fbd-f7e5-4884-a063-df35d9c2531a\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":true,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1560'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:15 GMT
      etag:
      - W/"56f07fbd-f7e5-4884-a063-df35d9c2531a"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 11455ae3-d27c-4afd-abbb-43247d7fe47b
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 5B44F38341E0457CB2ADC1F5AFA0E03B Ref B: TYO201151001052 Ref C: 2024-10-14T06:22:15Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy policy-setting update
      Connection:
      - keep-alive
      Content-Length:
      - '1737'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name --log-scrubbing-state --scrubbing-rules
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"e040c8bb-1a6d-4487-89e0-029a5fd31528\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/4138e199-b998-4061-b5b1-bfdde9a1f0a7?api-version=2024-03-01&t=638644837374138487&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=TmJb_jMN5jhNphncINm_bod_CyRA2M2N_73vFusXUb5bT-AGdPQC-YGRunwGdxpILjggeaGfwW-AIsg1gQlo6ZaVp-ikrBmDKRk8lDYPincGgXnUZX6ERpO8srWAQ84x4yfkSkSq86DIAyr-jc7QTf1hskPlWkOF9De6wYYsmbpNKj3RiahgGxtFmu4xzZb6iLz6f_IpqNeqPsZEgG4VXOQuy7MxDtJUgrTum5ffK7Wwrp8PlevwhKW1wA0hjj0WjdsYUavOFapOILHHx_eH2Rs9lxANH4a1Rg6YCi8Zlek9DvBsxs82l8ZuFPQGPcPMA0Bj4mhsfX3SyhndG6ElQQ&h=-amcrYAtZloisx6tyXksEB3ddQ25LildeH2yJ7sEeNk
      cache-control:
      - no-cache
      content-length:
      - '1810'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:16 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 8d75642a-5b56-4d06-bf22-40a81b3b13e5
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: A26AD0D7A091492996D2CBA55FE52305 Ref B: TYO201151001052 Ref C: 2024-10-14T06:22:16Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"f650812e-6db5-493e-a95f-6d1bd6f94205\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1811'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:18 GMT
      etag:
      - W/"f650812e-6db5-493e-a95f-6d1bd6f94205"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 2feb26d7-149d-43ca-a1ab-d90d7bf719be
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: FFFA7AB72A8842F5B4E1F869EE9FEE90 Ref B: TYO201151006042 Ref C: 2024-10-14T06:22:18Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "operator": "IPMatch"}], "name": "rule1", "priority": 1, "ruleType":
      "MatchRule", "state": "Enabled"}], "managedRules": {"exclusions": [{"exclusionManagedRuleSets":
      [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules":
      [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      Content-Length:
      - '1981'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"74f86ce6-125b-4a52-b52e-e84b85f9de79\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/954765bc-ff7d-4136-a971-ad425ee4346d?api-version=2024-03-01&t=638644837396896183&c=MIIHhzCCBm-gAwIBAgITfAWHizdXQLRDd48J5AAABYeLNzANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDUwHhcNMjQwOTIyMTIwNDAzWhcNMjUwMzIxMTIwNDAzWjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL3CpUYjuxooJSSrwK19FjzhBOC6rpM2nxEk8ZwpswjmQSs4371lD9cjpzoi1V66izrOAQO5dR4T7CBAdxC_T1La7B_GC0BLToEfDbOMLuij5eJKkGy743BYmNo5FXMcmO2f2PyZA8Q8FMkBzYwcpUlCBt0ofvjmFjb0o14-l_wkV8cVq6NA5rj5vzYRXrcBBDx0DXZzx0ey-DalD8BI5Efxzl0sFnA-qqtfi2y6thqMlNPWuGqiYFNmkko5caGs3a7hQy_mx3XdCDy2aWq0YXIqdiyYCA4MGA_vLQtjCUcC4EnHaLnPm-9OGFhKZHQZ2hQEFIYnnCNvsSRVaHBIatkCAwEAAaOCBHQwggRwMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHLBggrBgEFBQcBAQSCAb0wggG5MGMGCCsGAQUFBzAChldodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9DTzFQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDA1LmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDMuYW1lLmdibC9haWEvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MB0GA1UdDgQWBBR539nE3pOaYqC09YY5sInoMk2T-DAOBgNVHQ8BAf8EBAMCBaAwggEmBgNVHR8EggEdMIIBGTCCARWgggERoIIBDYY_aHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBR61hmFKHlscXYeYPjzS--iBUIWHTAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFQ1zkLj2l7rlyrM4j2l8rtJkHitIxnUkLkyeLRrVxZPkfV1_ABjrmrKVHwks1TT5vv190Z1rSszJ8F3BMbapuqZk7TG_eHqRVKnkNYrwXEAn99VULWloNnmsKbnii5qgA26KvYkNcrxJ4L_9pCm3mT47A_mvHkzKnovgy4XLdvqRPL1QGC_Itw4Y4QCb11tEdDabhFYx2hY0zhM3voH4pW_42NbuG3xwNLFeA2LThOsGcf_4F8bzQ6Pm__uo-XrnBE13ERimgL86M-z9h6W2bQUcKXqAf_RhKjv5ai9GEnITD2aoXBO8tu85DelvTvuH12hn2s2xEeYNMURYXNCzYc&s=H-3ar-Q26Ikw_w2Ua_nUuK3ISBrnnsi8lhkoAWIFZLob6ue3-nTQgU1i1ffS1CdF70kMS3vQ4TjRESW67AgNjpvhD6feZt-QSLewZeuGqI_5ffMY41zJUbKLh2B6QLG1_geHbaKUK9kKVPbvvxjT-sjFM2-cXSQZVVhFc7Yub0Pd_wj_b9m5Rt2_Ap8nfYgy_cgemJn00WmJR1E7wAr5VjMB-jqUf1-US3mhSkGdxSodk6qF4jMCeMSVj-65tdpHJap87XK3AyFT2AtpuD1e57y1zL4v05SFftattfLb9296r4wXotDea5b_Jox1Oto_zZNobo9mMyVzbf6GsTuxig&h=3I-CiziaQgYQfQiPZ1X9q7OuuHGVN9_ggWY8FSSMtHo
      cache-control:
      - no-cache
      content-length:
      - '2105'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:19 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - e6d14e1b-a006-4684-8534-a7255ea572a7
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 83996E4342AE4902999AE7A474535D87 Ref B: TYO201151006042 Ref C: 2024-10-14T06:22:18Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"dbc78bab-00d4-4840-8f80-cf18e08820c4\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2106'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:19 GMT
      etag:
      - W/"dbc78bab-00d4-4840-8f80-cf18e08820c4"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 5df19417-a011-4183-8de9-f923cb45ba5d
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 330F2113BDBC4E4D93B43156365EC9DB Ref B: TYO201151002009 Ref C: 2024-10-14T06:22:20Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "operator": "IPMatch"}],
      "name": "rule2", "priority": 2, "ruleType": "MatchRule", "state": "Enabled"}],
      "managedRules": {"exclusions": [{"exclusionManagedRuleSets": [{"ruleGroups":
      [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules": [{"ruleId":
      "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE", "rules":
      []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable": "RequestArgNames",
      "selector": "hello", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "EndsWith"},
      {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames", "selector":
      "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      Content-Length:
      - '2272'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"34de0481-aa8a-41b4-a56d-f687393cd42f\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/60fc3bfc-9b47-44b9-96c6-03c90b979412?api-version=2024-03-01&t=638644837417611744&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=higW8mupKmFSM_7MmidG_OIgDZdPXGzWLv0Sa-9_ny9aTgXSgaMNDzmji9IYO3URFAXh1mFn8XAJvL9LkCFRFW3x6YxCugie792GRDQYpTBDJb6zzT4MYddvONt-AvpXwBAV6wvbTKT9m2qfafSrSuCsYr8eySnsWwNJeGxP8NHIp9tly1w3IB7XBB1OiqZR4o8SySc4SGanwV6BFirkkbC-127ayh1Fm7RDjUfDB0wvW9kNnWAu2X58igu3EXDoLChdMNm9ezHu7E-v84O9HT4OKvIU3AE69CP9IuhqMkXcmC2bsrfmfblKODWRqgKBbYL4rWpA4WC2AbgQhyb1ZA&h=K0WN9xW9V2hpUpar0o_XRkEr2C5cnFcurKtolD5U-uE
      cache-control:
      - no-cache
      content-length:
      - '2401'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:20 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 764700cd-58c6-4620-9ce2-6dbf6f79108f
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 0AB74DCA455346288E48EE4E011B9444 Ref B: TYO201151002009 Ref C: 2024-10-14T06:22:20Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --negate
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"2862c3a0-2bdb-4338-8965-8895a871ba39\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2402'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:21 GMT
      etag:
      - W/"2862c3a0-2bdb-4338-8965-8895a871ba39"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 8948302b-5a6f-41cb-91e4-f55935f86660
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: B191E14A188647EBB088396A0577AA13 Ref B: TYO201151002054 Ref C: 2024-10-14T06:22:22Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch"}], "name":
      "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"}, {"action":
      "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}], "name": "rule2", "priority": 2, "ruleType":
      "MatchRule", "state": "Enabled"}], "managedRules": {"exclusions": [{"exclusionManagedRuleSets":
      [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules":
      [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '2471'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values --negate
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"c48689a1-87ef-4dd1-bc19-6a23fc0f1242\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/ccddf8a0-da52-4b7f-8299-b14e8b084b8a?api-version=2024-03-01&t=638644837443828793&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=T3Az5APG1aSPdPaWwYYIpsceHEeAGMAHCuYEfwYlDks6Z2fXnBc7XgZqyxSy_P9oKZdkZDt0Dtlu3dB1xE93h_D1cMr-ILe-AAhrxWQ5QK4mxWysm0XXWwVFe5Tx4NouNevLUWkRs7ic4ys_IhqmpRMjt_9ZZWDWiTpdfEpVjWDR6yomSxhSPUmGn7tgH8AMAneTZH0SgcUvd0Fv-JmLkrbULQekP4D2MGP9CTBt2kV5dF5AQEYboHo9Jh0NBifKR2b_3ubE2GZ06xJFCCx5iwwwxIpfm-RiQDO6W7QiaBMODE90ZRPs3IXnOgbuL5msy_BOdIK8OAc5-gcWjiu3sw&h=nncjj5sM6Zum0rnfPhvb8M5wVzFCYM8GkVLGwntApUw
      cache-control:
      - no-cache
      content-length:
      - '2561'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:23 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 70fcdbc6-0397-45f2-8ae7-9b21e8610af1
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 898962DBA21F491D9FD395F0F6E1416C Ref B: TYO201151002054 Ref C: 2024-10-14T06:22:23Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --negate --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"4c580d93-97aa-48c2-baee-2c6bbedd80ce\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2562'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:25 GMT
      etag:
      - W/"4c580d93-97aa-48c2-baee-2c6bbedd80ce"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - a13e2b01-a67e-4695-a9f6-b9031b679884
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: DE3BE5C542914688A344526A56A12EC7 Ref B: TYO201100116033 Ref C: 2024-10-14T06:22:25Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["192.168.1.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch"}], "name": "rule2", "priority": 2, "ruleType": "MatchRule",
      "state": "Enabled"}], "managedRules": {"exclusions": [{"exclusionManagedRuleSets":
      [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules":
      [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '2628'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --negate --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"4630ac8a-0e93-4b1c-b525-e71ba49bc8f0\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/6a2a5eaf-74c5-4057-b096-85303c415996?api-version=2024-03-01&t=638644837469299682&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=mOQ-ZnV-tmKEfhdRWQi_I-bJIrVPV9RfFRbkpqaIzjmP8QgSpM2-cgf9wXikBw7z4Hwq7bcFopRKJgOQdP8WWnMzc_kxD_3QMU3w8_qJOySu4Tr8DddkFtyuWm0llXSdvd2RMkTimylqvjOmYGOPkf3tpu-uMZK-SYnOL4rGwQaNPZs2SbMtt4C3QwybJVc4aCbYhVI37Ih1wBorf9sMyK-zMH1G3Jede91J-54vPHyRJzqK-DeFsVjf5m8WiUZETEY7ATj9eYojnMJ_6-jH4TywExMJMXjx9VAvs-yp1qBYSKMZSjfWJ098wgnk6HqNDV_H-FKJoAvinL9lrRsM2Q&h=9j4T6hKE8E2eX-9YrnseGgKPtay9angGgnYxlP7yCuc
      cache-control:
      - no-cache
      content-length:
      - '2707'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:26 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - b297282e-9e55-4b30-b55d-22803a136935
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: E62278C1B75F4652B81F551A57E6F0E4 Ref B: TYO201100116033 Ref C: 2024-10-14T06:22:26Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"23609638-1fb4-4a8d-b2f7-f40c8edc6978\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2708'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:28 GMT
      etag:
      - W/"23609638-1fb4-4a8d-b2f7-f40c8edc6978"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 9e73a3af-b8b0-4ad5-9a48-6849afb6534a
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 6F7F755DBA944E58A96FBEF2E6D8B2EB Ref B: TYO201151004023 Ref C: 2024-10-14T06:22:27Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["192.168.1.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["Windows"], "matchVariables":
      [{"selector": "UserAgent", "variableName": "RequestHeaders"}], "operator": "Contains"}],
      "name": "rule2", "priority": 2, "ruleType": "MatchRule", "state": "Enabled"}],
      "managedRules": {"exclusions": [{"exclusionManagedRuleSets": [{"ruleGroups":
      [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules": [{"ruleId":
      "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE", "rules":
      []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable": "RequestArgNames",
      "selector": "hello", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "EndsWith"},
      {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames", "selector":
      "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '2781'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"a62873f7-cc93-44c3-b4b9-b8026761c1e2\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/17fb2ea0-eb47-401c-b85c-91c564b4a1da?api-version=2024-03-01&t=638644837493334485&c=MIIHhzCCBm-gAwIBAgITfAWHizdXQLRDd48J5AAABYeLNzANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDUwHhcNMjQwOTIyMTIwNDAzWhcNMjUwMzIxMTIwNDAzWjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL3CpUYjuxooJSSrwK19FjzhBOC6rpM2nxEk8ZwpswjmQSs4371lD9cjpzoi1V66izrOAQO5dR4T7CBAdxC_T1La7B_GC0BLToEfDbOMLuij5eJKkGy743BYmNo5FXMcmO2f2PyZA8Q8FMkBzYwcpUlCBt0ofvjmFjb0o14-l_wkV8cVq6NA5rj5vzYRXrcBBDx0DXZzx0ey-DalD8BI5Efxzl0sFnA-qqtfi2y6thqMlNPWuGqiYFNmkko5caGs3a7hQy_mx3XdCDy2aWq0YXIqdiyYCA4MGA_vLQtjCUcC4EnHaLnPm-9OGFhKZHQZ2hQEFIYnnCNvsSRVaHBIatkCAwEAAaOCBHQwggRwMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHLBggrBgEFBQcBAQSCAb0wggG5MGMGCCsGAQUFBzAChldodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9DTzFQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDA1LmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDMuYW1lLmdibC9haWEvQ08xUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwNS5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0NPMVBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3J0MB0GA1UdDgQWBBR539nE3pOaYqC09YY5sInoMk2T-DAOBgNVHQ8BAf8EBAMCBaAwggEmBgNVHR8EggEdMIIBGTCCARWgggERoIIBDYY_aHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JshjFodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJbmZyYSUyMENBJTIwMDUuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBR61hmFKHlscXYeYPjzS--iBUIWHTAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFQ1zkLj2l7rlyrM4j2l8rtJkHitIxnUkLkyeLRrVxZPkfV1_ABjrmrKVHwks1TT5vv190Z1rSszJ8F3BMbapuqZk7TG_eHqRVKnkNYrwXEAn99VULWloNnmsKbnii5qgA26KvYkNcrxJ4L_9pCm3mT47A_mvHkzKnovgy4XLdvqRPL1QGC_Itw4Y4QCb11tEdDabhFYx2hY0zhM3voH4pW_42NbuG3xwNLFeA2LThOsGcf_4F8bzQ6Pm__uo-XrnBE13ERimgL86M-z9h6W2bQUcKXqAf_RhKjv5ai9GEnITD2aoXBO8tu85DelvTvuH12hn2s2xEeYNMURYXNCzYc&s=ATPBzlzPqr15qy_v7nSZGt7a-vzVNQZzqLj1MFYSfLHgjyO7UQ6EDcH1DqVxqI4PVRKIvewTf52YMsB1bEflW_cw6gx0rievGrFEzRRcIwChtHCbTaPONPEDmA2rPcBQE6gtvO-9JuSpf0xr0O3B2Ul1CtOaaq62HNdMRDoOiQut5M0r9xi__evqcqktRegGSxNbMCgi8kVR-NdrMtB-oVEl38TKpv2B6uh_GI-aGzWPZ1P_sG9PKSHv7iJHkyZeAyICZMzWM0BQAUumLDJY0qLhbJg3e57uYVXG8CRz-ux73Mm7AcP4lu7XlMDCOLrmDHH82DilP2cVoHrsJ-NVGg&h=nTuEZ23qSJoqIdlW60by3MMETJddc6Gjyt8ZqLRS0DY
      cache-control:
      - no-cache
      content-length:
      - '2874'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:29 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - e88f89a3-717b-49f4-bf35-47209db7ee2c
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 9279BC820750454786D7101510EF00FD Ref B: TYO201151004023 Ref C: 2024-10-14T06:22:28Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --rate-limit-duration
        --rate-limit-threshold --group-by-user-session --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"8dd1642b-6d1a-4b28-bf7c-306243406762\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '2875'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:29 GMT
      etag:
      - W/"8dd1642b-6d1a-4b28-bf7c-306243406762"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - bac993b9-4b75-438b-b3ee-92893325158a
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: E703BFC4462C41328ECD692BBBCBEBD6 Ref B: TYO201151002009 Ref C: 2024-10-14T06:22:29Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["192.168.1.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["Windows"], "matchVariables":
      [{"selector": "UserAgent", "variableName": "RequestHeaders"}], "negationConditon":
      false, "operator": "Contains", "transforms": []}], "name": "rule2", "priority":
      2, "ruleType": "MatchRule", "state": "Enabled"}, {"action": "Block", "groupByUserSession":
      [{"groupByVariables": [{"variableName": "GeoLocation"}]}], "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "operator": "IPMatch"}], "name": "rule3", "priority": 3, "rateLimitDuration":
      "FiveMins", "rateLimitThreshold": 15, "ruleType": "RateLimitRule", "state":
      "Enabled"}], "managedRules": {"exclusions": [{"exclusionManagedRuleSets": [{"ruleGroups":
      [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules": [{"ruleId":
      "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE", "rules":
      []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable": "RequestArgNames",
      "selector": "hello", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "EndsWith"},
      {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames", "selector":
      "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule create
      Connection:
      - keep-alive
      Content-Length:
      - '3216'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --priority --action --rule-type --rate-limit-duration
        --rate-limit-threshold --group-by-user-session --match-conditions
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"254522b4-c792-44f4-8b8c-717a279dfcfa\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule3","priority":3,"ruleType":"RateLimitRule","rateLimitDuration":"FiveMins","action":"Block","rateLimitThreshold":15,"matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"groupByUserSession":[{"groupByVariables":[{"variableName":"GeoLocation"}]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/67d85410-a359-4e36-9a5c-59afe860852b?api-version=2024-03-01&t=638644837509142344&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=czYoxK1OE6Ln4KXfKwkZM3Igh791aGAYCMakpsqqT8T-o15G--LLFeu4_A2Cr1fsDA3bULEHaIAsHo0nqgM_frBVd5AVMvYc1R9ZmVYlA8qts3A7aH5EaLoE0SvnOWux9zlHv8MI4MD7hvV9-rwrPDtm664gLZ-IQLFTPx6abZlc1LnNYtGLUeqmjt2j06O_myEzrofOpIIiDbAdTRbZHy9NlmX2bUDF4rXpihvqVnocnih9IRF3hPQK6HDIqrkVw4UByU9pwdkfGD5jhUn4PKLQqJho6Yxq8Y56Y3irekp54tYzBSFqVyMjPcQkOq3d2DqmXM7FeuqdS--U-_Chtw&h=OOj9llHtzm6mWD0hCoDBySP11e4C5eBTHnIUw_3jLp8
      cache-control:
      - no-cache
      content-length:
      - '3306'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:30 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 20a2cd06-47bc-4788-94e4-f455afcaa8ab
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 1BC83B7F4B384865AA2B642197FBFC56 Ref B: TYO201151002009 Ref C: 2024-10-14T06:22:30Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule update
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --rate-limit-duration --rate-limit-threshold --group-by-user-session
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"fa51951b-8ef1-4df3-9c52-603dc3fa4fc3\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule3","priority":3,"ruleType":"RateLimitRule","rateLimitDuration":"FiveMins","action":"Block","rateLimitThreshold":15,"matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"groupByUserSession":[{"groupByVariables":[{"variableName":"GeoLocation"}]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '3307'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:32 GMT
      etag:
      - W/"fa51951b-8ef1-4df3-9c52-603dc3fa4fc3"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 548e233e-ce82-4e8c-ba6d-a15f9a751d78
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: 9A940E7B47AA4023B0202184B2E872CC Ref B: TYO201151001011 Ref C: 2024-10-14T06:22:31Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["192.168.1.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["Windows"], "matchVariables":
      [{"selector": "UserAgent", "variableName": "RequestHeaders"}], "negationConditon":
      false, "operator": "Contains", "transforms": []}], "name": "rule2", "priority":
      2, "ruleType": "MatchRule", "state": "Enabled"}, {"action": "Block", "groupByUserSession":
      [{"groupByVariables": [{"variableName": "ClientAddr"}]}], "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule3", "priority": 3, "rateLimitDuration": "OneMin", "rateLimitThreshold":
      10, "ruleType": "RateLimitRule", "state": "Enabled"}], "managedRules": {"exclusions":
      [{"exclusionManagedRuleSets": [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI",
      "rules": [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule update
      Connection:
      - keep-alive
      Content-Length:
      - '3258'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --rate-limit-duration --rate-limit-threshold --group-by-user-session
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"c1d477dc-63b9-494d-b51f-ca6779b14242\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule3","priority":3,"ruleType":"RateLimitRule","rateLimitDuration":"OneMin","action":"Block","rateLimitThreshold":10,"matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"groupByUserSession":[{"groupByVariables":[{"variableName":"ClientAddr"}]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/03a6dcce-dbbb-4fa9-9f57-58ff686e5648?api-version=2024-03-01&t=638644837528629343&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=haWRTjPkNLj5dUCV47eI2WsSp15c7ZbZYFKTg8oFfzaz5SKmXcpbqdvdy-QEQnxFrTiUb0ieVBoC8TdBNP5L3hw07S7ByFaN9lUwX6TOemlvs1jz18MQUWCmyB26OwzbqawljprkGreKFxb7EcM2bgPb_v4f_WF8v-dOjbiQNT0u2uboePtTf6nyn4KK8iMf0tfv6QsxrN8IUSprJYIwRfzjqDaWgKBEFoQ1DLUl_8Cxx31poSDzBkiCxFtZvvig7e-Hls0Djw1EoCAwp6lX9Pk4bZ0QDtQN6UpL6vqPwOp-DtFiktRVPbw6NevdC5olLG-B8g4IpLuBOh_zvuSMiw&h=CFpuVwjZHNi2LFBNm0Zyv4mQnJKRxas5IbsGBjY56Pk
      cache-control:
      - no-cache
      content-length:
      - '3303'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:32 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - db03d98c-3cb8-4da8-85f4-9e91fa7050b4
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '199'
      x-msedge-ref:
      - 'Ref A: 098CE3FA300C4E20A4A276FBDDC2F154 Ref B: TYO201151001011 Ref C: 2024-10-14T06:22:32Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --policy-name -n --negate --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"23c2c9fd-f6ec-412f-a04b-df93c6e9a6ee\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Succeeded","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule3","priority":3,"ruleType":"RateLimitRule","rateLimitDuration":"OneMin","action":"Block","rateLimitThreshold":10,"matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]}],"groupByUserSession":[{"groupByVariables":[{"variableName":"ClientAddr"}]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '3304'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:33 GMT
      etag:
      - W/"23c2c9fd-f6ec-412f-a04b-df93c6e9a6ee"
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 439f6efa-2993-4d47-8f69-17de9a0a3cf2
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '3749'
      x-msedge-ref:
      - 'Ref A: E5F56742843242D7A537E3A6CB18660B Ref B: TYO201100115045 Ref C: 2024-10-14T06:22:33Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1",
      "location": "westus", "properties": {"customRules": [{"action": "Block", "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}], "name": "rule1", "priority": 1, "ruleType": "MatchRule", "state": "Enabled"},
      {"action": "Block", "matchConditions": [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["192.168.1.0/24"],
      "matchVariables": [{"variableName": "RemoteAddr"}], "negationConditon": false,
      "operator": "IPMatch", "transforms": []}, {"matchValues": ["Windows"], "matchVariables":
      [{"selector": "UserAgent", "variableName": "RequestHeaders"}], "negationConditon":
      false, "operator": "Contains", "transforms": []}], "name": "rule2", "priority":
      2, "ruleType": "MatchRule", "state": "Enabled"}, {"action": "Block", "groupByUserSession":
      [{"groupByVariables": [{"variableName": "ClientAddr"}]}], "matchConditions":
      [{"matchValues": ["192.168.2.0/24", "10.0.2.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": false, "operator": "IPMatch", "transforms":
      []}, {"matchValues": ["192.168.1.0/24", "10.0.0.0/24"], "matchVariables": [{"variableName":
      "RemoteAddr"}], "negationConditon": true, "operator": "IPMatch"}], "name": "rule3",
      "priority": 3, "rateLimitDuration": "OneMin", "rateLimitThreshold": 10, "ruleType":
      "RateLimitRule", "state": "Enabled"}], "managedRules": {"exclusions": [{"exclusionManagedRuleSets":
      [{"ruleGroups": [{"ruleGroupName": "REQUEST-930-APPLICATION-ATTACK-LFI", "rules":
      [{"ruleId": "930120"}]}, {"ruleGroupName": "REQUEST-932-APPLICATION-ATTACK-RCE",
      "rules": []}], "ruleSetType": "OWASP", "ruleSetVersion": "3.2"}], "matchVariable":
      "RequestArgNames", "selector": "hello", "selectorMatchOperator": "StartsWith"},
      {"exclusionManagedRuleSets": [{"ruleGroups": [], "ruleSetType": "OWASP", "ruleSetVersion":
      "3.2"}], "matchVariable": "RequestArgNames", "selector": "hello", "selectorMatchOperator":
      "EndsWith"}, {"exclusionManagedRuleSets": [], "matchVariable": "RequestArgNames",
      "selector": "test", "selectorMatchOperator": "StartsWith"}, {"exclusionManagedRuleSets":
      [], "matchVariable": "RequestArgValues", "selector": "test", "selectorMatchOperator":
      "StartsWith"}], "managedRuleSets": [{"ruleGroupOverrides": [], "ruleSetType":
      "Microsoft_DefaultRuleSet", "ruleSetVersion": "2.1"}]}, "policySettings": {"fileUploadEnforcement":
      true, "fileUploadLimitInMb": 100, "logScrubbing": {"scrubbingRules": [{"matchVariable":
      "RequestArgNames", "selector": "test", "selectorMatchOperator": "Equals", "state":
      "Enabled"}, {"matchVariable": "RequestIPAddress", "selectorMatchOperator": "EqualsAny",
      "state": "Enabled"}], "state": "Enabled"}, "maxRequestBodySizeInKb": 128, "mode":
      "Detection", "requestBodyCheck": false, "requestBodyEnforcement": true, "requestBodyInspectLimitInKB":
      128, "state": "Disabled"}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - network application-gateway waf-policy custom-rule match-condition add
      Connection:
      - keep-alive
      Content-Length:
      - '3411'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g --policy-name -n --negate --match-variables --operator --values
      User-Agent:
      - AZURECLI/2.65.0 azsdk-python-core/1.31.0 Python/3.12.7 (Windows-11-10.0.22631-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1?api-version=2024-03-01
  response:
    body:
      string: '{"name":"agp1","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_app_gateway_waf_custom_rule_v2_000001/providers/Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies/agp1","etag":"W/\"98154458-53ea-487d-9020-f9fa4dae6617\"","type":"Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies","location":"westus","properties":{"provisioningState":"Updating","customRules":[{"name":"rule1","priority":1,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule2","priority":2,"ruleType":"MatchRule","action":"Block","matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.1.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RequestHeaders","selector":"UserAgent"}],"operator":"Contains","negationConditon":false,"matchValues":["Windows"],"transforms":[]}],"skippedManagedRuleSets":[],"state":"Enabled"},{"name":"rule3","priority":3,"ruleType":"RateLimitRule","rateLimitDuration":"OneMin","action":"Block","rateLimitThreshold":10,"matchConditions":[{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":false,"matchValues":["192.168.2.0/24","10.0.2.0/24"],"transforms":[]},{"matchVariables":[{"variableName":"RemoteAddr"}],"operator":"IPMatch","negationConditon":true,"matchValues":["192.168.1.0/24","10.0.0.0/24"],"transforms":[]}],"groupByUserSession":[{"groupByVariables":[{"variableName":"ClientAddr"}]}],"skippedManagedRuleSets":[],"state":"Enabled"}],"policySettings":{"requestBodyCheck":false,"maxRequestBodySizeInKb":128,"fileUploadLimitInMb":100,"state":"Disabled","mode":"Detection","logScrubbing":{"state":"Enabled","scrubbingRules":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"Equals","selector":"test","state":"Enabled"},{"matchVariable":"RequestIPAddress","selectorMatchOperator":"EqualsAny","state":"Enabled"}]},"requestBodyInspectLimitInKB":128,"fileUploadEnforcement":true,"requestBodyEnforcement":true},"managedRules":{"managedRuleSets":[{"ruleSetType":"Microsoft_DefaultRuleSet","ruleSetVersion":"2.1","ruleGroupOverrides":[]}],"exclusions":[{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[{"ruleGroupName":"REQUEST-930-APPLICATION-ATTACK-LFI","rules":[{"ruleId":"930120"}]},{"ruleGroupName":"REQUEST-932-APPLICATION-ATTACK-RCE","rules":[]}]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"EndsWith","selector":"hello","exclusionManagedRuleSets":[{"ruleSetType":"OWASP","ruleSetVersion":"3.2","ruleGroups":[]}]},{"matchVariable":"RequestArgNames","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]},{"matchVariable":"RequestArgValues","selectorMatchOperator":"StartsWith","selector":"test","exclusionManagedRuleSets":[]}]}}}'
    headers:
      azure-asyncnotification:
      - Enabled
      azure-asyncoperation:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Network/locations/westus/operations/53ccfac1-2d10-4938-b830-18f01531066b?api-version=2024-03-01&t=638644837544613276&c=MIIHpTCCBo2gAwIBAgITOgO1eaNDEi_BvGCTxQAEA7V5ozANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSU5GUkEgQ0EgMDEwHhcNMjQwOTI0MDIxODE1WhcNMjUwMzIzMDIxODE1WjBAMT4wPAYDVQQDEzVhc3luY29wZXJhdGlvbnNpZ25pbmdjZXJ0aWZpY2F0ZS5tYW5hZ2VtZW50LmF6dXJlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMlHGdnqKLeF2F4OsgAOcHFNUAjiLFp6FCxlxQOYg51Cc3zek-BAsGf89aUGTGMJCdHE1mTaw1q_PUWPCksYWp3NcCCoVinm2o1MURSwaWIrqlNASHAEvb_ADFMgn4n4hc2vShYq2affaCR2GFiEUOUzENxFaDejcbaTAkH8VDqATpE-0Cs90fYiHo7MZO2TBnVbpKAC5zeCrw4nRGPYQx-V6X7jiQGDXIR-_OU8LW2XNvrrCvoPU5tFdlWYUQXvCArDZBYyBTw35HqRZVJeV7Nb1lFYUow80NtfPKaa782C2Gu9NeJ9CKvnuEzn6BsK50U06J63QS9iYtewwl8f_okCAwEAAaOCBJIwggSOMCcGCSsGAQQBgjcVCgQaMBgwCgYIKwYBBQUHAwEwCgYIKwYBBQUHAwIwPQYJKwYBBAGCNxUHBDAwLgYmKwYBBAGCNxUIhpDjDYTVtHiE8Ys-hZvdFs6dEoFghfmRS4WsmTQCAWQCAQcwggHaBggrBgEFBQcBAQSCAcwwggHIMGYGCCsGAQUFBzAChlpodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpaW5mcmEvQ2VydHMvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmwxLmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MFYGCCsGAQUFBzAChkpodHRwOi8vY3JsMi5hbWUuZ2JsL2FpYS9CWTJQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSU5GUkElMjBDQSUyMDAxKDQpLmNydDBWBggrBgEFBQcwAoZKaHR0cDovL2NybDMuYW1lLmdibC9haWEvQlkyUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMElORlJBJTIwQ0ElMjAwMSg0KS5jcnQwVgYIKwYBBQUHMAKGSmh0dHA6Ly9jcmw0LmFtZS5nYmwvYWlhL0JZMlBLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3J0MB0GA1UdDgQWBBSr8klupGadVT2XsbxtRSoLk5-S8jAOBgNVHQ8BAf8EBAMCBaAwggE1BgNVHR8EggEsMIIBKDCCASSgggEgoIIBHIZCaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NSTC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMS5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMi5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsMy5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JshjRodHRwOi8vY3JsNC5hbWUuZ2JsL2NybC9BTUUlMjBJTkZSQSUyMENBJTIwMDEoNCkuY3JsMIGdBgNVHSAEgZUwgZIwDAYKKwYBBAGCN3sBATBmBgorBgEEAYI3ewICMFgwVgYIKwYBBQUHAgIwSh5IADMAMwBlADAAMQA5ADIAMQAtADQAZAA2ADQALQA0AGYAOABjAC0AYQAwADUANQAtADUAYgBkAGEAZgBmAGQANQBlADMAMwBkMAwGCisGAQQBgjd7AwEwDAYKKwYBBAGCN3sEAjAfBgNVHSMEGDAWgBTl2Ztn_PjsurvwwKidileIud8-YzAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAHtj0YWqN3sYjYN-GBQMYMg1YMdzO7_Q-Mm2bT6ToQzKlQ8U_PWSHKQvJWHVz6OjdsyQku_l92cmgLYjEAsKHlKyDCUGz59BlajwSHMI_0DlBN2h773g9gi_Wn3K2PVudya1UlPloKAp4OM1m09oNeh0KByOgBBsgYVqwFpoHESoyDICFB_cnqZwNxw5ye-LGz4ePuRuzt9cKoe9ilJji_A2qUk1fJwdoxerf6Cm4EjYpfyGFVeXy4DodU8rwtg4rQt4YgjyxKtAqlFfMbJfqTqF4htWkY8wvqFKPXppJO8FYnc7A4R50cSPMF-Y70wHazRM1UXs0NWuK8_5R1Cw2Uo&s=tzG5t3IG3I7Mm4q79tytIluThWS9nr5Efqu4tEwjXEpE88YpPozuBhZ1OKmwGGqeFKXUpG0Jx6ZumNw0odfG78G563cpddBG1oqVu1NTlKjv0UZ3xaM7o-EkaeABmcgDzz1jJ6I6AfVYG-Z-JXo5JQUTrW1HB3pEJQ2ZmoWVUER0OiPijvQ76wToYDMXo_q5UlnBoMQ3p7yCMYtQqEGlWFfyU0Bdygfxcb5Ly8FbcZ8REUctnGNyRVDBmgCUcf71vqmyvm0Wi-JbXPVrfwnv6fXGihr99oz98MN1NNKBEHwwjp5m9hpmAmX6A7MiVDGyraKi8kmb5gfp8wMggv6cDQ&h=6uAXtcw6Y23-gBO0npl7KPT0_pKhEV72igy_uQBCEZw
      cache-control:
      - no-cache
      content-length:
      - '3462'
      content-type:
      - application/json; charset=utf-8
      date:
      - Mon, 14 Oct 2024 06:22:33 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-arm-service-request-id:
      - 08cfe2f7-d4e1-4be7-b55f-13a9fe733982
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '2998'
      x-ms-ratelimit-remaining-subscription-writes:
      - '198'
      x-msedge-ref:
      - 'Ref A: 29D344F68A7B488E9AE2E803DDD9D931 Ref B: TYO201100115045 Ref C: 2024-10-14T06:22:34Z'
    status:
      code: 200
      message: OK
version: 1
