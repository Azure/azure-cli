interactions:
- request:
    body: '{"location": "westus", "tags": {"product": "azurecli", "cause": "automation",
      "date": "2019-05-09T19:08:34Z"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - group create
      Connection:
      - keep-alive
      Content-Length:
      - '110'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - --location --name --tag
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        resourcemanagementclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001?api-version=2018-05-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001","name":"cli_test_remediation000001","location":"westus","tags":{"product":"azurecli","cause":"automation","date":"2019-05-09T19:08:34Z"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '384'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:35 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: '{"sku": {"name": "Standard_LRS"}, "kind": "Storage", "location": "westus"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - storage account create
      Connection:
      - keep-alive
      Content-Length:
      - '74'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -g -l --sku
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-storage/3.3.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002?api-version=2018-11-01
  response:
    body:
      string: ''
    headers:
      cache-control:
      - no-cache
      content-length:
      - '0'
      content-type:
      - text/plain; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:36 GMT
      expires:
      - '-1'
      location:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Storage/locations/westus/asyncoperations/d17c4497-058e-440c-8e8e-82c59ba27214?monitor=true&api-version=2018-11-01
      pragma:
      - no-cache
      server:
      - Microsoft-Azure-Storage-Resource-Provider/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1196'
    status:
      code: 202
      message: Accepted
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - storage account create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -l --sku
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-storage/3.3.0 Azure-SDK-For-Python AZURECLI/2.0.64
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Storage/locations/westus/asyncoperations/d17c4497-058e-440c-8e8e-82c59ba27214?monitor=true&api-version=2018-11-01
  response:
    body:
      string: '{"sku":{"name":"Standard_LRS","tier":"Standard"},"kind":"Storage","id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002","name":"cliremediation000002","type":"Microsoft.Storage/storageAccounts","location":"westus","tags":{},"properties":{"networkAcls":{"bypass":"AzureServices","virtualNetworkRules":[],"ipRules":[],"defaultAction":"Allow"},"supportsHttpsTrafficOnly":false,"encryption":{"services":{"file":{"enabled":true,"lastEnabledTime":"2019-05-09T19:08:36.7084248Z"},"blob":{"enabled":true,"lastEnabledTime":"2019-05-09T19:08:36.7084248Z"}},"keySource":"Microsoft.Storage"},"provisioningState":"Succeeded","creationTime":"2019-05-09T19:08:36.6303424Z","primaryEndpoints":{"blob":"https://cliremediation000002.blob.core.windows.net/","queue":"https://cliremediation000002.queue.core.windows.net/","table":"https://cliremediation000002.table.core.windows.net/","file":"https://cliremediation000002.file.core.windows.net/"},"primaryLocation":"westus","statusOfPrimary":"available"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1169'
      content-type:
      - application/json
      date:
      - Thu, 09 May 2019 19:08:53 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-Azure-Storage-Resource-Provider/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - storage account keys list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g --query -o
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-storage/3.3.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/listKeys?api-version=2018-11-01
  response:
    body:
      string: '{"keys":[{"keyName":"key1","value":"veryFakedStorageAccountKey==","permissions":"FULL"},{"keyName":"key2","value":"veryFakedStorageAccountKey==","permissions":"FULL"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '288'
      content-type:
      - application/json
      date:
      - Thu, 09 May 2019 19:08:55 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      server:
      - Microsoft-Azure-Storage-Resource-Provider/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2018-05-01
  response:
    body:
      string: '{"error":{"code":"PolicyDefinitionNotFound","message":"The policy definition
        ''06a78e20-9358-41c9-923c-fb736d382a4d'' could not be found."}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '138'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:55 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
    status:
      code: 404
      message: Not Found
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      ParameterSetName:
      - --policy -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2018-05-01
  response:
    body:
      string: '{"properties":{"displayName":"Audit VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '897'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:55 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: '{"properties": {"policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
      "scope": "/subscriptions/00000000-0000-0000-0000-000000000000"}, "sku": {"name":
      "A0", "tier": "Free"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '234'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - --policy -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2018-05-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"4290ae1b-4f92-4dc9-81fe-fab805a38536","createdOn":"2019-05-09T19:08:56.424989Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '618'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:56 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g -a
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2018-05-01
  response:
    body:
      string: '{"value":[{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"4290ae1b-4f92-4dc9-81fe-fab805a38536","createdOn":"2019-05-09T19:08:56.424989Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"ASC
        Default (subscription: 00977cdb-163f-435f-9c32-39ec8ae61f4d)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","parameters":{"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"},"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Batch Accounts
        must use a Pool Allocation Mode of User subscription on the Advanced tab to
        configure a VNet in the subscriptiong.  This enables the use of NSGs to secure
        the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.9760562Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.0025385Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/6bff79d27acb9c88","type":"Microsoft.Authorization/policyAssignments","name":"6bff79d27acb9c88"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"All C+AI Subscriptions
        must have a NSG on all VNets in the subscription.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.682075Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:40:00.2019682Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/aca4d19ab4e30392","type":"Microsoft.Authorization/policyAssignments","name":"aca4d19ab4e30392"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.5549343Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.3618916Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b65cf29bbd4b57d","type":"Microsoft.Authorization/policyAssignments","name":"b65cf29bbd4b57d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Kubernets must
        use the Advanced Networking option to configure the Kubernetes cluster to
        use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.085345Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:55.6577715Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/bce5fcf8b40531aa","type":"Microsoft.Authorization/policyAssignments","name":"bce5fcf8b40531aa"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"HDInsight Clusters
        must use the Custom configuration option to configure a VNet in the subscriptiong.  This
        enables the use of NSGs to secure the network traffic for the HDInsight cluster.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.3537501Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:38:59.5098707Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/fcbba78ebf3e874f","type":"Microsoft.Authorization/policyAssignments","name":"fcbba78ebf3e874f"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10572'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:56 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: 'b''{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003"}}'''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '186'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -g -a
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:08:57.9956491Z","lastUpdatedOn":"2019-05-09T19:08:58.0269023Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:58 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:08:57.9956491Z","lastUpdatedOn":"2019-05-09T19:08:58.0269023Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:58 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:08:57.9956491Z","lastUpdatedOn":"2019-05-09T19:08:58.0269023Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '744'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '599'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:08:57.9956491Z","lastUpdatedOn":"2019-05-09T19:08:58.0269023Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '732'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:08:59 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14999'
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:00 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -a --location-filters
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2018-05-01
  response:
    body:
      string: '{"value":[{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"4290ae1b-4f92-4dc9-81fe-fab805a38536","createdOn":"2019-05-09T19:08:56.424989Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"ASC
        Default (subscription: 00977cdb-163f-435f-9c32-39ec8ae61f4d)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","parameters":{"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"},"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Batch Accounts
        must use a Pool Allocation Mode of User subscription on the Advanced tab to
        configure a VNet in the subscriptiong.  This enables the use of NSGs to secure
        the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.9760562Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.0025385Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/6bff79d27acb9c88","type":"Microsoft.Authorization/policyAssignments","name":"6bff79d27acb9c88"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"All C+AI Subscriptions
        must have a NSG on all VNets in the subscription.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.682075Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:40:00.2019682Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/aca4d19ab4e30392","type":"Microsoft.Authorization/policyAssignments","name":"aca4d19ab4e30392"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.5549343Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.3618916Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b65cf29bbd4b57d","type":"Microsoft.Authorization/policyAssignments","name":"b65cf29bbd4b57d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Kubernets must
        use the Advanced Networking option to configure the Kubernetes cluster to
        use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.085345Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:55.6577715Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/bce5fcf8b40531aa","type":"Microsoft.Authorization/policyAssignments","name":"bce5fcf8b40531aa"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"HDInsight Clusters
        must use the Custom configuration option to configure a VNet in the subscriptiong.  This
        enables the use of NSGs to secure the network traffic for the HDInsight cluster.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.3537501Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:38:59.5098707Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/fcbba78ebf3e874f","type":"Microsoft.Authorization/policyAssignments","name":"fcbba78ebf3e874f"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10572'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:01 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: 'b''{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003",
      "filters": {"locations": ["westus"]}}}'''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '224'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -a --location-filters
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:02.2354798Z","lastUpdatedOn":"2019-05-09T19:09:02.2667401Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '676'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:02 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '598'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:02.2354798Z","lastUpdatedOn":"2019-05-09T19:09:02.2667401Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '676'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:02 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '597'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:02.2354798Z","lastUpdatedOn":"2019-05-09T19:09:02.2667401Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '688'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:03 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:03 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '596'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:02.2354798Z","lastUpdatedOn":"2019-05-09T19:09:02.2667401Z","filters":{"locations":["westus"]},"deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '676'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14998'
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:05 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '595'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -a -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2018-05-01
  response:
    body:
      string: '{"value":[{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"4290ae1b-4f92-4dc9-81fe-fab805a38536","createdOn":"2019-05-09T19:08:56.424989Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003"},{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"ASC
        Default (subscription: 00977cdb-163f-435f-9c32-39ec8ae61f4d)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","parameters":{"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"},"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Batch Accounts
        must use a Pool Allocation Mode of User subscription on the Advanced tab to
        configure a VNet in the subscriptiong.  This enables the use of NSGs to secure
        the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.9760562Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.0025385Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/6bff79d27acb9c88","type":"Microsoft.Authorization/policyAssignments","name":"6bff79d27acb9c88"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"All C+AI Subscriptions
        must have a NSG on all VNets in the subscription.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.682075Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:40:00.2019682Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/aca4d19ab4e30392","type":"Microsoft.Authorization/policyAssignments","name":"aca4d19ab4e30392"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.5549343Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.3618916Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b65cf29bbd4b57d","type":"Microsoft.Authorization/policyAssignments","name":"b65cf29bbd4b57d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Kubernets must
        use the Advanced Networking option to configure the Kubernetes cluster to
        use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.085345Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:55.6577715Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/bce5fcf8b40531aa","type":"Microsoft.Authorization/policyAssignments","name":"bce5fcf8b40531aa"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"HDInsight Clusters
        must use the Custom configuration option to configure a VNet in the subscriptiong.  This
        enables the use of NSGs to secure the network traffic for the HDInsight cluster.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.3537501Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:38:59.5098707Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/fcbba78ebf3e874f","type":"Microsoft.Authorization/policyAssignments","name":"fcbba78ebf3e874f"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '10572'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: 'b''{"properties": {"policyAssignmentId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003"}}'''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation create
      Connection:
      - keep-alive
      Content-Length:
      - '186'
      Content-Type:
      - application/json; charset=utf-8
      ParameterSetName:
      - -n -a -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:06.8416771Z","lastUpdatedOn":"2019-05-09T19:09:06.8729517Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '801'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '594'
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:06.8416771Z","lastUpdatedOn":"2019-05-09T19:09:06.8729517Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '801'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '594'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:06.8416771Z","lastUpdatedOn":"2019-05-09T19:09:06.8729517Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '813'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '593'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation deployment list
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: POST
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004/listDeployments?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '593'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations/azurecli-test-remediation000004?api-version=2018-07-01-preview
  response:
    body:
      string: '{"properties":{"policyAssignmentId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/microsoft.authorization/policyassignments/azurecli-test-policy-assignment000003","provisioningState":"Succeeded","createdOn":"2019-05-09T19:09:06.8416771Z","lastUpdatedOn":"2019-05-09T19:09:06.8729517Z","deploymentStatus":{"totalDeployments":0,"successfulDeployments":0,"failedDeployments":0}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001/providers/microsoft.storage/storageaccounts/cliremediation000002/providers/microsoft.policyinsights/remediations/azurecli-test-remediation000004","name":"azurecli-test-remediation000004","type":"Microsoft.PolicyInsights/remediations"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '801'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14997'
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '592'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy remediation list
      Connection:
      - keep-alive
      ParameterSetName:
      - -g --namespace --resource-type --resource
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        azure-mgmt-policyinsights/0.3.1 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_remediation000001/providers/Microsoft.Storage/storageAccounts/cliremediation000002/providers/Microsoft.PolicyInsights/remediations?api-version=2018-07-01-preview
  response:
    body:
      string: '{"value":[]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '12'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-policy-insights-requests:
      - '591'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        policyclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003?api-version=2018-05-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","metadata":{"createdBy":"4290ae1b-4f92-4dc9-81fe-fab805a38536","createdOn":"2019-05-09T19:08:56.424989Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/azurecli-test-policy-assignment000003","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-policy-assignment000003"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '618'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 09 May 2019 19:09:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14999'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - group delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - --name --yes --no-wait
      User-Agent:
      - python/3.7.2 (Darwin-18.2.0-x86_64-i386-64bit) msrest/0.6.6 msrest_azure/0.6.0
        resourcemanagementclient/2.1.0 Azure-SDK-For-Python AZURECLI/2.0.64
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_remediation000001?api-version=2018-05-01
  response:
    body:
      string: ''
    headers:
      cache-control:
      - no-cache
      content-length:
      - '0'
      date:
      - Thu, 09 May 2019 19:09:10 GMT
      expires:
      - '-1'
      location:
      - https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/operationresults/eyJqb2JJZCI6IlJFU09VUkNFR1JPVVBERUxFVElPTkpPQi1DTEk6NUZURVNUOjVGUkVNRURJQVRJT041UFZRVU9UVEwzQ1JNVEE2TldBUEQ0UXxGOTZDRTk2OEJGOTczOUNBLVdFU1RVUyIsImpvYkxvY2F0aW9uIjoid2VzdHVzIn0?api-version=2018-05-01
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14996'
    status:
      code: 202
      message: Accepted
version: 1
